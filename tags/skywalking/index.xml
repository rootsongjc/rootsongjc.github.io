<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Jimmy Song â€“ Skywalking</title>
    <link>https://jimmysong.io/tags/skywalking/</link>
    <description>Recent content in Skywalking on Jimmy Song</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Sat, 21 Oct 2023 10:18:40 +0800</lastBuildDate>
    
	  <atom:link href="https://jimmysong.io/tags/skywalking/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>ä½¿ç”¨ Argo é¡¹ç›® Istio åŠ SkyWalking å®ç° GitOps å’Œé‡‘ä¸é›€éƒ¨ç½²</title>
      <link>https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/</link>
      <pubDate>Sat, 21 Oct 2023 10:18:40 +0800</pubDate>
      
      <guid>https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/</guid>
      <description>
        
        
        


&lt;div class=&#34;alert&#34;&gt;
  
  &lt;div class=&#34;alert-note-title py-1 px-2&#34;&gt;
    å…³äºæœ¬æ–‡
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note py-1 px-2&#34;&gt;
    æœ¬æ–‡æ ¹æ®ç¬”è€…åœ¨ KubeCon&amp;amp;CloudNativeCon China 2023 çš„é€šè¯ä»“æ´»åŠ¨ &lt;a href=&#34;https://istioconchina2023.sched.com/event/1RoVG/nano-argo-istio-re-skywalking-jiong-gitops-reqi-zha-yao-pi-how-to-achieve-the-perfect-union-of-gitops-and-observability-with-argo-istio-and-skywalking-jimmy-song-tetrate&#34; title=&#34;IstioCon China&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IstioCon China&lt;/a&gt;
 ä¸Šçš„åˆ†äº«æ•´ç†è€Œæˆï¼ŒåŸæ ‡é¢˜ä¸ºã€Šå¦‚ä½•åœ¨ Argoã€Istio å’Œ SkyWalking ä¸­å®ç° GitOps å’Œå¯è§‚å¯Ÿæ€§çš„å®Œç¾ç»“åˆã€‹ã€‚
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;äº‘åŸç”Ÿåº”ç”¨çš„å‘å±•å¯¼è‡´å¼€å‘å·¦ç§»ï¼Œåº”ç”¨è¿­ä»£é¢‘ç‡æ›´é«˜ï¼Œè¿™å°±å‚¬ç”Ÿäº† GitOps çš„éœ€æ±‚ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Argo é¡¹ç›®ï¼ŒåŒ…æ‹¬ ArgoCD å’Œ Argo Rolloutsï¼Œé€šè¿‡ Istio å®ç° GitOps å’Œé‡‘ä¸é›€éƒ¨ç½²ã€‚æ–‡ä¸­è¿˜æœ‰ä¸€ä¸ªæ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åŸºäº Tetrate Service Expressï¼ˆä¹Ÿé€‚ç”¨äº Tetrate Service Bridgeï¼‰æä¾›çš„ Istio ç¯å¢ƒå®ç° GitOpsã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ demo çš„éƒ¨ç½²æ¶æ„å›¾å¦‚å›¾ 1 æ‰€ç¤ºã€‚å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰æœ¬æ–‡ä»‹ç»çš„éƒ¨ç½²ç­–ç•¥å’Œ Argo é¡¹ç›®ï¼Œå¯ä»¥ç›´æ¥è·³åˆ° &lt;a href=&#34;#demo&#34; title=&#34;demo éƒ¨åˆ†&#34;&gt;demo éƒ¨åˆ†&lt;/a&gt;
ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f1.svg&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f1.svg&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 1ï¼šåœ¨ TSE/TSB ä¸­ä½¿ç”¨ Istio å’Œ Argo é¡¹ç›®å®ç° GitOps å’Œé‡‘ä¸é›€å‘å¸ƒçš„æ¶æ„å›¾&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 1ï¼šåœ¨ TSE/TSB ä¸­ä½¿ç”¨ Istio å’Œ Argo é¡¹ç›®å®ç° GitOps å’Œé‡‘ä¸é›€å‘å¸ƒçš„æ¶æ„å›¾&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&#34;deployment-strategy&#34;&gt;éƒ¨ç½²ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘æƒ³ç®€å•ä»‹ç»ä¸€ä¸‹ Argo Rollouts æ”¯æŒçš„ä¸¤ç§éƒ¨ç½²ç­–ç•¥ï¼Œå¯ä»¥å®ç°é›¶åœæœºéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;è“ç»¿éƒ¨ç½²å’Œé‡‘ä¸é›€éƒ¨ç½²çš„æ­¥éª¤å¦‚å›¾ 2 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f2.svg&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f2.svg&#34; alt=&#34;image&#34; data-caption=&#34;Figure 2: Steps of blue-green deployment and canary deployment&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;Figure 2: Steps of blue-green deployment and canary deployment&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;è“ç»¿éƒ¨ç½²æ˜¯ä¸€ç§åœ¨å•ç‹¬çš„ç¯å¢ƒä¸­å¹¶è¡Œéƒ¨ç½²æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºè€Œä¸å½±å“å½“å‰ç”Ÿäº§ç¯å¢ƒçš„ç­–ç•¥ã€‚åœ¨è“ç»¿éƒ¨ç½²ä¸­ï¼Œå½“å‰çš„ç”Ÿäº§ç¯å¢ƒç§°ä¸ºâ€œè“è‰²ç¯å¢ƒâ€ï¼Œéƒ¨ç½²æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºçš„ç¯å¢ƒç§°ä¸ºâ€œç»¿è‰²ç¯å¢ƒâ€ã€‚ä¸€æ—¦ç»¿è‰²ç¯å¢ƒè¢«è®¤ä¸ºç¨³å®šå¹¶é€šè¿‡æµ‹è¯•ï¼Œæµé‡å°†é€æ¸ä»è“è‰²ç¯å¢ƒåˆ‡æ¢åˆ°ç»¿è‰²ç¯å¢ƒï¼Œè®©ç”¨æˆ·é€æ­¥æ¥å…¥æ–°ç‰ˆæœ¬ã€‚å¦‚æœåˆ‡æ¢è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šåˆ°è“ç¯å¢ƒï¼Œæœ€å¤§ç¨‹åº¦åœ°å‡å°‘å¯¹ç”¨æˆ·çš„å½±å“ã€‚è“ç»¿éƒ¨ç½²çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æä¾›é«˜å¯ç”¨æ€§å’Œé›¶åœæœºéƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;é‡‘ä¸é›€éƒ¨ç½²æ˜¯ä¸€ç§é€æ­¥å°†æ–°ç‰ˆæœ¬æˆ–åŠŸèƒ½å¼•å…¥ç”Ÿäº§ç¯å¢ƒçš„ç­–ç•¥ã€‚åœ¨é‡‘ä¸é›€éƒ¨ç½²ä¸­ï¼Œæ–°ç‰ˆæœ¬æˆ–æ–°åŠŸèƒ½é¦–å…ˆéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­çš„å°‘æ•°ç”¨æˆ·ï¼Œç§°ä¸ºâ€œé‡‘ä¸é›€ç”¨æˆ·â€ã€‚é€šè¿‡ç›‘æ§é‡‘ä¸é›€ç”¨æˆ·çš„åé¦ˆå’Œæ€§èƒ½æŒ‡æ ‡ï¼Œå¼€å‘å›¢é˜Ÿå¯ä»¥è¯„ä¼°æ–°ç‰ˆæœ¬æˆ–åŠŸèƒ½çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥é€æ­¥å°†æ›´å¤šç”¨æˆ·çº³å…¥é‡‘ä¸é›€éƒ¨ç½²ä¸­ï¼Œç›´åˆ°æ‰€æœ‰ç”¨æˆ·éƒ½ä½¿ç”¨æ–°ç‰ˆæœ¬ã€‚å¦‚æœå‘ç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šæˆ–ä¿®å¤ï¼Œé¿å…å¯¹æ•´ä¸ªç”¨æˆ·ç¾¤é€ æˆè´Ÿé¢å½±å“ã€‚é‡‘ä¸é›€éƒ¨ç½²çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å¿«é€Ÿå‘ç°é—®é¢˜å¹¶åœ¨å½±å“è¾ƒå°çš„èŒƒå›´å†…è¿›è¡Œè°ƒæ•´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è“ç»¿éƒ¨ç½²å’Œé‡‘ä¸é›€éƒ¨ç½²çš„ä¸»è¦åŒºåˆ«åœ¨äºéƒ¨ç½²æ–¹å¼å’Œå˜æ›´è§„æ¨¡ã€‚è“ç»¿éƒ¨ç½²æ˜¯å°†æ•´ä¸ªåº”ç”¨éƒ¨ç½²åœ¨æ–°çš„ç¯å¢ƒä¸­ï¼Œç„¶åè¿›è¡Œåˆ‡æ¢ï¼Œé€‚åˆå¤§è§„æ¨¡çš„å˜æ›´ï¼Œæ¯”å¦‚æ•´ä¸ªåº”ç”¨çš„é‡å¤§å‡çº§ã€‚é‡‘ä¸é›€éƒ¨ç½²é€æ¸å¼•å…¥æ–°ç‰ˆæœ¬æˆ–åŠŸèƒ½ï¼Œé€‚åˆå°è§„æ¨¡æ›´æ”¹ï¼Œä¾‹å¦‚æ·»åŠ æˆ–ä¿®æ”¹å•ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä»åº”ç”¨åœºæ™¯æ¥çœ‹ï¼Œè“ç»¿éƒ¨ç½²é€‚åˆå¯¹é«˜å¯ç”¨ã€é›¶å®•æœºéƒ¨ç½²è¦æ±‚è¾ƒé«˜çš„ç³»ç»Ÿã€‚åœ¨éƒ¨ç½²å¤§è§„æ¨¡å˜æ›´æ—¶ï¼Œè“ç»¿éƒ¨ç½²å¯ä»¥ä¿è¯ç¨³å®šæ€§å’Œå¯é æ€§ï¼Œå¹¶ä¸”å¯ä»¥å¿«é€Ÿå›æ»šä»¥åº”å¯¹çªå‘æƒ…å†µã€‚é‡‘ä¸é›€éƒ¨ç½²é€‚åˆéœ€è¦å¿«é€ŸéªŒè¯æ–°åŠŸèƒ½æˆ–ç‰ˆæœ¬çš„ç³»ç»Ÿã€‚é€šè¿‡é€æ­¥å¼•å…¥å˜æ›´ï¼Œå¯ä»¥åŠæ—©å‘ç°é—®é¢˜å¹¶è¿›è¡Œè°ƒæ•´ï¼Œå°½é‡å‡å°‘å¯¹ç”¨æˆ·çš„å½±å“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kuberentes-deployment&#34;&gt;Kubernetes Deployment çš„å‘å¸ƒç­–ç•¥&lt;/h2&gt;
&lt;p&gt;åœ¨ Kubernetes ä¸­ï¼ŒDeployment èµ„æºå¯¹è±¡æ˜¯ç®¡ç†åº”ç”¨ç¨‹åºéƒ¨ç½²å’Œæ›´æ–°çš„ä¸»è¦å·¥å…·ä¹‹ä¸€ã€‚éƒ¨ç½²æä¾›äº†ä¸€ç§å£°æ˜å¼æ–¹å¼æ¥å®šä¹‰åº”ç”¨ç¨‹åºçš„é¢„æœŸçŠ¶æ€ï¼Œå¹¶é€šè¿‡æ§åˆ¶å™¨çš„åŠŸèƒ½å®ç°å‘å¸ƒç­–ç•¥ã€‚Deployment çš„æ¶æ„å¦‚å›¾ 3 æ‰€ç¤ºï¼Œå…¶ä¸­å½©è‰²æ–¹å—ä»£è¡¨ä¸åŒç‰ˆæœ¬çš„ Podã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f3.svg&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f3.svg&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 3ï¼šKubernetes Deployment æ¶æ„å›¾&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 3ï¼šKubernetes Deployment æ¶æ„å›¾&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å‘å¸ƒç­–ç•¥å¯ä»¥åœ¨ Deployment çš„ spec å­—æ®µä¸­é…ç½®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å‘å¸ƒç­–ç•¥é€‰é¡¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ReplicaSet çš„ç®¡ç†ï¼šDeployment ä½¿ç”¨ ReplicaSet æ¥åˆ›å»ºå’Œç®¡ç†åº”ç”¨ç¨‹åºçš„å‰¯æœ¬ã€‚å¯ä»¥é€šè¿‡è®¾ç½® &lt;code&gt;spec.replicas&lt;/code&gt; å­—æ®µæ¥æŒ‡å®šæ‰€éœ€çš„å‰¯æœ¬æ•°é‡ã€‚åœ¨å‘å¸ƒè¿‡ç¨‹ä¸­ï¼ŒKubernetes æ§åˆ¶å™¨ä¿è¯æ–°ç‰ˆæœ¬ ReplicaSet çš„å‰¯æœ¬æ•°é‡åœ¨åˆ›å»ºæ—¶é€æ¸å¢åŠ ï¼Œæ—§ç‰ˆæœ¬ ReplicaSet çš„å‰¯æœ¬æ•°é‡åœ¨åˆ é™¤æ—¶é€æ¸å‡å°‘ï¼Œå®ç°å¹³æ»‘åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;æ»šåŠ¨æ›´æ–°ç­–ç•¥ï¼šéƒ¨ç½²æ”¯æŒå¤šç§æ»šåŠ¨æ›´æ–°ç­–ç•¥ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® &lt;code&gt;spec.strategy.type&lt;/code&gt; å­—æ®µæ¥é€‰æ‹©ã€‚å¸¸è§æ”¿ç­–åŒ…æ‹¬ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;RollingUpdate&lt;/code&gt;ï¼šé»˜è®¤ç­–ç•¥ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”é€æ¸æ›´æ–°å‰¯æœ¬ã€‚ä¸åŒæ—¶å¯ç”¨çš„å‰¯æœ¬æ•°é‡ä»¥åŠé¢å¤–å¯ç”¨çš„å‰¯æœ¬æ•°é‡å¯ä»¥é€šè¿‡è®¾ç½® &lt;code&gt;spec.strategy.rollingUpdate.maxUnavailable&lt;/code&gt; å’Œ &lt;code&gt;spec.strategy.rollingUpdate.maxSurge&lt;/code&gt; å­—æ®µæ¥æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ReCreate&lt;/code&gt;ï¼šè¯¥ç­–ç•¥åœ¨æ›´æ–°è¿‡ç¨‹ä¸­é¦–å…ˆåˆ é™¤æ—§ç‰ˆæœ¬çš„æ‰€æœ‰å‰¯æœ¬ï¼Œç„¶ååˆ›å»ºæ–°ç‰ˆæœ¬çš„å‰¯æœ¬ã€‚æ­¤ç­–ç•¥å°†å¯¼è‡´åº”ç”¨ç¨‹åºåœ¨æ›´æ–°æœŸé—´æš‚æ—¶ä¸å¯ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‰ˆæœ¬æ§åˆ¶ï¼šDeployment é€šè¿‡ &lt;code&gt;spec.template.metadata.labels&lt;/code&gt; å­—æ®µä¸ºæ¯ä¸ªç‰ˆæœ¬çš„ ReplicaSet è®¾ç½®æ ‡ç­¾ï¼Œä»¥ä¾¿æ§åˆ¶å™¨å‡†ç¡®è·Ÿè¸ªå’Œç®¡ç†ã€‚è¿™æ · ReplicaSet çš„å¤šä¸ªç‰ˆæœ¬å¯ä»¥å…±å­˜ï¼Œå¹¶ä¸”å¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªç‰ˆæœ¬çš„å‰¯æœ¬æ•°é‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ä½¿ç”¨è¿™äº›é…ç½®é€‰é¡¹ï¼ŒDeployment å¯ä»¥å®ç°ä¸åŒçš„å‘å¸ƒç­–ç•¥ã€‚æ›´æ–° Deployment å¯¹è±¡çš„ spec å­—æ®µå¯ä»¥è§¦å‘æ–°ç‰ˆæœ¬çš„å‘å¸ƒã€‚Kubernetes æ§åˆ¶å™¨ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥è‡ªåŠ¨å¤„ç†å‰¯æœ¬çš„åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ï¼Œä»¥å®ç°å¹³æ»‘çš„åº”ç”¨æ›´æ–°å’Œéƒ¨ç½²ç­–ç•¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;argocd-gitops&#34;&gt;ä½¿ç”¨ ArgoCD å®æ–½ GitOps&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ Deployment æ¥æ‰‹åŠ¨ç®¡ç†å‘å¸ƒç­–ç•¥ï¼Œä½†è¦å®ç°è‡ªåŠ¨åŒ–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ ArgoCD ç­‰ GitOps å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;ArgoCD æ˜¯ä¸€ä¸ªåŸºäº GitOps çš„æŒç»­äº¤ä»˜å·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–å’Œç®¡ç† Kubernetes åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€‚å®ƒä¸ºæé«˜åº”ç”¨ç¨‹åºéƒ¨ç½²çš„æ•ˆç‡å’Œå¯é æ€§æä¾›äº†ä¸€äº›å…³é”®çš„å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ ArgoCD ä¸º Kubernetes åº”ç”¨ç¨‹åºéƒ¨ç½²æä¾›çš„ä¸€äº›å¸®åŠ©ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å£°æ˜å¼é…ç½®&lt;/strong&gt;ï¼šArgoCD ä½¿ç”¨å£°æ˜å¼æ–¹å¼å®šä¹‰åº”ç”¨ç¨‹åºçš„é¢„æœŸçŠ¶æ€ï¼Œå¹¶å°†åº”ç”¨ç¨‹åºé…ç½®å­˜å‚¨åœ¨ Git å­˜å‚¨åº“ä¸­ã€‚é€šè¿‡ç‰ˆæœ¬æ§åˆ¶å’ŒæŒç»­é›†æˆ/æŒç»­äº¤ä»˜ (CI/CD) æµç¨‹ï¼Œå¯ä»¥è½»æ¾è·Ÿè¸ªå’Œç®¡ç†åº”ç”¨ç¨‹åºé…ç½®æ›´æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­éƒ¨ç½²&lt;/strong&gt;ï¼šArgoCD å¯ä»¥ç›‘æ§ Git å­˜å‚¨åº“ä¸­çš„é…ç½®å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° Kubernetes ç¯å¢ƒã€‚æä¾›å¯å®šåˆ¶çš„åŒæ­¥ç­–ç•¥ï¼Œè‡ªåŠ¨è§¦å‘åº”ç”¨éƒ¨ç½²å’Œæ›´æ–°ï¼Œå®ç°æŒç»­éƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€æ¯”è¾ƒå’Œè‡ªåŠ¨ä¿®å¤&lt;/strong&gt;ï¼šArgoCD å®šæœŸæ£€æŸ¥åº”ç”¨ç¨‹åºçš„å½“å‰çŠ¶æ€å¹¶å°†å…¶ä¸é¢„æœŸçŠ¶æ€è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå‘ç°ä¸ä¸€è‡´ï¼Œå®ƒä¼šè‡ªåŠ¨å°è¯•ä¿®å¤å¹¶å°†åº”ç”¨ç¨‹åºæ¢å¤åˆ°æ‰€éœ€çŠ¶æ€ï¼Œä»¥ç¡®ä¿é¢„æœŸçŠ¶æ€ä¸å®é™…çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šç¯å¢ƒç®¡ç†&lt;/strong&gt;ï¼šArgoCD æ”¯æŒç®¡ç†å¤šä¸ª Kubernetes ç¯å¢ƒï¼Œä¾‹å¦‚å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒã€‚å¯ä»¥è½»æ¾åœ°åœ¨ä¸åŒç¯å¢ƒä¹‹é—´éƒ¨ç½²å’ŒåŒæ­¥åº”ç”¨é…ç½®ï¼Œç¡®ä¿ä¸€è‡´æ€§å’Œå¯æ§æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ Deployment èµ„æºå¯¹è±¡ç›¸æ¯”ï¼ŒArgoCD æä¾›äº†æ›´é«˜çº§çš„åŠŸèƒ½å’Œå·¥ä½œæµç¨‹ï¼Œè¡¥å……äº†åŸç”Ÿ Kubernetes èµ„æºå¯¹è±¡çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºäº GitOps çš„é…ç½®ç®¡ç†&lt;/strong&gt;ï¼šArgoCD å°†åº”ç”¨ç¨‹åºé…ç½®å­˜å‚¨åœ¨ Git å­˜å‚¨åº“ä¸­ï¼Œä»è€Œå®ç°åŸºäº GitOps çš„é…ç½®ç®¡ç†ã€‚è¿™ç§æ–¹æ³•ç¡®ä¿é…ç½®æ›´æ”¹æ˜¯å¯è·Ÿè¸ªã€å¯å®¡è®¡çš„ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç°æœ‰çš„ CI/CD ç®¡é“é›†æˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è‡ªåŠ¨åŒ–éƒ¨ç½²å’ŒæŒç»­äº¤ä»˜&lt;/strong&gt;ï¼šArgoCD å¯ä»¥è‡ªåŠ¨æ£€æµ‹ Git å­˜å‚¨åº“ä¸­çš„é…ç½®æ›´æ”¹å¹¶å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° Kubernetes ç¯å¢ƒï¼Œä»è€Œå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²å’ŒæŒç»­äº¤ä»˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;çŠ¶æ€ç®¡ç†å’Œè‡ªåŠ¨æ¢å¤&lt;/strong&gt;ï¼šArgoCD æŒç»­ç›‘æ§åº”ç”¨ç¨‹åºçš„çŠ¶æ€å¹¶å°†å…¶ä¸é¢„æœŸçŠ¶æ€è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ£€æµ‹åˆ°ä¸ä¸€è‡´ï¼Œå®ƒä¼šè‡ªåŠ¨æ¢å¤å¹¶ç¡®ä¿åº”ç”¨ç¨‹åºçŠ¶æ€ä¸é¢„æœŸçŠ¶æ€ä¿æŒä¸€è‡´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;istio-routing-traffic&#34;&gt;ä½¿ç”¨ Istio å®ç°ç»†ç²’åº¦çš„æµé‡è·¯ç”±&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ ArgoCD å¯ä»¥å®ç° GitOpsï¼Œä½†å®ƒæœ¬è´¨ä¸Šæ˜¯åœ¨ Kubernetes éƒ¨ç½²ä¸Šè¿è¡Œå¹¶é€šè¿‡å‰¯æœ¬æ•°é‡æ§åˆ¶æµé‡è·¯ç”±ã€‚ä¸ºäº†å®ç°ç»†ç²’åº¦çš„æµé‡è·¯ç”±ï¼Œä½¿ç”¨äº† Istio ç­‰æœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;p&gt;Istio é€šè¿‡ä»¥ä¸‹æ–¹æ³•å®ç°æ›´ç»†ç²’åº¦çš„æµé‡è·¯ç”±å’Œåº”ç”¨å‘å¸ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;VirtualService&lt;/strong&gt;ï¼šIstio ä½¿ç”¨ VirtualService æ¥å®šä¹‰æµé‡è·¯ç”±è§„åˆ™ã€‚é€šè¿‡é…ç½® VirtualServiceï¼Œå¯ä»¥æ ¹æ®è¯·æ±‚å¤´ã€è·¯å¾„ã€æƒé‡ç­‰è¯·æ±‚å±æ€§å¯¹æµé‡è¿›è¡Œè·¯ç”±å’Œåˆ†å‘ï¼Œå°†è¯·æ±‚å®šå‘åˆ°ä¸åŒçš„æœåŠ¡å®ä¾‹æˆ–ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DestinationRule&lt;/strong&gt;ï¼šIstio çš„ DestinationRule ç”¨äºå®šä¹‰æœåŠ¡ç‰ˆæœ¬ç­–ç•¥å’Œè´Ÿè½½å‡è¡¡è®¾ç½®ã€‚é€šè¿‡æŒ‡å®šä¸åŒç‰ˆæœ¬æœåŠ¡å®ä¾‹ä¹‹é—´ä¸åŒçš„æµé‡æƒé‡ï¼Œå¯ä»¥å®ç°é‡‘ä¸é›€å‘å¸ƒã€è“ç»¿éƒ¨ç½²ç­‰é«˜çº§åº”ç”¨å‘å¸ƒç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æµé‡æ§åˆ¶å’Œç­–ç•¥&lt;/strong&gt;ï¼šIstio æä¾›äº†ä¸°å¯Œçš„æµé‡æ§åˆ¶å’Œç­–ç•¥èƒ½åŠ›ï¼Œå¦‚æµé‡é™åˆ¶ã€æ•…éšœæ³¨å…¥ã€è¶…æ—¶è®¾ç½®ã€é‡è¯•æœºåˆ¶ç­‰ï¼Œè¿™äº›åŠŸèƒ½å¸®åŠ©åº”ç”¨ç¨‹åºå®ç°æ›´é«˜çº§åˆ«çš„è´Ÿè½½å‡è¡¡ã€å®¹é”™å’Œå¯é æ€§è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ ArgoCD å’Œ Kubernetes Deployment å¯¹è±¡ç›¸æ¯”ï¼ŒIstio åœ¨åº”ç”¨éƒ¨ç½²æ–¹é¢æä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç»†ç²’åº¦çš„æµé‡è·¯ç”±æ§åˆ¶&lt;/strong&gt;ï¼šIstio æä¾›äº†æ›´ä¸°å¯Œçš„æµé‡è·¯ç”±èƒ½åŠ›ï¼Œå¯ä»¥æ ¹æ®å¤šç§è¯·æ±‚å±æ€§è¿›è¡Œçµæ´»çš„è·¯ç”±å’Œåˆ†å‘ï¼Œä»è€Œå®ç°æ›´ç»†ç²’åº¦çš„æµé‡æ§åˆ¶å’Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é«˜çº§å‘å¸ƒç­–ç•¥æ”¯æŒ&lt;/strong&gt;ï¼šIstio çš„ DestinationRule å¯ä»¥æŒ‡å®šä¸åŒç‰ˆæœ¬æœåŠ¡å®ä¾‹ä¹‹é—´çš„æµé‡æƒé‡ï¼Œæ”¯æŒé‡‘ä¸é›€å‘å¸ƒã€è“ç»¿éƒ¨ç½²ç­‰é«˜çº§åº”ç”¨å‘å¸ƒç­–ç•¥ã€‚è¿™ä½¿å¾—åº”ç”¨ç¨‹åºçš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒæ›´åŠ çµæ´»å¯æ§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼ºå¤§çš„æµé‡æ§åˆ¶å’Œç­–ç•¥èƒ½åŠ›&lt;/strong&gt;ï¼šIstio æä¾›äº†ä¸°å¯Œçš„æµé‡æ§åˆ¶å’Œç­–ç•¥èƒ½åŠ›ï¼Œå¦‚æµé‡é™åˆ¶ã€æ•…éšœæ³¨å…¥ã€è¶…æ—¶è®¾ç½®ã€é‡è¯•æœºåˆ¶ç­‰ï¼Œè¿™äº›åŠŸèƒ½å¸®åŠ©åº”ç”¨ç¨‹åºå®ç°æ›´é«˜çº§åˆ«çš„è´Ÿè½½å‡è¡¡ã€å®¹é”™å’Œå¯é æ€§è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å°† Istio ä¸ Argo Rollouts ç›¸ç»“åˆï¼Œå¯ä»¥å……åˆ†å‘æŒ¥ Istio ç»†ç²’åº¦æµé‡è·¯ç”±çš„ä¼˜åŠ¿ã€‚ç°åœ¨è®©æˆ‘ä»¬ä¸€èµ·è¿›è¡Œæ¼”ç¤ºã€‚åœ¨æˆ‘ä»¬çš„æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ TSE æä¾›çš„ Kubernetes å’Œ Istio ç¯å¢ƒï¼Œä½¿ç”¨ ArgoCD å®ç° GitOpsï¼Œå¹¶ä½¿ç”¨ Argo Rollouts å®ç°é‡‘ä¸é›€å‘å¸ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;demo&#34;&gt;Demo&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ¼”ç¤ºä¸­ä½¿ç”¨çš„è½¯ä»¶ç‰ˆæœ¬æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kubernetes v1.24.14&lt;/li&gt;
&lt;li&gt;Istio v1.15.7&lt;/li&gt;
&lt;li&gt;Argo CD v2.7.4&lt;/li&gt;
&lt;li&gt;Argo å‘å¸ƒ v1.5.1&lt;/li&gt;
&lt;li&gt;TSE Preview 2&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å°†ä½¿ç”¨ Istio çš„ VirtualService å’Œ DestinationRule æ¥å®ç°åŸºäº Subset çš„æµé‡åˆ†ç»„è·¯ç”±ï¼Œå¹¶ä½¿ç”¨ ArgoCD Rollouts è¿›è¡Œæ¸è¿›å¼å‘å¸ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;deployment-argocd-and-rollouts&#34;&gt;éƒ¨ç½² ArgoCD å’Œ Argo Rollouts&lt;/h3&gt;
&lt;p&gt;æˆ‘æå‰åˆ›å»ºäº†ä¸€ä¸ª Kubernetes é›†ç¾¤å¹¶å°†å…¶æ·»åŠ åˆ° TSE ä¸­ï¼ŒTSE ä¼šè‡ªåŠ¨ä¸ºé›†ç¾¤å®‰è£… Istio æ§åˆ¶å¹³é¢ã€‚æˆ‘ä»¬è¿˜éœ€è¦å®‰è£… ArgoCD å’Œ Argo Rolloutsï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Install ArgoCD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create namespace argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Install ArgoCD CLI on macOS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;brew install argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change the service type of argocd-server to LoadBalancer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl patch svc argocd-server -n argocd -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;spec&amp;#34;: {&amp;#34;type&amp;#34;: &amp;#34;LoadBalancer&amp;#34;}}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Get the ArgoCD UI address&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ARGOCD_ADDR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get svc argocd-server -n argocd -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{.status.loadBalancer.ingress[0].hostname}&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Login using ArgoCD CLI, see https://argo-cd.readthedocs.io/en/stable/getting_started/#4-login-using-the-cli to get password&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd login &lt;span class=&#34;nv&#34;&gt;$ARGOCD_ADDR&lt;/span&gt; --skip-test-tls --grpc-web --insecure
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Install Argo Rollouts&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create namespace argo-rollouts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/download/latest/install.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Install rollouts plugin on macOS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -LO https://github.com/argoproj/argo-rollouts/releases/download/v1.5.0/kubectl-argo-rollouts-darwin-amd64
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;chmod +x ./kubectl-argo-rollouts-darwin-amd64
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo mv ./kubectl-argo-rollouts-darwin-amd64 /usr/local/bin/kubectl-argo-rollouts
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥åŠŸèƒ½ä¸é€‚ç”¨äº TSE Bridge Modeï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨ TSE Direct Mode æ¥å®ç°æ¸è¿›å¼å‘å¸ƒã€‚&lt;/p&gt;



&lt;div class=&#34;alert&#34;&gt;
  
  &lt;div class=&#34;alert-note-title py-1 px-2&#34;&gt;
    ğŸ’¡ä»€ä¹ˆæ˜¯æ¡¥æ¥æ¨¡å¼å’Œç›´æ¥æ¨¡å¼ï¼Ÿ
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note py-1 px-2&#34;&gt;
    ç›´æ¥æ¨¡å¼å’Œæ¡¥æ¥æ¨¡å¼æ˜¯ TSE ä¸­æ§åˆ¶å¹³é¢ä¸‹å‘é…ç½®çš„ä¸¤ç§æ¨¡å¼ã€‚é€‚ç”¨äºæµé‡ã€å®‰å…¨ã€ç½‘å…³ç»„é…ç½®æ¨¡å¼ã€‚BRIDGED æ¨¡å¼æ˜¯ä¸€ç§æç®€æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨ Tetrate ç‰¹å®šçš„ API å¿«é€Ÿé…ç½®æœåŠ¡ç½‘æ ¼ä¸­æœ€å¸¸ç”¨çš„åŠŸèƒ½ï¼Œè€Œ DIRECT æ¨¡å¼ä¸ºé«˜çº§ç”¨æˆ·æä¾›æ›´å¤§çš„çµæ´»æ€§ï¼Œå…è®¸ä»–ä»¬ç›´æ¥ä½¿ç”¨ Istio API è¿›è¡Œé…ç½®ã€‚
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œéƒ¨ç½² Rollouts Dashboardï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/argoproj/argo-rollouts.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kustomize build manifests/dashboard-install&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;kubectl apply -n argo-rollouts -f -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward svc/argo-rollouts-dashboard -n argo-rollouts 3100:3100
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡ &lt;a href=&#34;https://localhost:3100/rollouts/&#34; title=&#34;https://localhost:3100/rollouts/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://localhost:3100/rollouts/&lt;/a&gt;
 è®¿é—® Rollouts ä»ªè¡¨æ¿ã€‚&lt;/p&gt;
&lt;h3 id=&#34;bookinfo&#34;&gt;éƒ¨ç½² Bookinfo åº”ç”¨&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»ä¸º Bookinfo åº”ç”¨ç¨‹åºå‡†å¤‡äº†é…ç½®æ–‡ä»¶ï¼ˆä¿å­˜åœ¨ &lt;a href=&#34;https://github.com/tetrateio/tse-gitops-demo/&#34; title=&#34;tse-gitops-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tse-gitops-demo&lt;/a&gt;
 å­˜å‚¨åº“ä¸­ï¼‰ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†å…¶ fork åˆ°æ‚¨è‡ªå·±çš„å¸æˆ·å¹¶å°†å…¶æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„å­˜å‚¨åº“ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éƒ¨ç½² Bookinfo åº”ç”¨ç¨‹åºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app create bookinfo-app --repo https://github.com/tetrateio/tse-gitops-demo.git --path application --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„ï¼šæˆ‘ä»¬åœ¨ &lt;a href=&#34;https://github.com/tetrateio/tse-gitops-demo/blob/main/application/bookinfo.yaml#L151&#34; title=&#34;&amp;lt;code&amp;gt;reviews&amp;lt;/code&amp;gt; éƒ¨ç½²&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;reviews&lt;/code&gt; éƒ¨ç½²&lt;/a&gt;
ä¸­å°† &lt;code&gt;replicas&lt;/code&gt; è®¾ç½®ä¸º &lt;code&gt;0&lt;/code&gt; ï¼Œå› ä¸ºæˆ‘ä»¬å°†åˆ›å»º Argo Rollouts æ¥æ“çºµ &lt;code&gt;reviews&lt;/code&gt; çš„å®ä¾‹æ•°é‡æœåŠ¡ã€‚å¦‚æœè¿™é‡Œè®¾ç½®ä¸ºéé›¶æ­£æ•´æ•°ï¼Œæˆ‘ä»¬å°†æ— æ³•å®ç°é‡‘ä¸é›€éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æ‚¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ ArgoCD UIï¼Œå¦‚å›¾ 4 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4_hu2adde1e204b15f6e0c3ec1d5cd693523_379147_3836x1928_resize_q75_h2_lanczos_3.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4.png&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4.png&#34; data-width=&#34;3836&#34; data-height=&#34;1928&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 4ï¼šArgoCD ç”¨æˆ·ç•Œé¢&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 4ï¼šArgoCD ç”¨æˆ·ç•Œé¢&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å¦‚æœæ‚¨å‘ç°åº”ç”¨ç¨‹åºçŠ¶æ€ä¸åŒæ­¥ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æˆ–å•å‡» UI ä¸­çš„ SYNC æŒ‰é’®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app sync bookinfo-app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;istio-fine-grain-traffic-management&#34;&gt;ä½¿ç”¨ Istio å®æ–½ç»†ç²’åº¦æµé‡ç®¡ç†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ Argo CD åˆ›å»º Istio ç›¸å…³çš„èµ„æºå¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app create bookinfo-tse-conf --repo https://github.com/tetrateio/tse-gitops-demo.git --path argo/tse --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated --self-heal
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Check the creation status&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app get bookinfo-tse-conf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;convert-deployment-to-rollout&#34;&gt;å°† Deployment è½¬æ¢ä¸º Rollout&lt;/h3&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬è¦å‘å¸ƒæ–°ç‰ˆæœ¬çš„ &lt;code&gt;reviews&lt;/code&gt; æœåŠ¡ã€‚ä¸ºäº†å®ç°é›¶åœæœºæ›´æ–°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é‡‘ä¸é›€éƒ¨ç½²ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°† &lt;code&gt;reviews&lt;/code&gt; Deployment çš„ &lt;code&gt;replicas&lt;/code&gt; å‡å°‘ä¸º 0ï¼›&lt;/li&gt;
&lt;li&gt;åˆ›å»ºå¼•ç”¨å…ˆå‰åœ¨ Bookinfo åº”ç”¨ç¨‹åºä¸­éƒ¨ç½²çš„ &lt;code&gt;reviews&lt;/code&gt; Deployment çš„ Rolloutï¼›&lt;/li&gt;
&lt;li&gt;å°†æµé‡å‘é€åˆ° &lt;code&gt;reviews&lt;/code&gt; æœåŠ¡ä»¥å®ç°è‡ªåŠ¨é‡‘ä¸é›€éƒ¨ç½²è¿›åº¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‚¨å¯ä»¥åœ¨ GitHub ä¸ŠæŸ¥çœ‹æœ¬æ¼”ç¤ºä¸­ä½¿ç”¨çš„ Rollout å’Œ AnalysisTemplate é…ç½®ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éƒ¨ç½² &lt;code&gt;reivews-rollout&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app create reviews-rollout --repo https://github.com/tetrateio/tse-gitops-demo.git --path argo/rollout --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;argocd&lt;/code&gt; å‘½ä»¤æ¥éƒ¨ç½²æˆ–ä½¿ç”¨ &lt;code&gt;kubectl apply&lt;/code&gt; ã€‚æ¨èä½¿ç”¨ &lt;code&gt;argocd&lt;/code&gt; ï¼Œå› ä¸ºæ‚¨å¯ä»¥åŒæ—¶åœ¨ ArgoCD UI å’Œ Argo Rollouts Dashboard ä¸­æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ &lt;code&gt;argocd&lt;/code&gt; å‘½ä»¤ç®¡ç†éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Argo Rollouts Dashboard ä¸­æŸ¥çœ‹ &lt;code&gt;reviews&lt;/code&gt; éƒ¨ç½²çš„çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æµé‡å‘é€åˆ° &lt;code&gt;reviews&lt;/code&gt; æœåŠ¡ä¸€æ®µæ—¶é—´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GATEWAY_HOSTNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl -n bookinfo get service tsb-gateway-bookinfo -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{.status.loadBalancer.ingress[0].hostname}&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; 1&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; curl -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: bookinfo.tetrate.com&amp;#34;&lt;/span&gt; http://&lt;span class=&#34;nv&#34;&gt;$GATEWAY_HOSTNAME&lt;/span&gt;/api/v1/products/1/reviews&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;sleep 3&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å°†åœ¨è¾“å‡ºä¸­çœ‹åˆ°æ¥è‡ªå…·æœ‰ä¸åŒ rollouts-pod-template-hash æ ‡ç­¾çš„ pod çš„å“åº”ï¼Œè¿™è¯æ˜é‡‘ä¸é›€éƒ¨ç½²æ˜¯æœ‰æ•ˆçš„ã€‚å¤§çº¦ 10 åˆ†é’Ÿåï¼Œæ‚¨çœ‹åˆ°çš„ Argo Rollouts ä»ªè¡¨æ¿å°†å¦‚å›¾ 5 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5_hu11170ce2820faa5c8b7ec39c7019924c_276397_3584x2240_resize_q75_h2_lanczos_3.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5.png&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5.png&#34; data-width=&#34;3584&#34; data-height=&#34;2240&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 5ï¼šArgo Rollouts ä»ªè¡¨æ¿&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 5ï¼šArgo Rollouts ä»ªè¡¨æ¿&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä»å›¾ 5 ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡‘ä¸é›€éƒ¨ç½²è¿›å±•é¡ºåˆ©ï¼Œå·²ç»åˆ°äº†ç¬¬ä¸‰æ­¥ã€‚è¿™æ˜¯å› ä¸º &lt;code&gt;reviews&lt;/code&gt; æœåŠ¡çš„ &lt;code&gt;apdex&lt;/code&gt; ï¼ˆåº”ç”¨æ€§èƒ½æŒ‡æ•°ï¼‰æŒ‡æ ‡æ­£å¸¸ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://tetrate.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/&#34; title=&#34;ä½¿ç”¨ Postman å‘ SkyWalking æäº¤ GraphQL æŸ¥è¯¢&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Postman å‘ SkyWalking æäº¤ GraphQL æŸ¥è¯¢&lt;/a&gt;
æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼Œå¦‚å›¾ 6 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6_hu5685ceb7be9c9e3d2b3ef1f9496adc1b_381735_3584x2040_resize_q75_h2_lanczos_3.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6.png&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6.png&#34; data-width=&#34;3584&#34; data-height=&#34;2040&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 6ï¼šä½¿ç”¨ Postman å°† GraphQL æŸ¥è¯¢æäº¤åˆ° SkyWalking&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 6ï¼šä½¿ç”¨ Postman å°† GraphQL æŸ¥è¯¢æäº¤åˆ° SkyWalking&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬æ„å»ºçš„ GraphQL æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-graphql&#34; data-lang=&#34;graphql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;ReadMetricsValues&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;readMetricsValues&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;condition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;service_apdex&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;entity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;serviceName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;canary|reviews|bookinfo|cluster-1|-&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2023-07-13 0812&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2023-07-13 0813&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;MINUTE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥è¯­å¥ä» UTC &lt;code&gt;2023-07-13 8:12&lt;/code&gt; åˆ° &lt;code&gt;2023 8:13&lt;/code&gt; æŸ¥è¯¢ &lt;code&gt;canary|reviews|bookinfo|cluster-1|-&lt;/code&gt; æœåŠ¡çš„ &lt;code&gt;apdex&lt;/code&gt; æŒ‡æ ‡ï¼ŒæŒç»­ä¸¤åˆ†é’Ÿï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;readMetricsValues&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nt&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nt&#34;&gt;&amp;#34;values&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;values&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;service_apdex_202307130812_Y2FuYXJ5fHJldmlld3N8Ym9va2luZm98Y2x1c3Rlci0xfC0=.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;service_apdex_202307130813_Y2FuYXJ5fHJldmlld3N8Ym9va2luZm98Y2x1c3Rlci0xfC0=.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;apdex&lt;/code&gt; æŒ‡æ ‡çš„å€¼å¤§äº 9900ï¼ˆAnalysisTemplate çš„ &lt;code&gt;successCondition&lt;/code&gt; ä¸­é…ç½®çš„é˜ˆå€¼ï¼‰ï¼Œå› æ­¤ Rollouts ä¼šé¡ºåˆ©è¿›è¡Œã€‚æ‚¨è¿˜å¯ä»¥åœ¨ Argo Rollouts Dashboard ä¸Šå•å‡»â€œæ‰‹åŠ¨å‡çº§â€æ¥å‡çº§å®ƒï¼Œæˆ–è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl argo rollouts promote reviews-rollout -n bookinf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;clean-up&#34;&gt;æ¸…ç†&lt;/h2&gt;
&lt;p&gt;åˆ é™¤å·²éƒ¨ç½²çš„ ArgoCD åº”ç”¨ç¨‹åºå’Œ Rolloutï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app delete -y reviews-rollout
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app delete -y bookinfo-tse-conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd app delete -y bookinfo-app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;rollouts-principle&#34;&gt;Argo Rollouts åŸç†&lt;/h2&gt;
&lt;p&gt;ä¸ Istio é›†æˆæ—¶ï¼ŒArgo Rollouts æ”¯æŒåŸºäº VirtualService å’Œ Subset çš„æµé‡æ‹†åˆ†ï¼Œå¦‚å›¾ 7 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f7.svg&#34; data-img=&#34;/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f7.svg&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 7ï¼šArgo Rollouts ä½¿ç”¨ Istio è¿›è¡Œæµé‡åˆ†é…&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 7ï¼šArgo Rollouts ä½¿ç”¨ Istio è¿›è¡Œæµé‡åˆ†é…&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä¸‹è¡¨æä¾›äº†è¿™ä¸¤ç§æµé‡åˆ†æ®µæ–¹æ³•çš„è¯¦ç»†æ¯”è¾ƒã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;ç±»å‹&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;èµ„æºå¯¹è±¡&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;åŸåˆ™&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸»æœºçº§æµé‡åˆ†å‰²&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é€‚ç”¨äºæ ¹æ®ä¸»æœºåè®¿é—®ä¸åŒç‰ˆæœ¬çš„æœåŠ¡ï¼›&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;2 ä¸ªæœåŠ¡ã€1 ä¸ªè™šæ‹ŸæœåŠ¡ã€1 ä¸ªéƒ¨ç½²ï¼›&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Rollout å°† rollouts-pod-template-hash æ ‡ç­¾æ³¨å…¥åˆ° ReplicaSet ä¸­ï¼Œå¹¶é€šè¿‡æ›´æ–° Service ä¸­çš„é€‰æ‹©å™¨æ¥é€‰æ‹©å¸¦æœ‰è¿™äº›æ ‡ç­¾çš„ podï¼›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å­é›†çº§æµé‡åˆ†å‰²&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é€‚ç”¨äºæ ¹æ®æ ‡ç­¾è®¿é—®ä¸åŒçš„æœåŠ¡ï¼›&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;1 ä¸ªæœåŠ¡ã€1 ä¸ªè™šæ‹ŸæœåŠ¡ã€1 ä¸ªç›®æ ‡è§„åˆ™å’Œ 1 ä¸ªè½¬å‡ºï¼›&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Rollout å°† rollouts-pod-template-hash æ ‡ç­¾æ³¨å…¥åˆ° ReplicaSet ä¸­ï¼Œå¹¶é€šè¿‡æ›´æ–° DestinationRule ä¸­çš„é€‰æ‹©å™¨æ¥é€‰æ‹©å…·æœ‰è¿™äº›æ ‡ç­¾çš„ podï¼›&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æœ¬æ¼”ç¤ºä¸­ä½¿ç”¨åŸºäºå­é›†çš„æµé‡åˆ†å‰²ï¼ŒArgo ä¸æ–­æ¨å‡ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ VirtualService &lt;code&gt;spec.http[].route[].weight&lt;/code&gt; ä»¥åŒ¹é…å½“å‰æ‰€éœ€çš„é‡‘ä¸é›€æƒé‡&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹ DestinationRule &lt;code&gt;spec.subsets[].labels&lt;/code&gt; ä»¥åŒ…å« canary å’Œç¨³å®š ReplicaSet çš„ &lt;code&gt;rollouts-pod-template-hash&lt;/code&gt; æ ‡ç­¾&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯·è®¿é—® &lt;a href=&#34;https://argo-rollouts.readthedocs.io/en/stable/features/traffic-management/istio/&#34; title=&#34;Argo Rollouts æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Argo Rollouts æ–‡æ¡£&lt;/a&gt;
ï¼Œäº†è§£æœ‰å…³ä½¿ç”¨ Istio è¿›è¡Œæµé‡ç®¡ç†çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;summary&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Argo é¡¹ç›®å’Œ Istio å®ç° GitOps å’Œé‡‘ä¸é›€éƒ¨ç½²ã€‚é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ ArgoCD å®ç° GitOpsï¼Œç„¶åä½¿ç”¨ Argo Rollout å’Œ SkyWalking å®ç°è‡ªåŠ¨åŒ–é‡‘ä¸é›€å‘å¸ƒã€‚ä» demo ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° TSE éƒ¨ç½²çš„ Istio ä¸å¼€æºç‰ˆæœ¬å®Œå…¨å…¼å®¹ã€‚TSE æœ‰è®¸å¤šåŠŸèƒ½å€¼å¾—æ¢ç´¢ï¼Œè¯·è®¿é—® &lt;a href=&#34;https://tetrate.io/tetrate-service-express/&#34; title=&#34;Tetrate ç½‘ç«™&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate ç½‘ç«™&lt;/a&gt;
äº†è§£æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ GraphQL å’Œ Postman æŸ¥è¯¢ SkyWalking ä¸­çš„æ•°æ®</title>
      <link>https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/</link>
      <pubDate>Thu, 20 Jul 2023 16:27:49 +0800</pubDate>
      
      <guid>https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•ä½¿ç”¨ &lt;a href=&#34;https://graphql.org/&#34; title=&#34;GraphQL ä¸&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GraphQL ä¸&lt;/a&gt;
&lt;a href=&#34;https://www.postman.com/&#34; title=&#34;Postman&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Postman&lt;/a&gt;
 ä¸€èµ·ä» &lt;a href=&#34;https://skywalking.apache.org/&#34; title=&#34;SkyWalking&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SkyWalking&lt;/a&gt;
 æŸ¥è¯¢æ•°æ®ã€‚å®ƒåŒ…æ‹¬è·å–ä¸è®°åä»¤ç‰Œã€æ„å»ºæŸ¥è¯¢ä»¥æ£€ç´¢ç‰¹å®šæœåŠ¡çš„è´Ÿè½½æŒ‡æ ‡ä»¥åŠä½¿ç”¨ GraphQL è‡ªçœæ¥æŸ¥çœ‹ SkyWalking GraphQL API æ¶æ„çš„æ­¥éª¤ã€‚æœ¬æ–‡è¿˜æä¾›äº†æ›´å¤šä¿¡æ¯çš„å‚è€ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-graphql&#34;&gt;ä»€ä¹ˆæ˜¯ GraphQLï¼Ÿ&lt;/h2&gt;
&lt;p&gt;GraphQL æ˜¯ Facebook å¼€å‘çš„ä¸€ç§ API æŸ¥è¯¢è¯­è¨€å’Œè¿è¡Œæ—¶ã€‚å®ƒå…è®¸å®¢æˆ·ç«¯å‡†ç¡®æŒ‡å®šä»–ä»¬éœ€è¦çš„æ•°æ®å¹¶ä»…æ¥æ”¶è¯¥æ•°æ®ä½œä¸ºå“åº”ï¼Œä»è€Œä¸ºä¼ ç»Ÿ REST API æä¾›äº†æ›´é«˜æ•ˆã€æ›´å¼ºå¤§ã€æ›´çµæ´»çš„æ›¿ä»£æ–¹æ¡ˆã€‚ä½¿ç”¨ GraphQLï¼Œå®¢æˆ·ç«¯å¯ä»¥åœ¨å•ä¸ªè¯·æ±‚ä¸­æŸ¥è¯¢å¤šä¸ªèµ„æºï¼Œä»è€Œå‡å°‘ä¸æœåŠ¡å™¨çš„å¾€è¿”æ¬¡æ•°å¹¶æé«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;graphql-å’Œ-rest-api-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«&#34;&gt;GraphQL å’Œ REST API ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;GraphQL å…è®¸å®¢æˆ·ç«¯ä»…è¯·æ±‚ä»–ä»¬éœ€è¦çš„æ•°æ®ï¼Œè€Œ REST API è¦æ±‚å®¢æˆ·ç«¯æ£€ç´¢èµ„æºä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œæ— è®ºä»–ä»¬æ˜¯å¦éœ€è¦ã€‚æ­¤å¤–ï¼ŒGraphQL å…è®¸å®¢æˆ·ç«¯åœ¨å•ä¸ªè¯·æ±‚ä¸­æŸ¥è¯¢å¤šä¸ªèµ„æºï¼Œè¿™ä½¿å…¶æ¯” REST API æ›´é«˜æ•ˆã€æ›´ç®€æ´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚ä½•æŸ¥è¯¢-skywalking-æ•°æ®&#34;&gt;å¦‚ä½•æŸ¥è¯¢ SkyWalking æ•°æ®ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;SkyWalking å®šä¹‰äº†æŸ¥è¯¢é˜¶æ®µçš„é€šä¿¡åè®®ã€‚SkyWalking åŸç”Ÿ UI å’Œ CLI ä½¿ç”¨æ­¤åè®®ä»åç«¯æŒç»­è·å–æ•°æ®ï¼Œæ— éœ€æ‹…å¿ƒåç«¯æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;ä» SkyWalking æŸ¥è¯¢æŒ‡æ ‡æœ‰ä¸¤ç§æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://skywalking.apache.org/docs/main/v9.4.0/en/api/query-protocol/&#34; title=&#34;GraphQL API&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GraphQL API&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://skywalking.apache.org/docs/main/v9.4.0/en/api/promql-service/&#34; title=&#34;PromQL API&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PromQL API&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ¬æ–‡æä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨ GraphQL ä» SkyWalking æŸ¥è¯¢æŒ‡æ ‡çš„æŒ‡å—ã€‚å¦‚æœä½ å¯¹ PromQL API æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚é˜…æ–‡ç« &lt;a href=&#34;https://skywalking.apache.org/zh/2023-03-17-build-grafana-dashboards-for-apache-skywalking-native-promql-support/&#34; title=&#34;ä¸º Apache SkyWalking æ„å»º Grafana Dashboard - åŸç”Ÿ PromQL æ”¯æŒ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸º Apache SkyWalking æ„å»º Grafana Dashboard - åŸç”Ÿ PromQL æ”¯æŒ&lt;/a&gt;
 ã€‚ç»§ç»­æ‰§è¡Œä»¥ä¸‹æ­¥éª¤éœ€è¦å®‰è£… TSBã€‚å¦‚æœä½ æ²¡æœ‰ï¼Œä½†ä»æƒ³ä½“éªŒä½¿ç”¨ GraphQL åœ¨ SkyWalking ä¸­æŸ¥è¯¢æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ SkyWalking æä¾›çš„å…è´¹&lt;a href=&#34;https://skywalking.apache.org/&#34; title=&#34;æ¼”ç¤ºç¯å¢ƒ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºç¯å¢ƒ&lt;/a&gt;
ï¼ˆç”¨æˆ·å / å¯†ç ï¼šskywalking/skywalkingï¼‰ã€‚ç™»å½•æ¼”ç¤ºç½‘ç«™å¹¶è·å–æŸ¥è¯¢ä»¤ç‰Œã€‚GraphQL æŸ¥è¯¢çš„ç«¯ç‚¹åœ°å€æ˜¯ &lt;a href=&#34;http://demo.skywalking.apache.org/graphql&#34; title=&#34;http://demo.skywalking.apache.org/graphql&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://demo.skywalking.apache.org/graphql&lt;/a&gt;
 ã€‚æ„é€ æŸ¥è¯¢çš„æ­¥éª¤ä¸ä¸‹é¢æè¿°çš„ç›¸åŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§‚å¯Ÿ-tsb-ä¸­çš„-graphql-æŸ¥è¯¢&#34;&gt;è§‚å¯Ÿ TSB ä¸­çš„ GraphQL æŸ¥è¯¢&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ä½¿ç”¨ Postman æ„å»ºè‡ªå·±çš„ GraphQL æŸ¥è¯¢ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè§‚å¯Ÿ TSB å¦‚ä½•ä» SkyWalking è·å–æ•°æ®ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰“å¼€ Chrome DevTools å¹¶åˆ‡æ¢åˆ°â€œNetworkâ€é€‰é¡¹å¡ã€‚&lt;/li&gt;
&lt;li&gt;è®¿é—®ç½‘ç«™ä¸Šçš„&lt;strong&gt;Organization - Services&lt;/strong&gt; é€‰é¡¹å¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è§‚å¯Ÿç½‘ç»œè¯·æ±‚åˆ—è¡¨å¹¶å³é”®å•å‡»å…¶ä¸­ä¸€ä¸ª graphql è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f1_hua5cbadcc83ed3f80e33e19b6c5b7a750_263893_2048x1440_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f1.jpg&#34; data-img=&#34;/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f1.jpg&#34; data-width=&#34;2048&#34; data-height=&#34;1440&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 1ï¼šChrome DevTool&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 1ï¼šChrome DevTool&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä½ çœ‹åˆ°çš„ curl å‘½ä»¤å°†å¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œä½ å°†ä» SkyWalking ä¸­è·å– TSB ç®¡ç†çš„æœåŠ¡åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;https://saturn.tetrate.work/ui/graphql&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Accept-Language: en,zh-CN;q=0.9,zh;q=0.8,en-US;q=0.7,zh-TW;q=0.6&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Cache-Control: no-cache&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Client-Timestamp: 1686104776136&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Connection: keep-alive&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Cookie: ...&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Origin: &amp;lt;https://saturn.tetrate.work&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pragma: no-cache&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Referer: &amp;lt;https://saturn.tetrate.work/mp/services&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Request-Id: ...&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Sec-Fetch-Dest: empty&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Sec-Fetch-Mode: cors&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Sec-Fetch-Site: same-origin&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;X-Bridge-Csrf-Token: IOmJszLAqY3TRIUNhTuGu7vQgnfQY1FtgYFm+l/+Mu4EmVQU5T8EaQ7bngkCv4hQ12ZGids+I21pHMdepE9/qQ==&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;X-Csrf-Token: xTbxZerD3t8N3PaS7nbjKCfxk1Q9dtvvrx4D+IJohHicb0VfB4iAZaP0zh1eXDWctQyCYZWaKLhAYT3M6Drk3A==&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;accept: application/json&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;sec-ch-ua: &amp;#34;Not.A/Brand&amp;#34;;v=&amp;#34;8&amp;#34;, &amp;#34;Chromium&amp;#34;;v=&amp;#34;114&amp;#34;, &amp;#34;Google Chrome&amp;#34;;v=&amp;#34;114&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;sec-ch-ua-mobile: ?0&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;sec-ch-ua-platform: &amp;#34;macOS&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --data-raw &lt;span class=&#34;s1&#34;&gt;$&amp;#39;{&amp;#34;query&amp;#34;:&amp;#34;query ServiceRegistryListMetrics(...)}&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --compressed
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt; &lt;em&gt;ä¸Šä¾‹ä¸­çš„æŸäº›å­—æ®µå¤ªé•¿ï¼Œç”¨ç‚¹ (&amp;hellip;) æ›¿æ¢&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘å°†æŒ‡å¯¼ä½ æ„å»ºä¸€ä¸ªæŸ¥è¯¢æ¥æ£€ç´¢ç‰¹å®šæœåŠ¡çš„è´Ÿè½½æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è·å–-bearer-token&#34;&gt;è·å– Bearer Token&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œä½ éœ€è¦è·å–ç½‘ç«™çš„ Bearer Tokenã€‚ç™»å½•åˆ° TSB UIï¼Œç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·æŒ‰é’®ï¼Œç„¶åç‚¹å‡»â€œShow token informationâ€ã€‚åœ¨å¼¹å‡ºçª—å£ä¸­ï¼Œä½ å°†çœ‹åˆ° Bearer Tokenï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f2_huef808561a14d54812cb568a1a6d23088_113453_2046x1036_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f2.jpg&#34; data-img=&#34;/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f2.jpg&#34; data-width=&#34;2046&#34; data-height=&#34;1036&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 2ï¼šä» TSB UI è·å– Bear Token&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 2ï¼šä» TSB UI è·å– Bear Token&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æ³¨æ„ï¼šBearer token çš„æœ‰æ•ˆæœŸæ¯”è¾ƒçŸ­ã€‚å½“å®ƒè¿‡æœŸæ—¶ï¼Œä½ éœ€è¦é‡æ–°ç™»å½• TSB ä»¥è·å–æ–°çš„ tokenã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»é¢„å…ˆéƒ¨ç½²äº†&lt;a href=&#34;https://istio.io/latest/docs/examples/bookinfo/&#34; title=&#34;bookinfo åº”ç”¨ç¨‹åº&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bookinfo åº”ç”¨ç¨‹åº&lt;/a&gt;
å¹¶å‘é€äº†ä¸€äº›æµ‹è¯•æµé‡ã€‚è¦åœ¨ Postman å®¢æˆ·ç«¯ä¸­ä½¿ç”¨ GraphQL æŸ¥è¯¢&lt;code&gt;reviews&lt;/code&gt;çš„è´Ÿè½½æŒ‡æ ‡ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„ GraphQL è¯·æ±‚ï¼Œå¹¶è¾“å…¥è¯·æ±‚ URLï¼š&lt;code&gt;$TSB_ADDRESS/graphql&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ·»åŠ å¸¦æœ‰å€¼&lt;code&gt;Bearer $TOKEN&lt;/code&gt;çš„&lt;code&gt;Authorization&lt;/code&gt;å¤´&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ GraphQL Introspection æŸ¥çœ‹ SkyWalking GraphQL APIs çš„æ¨¡å¼ã€‚æŸ¥æ‰¾å¹¶å•å‡»&lt;code&gt;readMetricsValues&lt;/code&gt;é¡¹ã€‚ä½ å°†åœ¨å³ä¾§çœ‹åˆ°å˜é‡ã€‚å¡«å†™&lt;code&gt;condition&lt;/code&gt;å’Œ&lt;code&gt;duration&lt;/code&gt;é¡¹ç›®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f3_hu70369268e4dca4468ad78942f5275e98_98935_2048x1164_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f3.jpg&#34; data-img=&#34;/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/f3.jpg&#34; data-width=&#34;2048&#34; data-height=&#34;1164&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 3ï¼šPostman æŸ¥è¯¢&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;å›¾ 3ï¼šPostman æŸ¥è¯¢&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å˜é‡å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-graphql&#34; data-lang=&#34;graphql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;ReadMetricsValues&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;readMetricsValues&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;condition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;service_cpm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;entity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;serviceName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;reviews&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2023-06-05 0625&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2023-06-05 0627&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;MINUTE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å•å‡» Query æŒ‰é’®ä»¥è·å–ç»“æœã€‚å®ƒåº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;readMetricsValues&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nt&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nt&#34;&gt;&amp;#34;values&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;values&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;service_cpm_202306050625_cmV2aWV3cw==.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;service_cpm_202306050626_cmV2aWV3cw==.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;service_cpm_202306050627_cmV2aWV3cw==.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;nt&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸Šæ˜¯ä½¿ç”¨ SkyWalking Demo ç¯å¢ƒæµ‹è¯• GraphQL æŸ¥è¯¢ã€‚TSE ä¹Ÿæ”¯æŒ GraphQL æŸ¥è¯¢ï¼Œå¹¶ä¸”ç«¯ç‚¹åœ°å€ä¸º&lt;code&gt;$TSB_SERVER/graphql&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šæ­¤å¤„çš„æŸ¥è¯¢ç«¯ç‚¹ä¸ DevTool ä¸­çœ‹åˆ°çš„ä¸åŒã€‚TSB UI ç‰¹å®šçš„ GraphQL æŸ¥è¯¢ç«¯ç‚¹æ˜¯&lt;code&gt;$TSB_SERVER/ui/graphql&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ SkyWalking GraphQL æŸ¥è¯¢åè®®çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§&lt;a href=&#34;https://github.com/apache/skywalking-query-protocol/tree/master&#34; title=&#34;GitHub&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub&lt;/a&gt;
ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»‹ç»äº†å¦‚ä½•åœ¨ Postman ä¸­ä½¿ç”¨ GraphQL æŸ¥è¯¢åè®®æŸ¥è¯¢ SkyWalking ä¸­çš„æ•°æ®ã€‚ä½ å¯ä»¥æ ¹æ® SkyWalking çš„ GraphQL æ¨¡å¼æ„å»ºè‡ªå·±çš„æŸ¥è¯¢æ¡ä»¶ã€‚TSB / TSE ä¸­ä¹Ÿæä¾›äº†æ­¤åŠŸèƒ½ã€‚&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ Istio ä¸­ä½¿ç”¨ SkyWalking è¿›è¡Œåˆ†å¸ƒå¼è¿½è¸ªï¼Ÿ</title>
      <link>https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/</link>
      <pubDate>Wed, 07 Dec 2022 11:09:40 +0800</pubDate>
      
      <guid>https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨äº‘åŸç”Ÿåº”ç”¨ä¸­ï¼Œä¸€æ¬¡è¯·æ±‚å¾€å¾€éœ€è¦ç»è¿‡ä¸€ç³»åˆ—çš„ API æˆ–åå°æœåŠ¡å¤„ç†æ‰èƒ½å®Œæˆï¼Œè¿™äº›æœåŠ¡æœ‰äº›æ˜¯å¹¶è¡Œçš„ï¼Œæœ‰äº›æ˜¯ä¸²è¡Œçš„ï¼Œè€Œä¸”ä½äºä¸åŒçš„å¹³å°æˆ–èŠ‚ç‚¹ã€‚é‚£ä¹ˆå¦‚ä½•ç¡®å®šä¸€æ¬¡è°ƒç”¨çš„ç»è¿‡çš„æœåŠ¡è·¯å¾„å’ŒèŠ‚ç‚¹ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œé—®é¢˜æ’æŸ¥ï¼Ÿè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°åˆ†å¸ƒå¼è¿½è¸ªã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†å‘ä½ ä»‹ç»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼è¿½è¸ªçš„åŸç†&lt;/li&gt;
&lt;li&gt;å¦‚ä½•é€‰æ‹©åˆ†å¸ƒå¼è¿½è¸ªè½¯ä»¶&lt;/li&gt;
&lt;li&gt;åœ¨ Istio ä¸­å¦‚ä½•ä½¿ç”¨åˆ†å¸ƒå¼è¿½è¸ª&lt;/li&gt;
&lt;li&gt;ä»¥ Bookinfo å’Œ SkyWalking ä¸ºä¾‹è¯´æ˜å¦‚ä½•æŸ¥çœ‹åˆ†å¸ƒå¼è¿½è¸ªæ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tracing-basic&#34;&gt;åˆ†å¸ƒå¼è¿½è¸ªåŸºç¡€&lt;/h2&gt;
&lt;p&gt;åˆ†å¸ƒå¼è¿½è¸ªæ˜¯ä¸€ç§ç”¨æ¥è·Ÿè¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¯·æ±‚çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£ã€æ§åˆ¶å’Œä¼˜åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿã€‚åˆ†å¸ƒå¼è¿½è¸ªä¸­ç”¨åˆ°äº†ä¸¤ä¸ªæ¦‚å¿µï¼šTraceID å’Œ SpanIDã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;TraceID æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ IDï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªè¯·æ±‚çš„è¿½è¸ªä¿¡æ¯ã€‚ä¸€ä¸ªè¯·æ±‚çš„æ‰€æœ‰è¿½è¸ªä¿¡æ¯éƒ½å±äºåŒä¸€ä¸ª TraceIDï¼ŒTraceID åœ¨æ•´ä¸ªè¯·æ±‚çš„è¿½è¸ªè¿‡ç¨‹ä¸­éƒ½æ˜¯ä¸å˜çš„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SpanID æ˜¯ä¸€ä¸ªå±€éƒ¨å”¯ä¸€çš„ IDï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªè¯·æ±‚åœ¨æŸä¸€æ—¶åˆ»çš„è¿½è¸ªä¿¡æ¯ã€‚ä¸€ä¸ªè¯·æ±‚åœ¨ä¸åŒçš„æ—¶é—´æ®µä¼šäº§ç”Ÿä¸åŒçš„ SpanIDï¼ŒSpanID ç”¨æ¥åŒºåˆ†ä¸€ä¸ªè¯·æ±‚åœ¨ä¸åŒæ—¶é—´æ®µçš„è¿½è¸ªä¿¡æ¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TraceID å’Œ SpanID æ˜¯åˆ†å¸ƒå¼è¿½è¸ªçš„åŸºç¡€ï¼Œå®ƒä»¬ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¯·æ±‚çš„è¿½è¸ªæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ ‡è¯†ï¼Œæ–¹ä¾¿ç”¨æˆ·æŸ¥è¯¢ã€ç®¡ç†å’Œåˆ†æè¯·æ±‚çš„è¿½è¸ªä¿¡æ¯ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/basic.svg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/basic.svg&#34; alt=&#34;image&#34; data-caption=&#34;åˆ†å¸ƒå¼è¿½è¸ªåŸç†å›¾&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;åˆ†å¸ƒå¼è¿½è¸ªåŸç†å›¾&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åˆ†å¸ƒå¼è¿½è¸ªçš„è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“ä¸€ä¸ªç³»ç»Ÿæ”¶åˆ°è¯·æ±‚åï¼Œåˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿä¼šä¸ºè¯¥è¯·æ±‚åˆ†é…ä¸€ä¸ª TraceIDï¼Œç”¨äºä¸²è”èµ·æ•´ä¸ªè°ƒç”¨é“¾ï¼›&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿä¼šä¸ºè¯¥è¯·æ±‚åœ¨ç³»ç»Ÿå†…çš„æ¯ä¸€æ¬¡æœåŠ¡è°ƒç”¨ç”Ÿæˆä¸€ä¸ª SpanID å’Œ ParentIDï¼Œç”¨äºè®°å½•è°ƒç”¨çš„çˆ¶å­å…³ç³»ï¼Œæ²¡æœ‰ ParentID çš„ Span å°†ä½œä¸ºè°ƒç”¨é“¾çš„å…¥å£ï¼›&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªæœåŠ¡è°ƒç”¨è¿‡ç¨‹ä¸­éƒ½è¦ä¼ é€’ TraceID å’Œ SpanIDï¼›&lt;/li&gt;
&lt;li&gt;åœ¨æŸ¥çœ‹åˆ†å¸ƒå¼è¿½è¸ªæ—¶ï¼Œé€šè¿‡ TraceID æŸ¥è¯¢æŸæ¬¡è¯·æ±‚çš„å…¨è¿‡ç¨‹ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;distributed-tracing-in-istio&#34;&gt;Istio å¦‚ä½•å®ç°åˆ†å¸ƒå¼è¿½è¸ª&lt;/h2&gt;
&lt;p&gt;Istio ä¸­çš„åˆ†å¸ƒå¼è¿½è¸ªæ˜¯åŸºäºæ•°æ®å¹³é¢ä¸­çš„ Envoy ä»£ç†å®ç°çš„ã€‚æœåŠ¡è¯·æ±‚åœ¨è¢«åŠ«æŒåˆ° Envoy ä¸­åï¼ŒEnvoy åœ¨è½¬å‘è¯·æ±‚æ—¶ä¼šé™„åŠ å¤§é‡ Headerï¼Œå…¶ä¸­ä¸åˆ†å¸ƒå¼è¿½è¸ªç›¸å…³çš„æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½œä¸º TraceIDï¼š&lt;code&gt;x-request-id&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç”¨äºåœ¨ LightStep è¿½è¸ªç³»ç»Ÿä¸­å»ºç«‹ Span çš„çˆ¶å­å…³ç³»ï¼š&lt;code&gt;x-ot-span-context&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç”¨äº Zipkinï¼ŒåŒæ—¶é€‚ç”¨äº Jaegerã€SkyWalkingï¼Œè¯¦è§ &lt;a href=&#34;https://github.com/openzipkin/b3-propagation&#34; title=&#34;b3-propagation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;b3-propagation&lt;/a&gt;
ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;x-b3-traceid&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-b3-spanid&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-b3-parentspanid&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-b3-sampled&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-b3-flags&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;b3&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç”¨äº Datadogï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;x-datadog-trace-id&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-datadog-parent-id&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x-datadog-sampling-priority&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç”¨äº SkyWalkingï¼š&lt;code&gt;sw8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç”¨äº AWS X-Rayï¼š&lt;code&gt;x-amzn-trace-id&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…³äºè¿™äº› Header çš„è¯¦ç»†ç”¨æ³•è¯·å‚è€ƒ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_conn_man/headers&#34; title=&#34;Envoy æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy æ–‡æ¡£&lt;/a&gt;
ã€‚&lt;/p&gt;
&lt;p&gt;Envoy ä¼šåœ¨ Ingress Gateway ä¸­ä¸ºä½ äº§ç”Ÿç”¨äºè¿½è¸ªçš„ Headerï¼Œä¸è®ºä½ çš„åº”ç”¨ç¨‹åºä½¿ç”¨ä½•ç§è¯­è¨€å¼€å‘ï¼ŒEnvoy éƒ½ä¼šå°†è¿™äº› Header è½¬å‘åˆ°ä¸Šæ¸¸é›†ç¾¤ã€‚ä½†æ˜¯ï¼Œä½ è¿˜è¦å¯¹åº”ç”¨ç¨‹åºä»£ç åšä¸€äº›å°çš„ä¿®æ”¹ï¼Œæ‰èƒ½ä¸ºä½¿ç”¨åˆ†å¸ƒå¼è¿½è¸ªåŠŸèƒ½ã€‚è¿™æ˜¯å› ä¸ºåº”ç”¨ç¨‹åºæ— æ³•è‡ªåŠ¨ä¼ æ’­è¿™äº› Headerï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­é›†æˆåˆ†å¸ƒå¼è¿½è¸ªçš„ Agentï¼Œæˆ–è€…åœ¨ä»£ç ä¸­æ‰‹åŠ¨ä¼ æ’­è¿™äº› Headerã€‚Envoy ä¼šå°†è¿½è¸ªæ•°æ®å‘é€åˆ° tracer åç«¯å¤„ç†ï¼Œç„¶åå°±å¯ä»¥åœ¨ UI ä¸­æŸ¥çœ‹è¿½è¸ªæ•°æ®äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚åœ¨ Bookinfo åº”ç”¨ä¸­çš„ Productpage æœåŠ¡ï¼Œå¦‚æœä½ æŸ¥çœ‹å®ƒçš„ä»£ç å¯ä»¥å‘ç°ï¼Œå…¶ä¸­é›†æˆäº† Jaeger å®¢æˆ·ç«¯åº“ï¼Œå¹¶åœ¨ &lt;code&gt;getForwardHeaders (request)&lt;/code&gt; æ–¹æ³•ä¸­å°† Envoy ç”Ÿæˆçš„ Header åŒæ­¥ç»™å¯¹ Details å’Œ Reviews æœåŠ¡çš„ HTTP è¯·æ±‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;getForwardHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# ä½¿ç”¨ Jaeger agent è·å– x-b3-* header&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_current_span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;carrier&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;tracer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;span_context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HTTP_HEADERS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;carrier&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;carrier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;carrier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# æ‰‹åŠ¨å¤„ç†é x-b3-* header&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;end-user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;incoming_headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-request-id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-ot-span-context&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-datadog-trace-id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-datadog-parent-id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-datadog-sampling-priority&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;traceparent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;tracestate&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-cloud-trace-context&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;grpc-trace-bin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;sw8&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;user-agent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;cookie&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;jwt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ihdr&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;incoming_headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ihdr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ihdr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;val&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…³äº Istio ä¸­åˆ†å¸ƒå¼è¿½è¸ªçš„å¸¸è§é—®é¢˜è¯·è§ &lt;a href=&#34;https://istio.io/latest/zh/about/faq/#distributed-tracing&#34; title=&#34;Istio æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ–‡æ¡£&lt;/a&gt;
ã€‚&lt;/p&gt;
&lt;h2 id=&#34;how-to-choose-a-distributed-tracing-system&#34;&gt;åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿå¦‚ä½•é€‰æ‹©&lt;/h2&gt;
&lt;p&gt;åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿçš„åŸç†ç±»ä¼¼ï¼Œå¸‚é¢ä¸Šä¹Ÿæœ‰å¾ˆå¤šè¿™æ ·çš„ç³»ç»Ÿï¼Œä¾‹å¦‚ &lt;a href=&#34;https://github.com/apache/skywalking&#34; title=&#34;Apache SkyWalking&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Apache SkyWalking&lt;/a&gt;
ã€&lt;a href=&#34;https://github.com/jaegertracing/jaeger&#34; title=&#34;Jaeger&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Jaeger&lt;/a&gt;
ã€&lt;a href=&#34;https://github.com/openzipkin/zipkin/&#34; title=&#34;Zipkin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Zipkin&lt;/a&gt;
ã€&lt;a href=&#34;https://lightstep.com/&#34; title=&#34;LightStep&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LightStep&lt;/a&gt;
ã€&lt;a href=&#34;https://github.com/pinpoint-apm/pinpoint&#34; title=&#34;Pinpoint&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Pinpoint&lt;/a&gt;
 ç­‰ã€‚æˆ‘ä»¬å°†é€‰æ‹©å…¶ä¸­ä¸‰ä¸ªï¼Œä»å¤šä¸ªç»´åº¦è¿›è¡Œå¯¹æ¯”ã€‚ä¹‹æ‰€ä»¥é€‰æ‹©å®ƒä»¬æ˜¯å› ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ƒä»¬æ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºåˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼›&lt;/li&gt;
&lt;li&gt;éƒ½æ˜¯åŸºäº OpenTracing è§„èŒƒï¼›&lt;/li&gt;
&lt;li&gt;éƒ½æ”¯æŒä¸ Istio åŠ Envoy é›†æˆï¼›&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»åˆ«&lt;/th&gt;
&lt;th&gt;Apache SkyWalking&lt;/th&gt;
&lt;th&gt;Jaeger&lt;/th&gt;
&lt;th&gt;Zipkin&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å®ç°æ–¹å¼&lt;/td&gt;
&lt;td&gt;åŸºäºè¯­è¨€çš„æ¢é’ˆã€æœåŠ¡ç½‘æ ¼æ¢é’ˆã€eBPF agentã€ç¬¬ä¸‰æ–¹æŒ‡æ ‡åº“ï¼ˆå½“å‰æ”¯æŒ Zipkinï¼‰&lt;/td&gt;
&lt;td&gt;åŸºäºè¯­è¨€çš„æ¢é’ˆ&lt;/td&gt;
&lt;td&gt;åŸºäºè¯­è¨€çš„æ¢é’ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®å­˜å‚¨&lt;/td&gt;
&lt;td&gt;ESã€H2ã€MySQLã€TiDBã€Sharding-sphereã€BanyanDB&lt;/td&gt;
&lt;td&gt;ESã€MySQLã€Cassandraã€å†…å­˜&lt;/td&gt;
&lt;td&gt;ESã€MySQLã€Cassandraã€å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ”¯æŒè¯­è¨€&lt;/td&gt;
&lt;td&gt;Javaã€Rustã€PHPã€NodeJSã€Goã€Pythonã€C++ã€.NETã€Lua&lt;/td&gt;
&lt;td&gt;Javaã€Goã€Pythonã€NodeJSã€C#ã€PHPã€Rubyã€C++&lt;/td&gt;
&lt;td&gt;Javaã€Goã€Pythonã€NodeJSã€C#ã€PHPã€Rubyã€C++&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‘èµ·è€…&lt;/td&gt;
&lt;td&gt;ä¸ªäºº&lt;/td&gt;
&lt;td&gt;Uber&lt;/td&gt;
&lt;td&gt;Twitter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ²»ç†æ–¹å¼&lt;/td&gt;
&lt;td&gt;Apache Foundation&lt;/td&gt;
&lt;td&gt;CNCF&lt;/td&gt;
&lt;td&gt;CNCF&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;9.3.0&lt;/td&gt;
&lt;td&gt;1.39.0&lt;/td&gt;
&lt;td&gt;2.23.19&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Star æ•°é‡&lt;/td&gt;
&lt;td&gt;20.9k&lt;/td&gt;
&lt;td&gt;16.8k&lt;/td&gt;
&lt;td&gt;15.8k&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;figcaption class=&#34;text-center&#34;&gt;
    åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿå¯¹æ¯”è¡¨ï¼ˆæ•°æ®æˆªæ­¢æ—¶é—´ 2022-12-07ï¼‰
&lt;/figcaption&gt;

&lt;p&gt;è™½ç„¶ Apache SkyWalking çš„ Agent æ”¯æŒçš„è¯­è¨€æ²¡æœ‰ Jaeger å’Œ Zipkin å¤šï¼Œä½†æ˜¯ SkyWalking çš„å®ç°æ–¹å¼æ›´ä¸°å¯Œï¼Œå¹¶ä¸”ä¸ Jaegerã€Zipkin çš„è¿½è¸ªæ•°æ®å…¼å®¹ï¼Œå¼€å‘æ›´ä¸ºæ´»è·ƒï¼Œä¸”ä¸ºå›½äººå¼€å‘ï¼Œä¸­æ–‡èµ„æ–™ä¸°å¯Œï¼Œæ˜¯æ„å»ºé¥æµ‹å¹³å°çš„æœ€ä½³é€‰æ‹©ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;demo&#34;&gt;å®éªŒ&lt;/h2&gt;
&lt;p&gt;å‚è€ƒ &lt;a href=&#34;https://istio.io/latest/docs/tasks/observability/distributed-tracing/skywalking/&#34; title=&#34;Istio æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ–‡æ¡£&lt;/a&gt;
æ¥å®‰è£…å’Œé…ç½® Apache SkyWalkingã€‚&lt;/p&gt;
&lt;h3 id=&#34;environments&#34;&gt;ç¯å¢ƒè¯´æ˜&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æˆ‘ä»¬å®éªŒçš„ç¯å¢ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kubernetes 1.24.5&lt;/li&gt;
&lt;li&gt;Istio 1.16&lt;/li&gt;
&lt;li&gt;SkyWalking 9.1.0&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;install-istio&#34;&gt;å®‰è£… Istio&lt;/h3&gt;
&lt;p&gt;å®‰è£…ä¹‹å‰å¯ä»¥å…ˆæ£€æŸ¥ä¸‹ç¯å¢ƒæ˜¯å¦æœ‰é—®é¢˜ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl experimental precheck
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;âœ” No issues found when checking the cluster. Istio is safe to install or upgrade!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  To get started, check out https://istio.io/latest/docs/setup/getting-started/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt; å®‰è£… Istio åŒæ—¶é…ç½®å‘é€è¿½è¸ªä¿¡æ¯çš„ç›®çš„åœ°ä¸º SkyWalkingï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å°†å®‰è£…é…ç½®ä¿å­˜åˆ°æ–‡ä»¶ä¸­&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat&lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF&amp;gt;istio-install.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: install.istio.io/v1alpha1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: IstioOperator
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: istio-with-skywalking
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  meshConfig:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    defaultProviders:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      tracing:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      - &amp;#34;skywalking&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    enableTracing: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    extensionProviders:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - name: &amp;#34;skywalking&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      skywalking:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        service: tracing.istio-system.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        port: 11800
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ä½¿ç”¨ istioctl å®‰è£… Istio&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl install -f istio-install.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;install-skywalking&#34;&gt;éƒ¨ç½² Apache SkyWalking&lt;/h3&gt;
&lt;p&gt;Istio 1.16 æ”¯æŒä½¿ç”¨ Apache SkyWalking è¿›è¡Œåˆ†å¸ƒå¼è¿½è¸ªï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç å®‰è£… SkyWalkingï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/istio/istio/master/samples/addons/extras/skywalking.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒå°†åœ¨ &lt;code&gt;istio-system&lt;/code&gt; å‘½åç©ºé—´ä¸‹å®‰è£…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://skywalking.apache.org/docs/main/v9.3.0/en/concepts-and-designs/backend-overview/&#34; title=&#34;SkyWalking OAP&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SkyWalking OAP&lt;/a&gt;
 (Observability Analysis Platform) ï¼šç”¨äºæ¥æ”¶è¿½è¸ªæ•°æ®ï¼Œæ”¯æŒ SkyWalking åŸç”Ÿæ•°æ®æ ¼å¼ï¼ŒZipkin v1 å’Œ v2 ä»¥åŠ Jaeger æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://skywalking.apache.org/docs/main/v9.3.0/en/ui/readme/&#34; title=&#34;UI&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UI&lt;/a&gt;
ï¼šç”¨äºæŸ¥è¯¢åˆ†å¸ƒå¼è¿½è¸ªæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…³äº SkyWalking çš„è¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ &lt;a href=&#34;https://skywalking.apache.org/docs/main/v9.3.0/readme/&#34; title=&#34;SkyWalking æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SkyWalking æ–‡æ¡£&lt;/a&gt;
ã€‚&lt;/p&gt;
&lt;h3 id=&#34;install-bookinfo&#34;&gt;éƒ¨ç½² Bookinfo åº”ç”¨&lt;/h3&gt;
&lt;p&gt;æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£… bookinfo ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl label namespace default istio-injection&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åç»™ productpage æœåŠ¡å‘é€è¯·æ±‚ï¼Œå¦‚æœä½ æ˜¯åœ¨ Kind ä¸­å®‰è£…çš„ Istioï¼Œåˆ™é»˜è®¤çš„ IngressGateway å°†æ˜¯ LoadBalancer ç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ç«¯å£è½¬å‘çš„æ–¹å¼æ¥æš´éœ²ç½‘å…³ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward -n istio-system svc/istio-ingressgateway 8081:80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡ &lt;code&gt;http://localhost:8081/productpage&lt;/code&gt; å°±å¯ä»¥è®¿é—®åˆ° productpage æœåŠ¡ã€‚å¤šè®¿é—®å‡ æ¬¡æ¥åˆ¶é€ ä¸€äº›æµé‡ï¼Œåé¢æˆ‘ä»¬å°±èƒ½åœ¨ SkyWalking UI ä¸Šçœ‹åˆ°æ‹“æ‰‘å›¾äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ SkyWalking UIï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl dashboard skywalking
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;SkyWalking çš„ General Service é¡µé¢å±•ç¤ºäº† bookinfo åº”ç”¨ä¸­çš„æ‰€æœ‰æœåŠ¡ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/general-service_hu2ddf7fb1c303810e377748b5f343fb3a_152317_1622x1080_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/general-service.jpg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/general-service.jpg&#34; data-width=&#34;1622&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;SkyWalking çš„ General Service é¡µé¢&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;SkyWalking çš„ General Service é¡µé¢&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä½ è¿˜å¯ä»¥çœ‹åˆ°å®ä¾‹ã€ç«¯ç‚¹ã€æ‹“æ‰‘ã€è¿½è¸ªç­‰ä¿¡æ¯ã€‚ä¾‹å¦‚ä¸‹å›¾å±•ç¤ºäº† bookinfo åº”ç”¨çš„æœåŠ¡æ‹“æ‰‘ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/topology_hubb87bfa54bb91be3314804bd27a89636_133434_1622x1080_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/topology.jpg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/topology.jpg&#34; data-width=&#34;1622&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;Bookinfo åº”ç”¨çš„æœåŠ¡æ‹“æ‰‘&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;Bookinfo åº”ç”¨çš„æœåŠ¡æ‹“æ‰‘&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;SkyWalking çš„è¿½è¸ªè§†å›¾æœ‰å¤šç§æ˜¾ç¤ºå½¢å¼ï¼Œå¦‚åˆ—è¡¨ã€æ ‘å½¢ã€è¡¨æ ¼å’Œç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/gs-styles_hu523c09f878b0bdef9667a82662683ca9_222855_2062x1080_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/gs-styles.jpg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/gs-styles.jpg&#34; data-width=&#34;2062&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;SkyWalking é€šç”¨æœåŠ¡è¿½è¸ªæ”¯æŒå¤šç§æ˜¾ç¤ºæ ·å¼&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;SkyWalking é€šç”¨æœåŠ¡è¿½è¸ªæ”¯æŒå¤šç§æ˜¾ç¤ºæ ·å¼&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬æ£€æŸ¥ï¼Œå°†è¿½è¸ªçš„é‡‡æ ·ç‡è®¾ç½®ä¸º 100%ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f - &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: telemetry.istio.io/v1alpha1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Telemetry
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: mesh-default
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  tracing:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  - randomSamplingPercentage: 100.00
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;purge&#34;&gt;å¸è½½&lt;/h3&gt;
&lt;p&gt;åœ¨å®éªŒå®Œåï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¸è½½ Istio å’Œ SkyWalkingï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;samples/bookinfo/platform/kube/cleanup.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl unintall --purge
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl delete namespace istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;bookinfo-tracing&#34;&gt;Bookinfo demo è¿½è¸ªä¿¡æ¯è¯´æ˜&lt;/h2&gt;
&lt;p&gt;åœ¨ Apache SkyWalking UI ä¸­å¯¼èˆªåˆ° General Service åˆ†é¡µï¼ŒæŸ¥çœ‹æœ€è¿‘çš„ &lt;code&gt;istio-ingressgateway&lt;/code&gt; æœåŠ¡çš„è¿½è¸ªä¿¡æ¯ï¼Œè¡¨è§†å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚å›¾ä¸­å±•ç¤ºäº†æ­¤æ¬¡è¯·æ±‚æ‰€æœ‰ Span çš„åŸºæœ¬ä¿¡æ¯ï¼Œç‚¹å‡»æ¯ä¸ª Span å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/span-table_hu96cc08eabccb88a60c7d395d0751ce9b_181866_1495x1080_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/span-table.jpg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/span-table.jpg&#34; data-width=&#34;1495&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;è¡¨æ ¼è§†å›¾ä¸­æ˜¾ç¤ºäº† Span çš„åŸºæœ¬ä¿¡æ¯&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;è¡¨æ ¼è§†å›¾ä¸­æ˜¾ç¤ºäº† Span çš„åŸºæœ¬ä¿¡æ¯&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;åˆ‡æ¢ä¸ºåˆ—è¡¨è§†å›¾ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ª Span çš„æ‰§è¡Œé¡ºåºåŠæŒç»­æ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/trace-list_huf7bd3b7813b91c53c4968ed99daee187_56031_1190x816_resize_q75_h2_lanczos.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/trace-list.jpg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/trace-list.jpg&#34; data-width=&#34;1190&#34; data-height=&#34;816&#34; alt=&#34;image&#34; data-caption=&#34;åˆ—è¡¨è§†å›¾&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  &lt;figcaption&gt;åˆ—è¡¨è§†å›¾&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ä½ å¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•çš„ä¸€ä¸ªåº”ç”¨ä¼šäº§ç”Ÿå¦‚æ­¤å¤šçš„ Span ä¿¡æ¯ï¼Ÿå› ä¸ºæˆ‘ä»¬ä¸º Pod æ³¨å…¥äº† Envoy ä»£ç†ä¹‹åï¼Œæ¯ä¸ªæœåŠ¡é—´çš„è¯·æ±‚éƒ½ä¼šè¢« Envoy æ‹¦æˆªå’Œå¤„ç†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/span.svg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/span.svg&#34; alt=&#34;image&#34; data-caption=&#34;Envoy æ‹¦æˆªè¯·æ±‚äº§ç”Ÿ Span&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;Envoy æ‹¦æˆªè¯·æ±‚äº§ç”Ÿ Span&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æ•´ä¸ªè¿½è¸ªæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/distributed-tracing-with-skywalking-in-istio/bookinfo-spans-with-time.svg&#34; data-img=&#34;/blog/distributed-tracing-with-skywalking-in-istio/bookinfo-spans-with-time.svg&#34; alt=&#34;image&#34; data-caption=&#34;Bookinfo çš„åˆ†å¸ƒå¼è¿½è¸ªç—•è¿¹&#34;&gt;
        
      
    
  
  &lt;figcaption&gt;Bookinfo çš„åˆ†å¸ƒå¼è¿½è¸ªç—•è¿¹&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å›¾ä¸­ç»™æ¯ä¸€ä¸ª Span æ ‡è®°äº†åºå·ï¼Œå¹¶åœ¨æ‹¬å·é‡Œæ³¨æ˜äº†è€—æ—¶ã€‚ä¸ºäº†ä¾¿äºè¯´æ˜æˆ‘ä»¬å°†æ‰€æœ‰ Span æ±‡æ€»åœ¨ä¸‹é¢çš„è¡¨æ ¼ä¸­ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åºå·&lt;/th&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;æ€»è€—æ—¶ï¼ˆmsï¼‰&lt;/th&gt;
&lt;th&gt;ç»„ä»¶è€—æ—¶ï¼ˆmsï¼‰&lt;/th&gt;
&lt;th&gt;å½“å‰æœåŠ¡&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;/productpage&lt;/td&gt;
&lt;td&gt;190&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;istio-ingressgateway&lt;/td&gt;
&lt;td&gt;Envoy Outbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;/productpage&lt;/td&gt;
&lt;td&gt;190&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;istio-ingressgateway&lt;/td&gt;
&lt;td&gt;Ingress -&amp;gt; Productpage ç½‘ç»œä¼ è¾“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;/productpage&lt;/td&gt;
&lt;td&gt;189&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;Envoy Inbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;/productpage&lt;/td&gt;
&lt;td&gt;188&lt;/td&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;åº”ç”¨å†…éƒ¨å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;/details/0&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;Envoy Outbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;/details/0&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;Productpage -&amp;gt; Details ç½‘ç»œä¼ è¾“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;/details/0&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;details&lt;/td&gt;
&lt;td&gt;Envoy Inbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;/details/0&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;details&lt;/td&gt;
&lt;td&gt;åº”ç”¨å†…éƒ¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;/reviews/0&lt;/td&gt;
&lt;td&gt;159&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;Envoy Outbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;/reviews/0&lt;/td&gt;
&lt;td&gt;159&lt;/td&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;productpage&lt;/td&gt;
&lt;td&gt;Productpage -&amp;gt; Reviews ç½‘ç»œä¼ è¾“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;/reviews/0&lt;/td&gt;
&lt;td&gt;145&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;reviews&lt;/td&gt;
&lt;td&gt;Envoy Inbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;/reviews/0&lt;/td&gt;
&lt;td&gt;144&lt;/td&gt;
&lt;td&gt;109&lt;/td&gt;
&lt;td&gt;reviews&lt;/td&gt;
&lt;td&gt;åº”ç”¨å†…éƒ¨å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;/ratings/0&lt;/td&gt;
&lt;td&gt;35&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;reviews&lt;/td&gt;
&lt;td&gt;Envoy Outbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;/ratings/0&lt;/td&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;reviews&lt;/td&gt;
&lt;td&gt;Reviews -&amp;gt; Ratings ç½‘ç»œä¼ è¾“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;/ratings/0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;ratings&lt;/td&gt;
&lt;td&gt;Envoy Inbound&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;/ratings/0&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;ratings&lt;/td&gt;
&lt;td&gt;åº”ç”¨å†…éƒ¨å¤„ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä»ä»¥ä¸Šä¿¡æ¯å¯ä»¥å‘ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬æ¬¡è¯·æ±‚æ€»è€—æ—¶ 190msï¼›&lt;/li&gt;
&lt;li&gt;åœ¨ Istio sidecar æ¨¡å¼ä¸‹ï¼Œæ¯æ¬¡æµé‡åœ¨è¿›å‡ºåº”ç”¨å®¹å™¨æ—¶éƒ½éœ€è¦ç»è¿‡ä¸€æ¬¡ Envoy ä»£ç†ï¼Œæ¯æ¬¡è€—æ—¶åœ¨ 0 åˆ° 2 msï¼›&lt;/li&gt;
&lt;li&gt;åœ¨ Pod é—´çš„ç½‘ç»œè¯·æ±‚è€—æ—¶åœ¨ 1 åˆ° 16ms ä¹‹é—´ï¼›&lt;/li&gt;
&lt;li&gt;å°†è€—æ—¶åšå¤šçš„è°ƒç”¨é“¾ Ingress Gateway -&amp;gt; Productpage -&amp;gt; Reviews -&amp;gt; Ratings ä¸Šçš„æ‰€æœ‰è€—æ—¶ç´¯è®¡ 182 msï¼Œå°äºè¯·æ±‚æ€»è€—æ—¶ 190msï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®æœ¬èº«æœ‰è¯¯å·®ï¼Œä»¥åŠ Span çš„å¼€å§‹æ—¶é—´å¹¶ä¸ä¸€å®šç­‰äºçˆ¶ Span çš„ç»“æŸæ—¶é—´ï¼Œå¦‚æœä½ åœ¨ SkyWalking çš„è¿½è¸ªé¡µé¢ï¼Œé€‰æ‹©ã€Œåˆ—è¡¨ã€æ ·å¼æŸ¥çœ‹è¿½è¸ªæ•°æ®ï¼ˆè§å›¾ 2ï¼‰å¯ä»¥æ›´ç›´è§‚çš„å‘ç°è¿™ä¸ªé—®é¢˜ï¼›&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°æœ€è€—æ—¶çš„éƒ¨åˆ†æ˜¯ Reviews åº”ç”¨ï¼Œè€—æ—¶ 109msï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é’ˆå¯¹è¯¥åº”ç”¨è¿›è¡Œä¼˜åŒ–ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;summary&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åªè¦å¯¹åº”ç”¨ä»£ç ç¨ä½œä¿®æ”¹å°±å¯ä»¥åœ¨ Istio å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨åˆ†å¸ƒå¼è¿½è¸ªåŠŸèƒ½ã€‚åœ¨ Istio æ”¯æŒçš„ä¼—å¤šåˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿä¸­ï¼Œ&lt;a href=&#34;https://skywalking.apache.org/&#34; title=&#34;Apache SkyWalking&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Apache SkyWalking&lt;/a&gt;
 æ˜¯å…¶ä¸­çš„ä½¼ä½¼è€…ã€‚å®ƒä¸ä»…æ”¯æŒåˆ†å¸ƒå¼è¿½è¸ªï¼Œè¿˜æ”¯æŒæŒ‡æ ‡å’Œæ—¥å¿—æ”¶é›†ã€æŠ¥è­¦ã€Kubernetes å’ŒæœåŠ¡ç½‘æ ¼ç›‘æ§ï¼Œ&lt;a href=&#34;https://skywalking.apache.org/zh/diagnose-service-mesh-network-performance-with-ebpf/&#34; title=&#34;ä½¿ç”¨ eBPF è¯Šæ–­æœåŠ¡ç½‘æ ¼æ€§èƒ½&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ eBPF è¯Šæ–­æœåŠ¡ç½‘æ ¼æ€§èƒ½&lt;/a&gt;
ç­‰åŠŸèƒ½ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„äº‘åŸç”Ÿåº”ç”¨åˆ†æå¹³å°ã€‚æœ¬æ–‡ä¸­ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå°†è¿½è¸ªé‡‡æ ·ç‡è®¾ç½®ä¸ºäº† 100%ï¼Œåœ¨ç”Ÿäº§ä½¿ç”¨æ—¶è¯·æ ¹æ®éœ€è¦è°ƒæ•´é‡‡æ ·ç­–ç•¥ï¼ˆé‡‡æ ·ç™¾åˆ†æ¯”ï¼‰ï¼Œé˜²æ­¢äº§ç”Ÿè¿‡å¤šçš„è¿½è¸ªæ—¥å¿—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/tasks/observability/distributed-tracing/overview/&#34; title=&#34;Istio åˆ†å¸ƒå¼è¿½è¸ªæ¦‚è§ˆ - istio.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åˆ†å¸ƒå¼è¿½è¸ªæ¦‚è§ˆ - istio.io&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/about/faq/#distributed-tracing&#34; title=&#34;Istio åˆ†å¸ƒå¼è¿½è¸ª FAQ - istio.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åˆ†å¸ƒå¼è¿½è¸ª FAQ - istio.io&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
  </channel>
</rss>
