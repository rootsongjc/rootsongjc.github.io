<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>Envoy - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="å®‹å‡€è¶…çš„åšå®¢">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.129.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/tags/envoy/" />
  <meta property="og:title" content="Envoy | Jimmy Song" />
  <meta property="twitter:title" content="Envoy | Jimmy Song" />

  
  <meta property="og:description" content="å®‹å‡€è¶…çš„åšå®¢" />
  <meta property="twitter:description" content="å®‹å‡€è¶…çš„åšå®¢" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">åšå®¢</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/book">èµ„æ–™</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">æ ‡ç­¾</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">å…¬å‘Š</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">è”ç³»</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">å…³äº</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">ç¤¾åŒº</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">è§†é¢‘ <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    <a class="nav-link" href="/en/tags/envoy/">English</a>
                    
                  
                
              
              
              
                
                  
                    
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>æœç´¢</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">âŒ˜</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>ç«™å†…æœç´¢</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="å…³é—­"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="è¯·è¾“å…¥æœç´¢è¯" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="è¯·è¾“å…¥æœç´¢è¯">
        
        <div class="mt-4">
          <span>æœç´¢ç±»å‹: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">æ‰€æœ‰</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">åŸåˆ›</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">è¯‘æ–‡</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">èµ„æ–™</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">å…¬å‘Š</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    Envoy
                </p>
                <p class="page-description">
                    
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/service-mesh-in-action-by-yangzhangxian-review/">ã€ŠService Mesh å®æˆ˜â€”åŸºäº Linkerd å’Œ Kubernetes çš„å¾®æœåŠ¡å®è·µã€‹è¯»åæ„Ÿ</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2019/01/08</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ã€ŠService Mesh å®æˆ˜â€”åŸºäº Linkerd å’Œ Kubernetes çš„å¾®æœåŠ¡å®è·µã€‹è¯»åæ„Ÿ', 'é¡ºä¾¿å¯¹æ¯”äº†ä¸‹ Linkerd å’Œ Envoyï¼Œç»™è¯»è€…ä¸€äº›æˆ‘è‡ªå·±çš„å»ºè®®ã€‚', '\næœ€è¿‘åœ¨å›é¡¾ Service Mesh æŠ€æœ¯åœ¨ 2018 å¹´çš„å‘å±•ï¼Œæƒ³å†çœ‹çœ‹ Linkerdï¼Œæ­£å¥½**æ¨å½°æ˜¾**çš„è¿™æœ¬ã€ŠService Mesh å®æˆ˜â€”â€”åŸºäº Linkerd å’Œ Kubernetes çš„å¾®æœåŠ¡å®è·µã€‹ä¸Šå¸‚å‘å”®äº†ï¼Œ**æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾**çš„ç¼–è¾‘é€äº†æˆ‘ä¸€æœ¬ï¼ŒğŸ™**æ¨ç¦å·**ç¼–è¾‘ï¼Œæˆ‘çœ‹äº†ä¸‹æŠ½ç©ºå†™äº†ç‚¹è¯»åæ„Ÿï¼Œæˆ‘çœ‹äº†ä¸‹æŠ½ç©ºå†™äº†ç‚¹è¯»åæ„Ÿï¼Œå…¶å®ä¹Ÿè¯´ä¸ä¸Šæ˜¯è¯»åæ„Ÿï¼Œå°±å½“æ˜¯è‡ªå·±çš„ä¸€ç‚¹æ„Ÿæ‚Ÿå§ï¼Œå°±å½“æ‹¿æ­¤ä¹¦å€Ÿé¢˜å‘æŒ¥å§ï¼Œè¿™ä¸ªçŸ¥è¯†çˆ†ç‚¸çš„å¹´ä»£ï¼ŒæŠ€æœ¯å‘å±•å¦‚æ­¤è¿…é€Ÿï¼Œå¯ä»¥è¯´æ˜¯ IT äººå‘˜çš„å¹¸è¿ï¼Œä¹Ÿæ˜¯ä¸å¹¸ï¼æœ‰å¤šå°‘å†™å¼€æºè½¯ä»¶çš„ä¹¦æ¨å‡ºä¸€ç‰ˆåèƒ½æ’‘è¿‡ä¸‰å¹´çš„ï¼Ÿå¦‚æœè½¯ä»¶çº¢å¾—å‘ç´«ï¼ŒæŒç»­è¿­ä»£ N ä¸ªç‰ˆæœ¬ï¼Œä¾‹å¦‚ Kubernetesï¼Œæœ€è¿‘ä¸¤å¹´ä»¥æ¯ä¸‰ä¸ªæœˆä¸€ä¸ªç‰ˆæœ¬çš„é€Ÿåº¦è¿­ä»£ï¼Œä¹‹å‰çš„ä¹¦æ—©å°±è·Ÿä¸ä¸ŠèŠ‚å¥ï¼Œè¦ä¹ˆå°±è¦ä¸æ–­æ¨å‡ºæ–°ç‰ˆï¼Œç›´åˆ°è½¯ä»¶ç¨³å®šåä¸å†æœ‰å¤§çš„æ”¹åŠ¨ã€‚è¿˜æœ‰ç§å¯èƒ½å°±æ˜¯è½¯ä»¶æ¨å¹¿å’Œå‘å±•çš„ä¸ç†æƒ³ï¼Œæ— äººé—®æ´¥ï¼Œå†™è¿™æ ·è½¯ä»¶çš„ä¹¦å°±ä¸ä¼šæœ‰å†ç‰ˆäº†ã€‚\n\næ‹¿åˆ°æœ¬ä¹¦åæˆ‘çš„ç¬¬ä¸€ååº”å°±æ˜¯çœ‹çœ‹è¿™æœ¬ä¹¦å®šç¨¿çš„æ—¶å€™ Istio æ˜¯ä»€ä¹ˆç‰ˆæœ¬ï¼ŒLinkerd åˆæ˜¯ä»€ä¹ˆç‰ˆæœ¬ã€‚å› ä¸ºåœ¨è¿™ä¸€å¹´å†…ä¸¤æ¬¾å¼€æºè½¯ä»¶éƒ½æœ‰è¾ƒå¤§çš„ç‰ˆæœ¬å˜åŠ¨ï¼Œå¦‚æœä¹¦ç±å®šç¨¿çš„æ—¶å€™åŸºäºçš„è½¯ä»¶ç‰ˆæœ¬å¤ªä½ï¼Œè½¯ä»¶æ¶æ„å¯èƒ½ä¼šæœ‰è¾ƒå¤§çš„å˜åŒ–ï¼Œå½±å“ä¹¦ä¸­ç¤ºä¾‹å’Œéƒ¨åˆ†ç« èŠ‚çš„æ—¶æ•ˆæ€§ã€‚è¿™ä¹Ÿæ˜¯å¤§å¤šæŠ€æœ¯ä¹¦ç±åçŸ­çš„ç—‡ç»“æ‰€åœ¨ï¼ŒæŠ€æœ¯å‘å±•æ˜¯åœ¨å¤ªå¿«ï¼Œä¼ ç»Ÿçš„ä¹¦ç±å‡ºç‰ˆæµç¨‹å¾€å¾€è¿‡äºç¹çå’Œå†—é•¿ï¼Œç­‰åˆ°ä¹¦ç±å‡ºç‰ˆåæ‰€ä»‹ç»çš„è½¯ä»¶éƒ½å‡ºäº†å¥½å‡ ä¸ªç‰ˆæœ¬ã€‚ä¾‹å¦‚ Kubernetes è¿™ç§çš„è½¯ä»¶ï¼Œæ¯ä¸‰ä¸ªæœˆä¸€ä¸ªç‰ˆæœ¬ï¼Œè€Œå†™ä¸€èˆ¬ä¹¦ä»ç­–åˆ’åˆ°å‘è¡Œå°‘è¯´åŠå¹´ï¼Œä¸€èˆ¬ä¹Ÿè¦ä¸€å¹´çš„æ—¶é—´ã€‚\n\n## å…³äºä¹¦ç±å®šç¨¿æ—¶çš„è½¯ä»¶ç‰ˆæœ¬\n\n**Istio 0.8**\n\næœ¬ä¹¦ç¬¬ä¸€ç« ã€ŒService Mesh ç®€ä»‹ã€å¯¹ Service Mesh ç›¸å…³å¼€æºäº§å“ä»‹ç»æ—¶æåˆ°æœ¬ä¹¦å®šç¨¿æ—¶ Istio æ˜¯ 0.8 ç‰ˆæœ¬ï¼Œè€Œ Istio åœ¨ 2018 å¹´ 7 æœˆ 31 æ—¥å‘å¸ƒäº† 1.0 ç‰ˆæœ¬ã€‚\n\nè¿™æœ¬ä¹¦å®šç¨¿æ—¶ï¼ŒIstio çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ 0.8ã€‚\n\n**Linkerd 1.3.6**\n\næœ¬ä¹¦ä»åºè¨€å¼€å§‹ä¸€ç›´åˆ°ç¬¬äºŒç« ç»“æŸä¹Ÿæ²¡æœ‰æåŠå†™ä½œæ—¶åŸºäºçš„ Linkerd ç‰ˆæœ¬ï¼Œæˆ‘åœ¨ç¬¬äºŒç« çš„å®‰è£…æ­¥éª¤ä¸­çœ‹åˆ°äº†è¯´æ˜ã€‚\n\nå¯ä»¥çœ‹åˆ°æœ¬ä¹¦å†™ä½œæ—¶æ˜¯åŸºäº Linkerd 1.3.6 ç‰ˆæœ¬ï¼Œè€Œ Linkerd åœ¨åŒå¹´çš„ 9 æœˆ 18 æ—¥å‘å¸ƒäº† [2.0 GA](https:\/\/cloudnative.to\/blog\/linkerd-2-0-in-general-availability\/)ï¼Œè¿™ä¸€ç‰ˆæœ¬è·Ÿ 1.x ç‰ˆæœ¬ç›¸æ¯”æœ‰é‡å¤§å˜åŒ–â€”â€”å®ƒè¿˜å°†é¡¹ç›®ä»é›†ç¾¤èŒƒå›´çš„ service mesh è½¬æ¢ä¸ºå¯ç»„åˆçš„ *service sidecar* ï¼Œæ—¨åœ¨ä¸ºå¼€å‘äººå‘˜å’ŒæœåŠ¡æ‰€æœ‰è€…æä¾›åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­æˆåŠŸæ‰€éœ€çš„å…³é”®å·¥å…·ã€‚\n\n## Linkerd vs Envoy\n\nLinkerd 2.0 çš„ service sidecar è®¾è®¡ä½¿å¼€å‘äººå‘˜å’ŒæœåŠ¡æ‰€æœ‰è€…èƒ½å¤Ÿåœ¨ä»–ä»¬çš„æœåŠ¡ä¸Šè¿è¡Œ Linkerdï¼Œæä¾›è‡ªåŠ¨å¯è§‚æµ‹æ€§ã€å¯é æ€§å’Œè¿è¡Œæ—¶è¯Šæ–­ï¼Œè€Œæ— éœ€æ›´æ”¹é…ç½®æˆ–ä»£ç ã€‚é€šè¿‡æä¾›è½»é‡çº§çš„å¢é‡è·¯å¾„æ¥è·å¾—å¹³å°èŒƒå›´çš„é¥æµ‹ã€å®‰å…¨æ€§å’Œå¯é æ€§çš„ä¼ ç»Ÿ service mesh åŠŸèƒ½ï¼Œservice sidecar æ–¹æ³•è¿˜é™ä½äº†å¹³å°æ‰€æœ‰è€…å’Œç³»ç»Ÿæ¶æ„å¸ˆçš„é£é™©ã€‚è¯¥ç‰ˆæœ¬è¿˜ç”¨ Rust é‡å†™äº†ä»£ç†éƒ¨åˆ†ï¼Œåœ¨å»¶è¿Ÿï¼Œååé‡å’Œèµ„æºæ¶ˆè€—æ–¹é¢äº§ç”Ÿäº†æ•°é‡çº§çš„æ”¹è¿›ã€‚\n\nè€Œ Linkerd 1.x ç»§æ‰¿è‡ª Twitter å¼€æºçš„ Finagle é«˜æ€§èƒ½ RPCï¼Œæ‰€æœ‰æƒ³è¦æ·±åº¦å­¦ä¹  Linkerd 1.x è¿˜éœ€è¦äº†è§£ Finagleï¼Œè¿™å°±è·Ÿ Istio å°† Envoy ä½œä¸ºé»˜è®¤çš„æ•°æ®å¹³é¢ä¸€æ ·ï¼Œè¦æƒ³æ·±åº¦å­¦ä¹  Istio å¿…é¡»äº†è§£ Envoyã€‚\n\näºŒè€…å‡ ä¹ä½¿ç”¨äº†å®Œå…¨ä¸åŒçš„æœ¯è¯­ï¼Œå‡å¦‚ä½ å·²ç»äº†è§£äº† [Envoy](https:\/\/envoyproxy.io) æƒ³è¦å†åˆ‡æ¢åˆ° Linkerd ä¸Šï¼Œé‚£ä¹ˆå°±è¦å†è´¹å¾ˆå¤šå¿ƒåŠ›æ¥å­¦ä¹ å®ƒçš„æ¦‚å¿µå’ŒåŸç†ï¼Œä¾‹å¦‚å¦‚ä¸‹è¿™äº›æœ¯è¯­æˆ–é…ç½®ï¼ˆLinkerd ä¸­ç‹¬æœ‰çš„é…ç½®ï¼‰ï¼š\n\n- **dtabï¼ˆå§”æ‰˜è¡¨ï¼‰**ï¼šç”±ä¸€ç³»åˆ—è·¯ç”±ç»„æˆï¼Œç”±ä¸€ç³»åˆ—è·¯ç”±è§„åˆ™ç»„æˆï¼Œä»¥é€»è¾‘è·¯å¾„ä¸ºè¾“å…¥ï¼Œç„¶åç»è¿‡è·¯ç”±è§„åˆ™åšä¸€ç³»åˆ—è½¬æ¢ç”Ÿæˆå…·ä½“åå­—ã€‚è¿™æ˜¯ Linkerd è·¯ç”±æœºåˆ¶çš„æ ¹æœ¬ï¼Œå°±åƒ Envoy ä¸­çš„ [xDS åè®®](https:\/\/jimmysong.io\/istio-handbook\/data-plane\/envoy-xds.html)ä¸€æ ·ï¼Œæœ¬ä¹¦çš„ç¬¬å››ç« ã€Œæ·±å…¥ Linkerd æ•°æ®è®¿é—®æµã€ä¸“é—¨è®²è§£äº† dtab çš„å®ç°æœºåˆ¶ã€‚\n- **dentryï¼ˆå§”æ‰˜è¡¨è®°å½•ï¼‰**ï¼šå§”æ‰˜è¡¨çš„æ¯æ¡è·¯ç”±è§„åˆ™ç§°ä¸º dentryï¼Œå¦‚ \/consul =\u003e \/#\/io.l5d.consul\/dc1ã€‚\n- **namer**ï¼šé…ç½® Linkerd æ”¯æŒçš„æœåŠ¡å‘ç°å·¥å…·ã€‚\n- **namerd**ï¼šLinkerd çš„æ§åˆ¶å¹³é¢ï¼Œç›¸å½“äº Istio ä¸­çš„ Pilotï¼Œå¯¹æ¥å„ç§æœåŠ¡å‘ç°ã€‚å½“ç„¶ Linkerd ä¹Ÿå¯ä»¥ç›´æ¥ä¸æŸä¸ªæœåŠ¡å‘ç°å¹³å°å¯¹æ¥å¦‚ consulï¼Œè€Œä¸ä½¿ç”¨ namerd è¿™ä¸ªé›†ä¸­è·¯ç”±å’Œé…ç½®ç®¡ç†ç»„ä»¶ã€‚\n- **interpreter**ï¼šinterpreter å†³å®šå¦‚ä½•è§£ææœåŠ¡åå­—å’Œå®¢æˆ·ç«¯åå­—ã€‚\n\nè™½ç„¶ Linkerd ä¹Ÿæ˜¯ [CNCF ä¸­çš„é¡¹ç›®](https:\/\/www.cncf.io\/projects\/)ï¼Œä½†å®ƒç›®å‰è¿˜å¤„äºå­µåŒ–é˜¶æ®µï¼Œè€Œ Envoy çš„ [xDS åè®®](https:\/\/jimmysong.io\/istio-handbook\/data-plane\/envoy-xds.html)å·²ç»è¢«ä¼—å¤šå¼€æºé¡¹ç›®æ‰€æ”¯æŒï¼Œå¦‚ [Istio](https:\/\/istio.io\/zh)ã€[SOFAMesh](https:\/\/github.com\/alipay\/sofa-mesh)ã€[NginxMesh](https:\/\/github.com\/nginxinc\/nginmesh) ç­‰ï¼Œä¸” Envoy å·²ç»ä» CNCF ä¸­æ¯•ä¸šï¼Œä»¥åå¯èƒ½æˆä¸º Service Mesh é¢†åŸŸçš„æ ‡å‡†åè®®ï¼ŒLinkerd çš„ç”Ÿå­˜çŠ¶å†µå ªå¿§ã€‚\n\n## å…³äºæœ¬ä¹¦\n\næœ¬ä¹¦ä¸­æ‰€æœ‰ç¤ºä¾‹éƒ½æä¾›äº†è™šæ‹Ÿæœºçš„å¿«é€Ÿä¸Šæ‰‹ç¯å¢ƒï¼Œåªè¦ä½¿ç”¨ Vagrant å³å¯åˆ›å»ºè™šæ‹Ÿæœºå’Œåº”ç”¨ï¼Œæ‰€ä»¥åœ¨æœ¬ä¹¦çš„[ç¤ºä¾‹ä»£ç ](https:\/\/github.com\/yangzhares\/linkerd-in-action)æœ‰å¤§é‡çš„ Vagrantfileã€‚\n\næœ¬ä¹¦ç¬¬ä¸‰éƒ¨åˆ†ã€Œå®æˆ˜ç¯‡ã€èŠ±äº†å¤§é‡ç¯‡å¹…ï¼ˆæœ¬ä¹¦ä¸€åŠçš„é¡µæ•°ï¼‰æ¥è®²è§£å¦‚ä½•ä½¿ç”¨ Linkerd å’Œ Kubernetes æ¥ç®¡ç†å¾®æœåŠ¡ï¼Œå¯ä»¥å‚è€ƒæˆ‘ 2017 å¹´ 8 æœˆ 1 æ—¥å†™çš„è¿™ç¯‡[å¾®æœåŠ¡ç®¡ç†æ¡†æ¶ service meshâ€”â€”Linkerd å®‰è£…è¯•ç”¨ç¬”è®°](https:\/\/jimmysong.io\/posts\/linkerd-user-guide\/)ï¼Œé‚£æ—¶å€™è¿˜æ˜¯åŸºäº Linkerd 1.1.2ï¼Œè¿˜æœ‰ [Linkerd å®˜æ–¹ç¤ºä¾‹](https:\/\/github.com\/linkerd\/linkerd-examples\/)ï¼Œè¿™äº›ç¤ºä¾‹åŸºæœ¬éƒ½ä¸æ€ä¹ˆæ›´æ–°äº†ã€‚\n\nå› ä¸ºè¯¥ä¹¦å®šç¨¿æ—¶æ‰€åŸºäºçš„ Linkerd ç‰ˆæœ¬è·ç¦»æœ¬ä¹¦å‘å”®æ—¶çš„ Linkerd å·²ç»è½åä¸€ä¸ªå¤§ç‰ˆæœ¬ï¼ˆæœ€æ–°ç‰ˆæœ¬æ˜¯ [Linkerd 2.1](https:\/\/blog.linkerd.io\/2018\/12\/06\/announcing-linkerd-2-1\/)ï¼‰ï¼Œæ‰€ä»¥è¯»è€…ä¸€å®šè¦æ³¨æ„è¿™ä¸€ç‚¹ï¼Œè€å®è¯´æˆ‘åªèŠ±äº†ä¸¤ä¸ªå¤œæ™šå¿«é€Ÿè¿‡äº†ä¸€ä¸‹æœ¬ä¹¦ï¼Œæ— æ³•å¯¹æœ¬ä¹¦å†…å®¹ç»™å‡ºå…·ä½“è¯„è®ºï¼Œæ‰€ä»¥æœ¬ä¹¦æ˜¯å¦æ˜¯ä½ æ‰€éœ€è¦çš„å°±è¦ä½ è‡ªå·±å»æ€è€ƒäº†ã€‚\n\n', '\/blog\/service-mesh-in-action-by-yangzhangxian-review\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">é¡ºä¾¿å¯¹æ¯”äº†ä¸‹ Linkerd å’Œ Envoyï¼Œç»™è¯»è€…ä¸€äº›æˆ‘è‡ªå·±çš„å»ºè®®ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/envoy-proxy-config-deep-dive/">Istio çš„æ•°æ®å¹³é¢ Envoy Proxy é…ç½®è¯¦è§£</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2019/01/07</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/envoy"> 
             Envoy
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio çš„æ•°æ®å¹³é¢ Envoy Proxy é…ç½®è¯¦è§£', 'æœ¬æ–‡ä»‹ç»äº† Envoy proxy çš„æ¦‚å¿µï¼Œå¯¹åº”çš„ xDS çš„ç‰ˆæœ¬ä»¥åŠé…ç½®çš„è¯¦ç»†è§£æã€‚', '\nEnvoy æ˜¯ Istio Service Mesh ä¸­é»˜è®¤çš„ Sidecarï¼ŒIstio åœ¨ Envoy çš„åŸºç¡€ä¸ŠæŒ‰ç…§ Envoy çš„ xDS åè®®æ‰©å±•äº†å…¶æ§åˆ¶å¹³é¢ï¼Œåœ¨è®²åˆ° Envoy xDS åè®®ä¹‹å‰è¿˜éœ€è¦æˆ‘ä»¬å…ˆç†Ÿæ‚‰ä¸‹ Envoy çš„åŸºæœ¬æœ¯è¯­ã€‚ä¸‹é¢åˆ—ä¸¾äº† Envoy é‡Œçš„åŸºæœ¬æœ¯è¯­åŠå…¶æ•°æ®ç»“æ„è§£æï¼Œå…³äº Envoy çš„è¯¦ç»†ä»‹ç»è¯·å‚è€ƒ [Envoy å®˜æ–¹æ–‡æ¡£](https:\/\/cloudnative.to\/envoy\/)ï¼Œè‡³äº Envoy åœ¨ Service Meshï¼ˆä¸ä»…é™äº Istioï¼‰ä¸­æ˜¯å¦‚ä½•ä½œä¸ºè½¬å‘ä»£ç†å·¥ä½œçš„è¯·å‚è€ƒç½‘æ˜“äº‘åˆ˜è¶…çš„è¿™ç¯‡[æ·±å…¥è§£è¯» Service Mesh èƒŒåçš„æŠ€æœ¯ç»†èŠ‚ ](https:\/\/www.cnblogs.com\/163yun\/p\/8962278.html)ä»¥åŠ[ç†è§£ Istio Service Mesh ä¸­ Envoy ä»£ç† Sidecar æ³¨å…¥åŠæµé‡åŠ«æŒ](\/blog\/envoy-sidecar-injection-in-istio-service-mesh-deep-dive\/)ï¼Œæœ¬æ–‡å¼•ç”¨å…¶ä¸­çš„ä¸€äº›è§‚ç‚¹ï¼Œè¯¦ç»†å†…å®¹ä¸å†èµ˜è¿°ã€‚\n\n![Envoy proxy æ¶æ„å›¾](xds.svg)\n\n## åŸºæœ¬æœ¯è¯­\n\nä¸‹é¢æ˜¯æ‚¨åº”è¯¥äº†è§£çš„ Envoy é‡Œçš„åŸºæœ¬æœ¯è¯­ï¼š\n\n- **Downstreamï¼ˆä¸‹æ¸¸ï¼‰**ï¼šä¸‹æ¸¸ä¸»æœºè¿æ¥åˆ° Envoyï¼Œå‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”ï¼Œå³å‘é€è¯·æ±‚çš„ä¸»æœºã€‚\n- **Upstreamï¼ˆä¸Šæ¸¸ï¼‰**ï¼šä¸Šæ¸¸ä¸»æœºæ¥æ”¶æ¥è‡ª Envoy çš„è¿æ¥å’Œè¯·æ±‚ï¼Œå¹¶è¿”å›å“åº”ï¼Œå³æ¥å—è¯·æ±‚çš„ä¸»æœºã€‚\n- **Listenerï¼ˆç›‘å¬å™¨ï¼‰**ï¼šç›‘å¬å™¨æ˜¯å‘½åç½‘åœ°å€ï¼ˆä¾‹å¦‚ï¼Œç«¯å£ã€unix domain socket ç­‰)ï¼Œä¸‹æ¸¸å®¢æˆ·ç«¯å¯ä»¥è¿æ¥è¿™äº›ç›‘å¬å™¨ã€‚Envoy æš´éœ²ä¸€ä¸ªæˆ–è€…å¤šä¸ªç›‘å¬å™¨ç»™ä¸‹æ¸¸ä¸»æœºè¿æ¥ã€‚\n- **Clusterï¼ˆé›†ç¾¤ï¼‰**ï¼šé›†ç¾¤æ˜¯æŒ‡ Envoy è¿æ¥çš„ä¸€ç»„é€»è¾‘ç›¸åŒçš„ä¸Šæ¸¸ä¸»æœºã€‚Envoy é€šè¿‡æœåŠ¡å‘ç°æ¥å‘ç°é›†ç¾¤çš„æˆå‘˜ã€‚å¯ä»¥é€‰æ‹©é€šè¿‡ä¸»åŠ¨å¥åº·æ£€æŸ¥æ¥ç¡®å®šé›†ç¾¤æˆå‘˜çš„å¥åº·çŠ¶æ€ã€‚Envoy é€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥å†³å®šå°†è¯·æ±‚è·¯ç”±åˆ°é›†ç¾¤çš„å“ªä¸ªæˆå‘˜ã€‚\n\næˆ‘å°†åœ¨æœ¬æ–‡çš„ååŠéƒ¨åˆ†è§£é‡Šä»¥ä¸Šæœ¯è¯­ä¸ Kubernetesã€Istio ä¸­æ¦‚å¿µä¹‹é—´çš„è”ç³»ã€‚\n\n## å…³äº xDS çš„ç‰ˆæœ¬\n\næœ‰ä¸€ç‚¹éœ€è¦å¤§å®¶æ³¨æ„ï¼Œå°±æ˜¯ Envoy çš„ API æœ‰ v1 å’Œ v2 ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä» Envoy 1.5.0 èµ· v2 API å°±å·²ç»ç”Ÿäº§å°±ç»ªäº†ï¼Œä¸ºäº†èƒ½å¤Ÿè®©ç”¨æˆ·é¡ºåˆ©çš„å‘ v2 ç‰ˆæœ¬çš„é¢ API è¿‡åº¦ï¼ŒEnvoy å¯åŠ¨çš„æ—¶å€™è®¾ç½®äº†ä¸€ä¸ª \u0060--v2-config-only\u0060 çš„æ ‡å¿—ï¼ŒEnvoy ä¸åŒç‰ˆæœ¬å¯¹ v1\/v2 API çš„æ”¯æŒè¯¦æƒ…è¯·å‚è€ƒ [Envoy v1 é…ç½®åºŸå¼ƒæ—¶é—´è¡¨](https:\/\/groups.google.com\/forum\/#!topic\/envoy-announce\/Lb1QZcSclGQ)ã€‚\n\nEnvoy çš„ä½œè€… Matt Klein åœ¨ [Service Mesh ä¸­çš„é€šç”¨æ•°æ®å¹³é¢ API è®¾è®¡](https:\/\/cloudnative.to\/blog\/the-universal-data-plane-api\/)è¿™ç¯‡æ–‡ç« ä¸­è¯´æ˜äº† Envoy API v1 çš„å†å²åŠå…¶ç¼ºç‚¹ï¼Œè¿˜æœ‰ v2 çš„å¼•å…¥ã€‚v2 API æ˜¯ v1 çš„æ¼”è¿›ï¼Œè€Œä¸æ˜¯é©å‘½ï¼Œå®ƒæ˜¯ v1 åŠŸèƒ½çš„è¶…é›†ã€‚\n\nåœ¨ Istio 1.0 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ä½¿ç”¨çš„æ˜¯ **Envoy 1.8.0-dev** ç‰ˆæœ¬ï¼Œå…¶æ”¯æŒ v2 çš„ APIï¼ŒåŒæ—¶åœ¨ Envoy ä½œä¸º Sidecar proxy å¯åŠ¨çš„ä½¿ç”¨ä½¿ç”¨äº†ä¾‹å¦‚ä¸‹é¢çš„å‘½ä»¤ï¼š\n\n\u0060\u0060\u0060bash\n$ \/usr\/local\/bin\/envoy -c \/etc\/istio\/proxy\/envoy-rev0.json --restart-epoch 0 --drain-time-s 45 --parent-shutdown-time-s 60 --service-cluster ratings --service-node sidecar~172.33.14.2~ratings-v1-8558d4458d-ld8x9.default~default.svc.cluster.local --max-obj-name-len 189 --allow-unknown-fields -l warn --v2-config-only\n\u0060\u0060\u0060\n\nä¸Šé¢æ˜¯éƒ½ Bookinfo ç¤ºä¾‹ä¸­çš„ rating pod ä¸­çš„ sidecar å¯åŠ¨çš„åˆ†æï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­æŒ‡å®šäº† \u0060--v2-config-only\u0060ï¼Œè¡¨æ˜ Istio 1.0\u002b åªæ”¯æŒ xDS v2 çš„ APIã€‚\n\n## Istio sidecar proxy é…ç½®\n\nå‡å¦‚æ‚¨ä½¿ç”¨ [kubernetes-vagrant-centos-cluster](https:\/\/github.com\/rootsongjc\/kubernetes-vagrant-centos-cluster) éƒ¨ç½²äº† Kubernetes é›†ç¾¤å¹¶å¼€å¯äº† [Istio Service Mesh](https:\/\/istio.io\/zh)ï¼Œå†éƒ¨ç½² [bookinfo ç¤ºä¾‹](https:\/\/istio.io\/latest\/zh\/docs\/examples\/bookinfo\/)ï¼Œé‚£ä¹ˆåœ¨ \u0060default\u0060 å‘½åç©ºé—´ä¸‹æœ‰ä¸€ä¸ªåå­—ç±»ä¼¼äº \u0060ratings-v1-7c9949d479-dwkr4\u0060 çš„ Podï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹è¯¥ Pod çš„ Envoy sidecar çš„å…¨é‡é…ç½®ï¼š\n\n\u0060\u0060\u0060bash\nkubectl -n default exec ratings-v1-7c9949d479-dwkr4 -c istio-proxy curl http:\/\/localhost:15000\/config_dump \u003e dump-rating.json\n\u0060\u0060\u0060\n\nå°† Envoy çš„è¿è¡Œæ—¶é…ç½® dump å‡ºæ¥ä¹‹åä½ å°†çœ‹åˆ°ä¸€ä¸ªé•¿ 6000 ä½™è¡Œçš„é…ç½®æ–‡ä»¶ã€‚\n\nIstio ä¼šåœ¨ä¸º Service Mesh ä¸­çš„æ¯ä¸ª Pod æ³¨å…¥ Sidecar çš„æ—¶å€™åŒæ—¶ä¸º Envoy æ³¨å…¥ Bootstrap é…ç½®ï¼Œå…¶ä½™çš„é…ç½®æ˜¯é€šè¿‡ Pilot ä¸‹å‘çš„ï¼Œæ³¨æ„æ•´ä¸ªæ•°æ®å¹³é¢å³ Service Mesh ä¸­çš„ Envoy çš„åŠ¨æ€é…ç½®åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤æ£€æŸ¥å…¶ä»– sidecar çš„ Envoy é…ç½®æ˜¯å¦è·Ÿæœ€ä¸Šé¢çš„é‚£ä¸ªç›¸åŒã€‚\n\nä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ£€æŸ¥ Service Mesh ä¸­çš„æ‰€æœ‰æœ‰ Sidecar æ³¨å…¥çš„ Pod ä¸­çš„ proxy é…ç½®æ˜¯å¦åŒæ­¥ã€‚\n\n\u0060\u0060\u0060bash\n$ istioctl proxy-status\nPROXY                                                 CDS        LDS        EDS               RDS          PILOT                            VERSION\ndetails-v1-876bf485f-sx7df.default                    SYNCED     SYNCED     SYNCED (100%)     SYNCED       istio-pilot-5bf6d97f79-6lz4x     1.0.0\n...\n\u0060\u0060\u0060\n\n[istioctl](https:\/\/istio.io\/zh\/docs\/reference\/commands\/istioctl\/) è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·å°±åƒ [kubectl](https:\/\/jimmysong.io\/kubernetes-handbook\/guide\/kubectl-cheatsheet.html) ä¸€æ ·æœ‰å¾ˆå¤šç¥å™¨çš„é­”æ³•ï¼Œé€šè¿‡å®ƒå¯ä»¥é«˜æ•ˆçš„ç®¡ç† Istio å’Œ debugã€‚\n\n## Envoy proxy é…ç½®è§£æ\n\nIstio envoy sidecar proxy é…ç½®ä¸­åŒ…å«ä»¥ä¸‹å››ä¸ªéƒ¨åˆ†ã€‚\n\n- **bootstrap**ï¼šEnvoy proxy å¯åŠ¨æ—¶å€™åŠ è½½çš„é™æ€é…ç½®ã€‚\n- **listeners**ï¼šç›‘å¬å™¨é…ç½®ï¼Œä½¿ç”¨ LDS ä¸‹å‘ã€‚\n- **clusters**ï¼šé›†ç¾¤é…ç½®ï¼Œé™æ€é…ç½®ä¸­åŒ…æ‹¬ xds-grpc å’Œ zipkin åœ°å€ï¼ŒåŠ¨æ€é…ç½®ä½¿ç”¨  CDS ä¸‹å‘ã€‚\n- **routes**ï¼šè·¯ç”±é…ç½®ï¼Œé™æ€é…ç½®ä¸­åŒ…æ‹¬äº†æœ¬åœ°ç›‘å¬çš„æœåŠ¡çš„é›†ç¾¤ä¿¡æ¯ï¼Œå…¶ä¸­å¼•ç”¨äº† clusterï¼ŒåŠ¨æ€é…ç½®ä½¿ç”¨ RDS ä¸‹å‘ã€‚\n\næ¯ä¸ªéƒ¨åˆ†ä¸­éƒ½åŒ…å«é™æ€é…ç½®ä¸åŠ¨æ€é…ç½®ï¼Œå…¶ä¸­ bootstrap é…ç½®åˆæ˜¯åœ¨é›†ç¾¤å¯åŠ¨çš„æ—¶å€™é€šè¿‡ sidecar å¯åŠ¨å‚æ•°æ³¨å…¥çš„ï¼Œé…ç½®æ–‡ä»¶åœ¨ \u0060\/etc\/istio\/proxy\/envoy-rev0.json\u0060ã€‚\n\nç”±äº bootstrap ä¸­çš„é…ç½®æ˜¯æ¥è‡ª Envoy å¯åŠ¨æ—¶åŠ è½½çš„é™æ€æ–‡ä»¶ï¼Œä¸»è¦é…ç½®äº†èŠ‚ç‚¹ä¿¡æ¯ã€tracingã€admin å’Œç»Ÿè®¡ä¿¡æ¯æ”¶é›†ç­‰ä¿¡æ¯ï¼Œè¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚\n\nBootstrap æ˜¯ Envoy ä¸­é…ç½®çš„æ ¹æœ¬æ¥æºï¼ŒBootstrap æ¶ˆæ¯ä¸­æœ‰ä¸€ä¸ªå…³é”®çš„æ¦‚å¿µï¼Œå°±æ˜¯é™æ€å’ŒåŠ¨æ€èµ„æºçš„ä¹‹é—´çš„åŒºåˆ«ã€‚ä¾‹å¦‚ Listener æˆ– Cluster è¿™äº›èµ„æºæ—¢å¯ä»¥ä» static_resources é™æ€çš„è·å¾—ä¹Ÿå¯ä»¥ä» dynamic_resources ä¸­é…ç½®çš„ LDS æˆ– CDS ä¹‹ç±»çš„ xDS æœåŠ¡è·å–ã€‚\n\n### Listener\n\nListener é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç›‘å¬å™¨ï¼Œç›‘å¬ IP åœ°å€å’Œç«¯å£ï¼Œç„¶åæ ¹æ®ç­–ç•¥è½¬å‘ã€‚\n\n**Listener çš„ç‰¹ç‚¹**\n\n- æ¯ä¸ª Envoy è¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ª Listenerï¼ŒEnvoy ä¸ Listener ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚\n- æ¯ä¸ª Listener ä¸­å¯ä»¥é…ç½®ä¸€æ¡ filter é“¾è¡¨ï¼ˆfilter_chainsï¼‰ï¼ŒEnvoy ä¼šæ ¹æ® filter é¡ºåºæ‰§è¡Œè¿‡æ»¤ã€‚\n- Listener å¯ä»¥ç›‘å¬ä¸‹æ¸¸çš„ç«¯å£ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶æ¥è‡ªå…¶ä»– listener çš„æ•°æ®ï¼Œå½¢æˆé“¾å¼å¤„ç†ã€‚\n- filter æ˜¯å¯æ‰©å±•çš„ã€‚\n- å¯ä»¥é™æ€é…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ LDS åŠ¨æ€é…ç½®ã€‚\n- ç›®å‰åªèƒ½ç›‘å¬ TCPï¼ŒUDP è¿˜æœªæ”¯æŒã€‚\n\n**Listener çš„æ•°æ®ç»“æ„**\n\nListener çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼Œé™¤äº† \u0060name\u0060ã€\u0060address\u0060 å’Œ \u0060filter_chains\u0060 ä¸ºå¿…é¡»é…ç½®ä¹‹å¤–ï¼Œå…¶ä»–éƒ½ä¸ºå¯é€‰çš„ã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022name\u0022: \u0022...\u0022,\n  \u0022address\u0022: \u0022{...}\u0022,\n  \u0022filter_chains\u0022: [],\n  \u0022use_original_dst\u0022: \u0022{...}\u0022,\n  \u0022per_connection_buffer_limit_bytes\u0022: \u0022{...}\u0022,\n  \u0022metadata\u0022: \u0022{...}\u0022,\n  \u0022drain_type\u0022: \u0022...\u0022,\n  \u0022listener_filters\u0022: [],\n  \u0022transparent\u0022: \u0022{...}\u0022,\n  \u0022freebind\u0022: \u0022{...}\u0022,\n  \u0022socket_options\u0022: [],\n  \u0022tcp_fast_open_queue_length\u0022: \u0022{...}\u0022,\n  \u0022bugfix_reverse_write_filter_order\u0022: \u0022{...}\u0022\n}\n\u0060\u0060\u0060\n\nä¸‹é¢æ˜¯å…³äºä¸Šè¿°æ•°æ®ç»“æ„ä¸­çš„å¸¸ç”¨é…ç½®è§£æã€‚\n\n- **name**ï¼šè¯¥ listener çš„ UUIDï¼Œå”¯ä¸€é™å®šåï¼Œé»˜è®¤ 60 ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ \u006010.254.74.159_15011\u0060ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤å‚æ•°æŒ‡å®šé•¿åº¦é™åˆ¶ã€‚\n\n- **address**ï¼šç›‘å¬çš„é€»è¾‘\/ç‰©ç†åœ°å€å’Œç«¯å£å·ï¼Œä¾‹å¦‚\n\n  \u0060\u0060\u0060json\n  \u0022address\u0022: {\n         \u0022socket_address\u0022: {\n          \u0022address\u0022: \u002210.254.74.159\u0022,\n          \u0022port_value\u0022: 15011\n         }\n  }\n  \u0060\u0060\u0060\n\n- **filter_chains**ï¼šè¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒEnvoy ä¸­å†…ç½®äº†ä¸€äº›é€šç”¨çš„ filterï¼Œæ¯ç§ filter éƒ½æœ‰ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼ŒEnvoy ä¼šæ ¹æ®è¯¥é…ç½®é¡ºåºæ‰§è¡Œ filterã€‚Envoy ä¸­å†…ç½®çš„ filter æœ‰ï¼š[envoy.client_ssl_auth](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/client_ssl_auth_filter#config-network-filters-client-ssl-auth)ã€[envoy.echo](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/echo_filter#config-network-filters-echo)ã€[Envoy.http_connection_manager](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/http_conn_man\/http_conn_man#config-http-conn-man)ã€[envoy.mongo_proxy](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/mongo_proxy_filter#config-network-filters-mongo-proxy)ã€[envoy.rate_limit](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/rate_limit_filter#config-network-filters-rate-limit)ã€[Envoy.redis_proxy](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/redis_proxy_filter#config-network-filters-redis-proxy)ã€[envoy.tcp_proxy](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/network_filters\/tcp_proxy_filter#config-network-filters-tcp-proxy)ã€[http_filters](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/intro\/arch_overview\/http_filters)ã€[thrift_filters](https:\/\/www.envoyproxy.io\/docs\/envoy\/v1.8.0\/configuration\/thrift_filters\/thrift_filters)ç­‰ã€‚è¿™äº› filter å¯ä»¥å•ç‹¬ä½¿ç”¨ä¹Ÿå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ‰©å±•ï¼Œä¾‹å¦‚ä½¿ç”¨ Istio ä¸­çš„ EnvoyFilter é…ç½®ã€‚\n\n- **use_original_dst**ï¼šè¿™æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœä½¿ç”¨ iptables é‡å®šå‘è¿æ¥ï¼Œåˆ™ä»£ç†æ¥æ”¶çš„ç«¯å£å¯èƒ½ä¸åŸå§‹ç›®çš„åœ°å€çš„ç«¯å£ä¸ä¸€æ ·ã€‚å½“æ­¤æ ‡å¿—è®¾ç½®ä¸º true æ—¶ï¼ŒListener å°†é‡å®šå‘çš„è¿æ¥åˆ‡æ¢åˆ°ä¸åŸå§‹ç›®çš„åœ°å€å…³è”çš„ Listenerã€‚å¦‚æœæ²¡æœ‰ä¸åŸå§‹ç›®çš„åœ°å€å…³è”çš„ Listenerï¼Œåˆ™è¿æ¥ç”±æ¥æ”¶å®ƒçš„ Listener å¤„ç†ã€‚é»˜è®¤ä¸º falseã€‚æ³¨æ„ï¼šè¯¥å‚æ•°å°†è¢«åºŸå¼ƒï¼Œè¯·ä½¿ç”¨åŸå§‹ç›®çš„åœ°å€çš„ Listener filter æ›¿ä»£ã€‚è¯¥å‚æ•°çš„ä¸»è¦ç”¨é€”æ˜¯ï¼šEnvoy é€šè¿‡ç›‘å¬ 15001 ç«¯å£å°†åº”ç”¨çš„æµé‡æˆªå–åå†ç”±å…¶ä»– Listener å¤„ç†è€Œä¸æ˜¯ç›´æ¥è½¬å‘å‡ºå»ï¼Œè¯¦æƒ…è§ [Virtual Listener](https:\/\/zhaohuabing.com\/post\/2018-09-25-istio-traffic-management-impl-intro\/#virtual-listener)ã€‚\n\nå…³äº Listener çš„è¯¦ç»†ä»‹ç»è¯·å‚è€ƒ Envoy v2 API reference - listenerã€‚\n\n### Route\n\næˆ‘ä»¬åœ¨è¿™é‡Œæ‰€è¯´çš„è·¯ç”±æŒ‡çš„æ˜¯ HTTP è·¯ç”±ï¼Œè¿™ä¹Ÿä½¿å¾— Envoy å¯ä»¥ç”¨æ¥å¤„ç†ç½‘æ ¼è¾¹ç¼˜çš„æµé‡ã€‚HTTP è·¯ç”±è½¬å‘æ˜¯é€šè¿‡è·¯ç”±è¿‡æ»¤å™¨å®ç°çš„ã€‚è¯¥è¿‡æ»¤å™¨çš„ä¸»è¦èŒèƒ½å°±æ˜¯æ‰§è¡Œè·¯ç”±è¡¨ä¸­çš„æŒ‡ä»¤ã€‚é™¤äº†å¯ä»¥åšé‡å®šå‘å’Œè½¬å‘ï¼Œè·¯ç”±è¿‡æ»¤å™¨è¿˜éœ€è¦å¤„ç†é‡è¯•ã€ç»Ÿè®¡ä¹‹ç±»çš„ä»»åŠ¡ã€‚\n\n**HTTP è·¯ç”±çš„ç‰¹ç‚¹**\n\n- å‰ç¼€å’Œç²¾ç¡®è·¯å¾„åŒ¹é…è§„åˆ™ã€‚\n- å¯è·¨è¶Šå¤šä¸ªä¸Šæ¸¸é›†ç¾¤è¿›è¡ŒåŸºäºæƒé‡\/ç™¾åˆ†æ¯”çš„è·¯ç”±ã€‚\n- åŸºäºä¼˜å…ˆçº§çš„è·¯ç”±ã€‚\n- åŸºäºå“ˆå¸Œç­–ç•¥çš„è·¯ç”±ã€‚\n\n**Route çš„æ•°æ®ç»“æ„**\n\n\u0060\u0060\u0060json\n{\n  \u0022name\u0022: \u0022...\u0022,\n  \u0022virtual_hosts\u0022: [],\n  \u0022internal_only_headers\u0022: [],\n  \u0022response_headers_to_add\u0022: [],\n  \u0022response_headers_to_remove\u0022: [],\n  \u0022request_headers_to_add\u0022: [],\n  \u0022request_headers_to_remove\u0022: [],\n  \u0022validate_clusters\u0022: \u0022{...}\u0022\n}\n\u0060\u0060\u0060\n\nä¸‹é¢æ˜¯å…³äºä¸Šè¿°æ•°æ®ç»“æ„ä¸­çš„å¸¸ç”¨é…ç½®è§£æã€‚\n\n- **name**ï¼šè¯¥åå­—è·Ÿ \u0060envoy.http_connection_manager\u0060 filter ä¸­çš„ \u0060http_filters.rds.route_config_name\u0060 ä¸€è‡´ï¼Œåœ¨ Istio Service Mesh ä¸­ä¸º Envoy ä¸‹å‘çš„é…ç½®ä¸­çš„ Route æ˜¯ä»¥ç›‘å¬çš„ç«¯å£å·ä½œä¸ºåå­—ï¼Œè€ŒåŒä¸€ä¸ªåå­—ä¸‹é¢çš„ \u0060virtual_hosts\u0060 å¯ä»¥æœ‰å¤šä¸ªå€¼ï¼ˆæ•°ç»„å½¢å¼ï¼‰ã€‚\n- **virtual_hosts**ï¼šå› ä¸º **VirtualHosts** æ˜¯ Envoy ä¸­å¼•å…¥çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæˆ‘ä»¬åœ¨ä¸‹æ–‡å°†è¯¦ç»†è¯´æ˜ \u0060virtual_hosts\u0060 çš„æ•°æ®ç»“æ„ã€‚\n- **validate_clusters**ï¼šè¿™æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨æ¥è®¾ç½®å¼€å¯ä½¿ç”¨ cluster manager æ¥æ£€æµ‹è·¯ç”±è¡¨å¼•ç”¨çš„ cluster æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœæ˜¯è·¯ç”±è¡¨æ˜¯é€šè¿‡ route_config é™æ€é…ç½®çš„åˆ™è¯¥å€¼é»˜è®¤è®¾ç½®ä¸º trueï¼Œå¦‚æœæ˜¯ä½¿ç”¨ rds åŠ¨æ€é…ç½®çš„è¯ï¼Œåˆ™è¯¥å€¼é»˜è®¤è®¾ç½®ä¸º falseã€‚\n\n#### route.VirtualHost\n\nVirtualHost å³ä¸Šæ–‡ä¸­ Route é…ç½®ä¸­çš„ \u0060virtual_hosts\u0060ï¼ŒVirtualHost æ˜¯è·¯ç”±é…ç½®ä¸­çš„é¡¶çº§å…ƒç´ ã€‚æ¯ä¸ªè™šæ‹Ÿä¸»æœºéƒ½æœ‰ä¸€ä¸ªé€»è¾‘åç§°ä»¥åŠä¸€ç»„æ ¹æ®ä¼ å…¥è¯·æ±‚çš„ host header è·¯ç”±åˆ°å®ƒçš„åŸŸã€‚è¿™å…è®¸å•ä¸ª Listener ä¸ºå¤šä¸ªé¡¶çº§åŸŸè·¯å¾„æ ‘æä¾›æœåŠ¡ã€‚åŸºäºåŸŸé€‰æ‹©äº†è™šæ‹Ÿä¸»æœºå Envoy  å°±ä¼šå¤„ç†è·¯ç”±ä»¥æŸ¥çœ‹è¦è·¯ç”±åˆ°å“ªä¸ªä¸Šæ¸¸é›†ç¾¤æˆ–æ˜¯å¦æ‰§è¡Œé‡å®šå‘ã€‚\n\n**VirtualHost çš„æ•°æ®ç»“æ„**\n\nä¸‹é¢æ˜¯ VirtualHost çš„æ•°æ®ç»“æ„ï¼Œé™¤äº† \u0060name\u0060 å’Œ \u0060domains\u0060 æ˜¯å¿…é¡»é…ç½®é¡¹å¤–ï¼Œå…¶ä»–çš†ä¸ºå¯é€‰é¡¹ã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022name\u0022: \u0022...\u0022,\n  \u0022domains\u0022: [],\n  \u0022routes\u0022: [],\n  \u0022require_tls\u0022: \u0022...\u0022,\n  \u0022virtual_clusters\u0022: [],\n  \u0022rate_limits\u0022: [],\n  \u0022request_headers_to_add\u0022: [],\n  \u0022request_headers_to_remove\u0022: [],\n  \u0022response_headers_to_add\u0022: [],\n  \u0022response_headers_to_remove\u0022: [],\n  \u0022cors\u0022: \u0022{...}\u0022,\n  \u0022per_filter_config\u0022: \u0022{...}\u0022,\n  \u0022include_request_attempt_count\u0022: \u0022...\u0022\n}\n\u0060\u0060\u0060\n\nä¸‹é¢æ˜¯å…³äºä¸Šè¿°æ•°æ®ç»“æ„ä¸­çš„å¸¸ç”¨é…ç½®è§£æã€‚\n\n- **name**ï¼šè¯¥ VirtualHost çš„åå­—ï¼Œä¸€èˆ¬æ˜¯ FQDN åŠ ç«¯å£ï¼Œå¦‚ \u0060details.default.svc.cluster.local:9080\u0060ã€‚\n- **domains**ï¼šè¿™æ˜¯ä¸ªç”¨æ¥åŒ¹é… VirtualHost çš„åŸŸåï¼ˆhost\/authority headerï¼‰åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä½†æ˜¯é€šé…ç¬¦ä¸èƒ½åŒ¹é…ç©ºå­—ç¬¦ï¼Œé™¤äº†ä»…ä½¿ç”¨ \u0060*\u0060 ä½œä¸º domainsï¼Œæ³¨æ„åˆ—è¡¨ä¸­çš„å€¼ä¸èƒ½é‡å¤å’Œå­˜åœ¨äº¤é›†ï¼Œåªè¦æœ‰ä¸€æ¡ domain è¢«åŒ¹é…ä¸Šäº†ï¼Œå°±ä¼šæ‰§è¡Œè·¯ç”±ã€‚Istio ä¼šä¸ºè¯¥å€¼é…ç½®æ‰€æœ‰åœ°å€è§£æå½¢å¼ï¼ŒåŒ…æ‹¬ IP åœ°å€ã€FQDN å’ŒçŸ­åŸŸåç­‰ã€‚\n- **routes**ï¼šé’ˆå¯¹å…¥å£æµé‡çš„æœ‰åºè·¯ç”±åˆ—è¡¨ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„è·¯ç”±å°†è¢«æ‰§è¡Œã€‚æˆ‘ä»¬åœ¨ä¸‹æ–‡å°†è¯¦ç»†è¯´æ˜ route çš„æ•°æ®ç»“æ„ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ VirtualHost çš„ä¾‹å­ï¼Œè¯¥é…ç½®æ¥è‡ª [Bookinfo åº”ç”¨](https:\/\/istio.io\/latest\/zh\/docs\/examples\/bookinfo\/)çš„ details åº”ç”¨çš„ Sidecar æœåŠ¡ã€‚\n\n\u0060\u0060\u0060json\n{\n            \u0022name\u0022: \u0022details.default.svc.cluster.local:9080\u0022,\n            \u0022domains\u0022: [\n                \u0022details.default.svc.cluster.local\u0022,\n                \u0022details.default.svc.cluster.local:9080\u0022,\n                \u0022details\u0022,\n                \u0022details:9080\u0022,\n                \u0022details.default.svc.cluster\u0022,\n                \u0022details.default.svc.cluster:9080\u0022,\n                \u0022details.default.svc\u0022,\n                \u0022details.default.svc:9080\u0022,\n                \u0022details.default\u0022,\n                \u0022details.default:9080\u0022,\n                \u002210.254.4.113\u0022,\n                \u002210.254.4.113:9080\u0022\n            ],\n            \u0022routes\u0022: [\n                {\n                    \u0022match\u0022: {\n                        \u0022prefix\u0022: \u0022\/\u0022\n                    },\n                    \u0022route\u0022: {\n                        \u0022cluster\u0022: \u0022outbound|9080||details.default.svc.cluster.local\u0022,\n                        \u0022timeout\u0022: \u00220s\u0022,\n                        \u0022max_grpc_timeout\u0022: \u00220s\u0022\n                    },\n                    \u0022decorator\u0022: {\n                        \u0022operation\u0022: \u0022details.default.svc.cluster.local:9080\/*\u0022\n                    },\n                    \u0022per_filter_config\u0022: {\n                        \u0022mixer\u0022: {\n                            \u0022forward_attributes\u0022: {\n                                \u0022attributes\u0022: {\n                                    \u0022destination.service.uid\u0022: {\n                                        \u0022string_value\u0022: \u0022istio:\/\/default\/services\/details\u0022\n                                    },\n                                    \u0022destination.service.host\u0022: {\n                                        \u0022string_value\u0022: \u0022details.default.svc.cluster.local\u0022\n                                    },\n                                    \u0022destination.service.namespace\u0022: {\n                                        \u0022string_value\u0022: \u0022default\u0022\n                                    },\n                                    \u0022destination.service.name\u0022: {\n                                        \u0022string_value\u0022: \u0022details\u0022\n                                    },\n                                    \u0022destination.service\u0022: {\n                                        \u0022string_value\u0022: \u0022details.default.svc.cluster.local\u0022\n                                    }\n                                }\n                            },\n                            \u0022mixer_attributes\u0022: {\n                                \u0022attributes\u0022: {\n                                    \u0022destination.service.host\u0022: {\n                                        \u0022string_value\u0022: \u0022details.default.svc.cluster.local\u0022\n                                    },\n                                    \u0022destination.service.uid\u0022: {\n                                        \u0022string_value\u0022: \u0022istio:\/\/default\/services\/details\u0022\n                                    },\n                                    \u0022destination.service.name\u0022: {\n                                        \u0022string_value\u0022: \u0022details\u0022\n                                    },\n                                    \u0022destination.service.namespace\u0022: {\n                                        \u0022string_value\u0022: \u0022default\u0022\n                                    },\n                                    \u0022destination.service\u0022: {\n                                        \u0022string_value\u0022: \u0022details.default.svc.cluster.local\u0022\n                                    }\n                                }\n                            },\n                            \u0022disable_check_calls\u0022: true\n                        }\n                    }\n                }\n            ]\n        }\n\u0060\u0060\u0060\n\n#### route.Route\n\nè·¯ç”±æ—¢æ˜¯å¦‚ä½•åŒ¹é…è¯·æ±‚çš„è§„èŒƒï¼Œä¹Ÿæ˜¯å¯¹ä¸‹ä¸€æ­¥åšä»€ä¹ˆçš„æŒ‡ç¤ºï¼ˆä¾‹å¦‚ï¼Œredirectã€forwardã€rewrite ç­‰ï¼‰ã€‚\n\n**route.Route çš„æ•°æ®ç»“æ„**\n\nä¸‹é¢æ˜¯æ˜¯ route.Route çš„æ•°æ®ç»“æ„ï¼Œé™¤äº† \u0060match\u0060 ä¹‹å¤–å…¶ä½™éƒ½æ˜¯å¯é€‰çš„ã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022match\u0022: \u0022{...}\u0022,\n  \u0022route\u0022: \u0022{...}\u0022,\n  \u0022redirect\u0022: \u0022{...}\u0022,\n  \u0022direct_response\u0022: \u0022{...}\u0022,\n  \u0022metadata\u0022: \u0022{...}\u0022,\n  \u0022decorator\u0022: \u0022{...}\u0022,\n  \u0022per_filter_config\u0022: \u0022{...}\u0022,\n  \u0022request_headers_to_add\u0022: [],\n  \u0022request_headers_to_remove\u0022: [],\n  \u0022response_headers_to_add\u0022: [],\n  \u0022response_headers_to_remove\u0022: []\n}\n\u0060\u0060\u0060\n\nä¸‹é¢æ˜¯å…³äºä¸Šè¿°æ•°æ®ç»“æ„ä¸­çš„å¸¸ç”¨é…ç½®è§£æã€‚\n\n- **match**ï¼šè·¯ç”±åŒ¹é…å‚æ•°ã€‚ä¾‹å¦‚ URL prefixï¼ˆå‰ç¼€ï¼‰ã€pathï¼ˆURL çš„å®Œæ•´è·¯å¾„ï¼‰ã€regexï¼ˆè§„åˆ™è¡¨è¾¾å¼ï¼‰ç­‰ã€‚\n- **route**ï¼šè¿™é‡Œé¢é…ç½®è·¯ç”±çš„è¡Œä¸ºï¼Œå¯ä»¥æ˜¯ routeã€redirect å’Œ direct_responseï¼Œä¸è¿‡è¿™é‡Œé¢æ²¡æœ‰ä¸“é—¨çš„ä¸€ä¸ªé…ç½®é¡¹ç”¨æ¥é…ç½®ä»¥ä¸Šä¸‰ç§è¡Œä¸ºï¼Œè€Œæ˜¯æ ¹æ®å®é™…å¡«å……çš„é…ç½®é¡¹æ¥ç¡®å®šçš„ã€‚ä¾‹å¦‚åœ¨æ­¤å¤„æ·»åŠ  \u0060cluster\u0060 é…ç½®åˆ™æš—ç¤ºè·¯ç”±åŠ¨ä½œä¸ºâ€routeâ€œï¼Œè¡¨ç¤ºå°†æµé‡è·¯ç”±åˆ°è¯¥ clusterã€‚è¯¦æƒ…è¯·å‚è€ƒ route.RouteActionã€‚\n- **decorator**ï¼šè¢«åŒ¹é…çš„è·¯ç”±çš„ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºè¢«åŒ¹é…çš„è™šæ‹Ÿä¸»æœºå’Œ URLã€‚è¯¥é…ç½®é‡Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªå¿…é¡»é…ç½®çš„é¡¹ \u0060operation\u0060ï¼Œä¾‹å¦‚ \u0060details.default.svc.cluster.local:9080\/*\u0060ã€‚\n- **per_filter_config**ï¼šè¿™æ˜¯ä¸€ä¸ª map ç±»å‹ï¼Œ\u0060per_filter_config\u0060 å­—æ®µå¯ç”¨äºä¸º filter æä¾›ç‰¹å®šè·¯ç”±çš„é…ç½®ã€‚Map çš„ key åº”ä¸ filleter åç§°åŒ¹é…ï¼Œä¾‹å¦‚ç”¨äº HTTP buffer filter çš„ \u0060envoy.buffer\u0060ã€‚è¯¥å­—æ®µæ˜¯ç‰¹å®šäº filter çš„ï¼Œè¯¦æƒ…è¯·å‚è€ƒ HTTP filterã€‚\n\n### Cluster\n\nCluster æ˜¯æŒ‡ Envoy è¿æ¥çš„ä¸€ç»„é€»è¾‘ç›¸åŒçš„ä¸Šæ¸¸ä¸»æœºã€‚Envoy é€šè¿‡æœåŠ¡å‘ç°æ¥å‘ç° cluster çš„æˆå‘˜ã€‚å¯ä»¥é€‰æ‹©é€šè¿‡ä¸»åŠ¨å¥åº·æ£€æŸ¥æ¥ç¡®å®šé›†ç¾¤æˆå‘˜çš„å¥åº·çŠ¶æ€ã€‚Envoy é€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥å†³å®šå°†è¯·æ±‚è·¯ç”±åˆ° cluster çš„å“ªä¸ªæˆå‘˜ã€‚\n\n**Cluster çš„ç‰¹ç‚¹**\n\n- ä¸€ç»„é€»è¾‘ä¸Šç›¸åŒçš„ä¸»æœºæ„æˆä¸€ä¸ª clusterã€‚\n- å¯ä»¥åœ¨ cluster ä¸­å®šä¹‰å„ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚\n- æ–°åŠ å…¥çš„ cluster éœ€è¦ä¸€ä¸ªçƒ­èº«çš„è¿‡ç¨‹æ‰å¯ä»¥ç»™è·¯ç”±å¼•ç”¨ï¼Œè¯¥è¿‡ç¨‹æ˜¯åŸå­çš„ï¼Œå³åœ¨ cluster çƒ­èº«ä¹‹å‰å¯¹äº Envoy åŠ Service Mesh çš„å…¶ä½™éƒ¨åˆ†æ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚\n- å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥é…ç½® clusterï¼Œä¾‹å¦‚é™æ€ç±»å‹ã€ä¸¥æ ¼é™å®š DNSã€é€»è¾‘ DNSã€EDS ç­‰ã€‚\n\n**Cluster çš„æ•°æ®ç»“æ„**\n\nCluster çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼Œé™¤äº† \u0060name\u0060 å­—æ®µï¼Œå…¶ä»–éƒ½æ˜¯å¯é€‰çš„ã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022name\u0022: \u0022...\u0022,\n  \u0022alt_stat_name\u0022: \u0022...\u0022,\n  \u0022type\u0022: \u0022...\u0022,\n  \u0022eds_cluster_config\u0022: \u0022{...}\u0022,\n  \u0022connect_timeout\u0022: \u0022{...}\u0022,\n  \u0022per_connection_buffer_limit_bytes\u0022: \u0022{...}\u0022,\n  \u0022lb_policy\u0022: \u0022...\u0022,\n  \u0022hosts\u0022: [],\n  \u0022load_assignment\u0022: \u0022{...}\u0022,\n  \u0022health_checks\u0022: [],\n  \u0022max_requests_per_connection\u0022: \u0022{...}\u0022,\n  \u0022circuit_breakers\u0022: \u0022{...}\u0022,\n  \u0022tls_context\u0022: \u0022{...}\u0022,\n  \u0022common_http_protocol_options\u0022: \u0022{...}\u0022,\n  \u0022http_protocol_options\u0022: \u0022{...}\u0022,\n  \u0022http2_protocol_options\u0022: \u0022{...}\u0022,\n  \u0022extension_protocol_options\u0022: \u0022{...}\u0022,\n  \u0022dns_refresh_rate\u0022: \u0022{...}\u0022,\n  \u0022dns_lookup_family\u0022: \u0022...\u0022,\n  \u0022dns_resolvers\u0022: [],\n  \u0022outlier_detection\u0022: \u0022{...}\u0022,\n  \u0022cleanup_interval\u0022: \u0022{...}\u0022,\n  \u0022upstream_bind_config\u0022: \u0022{...}\u0022,\n  \u0022lb_subset_config\u0022: \u0022{...}\u0022,\n  \u0022ring_hash_lb_config\u0022: \u0022{...}\u0022,\n  \u0022original_dst_lb_config\u0022: \u0022{...}\u0022,\n  \u0022least_request_lb_config\u0022: \u0022{...}\u0022,\n  \u0022common_lb_config\u0022: \u0022{...}\u0022,\n  \u0022transport_socket\u0022: \u0022{...}\u0022,\n  \u0022metadata\u0022: \u0022{...}\u0022,\n  \u0022protocol_selection\u0022: \u0022...\u0022,\n  \u0022upstream_connection_options\u0022: \u0022{...}\u0022,\n  \u0022close_connections_on_host_health_failure\u0022: \u0022...\u0022,\n  \u0022drain_connections_on_host_removal\u0022: \u0022...\u0022\n}\n\u0060\u0060\u0060\n\nä¸‹é¢æ˜¯å…³äºä¸Šè¿°æ•°æ®ç»“æ„ä¸­çš„å¸¸ç”¨é…ç½®è§£æã€‚\n\n- **name**ï¼šå¦‚æœä½ ç•™æ„åˆ°ä½œä¸º Sidecar å¯åŠ¨çš„ Envoy çš„å‚æ•°çš„ä¼šæ³¨æ„åˆ° \u0060--max-obj-name-len 189\u0060ï¼Œè¯¥é€‰é¡¹ç”¨æ¥ç”¨æ¥æŒ‡å®š cluster çš„åå­—ï¼Œä¾‹å¦‚ \u0060inbound|9080||ratings.default.svc.cluster.local\u0060ã€‚è¯¥åå­—å­—ç¬¦ä¸²ç”± \u0060|\u0060 åˆ†éš”æˆå››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ \u0060inbound\u0060 æˆ– \u0060outbound\u0060 ä»£è¡¨å…¥å‘æµé‡æˆ–å‡ºå‘æµé‡ã€ç«¯å£å·ã€subcluster åç§°ã€FQDNï¼Œå…¶ä¸­ subcluster åç§°å°†å¯¹åº”äº Istio \u0060DestinationRule\u0060 ä¸­é…ç½®çš„ \u0060subnet\u0060ï¼Œå¦‚æœæ˜¯æŒ‰ç…§å¤šç‰ˆæœ¬æŒ‰æ¯”ä¾‹è·¯ç”±çš„è¯ï¼Œè¯¥å€¼å¯ä»¥æ˜¯ç‰ˆæœ¬å·ã€‚\n- **type**ï¼šå³æœåŠ¡å‘ç°ç±»å‹ï¼Œæ”¯æŒçš„å‚æ•°æœ‰ \u0060STATIC\u0060ï¼ˆç¼ºçœå€¼ï¼‰ã€\u0060STRICT_DNS\u0060ã€\u0060LOGICAL_DNS\u0060ã€\u0060EDS\u0060ã€\u0060ORIGINAL_DST\u0060ã€‚\n- **hosts**ï¼šè¿™æ˜¯ä¸ªåˆ—è¡¨ï¼Œé…ç½®è´Ÿè½½å‡è¡¡çš„ IP åœ°å€å’Œç«¯å£ï¼Œåªæœ‰ä½¿ç”¨äº†  \u0060STATIC\u0060ã€\u0060STRICT_DNS\u0060ã€\u0060LOGICAL_DNS\u0060 æœåŠ¡å‘ç°ç±»å‹æ—¶æ‰éœ€è¦é…ç½®ã€‚\n- **eds_cluster_config**ï¼šå¦‚æœä½¿ç”¨ \u0060EDS\u0060 åšæœåŠ¡å‘ç°ï¼Œåˆ™éœ€è¦é…ç½®è¯¥é¡¹ç›®ï¼Œå…¶ä¸­åŒ…æ‹¬çš„é…ç½®æœ‰ \u0060service_name\u0060 å’Œ \u0060ads\u0060ã€‚\n\n## å‚è€ƒ\n\n- [æ·±å…¥è§£è¯» Service Mesh èƒŒåçš„æŠ€æœ¯ç»†èŠ‚ - cnblogs.com](https:\/\/www.cnblogs.com\/163yun\/p\/8962278.html)\n- [ç†è§£ Istio Service Mesh ä¸­ Envoy ä»£ç† Sidecar æ³¨å…¥åŠæµé‡åŠ«æŒ - jimmysong.io](https:\/\/jimmysong.io\/blog\/envoy-sidecar-injection-in-istio-service-mesh-deep-dive\/)\n', '\/blog\/envoy-proxy-config-deep-dive\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡ä»‹ç»äº† Envoy proxy çš„æ¦‚å¿µï¼Œå¯¹åº”çš„ xDS çš„ç‰ˆæœ¬ä»¥åŠé…ç½®çš„è¯¦ç»†è§£æã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/envoy-mesh-in-kubernetes-tutorial/">åœ¨ Kubernetes ä¸­ä½¿ç”¨ Envoy mesh æ•™ç¨‹</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2018/04/28</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/envoy"> 
             Envoy
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('åœ¨ Kubernetes ä¸­ä½¿ç”¨ Envoy mesh æ•™ç¨‹', 'æœ¬æ–‡æ˜¯åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼Œä½¿ç”¨ Envoy æ¥åš meshï¼Œæ¥ä¸ºä¸€ä¸ªç®€å•çš„ä½¿ç”¨ Python ç¼–å†™çš„ Flask åº”ç”¨ç¨‹åºåšåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚', '\næœ¬æ–‡æ˜¯åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼Œä½¿ç”¨ Envoy æ¥åš meshï¼Œæ¥ä¸ºä¸€ä¸ªç®€å•çš„ä½¿ç”¨ Python ç¼–å†™çš„ Flask åº”ç”¨ç¨‹åºåšåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚\n\n**æ³¨**ï¼šæœ¬æ•™ç¨‹ä¸­çš„ç¤ºä¾‹æ¥è‡ª [envoy-steps](https:\/\/github.com\/datawire\/envoy-steps)ï¼Œæœ¬æ–‡ä¸­ä½¿ç”¨çš„æ‰€æœ‰çš„ä»£ç å’Œ YAML é…ç½®è§ [envoy-tutorial](https:\/\/github.com\/rootsongjc\/envoy-tutorial)ã€‚\n\n![Envoy Mesh æ¶æ„å›¾](envoy-mesh-in-kubernetes.webp)\n\n## å‰ææ¡ä»¶\n\nä½¿ç”¨ [kubernetes-vagrant-centos-cluster](https:\/\/github.com\/rootsongjc\/kubernetes-vagrant-centos-cluster) éƒ¨ç½² kubernetes é›†ç¾¤ï¼Œåªè¦å¯åŠ¨é›†ç¾¤å¹¶å®‰è£…äº† CoreDNS å³å¯ï¼Œæ— é¡»å®‰è£…å…¶ä»–æ’ä»¶ã€‚\n\n## éƒ¨ç½²åº”ç”¨\n\næˆ‘ä»¬é¦–å…ˆå°†åº”ç”¨éƒ¨ç½²åˆ° Kubernetes ä¸­ã€‚\n\néƒ¨ç½² postgres æ•°æ®åº“ã€‚\n\n\u0060\u0060\u0060bash\nkubectl apply -f postgres\n\u0060\u0060\u0060\n\nåˆ›å»º usersvc é•œåƒã€‚\n\n\u0060\u0060\u0060bash\ndocker build -t jimmysong\/usersvc:step1 .\n\u0060\u0060\u0060\n\néƒ¨ç½² usersvcã€‚\n\n\u0060\u0060\u0060bash\nkubectl apply -f usersvc\n\u0060\u0060\u0060\n\næŸ¥çœ‹ uservc çš„ ClusterIP åœ°å€ã€‚\n\n\u0060\u0060\u0060bash\n$ kubectl get svc usersvc\nkubectl get svc usersvc\nNAME      TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE\nusersvc   ClusterIP   10.254.176.248   \u003cnone\u003e        5000\/TCP   11m\n\u0060\u0060\u0060\n\nè¿›åˆ° node1 ä¸­è®¿é—®è¯¥æœåŠ¡ï¼Œå› ä¸ºæˆ‘ä»¬è¦è®¿é—®çš„æ˜¯ ClusterIPï¼Œåœ¨æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘ä¸Šæ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„ï¼Œæ‰€ä»¥è¿›åˆ°è™šæ‹Ÿæœºä¸­æ“ä½œã€‚\n\n\u0060\u0060\u0060bash\n$ vagrant ssh node1\n$ curl 10.254.176.248:5000\n{\n  \u0022hostname\u0022: \u0022usersvc-7cf5bb9d85-9gx7w\u0022,\n  \u0022msg\u0022: \u0022user health check OK\u0022,\n  \u0022ok\u0022: true,\n  \u0022resolvedname\u0022: \u0022172.33.10.7\u0022\n}\n\u0060\u0060\u0060\n\nå°è¯•æ·»åŠ ä¸€ä¸ªåä¸º \u0060Alice\u0060 çš„ç”¨æˆ·ã€‚\n\n\u0060\u0060\u0060bash\n$ curl -X PUT -H \u0022Content-Type: application\/json\u0022 \\\n    -d \u0027{ \u0022fullname\u0022: \u0022Alice\u0022, \u0022password\u0022: \u0022alicerules\u0022 }\u0027 \\\n    10.254.176.248\/user\/alice\n\u0060\u0060\u0060\n\nå°†ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022fullname\u0022: \u0022Alice\u0022,\n  \u0022hostname\u0022: \u0022usersvc-7cf5bb9d85-9gx7w\u0022,\n  \u0022ok\u0022: true,\n  \u0022resolvedname\u0022: \u0022172.33.10.7\u0022,\n  \u0022uuid\u0022: \u0022EF43B475F65848C6BE708F436305864B\u0022\n}\n\u0060\u0060\u0060\n\nå°è¯•å†æ·»åŠ ä¸€ä¸ªåä¸º \u0060Bob\u0060 çš„ç”¨æˆ·ã€‚\n\n\u0060\u0060\u0060bash\n$ curl -X PUT -H \u0022Content-Type: application\/json\u0022 \\\n    -d \u0027{ \u0022fullname\u0022: \u0022Bob\u0022, \u0022password\u0022: \u0022bobrules\u0022 }\u0027 \\\n    10.254.176.248\/user\/bob\n\u0060\u0060\u0060\n\nå°†ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022fullname\u0022: \u0022Bob\u0022,\n  \u0022hostname\u0022: \u0022usersvc-7cf5bb9d85-9gx7w\u0022,\n  \u0022ok\u0022: true,\n  \u0022resolvedname\u0022: \u0022172.33.10.7\u0022,\n  \u0022uuid\u0022: \u00226AC944E7D4254D9A811A82C0FDAC3046\u0022\n}\n\u0060\u0060\u0060\n\nå½“åº”ç”¨éƒ¨ç½²å®Œæ¯•åï¼Œæˆ‘ä»¬è¯¥éƒ¨ç½² edge envoy äº†ã€‚\n\n## éƒ¨ç½² edge envoy\n\néƒ¨ç½² edge envoy çš„æ–¹å¼å¾ˆç®€å•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\n\n\u0060\u0060\u0060bash\nkubectl apply -f edge-envoy\n\u0060\u0060\u0060\n\nç°åœ¨è®¿é—® edge envoy æ˜¯å°±å¯ä»¥è·¯ç”±åˆ° \u0060usersvc\u0060 ä¸Šçš„ï¼Œå½“ç„¶ç›´æ¥è®¿é—® \u0060usersvc\u0060 ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\n\næˆ‘ä»¬çœ‹ä¸‹ edge-envoy çš„ envoy é…ç½®æ–‡ä»¶å®šä¹‰ã€‚\n\n\u0060\u0060\u0060json\n{\n  \u0022listeners\u0022: [\n    {\n      \u0022address\u0022: \u0022tcp:\/\/0.0.0.0:80\u0022,\n      \u0022filters\u0022: [\n        {\n          \u0022type\u0022: \u0022read\u0022,\n          \u0022name\u0022: \u0022http_connection_manager\u0022,\n          \u0022config\u0022: {\n            \u0022codec_type\u0022: \u0022auto\u0022,\n            \u0022stat_prefix\u0022: \u0022ingress_http\u0022,\n            \u0022route_config\u0022: {\n              \u0022virtual_hosts\u0022: [\n                {\n                  \u0022name\u0022: \u0022backend\u0022,\n                  \u0022domains\u0022: [\u0022*\u0022],\n                  \u0022routes\u0022: [\n                    {\n                      \u0022timeout_ms\u0022: 0,\n                      \u0022prefix\u0022: \u0022\/user\u0022,\n                      \u0022cluster\u0022: \u0022usersvc\u0022\n                    }\n                  ]\n                }\n              ]\n            },\n            \u0022filters\u0022: [\n              {\n                \u0022type\u0022: \u0022decoder\u0022,\n                \u0022name\u0022: \u0022router\u0022,\n                \u0022config\u0022: {}\n              }\n            ]\n          }\n        }\n      ]\n    }\n  ],\n  \u0022admin\u0022: {\n    \u0022access_log_path\u0022: \u0022\/dev\/null\u0022,\n    \u0022address\u0022: \u0022tcp:\/\/127.0.0.1:8001\u0022\n  },\n  \u0022cluster_manager\u0022: {\n    \u0022clusters\u0022: [\n      {\n        \u0022name\u0022: \u0022usersvc\u0022,\n        \u0022connect_timeout_ms\u0022: 250,\n        \u0022type\u0022: \u0022strict_dns\u0022,\n        \u0022service_name\u0022: \u0022usersvc\u0022,\n        \u0022lb_type\u0022: \u0022round_robin\u0022,\n        \u0022features\u0022: \u0022http2\u0022,\n        \u0022hosts\u0022: [\n          {\n            \u0022url\u0022: \u0022tcp:\/\/usersvc:80\u0022\n          }\n        ]\n      }\n    ]\n  }\n}\n\u0060\u0060\u0060\n\nå®¢æˆ·ç«¯è®¿é—® \u0060edge-envoy\u0060 çš„ \u0060ClusterIP:8000\/user\/health\u0060 å°±å¯ä»¥æ£€æŸ¥èŠ‚ç‚¹çš„å¥åº·çŠ¶å†µã€‚\n\n## éƒ¨ç½² usersvc2\n\nåˆ é™¤åŸæ¥çš„ \u0060usersvc\u0060ï¼Œéƒ¨ç½²ç¬¬äºŒç‰ˆ \u0060usersvc2\u0060ï¼Œå®ƒä¸åŸæ¥çš„ \u0060usersvc\u0060 å”¯ä¸€ä¸åŒçš„åœ°æ–¹æ˜¯åœ¨ \u0060entrypoint\u0060 ä¸­é›†æˆäº† envoyï¼ŒæŸ¥çœ‹ \u0060Dockerfile\u0060 ä¸­æŒ‡å®šçš„ \u0060entrypoint.sh\u0060 çš„å†…å®¹ä¾¿å¯çŸ¥ã€‚\n\n\u0060\u0060\u0060bash\n#!\/bin\/sh\n\npython \/application\/service.py \u0026\n\/usr\/local\/bin\/envoy -c \/application\/envoy.json\n\u0060\u0060\u0060\n\né¦–å…ˆåˆ é™¤è€çš„ \u0060usersvc\u0060ã€‚\n\n\u0060\u0060\u0060bash\nkubectl delete -f usersvc\n\u0060\u0060\u0060\n\nä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤éƒ¨ç½² \u0060usersvc2\u0060ï¼Œå®ƒä»ç„¶ä½¿ç”¨ \u0060usersvc\u0060 è¿™ä¸ª service åç§°ã€‚\n\n\u0060\u0060\u0060bash\nkubectl apply -f usersvc2\n\u0060\u0060\u0060\n\nEnvoy ä»¥ out-of-process çš„æ–¹å¼è¿è¡Œï¼Œå¯¹åº”ç”¨è¿›ç¨‹æ²¡æœ‰ä¾µå…¥æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ sidecar çš„æ–¹å¼è¿è¡Œï¼Œè®© envoy ä¸ åº”ç”¨å®¹å™¨è¿è¡Œåœ¨åŒä¸€ä¸ª pod ä¸­ã€‚\n\nå¢åŠ  \u0060usersvc2\u0060 çš„å®ä¾‹ä¸ªæ•°ã€‚\n\n\u0060\u0060\u0060bash\nkubectl scale --replicas=3 deployment\/usersvc\n\u0060\u0060\u0060\n\næ­¤æ—¶æˆ‘ä»¬æœ‰ 3 ä¸ª usersvc å®ä¾‹ï¼Œç°åœ¨é€šè¿‡ \u0060edge-envoy\u0060 çš„ \u0060ClusterIP:8000\/user\/health\u0060 æ£€æŸ¥èŠ‚ç‚¹çš„å¥åº·çŠ¶å†µæ—¶ï¼Œæ˜¯ä¸æ˜¯ä¼šè½®è¯¢çš„è®¿é—®åˆ°åç«¯çš„çš„ \u0060usersvc2\u0060 çš„å®ä¾‹å‘¢ï¼Ÿ\n\næˆ‘ä»¬å½“åˆåœ¨ \u0060edge-node\u0060 çš„ \u0060envoy.json\u0060 ä¸­é…ç½®è¿‡ cluster çš„ï¼Œå…¶ä¸­æŒ‡å®šäº† \u0060lb_type\u0060 ä¸º \u0060round_robin\u0060 ã€‚\n\n\u0060\u0060\u0060json\n  \u0022cluster_manager\u0022: {\n    \u0022clusters\u0022: [\n      {\n        \u0022name\u0022: \u0022usersvc\u0022,\n        \u0022connect_timeout_ms\u0022: 250,\n        \u0022type\u0022: \u0022strict_dns\u0022,\n        \u0022service_name\u0022: \u0022usersvc\u0022,\n        \u0022lb_type\u0022: \u0022round_robin\u0022,\n        \u0022features\u0022: \u0022http2\u0022,\n        \u0022hosts\u0022: [\n          {\n            \u0022url\u0022: \u0022tcp:\/\/usersvc:80\u0022\n          }\n        ]\n      }\n    ]\n  }\n\u0060\u0060\u0060\n\nè€Œä¸”è¯¥ \u0060Service_name\u0060 ä¹Ÿå¯ä»¥è¢« DNS æ­£ç¡®è§£æã€‚\n\n\u0060\u0060\u0060bash\nroot@usersvc-55b6857d44-gcg5c:\/application# nslookup usersvc\nServer:         10.254.0.2\nAddress:        10.254.0.2#53\n\nName:   usersvc.envoy-tutorial.svc.cluster.local\nAddress: 10.254.123.166\n\u0060\u0060\u0060\n\n**ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚**\n\nè™½ç„¶é€šè¿‡ DNS å¯ä»¥æ­£ç¡®çš„è§£æå‡º Service çš„ ClusterIPï¼Œä½†æ˜¯è´Ÿè½½å‡è¡¡ä¸å†é€šè¿‡ kube-proxy å®ç°ï¼Œæ‰€ä»¥ä¸è®ºæˆ‘ä»¬è®¿é—®å¤šå°‘æ¬¡ \u0060edge-envoy\u0060 æ°¸è¿œåªèƒ½è®¿é—®åˆ°ä¸€ä¸ªå›ºå®šçš„åç«¯ \u0060usersvc\u0060ã€‚\n\n## æœåŠ¡å‘ç°æœåŠ¡ - SDS\n\nKubernetes ä¸­çš„ DNS å¯ä»¥å‘ç°æ‰€æœ‰ Service çš„ ClusterIPï¼Œä½†æ˜¯ DNS ä¸­ä¸åŒ…æ‹¬æ‰€æœ‰ endpoint åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª SDSï¼ˆæœåŠ¡å‘ç°æœåŠ¡ï¼‰æ¥å‘ç°æœåŠ¡çš„æ‰€æœ‰çš„ endpointï¼Œæˆ‘ä»¬å°†ä¿®æ”¹ \u0060lb_type\u0060ï¼Œä½¿ç”¨ \u0060sds\u0060 æ›¿ä»£ \u0060strict_dns\u0060ã€‚\n\næ‰§è¡Œä¸‹é¢çš„å‘½ä»¤éƒ¨ç½² SDSã€‚\n\n\u0060\u0060\u0060bassh\nkubectl apply -f usersvc-sds\n\u0060\u0060\u0060\n\nå› ä¸ºåœ¨æ·»åŠ äº† SDS ä¹‹åéœ€è¦ä¿®æ”¹ \u0060edge-envoy\u0060 ä¸­çš„ \u0060envoy.josn\u0060 é…ç½®ï¼Œåœ¨ \u0060clusters\u0060 å­—æ®µä¸­å¢åŠ  \u0060sds\u0060 ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„é…ç½®éƒ½å†™å¥½äº†ï¼Œé‡æ–°æ‰“åŒ…æˆäº†é•œåƒï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ é™¤ä¹‹å‰éƒ¨ç½²çš„ \u0060edge-envoy\u0060ã€‚\n\n\u0060\u0060\u0060bash\nkubectl delete -f edge-envoy\n\u0060\u0060\u0060\n\néƒ¨ç½²æ–°çš„ \u0060edge-envoy2\u0060ã€‚\n\n\u0060\u0060\u0060bash\nkubectl apply -f edge-envoy2\n\u0060\u0060\u0060\n\nè¿ç»­è®¿é—® \u0060usersvc\u0060 12 æ¬¡çœ‹çœ‹è¾“å‡ºç»“æœå¦‚ä½•ã€‚\n\n\u0060\u0060\u0060bash\nURL=http:\/\/172.17.8.101:30800\/user\/alice\nfor i in \u0060seq 1 12\u0060;do curl -s $URL|grep \u0022resolvedname\u0022|tr -d \u0022 \u0022|tr -d \u0022,\u0022|tr -d \u0027\u0022\u0027;done\n\u0060\u0060\u0060\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š\n\n\u0060\u0060\u0060ini\nresolvedname:172.33.71.2\nresolvedname:172.33.88.2\nresolvedname:172.33.10.2\nresolvedname:172.33.71.2\nresolvedname:172.33.88.2\nresolvedname:172.33.10.2\nresolvedname:172.33.71.2\nresolvedname:172.33.88.2\nresolvedname:172.33.10.2\nresolvedname:172.33.71.2\nresolvedname:172.33.88.2\nresolvedname:172.33.10.2\n\u0060\u0060\u0060\n\nå†æŸ¥çœ‹ä¸‹ \u0060usersvc\u0060 æœåŠ¡çš„æ‰€æœ‰ pod çš„ IP åœ°å€ã€‚\n\n\u0060\u0060\u0060bash\n$ kubectl get pod -l service=usersvc -o wide\nNAME                       READY     STATUS    RESTARTS   AGE       IP            NODE\nusersvc-55b6857d44-mkfpv   1\/1       Running   0          9m        172.33.88.2   node1\nusersvc-55b6857d44-q98jg   1\/1       Running   0          9m        172.33.71.2   node2\nusersvc-55b6857d44-s2znk   1\/1       Running   0          9m        172.33.10.2   node3\n\u0060\u0060\u0060\n\næˆ‘ä»¬çœ‹åˆ° round-robin è´Ÿè½½å‡è¡¡ç”Ÿæ•ˆäº†ã€‚\n\n## å‚è€ƒ\n\n- [Part 2: Deploying Envoy with a Python Flask webapp and Kubernetes](https:\/\/www.datawire.io\/envoyproxy\/envoy-flask-kubernetes\/)\n- [envoy-steps](https:\/\/github.com\/datawire\/envoy-steps)\n- [kubernetes-vagrant-centos-cluster](https:\/\/github.com\/rootsongjc\/kubernetes-vagrant-centos-cluster) \n- [envoy-tutorial](https:\/\/github.com\/rootsongjc\/envoy-tutorial)\n', '\/blog\/envoy-mesh-in-kubernetes-tutorial\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡æ˜¯åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼Œä½¿ç”¨ Envoy æ¥åš meshï¼Œæ¥ä¸ºä¸€ä¸ªç®€å•çš„ä½¿ç”¨ Python ç¼–å†™çš„ Flask åº”ç”¨ç¨‹åºåšåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/envoy-archiecture-and-terminology/">Envoy çš„æ¶æ„ä¸åŸºæœ¬é…ç½®è§£æ</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2018/04/27</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/envoy"> 
             Envoy
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Envoy çš„æ¶æ„ä¸åŸºæœ¬é…ç½®è§£æ', 'æœ¬æ–‡ä»‹ç»äº† Envoy proxy ä¸­çš„åŸºæœ¬æ¦‚å¿µã€é…ç½®ä¸æ¶æ„è§£æã€‚', '\nåœ¨äº†è§£ä¸€é—¨æŠ€æœ¯ä¹‹å‰ä¸€å¼€å§‹å°±è¦äº†è§£å…¶ä¸­çš„åŸºæœ¬æ¦‚å¿µå’Œæœ¯è¯­ï¼Œåªæœ‰èå…¥äº†è¯¥è¯­å¢ƒæ‰èƒ½ç†è§£è¿™é—¨æŠ€æœ¯ã€‚æœ¬æ–‡å°†ä¸ºå¤§å®¶ä»‹ç» Envoy ä¸­çš„åŸºæœ¬æœ¯è¯­å’Œé‡ç‚¹æ¦‚å¿µã€‚\n\n## æ¶æ„\n\nä¸‹å›¾æ˜¯ Envoy proxy çš„æ¶æ„å›¾ï¼Œæ˜¾ç¤ºäº† host B ç»è¿‡ Envoy è®¿é—® host A çš„è¿‡ç¨‹ã€‚æ¯ä¸ª host ä¸Šéƒ½å¯èƒ½è¿è¡Œå¤šä¸ª serviceï¼ŒEnvoy ä¸­ä¹Ÿå¯èƒ½æœ‰å¤šä¸ª Listenerï¼Œæ¯ä¸ª Listener ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ª filter ç»„æˆäº† chainã€‚\n\n![Envoy proxy æ¶æ„å›¾](envoy-arch.jpg)\n\nå…¶ä¸­çš„åŸºæœ¬æœ¯è¯­å°†åœ¨ä¸‹é¢è§£é‡Šã€‚\n\n## åŸºæœ¬æœ¯è¯­\n\n**Host**ï¼šèƒ½å¤Ÿè¿›è¡Œç½‘ç»œé€šä¿¡çš„å®ä½“ï¼ˆåœ¨æ‰‹æœºæˆ–æœåŠ¡å™¨ç­‰ä¸Šçš„åº”ç”¨ç¨‹åºï¼‰ã€‚åœ¨ Envoy ä¸­ä¸»æœºæ˜¯æŒ‡é€»è¾‘ç½‘ç»œåº”ç”¨ç¨‹åºã€‚åªè¦æ¯å°ä¸»æœºéƒ½å¯ä»¥ç‹¬ç«‹å¯»å€ï¼Œä¸€å—ç‰©ç†ç¡¬ä»¶ä¸Šå°±è¿è¡Œå¤šä¸ªä¸»æœºã€‚\n\n**Downstream**ï¼šä¸‹æ¸¸ï¼ˆdownstreamï¼‰ä¸»æœºè¿æ¥åˆ° Envoyï¼Œå‘é€è¯·æ±‚å¹¶æˆ–è·å¾—å“åº”ã€‚\n\n**Upstream**ï¼šä¸Šæ¸¸ï¼ˆupstreamï¼‰ä¸»æœºè·å–æ¥è‡ª Envoy çš„é“¾æ¥è¯·æ±‚å’Œå“åº”ã€‚\n\n**Cluster**: é›†ç¾¤ï¼ˆclusterï¼‰æ˜¯ Envoy è¿æ¥åˆ°çš„ä¸€ç»„é€»è¾‘ä¸Šç›¸ä¼¼çš„ä¸Šæ¸¸ä¸»æœºã€‚Envoy é€šè¿‡æœåŠ¡å‘ç°å‘ç°é›†ç¾¤ä¸­çš„æˆå‘˜ã€‚Envoy å¯ä»¥é€šè¿‡ä¸»åŠ¨è¿è¡ŒçŠ¶å†µæ£€æŸ¥æ¥ç¡®å®šé›†ç¾¤æˆå‘˜çš„å¥åº·çŠ¶å†µã€‚Envoy å¦‚ä½•å°†è¯·æ±‚è·¯ç”±åˆ°é›†ç¾¤æˆå‘˜ç”±è´Ÿè½½å‡è¡¡ç­–ç•¥ç¡®å®šã€‚\n\n**Mesh**ï¼šä¸€ç»„äº’ç›¸åè°ƒä»¥æä¾›ä¸€è‡´ç½‘ç»œæ‹“æ‰‘çš„ä¸»æœºã€‚Envoy mesh æ˜¯æŒ‡ä¸€ç»„ Envoy ä»£ç†ï¼Œå®ƒä»¬æ„æˆäº†ç”±å¤šç§ä¸åŒæœåŠ¡å’Œåº”ç”¨ç¨‹åºå¹³å°ç»„æˆçš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶ˆæ¯ä¼ é€’åŸºç¡€ã€‚\n\n**è¿è¡Œæ—¶é…ç½®**ï¼šä¸ Envoy ä¸€èµ·éƒ¨ç½²çš„å¸¦å¤–å®æ—¶é…ç½®ç³»ç»Ÿã€‚å¯ä»¥åœ¨æ— éœ€é‡å¯ Envoy æˆ– æ›´æ”¹ Envoy ä¸»é…ç½®çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ›´æ”¹è®¾ç½®æ¥å½±å“æ“ä½œã€‚\n\n**Listener**: ä¾¦å¬å™¨ï¼ˆlistenerï¼‰æ˜¯å¯ä»¥ç”±ä¸‹æ¸¸å®¢æˆ·ç«¯è¿æ¥çš„å‘½åç½‘ç»œä½ç½®ï¼ˆä¾‹å¦‚ï¼Œç«¯å£ã€unix åŸŸå¥—æ¥å­—ç­‰ï¼‰ã€‚Envoy å…¬å¼€ä¸€ä¸ªæˆ–å¤šä¸ªä¸‹æ¸¸ä¸»æœºè¿æ¥çš„ä¾¦å¬å™¨ã€‚ä¸€èˆ¬æ˜¯æ¯å°ä¸»æœºè¿è¡Œä¸€ä¸ª Envoyï¼Œä½¿ç”¨å•è¿›ç¨‹è¿è¡Œï¼Œä½†æ˜¯æ¯ä¸ªè¿›ç¨‹ä¸­å¯ä»¥å¯åŠ¨ä»»æ„æ•°é‡çš„ Listenerï¼ˆç›‘å¬å™¨ï¼‰ï¼Œç›®å‰åªç›‘å¬ TCPï¼Œæ¯ä¸ªç›‘å¬å™¨éƒ½ç‹¬ç«‹é…ç½®ä¸€å®šæ•°é‡çš„ï¼ˆL3\/L4ï¼‰ç½‘ç»œè¿‡æ»¤å™¨ã€‚Listenter ä¹Ÿå¯ä»¥é€šè¿‡ Listener Discovery Serviceï¼ˆ**LDS**ï¼‰åŠ¨æ€è·å–ã€‚\n\n**Listener filter**ï¼šListener ä½¿ç”¨ listener filterï¼ˆç›‘å¬å™¨è¿‡æ»¤å™¨ï¼‰æ¥æ“ä½œé“¾æ¥çš„å…ƒæ•°æ®ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨ä¸æ›´æ”¹ Envoy çš„æ ¸å¿ƒåŠŸèƒ½çš„æƒ…å†µä¸‹æ·»åŠ æ›´å¤šçš„é›†æˆåŠŸèƒ½ã€‚Listener filter çš„ API ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºè¿™äº›è¿‡æ»¤å™¨æœ€ç»ˆæ˜¯åœ¨æ–°æ¥å—çš„å¥—æ¥å­—ä¸Šè¿è¡Œã€‚åœ¨é“¾ä¸­å¯ä»¥äº’ç›¸è¡”æ¥ä»¥æ”¯æŒæ›´å¤æ‚çš„åœºæ™¯ï¼Œä¾‹å¦‚è°ƒç”¨é€Ÿç‡é™åˆ¶ã€‚Envoy å·²ç»åŒ…å«äº†å¤šä¸ªç›‘å¬å™¨è¿‡æ»¤å™¨ã€‚\n\n**Http Route Table**ï¼šHTTP çš„è·¯ç”±è§„åˆ™ï¼Œä¾‹å¦‚è¯·æ±‚çš„åŸŸåï¼ŒPath ç¬¦åˆä»€ä¹ˆè§„åˆ™ï¼Œè½¬å‘ç»™å“ªä¸ª Clusterã€‚\n\n**Health checking**ï¼šå¥åº·æ£€æŸ¥ä¼šä¸ SDS æœåŠ¡å‘ç°é…åˆä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå³ä½¿ä½¿ç”¨å…¶ä»–æœåŠ¡å‘ç°æ–¹å¼ï¼Œä¹Ÿæœ‰ç›¸åº”éœ€è¦è¿›è¡Œä¸»åŠ¨å¥åº·æ£€æŸ¥çš„æƒ…å†µã€‚è¯¦è§ health checkingã€‚\n\n## xDS\n\nxDS æ˜¯ä¸€ä¸ªå…³é”®æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç±»å‘ç°æœåŠ¡çš„ç»Ÿç§°ï¼Œå…¶åŒ…æ‹¬å¦‚ä¸‹å‡ ç±»ï¼š\n\n- CDS: Cluster Discovery Service\n- EDS: Endpoint Discovery Service\n- SDS: Secret Discovery Service\n- RDS: Route Discovery Service\n- LDS: Listener Discovery Service\n\næ­£æ˜¯é€šè¿‡å¯¹ xDS çš„è¯·æ±‚æ¥åŠ¨æ€æ›´æ–° Envoy é…ç½®ï¼Œå¦å¤–è¿˜æœ‰ä¸ª ADSï¼ˆAggregated Discovery Serviceï¼‰é€šè¿‡èšåˆçš„æ–¹å¼è§£å†³ä»¥ä¸Š xDS çš„æ›´æ–°é¡ºåºé—®é¢˜ã€‚\n\n## Envoy Mesh\n\nEnvoy Mesh æŒ‡çš„æ˜¯ç”± envoy åšè´Ÿè½½å‡è¡¡å’Œä»£ç†çš„ meshã€‚è¯¥ Mesh ä¸­ä¼šåŒ…å«ä¸¤ç±» envoyï¼š\n\n- Edge envoyï¼šå³æµé‡è¿›å‡º mesh æ—¶å€™çš„ envoyï¼Œç›¸å½“äº kubernetes ä¸­çš„ ingressã€‚\n- Service envoyï¼šæœåŠ¡ envoy æ˜¯è·Ÿæ¯ä¸ª Service å®ä¾‹ä¸€èµ·è¿è¡Œçš„ï¼Œåº”ç”¨ç¨‹åºæ— æ„ŸçŸ¥çš„è¿›ç¨‹å¤–å·¥å…·ï¼Œåœ¨ kubernetes ä¸­ä¼šä¸åº”ç”¨å®¹å™¨ä»¥ sidecar å½¢å¼è¿è¡Œåœ¨åŒä¸€ä¸ª pod ä¸­ã€‚\n\nEnvoy å³å¯ä»¥å•ç‹¬ä½œä¸º edge envoyï¼Œä¹Ÿå¯ä»¥ä»…åš service envoy ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸¤è€…åŒæ—¶ä½¿ç”¨ã€‚Mesh ä¸­çš„æ‰€æœ‰ envoy ä¼šå…±äº«è·¯ç”±ä¿¡æ¯ã€‚\n\n## Envoy é…ç½®\n\nEnvoy ä¸­çš„é…ç½®åŒ…æ‹¬ä¸¤å¤§ç±»ï¼šlistenner é…ç½®å’Œ cluster é…ç½®ã€‚\n\n### Listener é…ç½®\n\næˆ‘ä»¬çŸ¥é“ Envoy ä¸­å¯ä»¥é…ç½®ä¸€ç»„ listener ä»¥å®ç°å¤æ‚çš„å¤„ç†é€»è¾‘ã€‚Listener ä¸­è®¾ç½®ç›‘å¬çš„ TCP ç«¯å£ï¼Œè¿˜æœ‰ä¸€ç»„ filter å¯¹è¿™äº›ç«¯å£ä¸Šçš„æ•°æ®æµè¿›è¡Œå¤„ç†ã€‚\n\n\u0060\u0060\u0060yaml\n  listeners:\n  - address:\n      socket_address:\n        address: 0.0.0.0\n        port_value: 80\n    filter_chains:\n    - filters:\n      - name: envoy.http_connection_manager\n        config:\n          codec_type: auto\n          stat_prefix: ingress_http\n          route_config:\n            name: local_route\n            virtual_hosts:\n            - name: backend\n              domains:\n              - \u0022*\u0022\n              routes:\n              - match:\n                  prefix: \u0022\/service\/1\u0022\n                route:\n                  cluster: service1\n              - match:\n                  prefix: \u0022\/service\/2\u0022\n                route:\n                  cluster: service2\n\u0060\u0060\u0060\n\nè¿™æ˜¯ä¸€ä¸ª \u0060http_connection_manager\u0060 ä¾‹å­ï¼Œå…¶ä¸­å¿…é¡»åŒ…å« \u0060virtual_hosts\u0060 é…ç½®ï¼Œè€Œ \u0060virtual_hosts\u0060 é…ç½®ä¸­å¿…é¡»åŒ…å«ä»¥ä¸‹å‡ é¡¹é…ç½®ï¼š\n\n- \u0060name\u0060ï¼šæœåŠ¡åç§°\n- \u0060domains\u0060ï¼šDNS åŸŸåï¼Œå¿…é¡»èƒ½è·Ÿ \u0060virtual_host\u0060 çš„ URL åŒ¹é… \n- \u0060routes\u0060ï¼šè·¯ç”±åˆ—è¡¨\n\næ¯ä¸ªè·¯ç”±ä¸­è¿˜å¯ä»¥åŒ…å«ä»¥ä¸‹é…ç½®ï¼š\n\n- \u0060prefix\u0060ï¼šURL è·¯å¾„å‰ç¼€\n- \u0060cluster\u0060ï¼šå¤„ç†è¯¥è¯·æ±‚çš„ envoy cluster\n- \u0060timeout_ms\u0060ï¼šå½“å‡ºé”™æ—¶çš„è¶…æ—¶æ—¶é—´\n\nå¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®šä¹‰ \u0060service1\u0060 cluster å’Œ \u0060service2\u0060 clusterã€‚\n\n### Cluster é…ç½®\n\nCluster æ˜¯ä¸€ç»„é€»è¾‘ç›¸ä¼¼çš„ä¸»æœºé…ç½®ï¼Œå®šä¹‰å“ªäº›ä¸»æœºå±äºä¸€ä¸ªæœåŠ¡ï¼Œcluster çš„é…ç½®ä¸­åŒ…å«äº†æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡æ–¹å¼é…ç½®ã€‚ä¾ç„¶æ˜¯å‚è€ƒä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†ä¸­çš„é…ç½®ï¼š\n\n\u0060\u0060\u0060yaml\n clusters:\n  - name: service1\n    connect_timeout: 0.25s\n    type: strict_dns\n    lb_policy: round_robin\n    http2_protocol_options: {}\n    hosts:\n    - socket_address:\n        address: service1\n        port_value: 80\n  - name: service2\n    connect_timeout: 0.25s\n    type: strict_dns\n    lb_policy: round_robin\n    http2_protocol_options: {}\n    hosts:\n    - socket_address:\n        address: service2\n        port_value: 80\n\u0060\u0060\u0060\n\nCluster çš„é…ç½®ä¸­è‡³å°‘åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š\n\n- \u0060name\u0060ï¼šcluster åç§°ï¼Œå°±æ˜¯æœåŠ¡åç§°\n- \u0060type\u0060ï¼šè¯¥ cluster æ€ä¹ˆçŸ¥é“ä¸»æœºæ˜¯å¦å¯åŠ¨ï¼Ÿå³æœåŠ¡å‘ç°ç±»å‹ï¼Œæœ‰ä»¥ä¸‹æ–¹å¼ï¼š\n  - \u0060static\u0060ï¼šç›‘å¬ cluster ä¸­çš„æ‰€æœ‰ä¸»æœº\n  - \u0060strict_dns\u0060ï¼šenvoy ä¼šç›‘å¬ DNSï¼Œæ¯ä¸ªåŒ¹é…çš„ A è®°å½•éƒ½ä¼šè®¤å®šä¸ºæœ‰æ•ˆ\n  - \u0060logical_dns\u0060ï¼šenvoy å°†ä½¿ç”¨ DNS æ¥å¢åŠ ä¸»æœºï¼Œå¦‚æœ DNS ä¸å†è¿”å›è¯¥ä¸»æœºä¹Ÿä¸ä¼šåˆ é™¤è¿™äº›ä¸»æœºä¿¡æ¯\n  - \u0060sds\u0060ï¼šå³ Service Discovery Serviceï¼Œenvoy è®¿é—®å¤–éƒ¨çš„ REST è·å– cluster æˆå‘˜ä¿¡æ¯\n- \u0060lb_type\u0060ï¼šcluster çš„è´Ÿè½½å‡è¡¡ç±»å‹ï¼Œæœ‰ä»¥ä¸‹æ–¹å¼ï¼š\n  - \u0060round_robin\u0060ï¼šè½®è¯¢ä¸»æœº\n  - \u0060weighted_least_request\u0060ï¼šæœ€è¿‘è·å¾—æœ€å°‘è¯·æ±‚çš„ä¸»æœº\n  - \u0060random\u0060ï¼šéšæœº\n- \u0060hosts\u0060ï¼šèƒ½å¤Ÿå®šä¹‰ cluster ä¸­ä¸»æœºçš„ URL åœ°å€ï¼Œé€šå¸¸æ˜¯\u0060tcp:\/\/\u0060 URL\n\n## å‚è€ƒ\n\n- [Part 1: Getting started with Envoy Proxy for microservices resilience - getambassador.io](https:\/\/www.getambassador.io\/resources\/getting-started-envoyproxy-microservices-resilience\/\/)\n', '\/blog\/envoy-archiecture-and-terminology\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡ä»‹ç»äº† Envoy proxy ä¸­çš„åŸºæœ¬æ¦‚å¿µã€é…ç½®ä¸æ¶æ„è§£æã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/envoy-as-front-proxy/">ä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2018/04/22</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/envoy"> 
             Envoy
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†', 'æœ¬æ–‡æ˜¯ä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†çš„ä»‹ç»ï¼Œä»…ä½¿ç”¨ docker å®¹å™¨å’Œ docker-compose åšç¼–æ’åœ¨å•æœºä¸­è¿è¡Œï¼Œå¸®åŠ©æˆ‘ä»¬ä»æ›´åº•å±‚äº†è§£ Envoyï¼Œå½“æˆ‘ä»¬å°† Envoy ä½œä¸º Istio Service Mesh çš„ data panel çš„æ—¶å€™å°†æ›´åŠ æ¸¸åˆƒæœ‰ä½™ã€‚', '\n[Envoy](https:\/\/github.com\/envoyproxy\/envoy) æ˜¯ä¸€æ¬¾ç”± Lyft å¼€æºçš„ï¼Œä½¿ç”¨ C\u002b\u002b ç¼–å†™çš„ L7 ä»£ç†å’Œé€šä¿¡æ€»çº¿ï¼Œç›®å‰æ˜¯ [CNCF](https:\/\/cncf.io) æ——ä¸‹çš„å¼€æºé¡¹ç›®ï¼Œä»£ç æ‰˜ç®¡åœ¨ GitHub ä¸Šï¼Œå®ƒä¹Ÿæ˜¯ [Istio](https:\/\/istio.io) service mesh ä¸­é»˜è®¤çš„ data planeã€‚æœ¬æ–‡å°†ç»™å‡ºä½¿ç”¨ Envoy ä½œä¸º service mesh çš„æ•°æ®å¹³é¢çš„ç¤ºä¾‹ï¼Œåº”ç”¨ä½¿ç”¨ docker-compose ç¼–æ’ã€‚\n\n## ç‰¹æ€§\n\nEnvoy åŒ…æ‹¬å¦‚ä¸‹ç‰¹æ€§ï¼š\n\n- è¿›ç¨‹å¤–æ¶æ„ï¼Œä¸ä¾µå…¥åº”ç”¨è¿›ç¨‹\n- ä½¿ç”¨ç°ä»£ç‰ˆ C\u002b\u002b11 ä»£ç \n- L3\/L4 filter æ¶æ„\n- HTTP L7 filter æ¶æ„\n- æ”¯æŒ HTTP\/2\n- HTTP L7 routing\n- æ”¯æŒ gRPC\n- æ”¯æŒ MongoDB L7\n- åŠ¨æ€é…ç½®\n- æœ€ä½³å¯è§‚æµ‹æ€§\n- æ”¯æŒ front\/edge proxy\n- é«˜çº§è´Ÿè½½å‡è¡¡\n- å¥åº·æ£€æŸ¥\n- æœåŠ¡å‘ç°\n- æ”¯æŒ DynamoDB L7\n\nEnvoy æœ¬èº«æ— æ³•æ„æˆä¸€ä¸ªå®Œæ•´çš„ Service Meshï¼Œä½†æ˜¯å®ƒå¯ä»¥ä½œä¸º service mesh ä¸­çš„åº”ç”¨é—´æµé‡çš„ä»£ç†ï¼Œè´Ÿè´£ service mesh ä¸­çš„æ•°æ®å±‚ã€‚\n\næ›´å¤šä¿¡æ¯è¯·å‚è€ƒ [Envoy å®˜ç½‘](https:\/\/www.envoyproxy.io\/)ã€‚\n\n## Envoy ä½œä¸ºå‰ç«¯ä»£ç†\n\næœ¬æ–‡æ˜¯ä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†çš„ä»‹ç»ï¼Œä»…ä½¿ç”¨ docker å®¹å™¨å’Œ docker-compose åšç¼–æ’åœ¨å•æœºä¸­è¿è¡Œï¼Œå¸®åŠ©æˆ‘ä»¬ä»æ›´åº•å±‚äº†è§£ Envoyï¼Œå½“æˆ‘ä»¬å°† Envoy ä½œä¸º Istio Service Mesh çš„ data panel çš„æ—¶å€™å°†æ›´åŠ æ¸¸åˆƒæœ‰ä½™ã€‚\n\n## å¿«é€Ÿå¼€å§‹\n\nEnvoy ä¸­çš„æ‰€æœ‰è§„åˆ™é…ç½®è·Ÿ Kubernetes ä¸€æ ·éƒ½æ˜¯é€šè¿‡ YAML æ–‡ä»¶æ¥å®Œæˆçš„ã€‚åœ¨ç»§ç»­ä¸‹é¢çš„æ­¥éª¤ä¹‹å‰ï¼Œé¦–å…ˆå…‹éš† Envoy çš„ GitHub repoã€‚\n\n\u0060\u0060\u0060bash\ngit clone https:\/\/github.com\/envoyproxy\/envoy.git\n\u0060\u0060\u0060\n\n## è¿è¡Œ sandbox æµ‹è¯•\n\nEnvoy å®˜æ–¹æä¾›äº†ä»¥ä¸‹æ‰“åŒ…ç”¨ä¾‹ï¼š\n\n- Front Proxy\n- [Zipkin Tracing](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/start\/sandboxes\/zipkin_tracing)\n- Jaeger Tracing\n- gRPC Bridge\n\nå…¨éƒ¨å¯ä»¥ä½¿ç”¨ \u0060docker-compose\u0060 è¿è¡Œï¼Œä»£ç å¯ä»¥åœ¨ https:\/\/github.com\/envoyproxy\/envoy\/tree\/master\/examples æ‰¾åˆ°ã€‚\n\n## Front proxy\n\nEnvoy åœ¨ envoymesh çš„è¾¹ç¼˜åšåå‘ä»£ç†ï¼Œè¯¦ç»†ä½¿ç”¨æ–¹å¼è§ \u003chttps:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/start\/sandboxes\/front_proxy\u003eï¼Œåœ¨æ­¤æˆ‘å°†è§£è¯´ä¸‹ä»¥ä¸‹é—®é¢˜ï¼š\n\n- Envoy æ˜¯å¦‚ä½•ä½œä¸ºè¿›ç¨‹å¤–æ¶æ„è¿è¡Œçš„ï¼Ÿ\n- ä¸ºä½•è¯´ Envoy æ˜¯æ— ä¾µå…¥å¼æ¶æ„ï¼Ÿ\n- Envoy ä½œä¸ºè¾¹ç¼˜åå‘ä»£ç†èƒ½åšä»€ä¹ˆï¼Ÿ\n\næœ¬ç¤ºä¾‹çš„æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¤æ—¶ Envoy å°†ä½œä¸ºä¸€ä¸ªåå‘ä»£ç†ï¼Œç±»ä¼¼äº Nginxï¼Œä½†ä¸ Nginx ä¸åŒçš„æ˜¯å®ƒè¿˜ä¼šä½œä¸ºä¸€ä¸ªè¿›ç¨‹ï¼Œä¼´éšæ¯ä¸ªæœåŠ¡ä¸€èµ·è¿è¡Œåœ¨åŒä¸€ä¸ªå®¹å™¨ä¸­ï¼ˆåœ¨ Kubernetes ä¸­å¯ä»¥ä½œä¸º Sidecar ä¸åº”ç”¨å®¹å™¨ä¸€èµ·è¿è¡Œåœ¨åŒä¸€ä¸ª Pod ä¸­ï¼‰ã€‚\n\n![Front proxy éƒ¨ç½²ç»“æ„å›¾](envoyproxy-docker-compose.png)\n\nåœ¨æ­¤ç¤ºä¾‹ä¸­ä¸€å…±æœ‰ 3 ä¸ªæœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå…¶åˆ›å»ºå®¹å™¨ç¼–æ’çš„ \u0060docker-compose.yml\u0060 æ–‡ä»¶ã€‚\n\n\u0060\u0060\u0060yaml\nversion: \u00272\u0027\nservices:\n\n  front-envoy:\n    build:\n      context: .\n      dockerfile: Dockerfile-frontenvoy\n    volumes:\n      - .\/front-envoy.yaml:\/etc\/front-envoy.yaml\n    networks:\n      - envoymesh\n    expose:\n      - \u002280\u0022\n      - \u00228001\u0022\n    ports:\n      - \u00228000:80\u0022\n      - \u00228001:8001\u0022\n\n  service1:\n    build:\n      context: .\n      dockerfile: Dockerfile-service\n    volumes:\n      - .\/service-envoy.yaml:\/etc\/service-envoy.yaml\n    networks:\n      envoymesh:\n        aliases:\n          - service1\n    environment:\n      - SERVICE_NAME=1\n    expose:\n      - \u002280\u0022\n\n  service2:\n    build:\n      context: .\n      dockerfile: Dockerfile-service\n    volumes:\n      - .\/service-envoy.yaml:\/etc\/service-envoy.yaml\n    networks:\n      envoymesh:\n        aliases:\n          - service2\n    environment:\n      - SERVICE_NAME=2\n    expose:\n      - \u002280\u0022\n\nnetworks:\n  envoymesh: {}\n\u0060\u0060\u0060\n\nä½¿ç”¨ docker-compose å¯åŠ¨å¯ä»¥ä¿è¯ä¸‰ä¸ªæœåŠ¡éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œå†…ï¼Œå³ \u0060frontproxy_envoymesh\u0060 ç½‘ç»œä¸­ã€‚\n\nå…¶ä¸­ \u0060front-envoy\u0060 æ˜¯å‰ç«¯ï¼ˆè¾¹ç¼˜ï¼‰Envoy æœåŠ¡ï¼Œç”¨æ¥åšåå‘ä»£ç†ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ \u0060Dockerfile-frontenvoy\u0060 æ–‡ä»¶æ¥æ„å»ºé•œåƒçš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹è¯¥ \u0060Dockerfile\u0060 çš„å†…å®¹ã€‚\n\n\u0060\u0060\u0060dockerfile\nFROM envoyproxy\/envoy:latest\n\nRUN apt-get update \u0026\u0026 apt-get -q install -y \\\n    curl\nCMD \/usr\/local\/bin\/envoy -c \/etc\/front-envoy.yaml --service-cluster front-proxy\n\u0060\u0060\u0060\n\nå…¶ä¸­ \u0060\/etc\/front-envoy.yaml\u0060 æ˜¯æœ¬åœ°çš„ \u0060front-envoy.yaml\u0060 æŒ‚è½½è¿›å»çš„ã€‚æˆ‘ä»¬çœ‹ä¸‹è¯¥æ–‡ä»¶çš„å†…å®¹ã€‚\n\n\u0060\u0060\u0060yaml\nstatic_resources:\n  listeners:\n  - address:\n      socket_address:\n        address: 0.0.0.0\n        port_value: 80\n    filter_chains:\n    - filters:\n      - name: envoy.http_connection_manager\n        config:\n          codec_type: auto\n          stat_prefix: ingress_http\n          route_config:\n            name: local_route\n            virtual_hosts:\n            - name: backend\n              domains:\n              - \u0022*\u0022\n              routes:\n              - match:\n                  prefix: \u0022\/service\/1\u0022\n                route:\n                  cluster: service1\n              - match:\n                  prefix: \u0022\/service\/2\u0022\n                route:\n                  cluster: service2\n          http_filters:\n          - name: envoy.router\n            config: {}\n  clusters:\n  - name: service1\n    connect_timeout: 0.25s\n    type: strict_dns\n    lb_policy: round_robin\n    http2_protocol_options: {}\n    hosts:\n    - socket_address:\n        address: service1\n        port_value: 80\n  - name: service2\n    connect_timeout: 0.25s\n    type: strict_dns\n    lb_policy: round_robin\n    http2_protocol_options: {}\n    hosts:\n    - socket_address:\n        address: service2\n        port_value: 80\nadmin:\n  access_log_path: \u0022\/dev\/null\u0022\n  address:\n    socket_address:\n      address: 0.0.0.0\n      port_value: 8001\n\u0060\u0060\u0060\n\næˆ‘ä»¬çœ‹åˆ°å…¶ä¸­åŒ…æ‹¬äº†ä¸‰å¤§é…ç½®é¡¹ï¼š\n\n- **static_resources**ï¼šè·¯ç”±é…ç½®ä¿¡æ¯\n- **cluster**ï¼šenvoymesh çš„æœåŠ¡æ³¨å†Œä¿¡æ¯\n- **admin**ï¼šç®¡ç†æ¥å£ï¼Œå¯ä»¥é€šè¿‡è®¿é—® 8001 ç«¯å£çš„ï¼Œè®¿é—® \u0060\/stats\u0060  è·å–å½“å‰ envoymesh çš„ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¿é—® \u0060\/server_info\u0060 è·å– Envoy çš„ç‰ˆæœ¬ä¿¡æ¯\n\nä½¿ç”¨ \u0060docker-compose\u0060 å¯åŠ¨ä¸‰ä¸ªå®¹å™¨ã€‚\n\n\u0060\u0060\u0060bash\n$ pwd\nenvoy\/examples\/front-proxy\n$ docker-compose up --build -d\n$ docker-compose ps\n        Name                       Command               State      Ports\n-------------------------------------------------------------------------------------------------------------\nexample_service1_1      \/bin\/sh -c \/usr\/local\/bin\/ ... Up       80\/tcp\nexample_service2_1      \/bin\/sh -c \/usr\/local\/bin\/ ... Up       80\/tcp\nexample_front-envoy_1   \/bin\/sh -c \/usr\/local\/bin\/ ... Up       0.0.0.0:8000-\u003e80\/tcp, 0.0.0.0:8001-\u003e8001\/tcp\n\u0060\u0060\u0060\n\næˆ‘ä»¬ä¸‹é¢å°†è¿‡ä¸€é Envoy ä½œä¸ºå‰ç«¯ä»£ç†çš„æ‰€æœ‰åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½æ˜¯é€šç”¨åŠŸèƒ½ã€‚\n\n### è·¯ç”±\n\nè®¿é—® service1 \u003chttp:\/\/localhost:8000\/service\/1\u003e å°†çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºã€‚\n\n\u0060\u0060\u0060bash\n$ curl -v localhost:8000\/service\/1\n* \nTrying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 8000 (#0)\n\u003e GET \/service\/1 HTTP\/1.1\n\u003e Host: localhost:8000\n\u003e User-Agent: curl\/7.54.0\n\u003e Accept: *\/*\n\u003e\n\u003c HTTP\/1.1 200 OK\n\u003c content-type: text\/html; charset=utf-8\n\u003c content-length: 89\n\u003c server: envoy\n\u003c date: Fri, 20 Apr 2018 08:26:33 GMT\n\u003c x-envoy-upstream-service-time: 14\n\u003c\nHello from behind Envoy (service 1)! hostname: a3e4185a9a49 resolvedhostname: 172.18.0.4\n* Connection #0 to host localhost left intact\n\u0060\u0060\u0060\n\nè®¿é—® service2 \u003chttp:\/\/localhost:8000\/service\/2\u003e å°†çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºã€‚\n\n\u0060\u0060\u0060bash\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 8000 (#0)\n\u003e GET \/service\/2 HTTP\/1.1\n\u003e Host: localhost:8000\n\u003e User-Agent: curl\/7.54.0\n\u003e Accept: *\/*\n\u003e\n\u003c HTTP\/1.1 200 OK\n\u003c content-type: text\/html; charset=utf-8\n\u003c content-length: 89\n\u003c server: envoy\n\u003c date: Fri, 20 Apr 2018 08:27:27 GMT\n\u003c x-envoy-upstream-service-time: 10\n\u003c\nHello from behind Envoy (service 2)! hostname: f6650e1911a0 resolvedhostname: 172.18.0.3\n* Connection #0 to host localhost left intact\n\u0060\u0060\u0060\n\næˆ‘ä»¬çœ‹åˆ°è®¿é—®è¯·æ±‚è¢«è·¯ç”±åˆ°äº†æ­£ç¡®çš„æœåŠ¡åç«¯ã€‚\n\n### è´Ÿè½½å‡è¡¡\n\nå¢åŠ  service1 çš„ç¤ºä¾‹æ•°ã€‚\n\n\u0060\u0060\u0060bash\n$ docker-compose scale service1=3\nWARNING: The scale command is deprecated. Use the up command with the --scale flag instead.\nStarting frontproxy_service1_1 ... done\nCreating frontproxy_service1_2 ... done\nCreating frontproxy_service1_3 ... done\n\n$ docker-compose ps\n          Name                        Command               State                            Ports\n---------------------------------------------------------------------------------------------------------------------------\nfrontproxy_front-envoy_1   \/usr\/bin\/dumb-init -- \/bin ...   Up      10000\/tcp, 0.0.0.0:8000-\u003e80\/tcp, 0.0.0.0:8001-\u003e8001\/tcp\nfrontproxy_service1_1      \/bin\/sh -c \/usr\/local\/bin\/ ...   Up      10000\/tcp, 80\/tcp\nfrontproxy_service1_2      \/bin\/sh -c \/usr\/local\/bin\/ ...   Up      10000\/tcp, 80\/tcp\nfrontproxy_service1_3      \/bin\/sh -c \/usr\/local\/bin\/ ...   Up      10000\/tcp, 80\/tcp\nfrontproxy_service2_1      \/bin\/sh -c \/usr\/local\/bin\/ ...   Up      10000\/tcp, 80\/tcp\n\u0060\u0060\u0060\n\næˆ‘ä»¬çœ‹åˆ°ç°åœ¨ service1 å·²ç»æœ‰äº† 3 ä¸ªå®ä¾‹ï¼Œç°åœ¨å†è®¿é—® service1 \u003chttp:\/\/localhost:8000\/service\/1\u003eã€‚\n\n\u0060\u0060\u0060bash\n$ while true;do curl localhost:8000\/service\/1;sleep 1;done\nHello from behind Envoy (service 1)! hostname: a3e4185a9a49 resolvedhostname: 172.18.0.4\nHello from behind Envoy (service 1)! hostname: fe44dba64122 resolvedhostname: 172.18.0.5\nHello from behind Envoy (service 1)! hostname: c5b9f1289e0f resolvedhostname: 172.18.0.6\nHello from behind Envoy (service 1)! hostname: a3e4185a9a49 resolvedhostname: 172.18.0.4\nHello from behind Envoy (service 1)! hostname: fe44dba64122 resolvedhostname: 172.18.0.5\nHello from behind Envoy (service 1)! hostname: c5b9f1289e0f resolvedhostname: 172.18.0.6\n\u0060\u0060\u0060\n\næˆ‘ä»¬çœ‹åˆ°å¯¹ service1 çš„å·²ç»æœ‰è´Ÿè½½å‡è¡¡äº†ï¼Œä½¿ç”¨çš„ç­–ç•¥æ˜¯ \u0060round_robin\u0060ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ \u0060front-envoy.yaml\u0060 æ–‡ä»¶ä¸­çš„ \u0060cluster\u0060 é¡¹ä¸‹é…ç½®çš„ã€‚\n\n### admin ç«¯ç‚¹\n\nè®¿é—® \u003chttp:\/\/localhost:8001\u003e å¯ä»¥çœ‹åˆ° Envoy admin æä¾›ä»¥ä¸‹ç®¡ç† API ç«¯ç‚¹ã€‚\n\n| å‘½ä»¤                 | æè¿°                                     |\n| -------------------- | ---------------------------------------- |\n| \/                    | Admin ä¸»é¡µ                               |\n| \/certs               | æ‰“å°æœºå™¨ä¸Šçš„ certs                       |\n| \/clusters            | upstream cluster çŠ¶æ€                    |\n| \/config_dump         | è¾“å‡ºå½“å‰çš„ Envoy é…ç½®                    |\n| \/cpuprofiler         | å¼€å¯\/å…³é—­ CPU profiler                   |\n| \/healthcheck\/fail    | å¯¼è‡´æœåŠ¡å¤±è´¥å¥åº·æ£€æŸ¥                     |\n| \/healthcheck\/ok      | å¯¼è‡´æœåŠ¡é€šè¿‡å¥åº·æ£€æŸ¥                     |\n| \/help                | æ‰“å°ç®¡ç†å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯                   |\n| \/hot_restart_version | æ‰“å°çƒ­é‡å¯å…¼å®¹ç‰ˆæœ¬                       |\n| \/listeners           | æ‰“å° listener åœ°å€                       |\n| \/logging             | æŸ¥è¯¢\/æ›´æ”¹æ—¥å¿—çº§åˆ«                        |\n| \/quitquitquit        | é€€å‡ºæœåŠ¡                                 |\n| \/reset_counters      | å°†è®¡æ•°å™¨é‡ç½®ä¸º 1                         |\n| \/runtime             | æ‰“å°è¿è¡Œæ—¶å€¼                             |\n| \/runtime_modify      | ä¿®æ”¹è¿è¡Œæ—¶å€¼                             |\n| \/server_info         | æ‰“å°æœåŠ¡å™¨ç‰ˆæœ¬\/çŠ¶æ€ä¿¡æ¯                  |\n| \/stats               | æ‰“å°æœåŠ¡å™¨çŠ¶æ€ç»Ÿè®¡ä¿¡æ¯                   |\n| \/stats\/prometheus    | æ‰“å° prometheus æ ¼å¼çš„æœåŠ¡å™¨çŠ¶æ€ç»Ÿè®¡ä¿¡æ¯ |\n\nEnvoy æä¾›äº† API ç®¡ç†ç«¯ç‚¹ï¼Œå¯ä»¥å¯¹ Envoy è¿›è¡ŒåŠ¨æ€é…ç½®ï¼Œå‚è€ƒ v2 API referenceã€‚\n\n## å‚è€ƒ\n\n- Front proxy\n', '\/blog\/envoy-as-front-proxy\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡æ˜¯ä½¿ç”¨ Envoy ä½œä¸ºå‰ç«¯ä»£ç†çš„ä»‹ç»ï¼Œä»…ä½¿ç”¨ docker å®¹å™¨å’Œ docker-compose åšç¼–æ’åœ¨å•æœºä¸­è¿è¡Œï¼Œå¸®åŠ©æˆ‘ä»¬ä»æ›´åº•å±‚äº†è§£ Envoyï¼Œå½“æˆ‘ä»¬å°† Envoy ä½œä¸º Istio Service Mesh çš„ data panel çš„æ—¶å€™å°†æ›´åŠ æ¸¸åˆƒæœ‰ä½™ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     <li class="page-item">
       <a class="page-link" href="/tags/envoy/">
         Â«Â«
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a href="/tags/envoy/page/2/" class="page-link">
         Â«
       </a>
     </li>
     
     
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/tags/envoy/" class="page-link">
             1
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/tags/envoy/page/2/" class="page-link">
             2
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item page-item active ">
           <a href="/tags/envoy/page/3/" class="page-link">
             3
           </a>
         </li>
       
     
     
     
     
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      ä¸“æ 
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(70)</span>
        </a>
      
        <a href="/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(41)</span>
        </a>
      
        <a href="/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(24)</span>
        </a>
      
        <a href="/categories/%e9%9a%8f%e7%ac%94" class="sidebar-item">
            <span>éšç¬”</span>
            <span>(21)</span>
        </a>
      
        <a href="/categories/%e4%b8%9a%e6%80%81" class="sidebar-item">
            <span>ä¸šæ€</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e5%85%b6%e4%bb%96" class="sidebar-item">
            <span>å…¶ä»–</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(16)</span>
        </a>
      
        <a href="/categories/%e4%ba%91%e5%8e%9f%e7%94%9f" class="sidebar-item">
            <span>äº‘åŸç”Ÿ</span>
            <span>(14)</span>
        </a>
      
        <a href="/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%ae%89%e5%85%a8" class="sidebar-item">
            <span>å®‰å…¨</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%bc%80%e6%ba%90" class="sidebar-item">
            <span>å¼€æº</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7" class="sidebar-item">
            <span>å¯è§‚æµ‹æ€§</span>
            <span>(5)</span>
        </a>
      
        <a href="/categories/%e6%97%85%e8%a1%8c" class="sidebar-item">
            <span>æ—…è¡Œ</span>
            <span>(5)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      èµ„æ–™
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/%e5%87%ba%e7%89%88%e7%89%a9" class="sidebar-item">
            <span>å‡ºç‰ˆç‰©</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e7%94%b5%e5%ad%90%e4%b9%a6" class="sidebar-item">
            <span>ç¿»è¯‘ç”µå­ä¹¦</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e6%96%87%e6%a1%a3" class="sidebar-item">
            <span>ç¿»è¯‘æ–‡æ¡£</span>
            <span>(7)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>ç¿»è¯‘å›¾ä¹¦</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8e%9f%e5%88%9b%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>åŸåˆ›å›¾ä¹¦</span>
            <span>(2)</span>
        </a>
      
        <a href="/categories/%e6%95%99%e7%a8%8b%e6%89%8b%e5%86%8c" class="sidebar-item">
            <span>æ•™ç¨‹æ‰‹å†Œ</span>
            <span>(1)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">è”ç³»</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">å¾®ä¿¡å…¬ä¼—å·</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">åšå®¢</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/service-mesh-data-plane-deployment-modes/">æ·±å…¥è§£ææœåŠ¡ç½‘æ ¼çš„å››ç§æ•°æ®å¹³é¢éƒ¨ç½²æ¨¡å¼ï¼šæ€§èƒ½ã€å®‰å…¨æ€§ä¸æˆæœ¬åˆ†æ</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/service-mesh-sidecar-vs-sidecarless-debate/">æœåŠ¡ç½‘æ ¼æ¶æ„ï¼šSidecar vs. Sidecarlessï¼Œè°æ‰æ˜¯æœªæ¥ï¼Ÿ</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/hong-kong-trip/">é¦™æ¸¯â€”â€”å†…åœ°çš„ä¸€é¢çš„é•œå­</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">é“¾æ¥</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio æœåŠ¡ç½‘æ ¼
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate å…¬å¸
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿå­¦é™¢|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿå¼€æºé¡¹ç›®å¤§å…¨
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">æ•™ç¨‹</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy åŸºç¡€æ•™ç¨‹
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio åŸºç¡€æ•™ç¨‹
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes åŸºç¡€æ•™ç¨‹
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">é€šçŸ¥</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/nist-sp-800-233-service-mesh-proxy-models/">èµ„æ–™åˆ†äº«ï¼šäº‘åŸç”Ÿåº”ç”¨æœåŠ¡ç½‘æ ¼ä»£ç†æ¨¡å‹çš„å¨èƒåˆ†ææŒ‡å—</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/kubecon-china-2024-panel/">KubeCon China 2024ï¼ˆé¦™æ¸¯ï¼‰</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/website-revamp-notice/">ç½‘ç«™æ”¹ç‰ˆé€šçŸ¥</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">Â© 2017-2024 Jimmy Song ä¿ç•™æ‰€æœ‰æƒåˆ©</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>









<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
