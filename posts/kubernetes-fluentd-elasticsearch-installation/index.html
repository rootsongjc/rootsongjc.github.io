<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title> ä½¿ç”¨Fluentdå’ŒElasticSearchæ”¶é›†Kubernetesé›†ç¾¤æ—¥å¿— - Cloud NativeğŸ¤˜Big Data</title>
  <meta name="description" content="Cloud NativeğŸ¤˜Big Data" />
  <meta property="og:title" content="ä½¿ç”¨Fluentdå’ŒElasticSearchæ”¶é›†Kubernetesé›†ç¾¤æ—¥å¿—" />
  <meta name="twitter:title" content="ä½¿ç”¨Fluentdå’ŒElasticSearchæ”¶é›†Kubernetesé›†ç¾¤æ—¥å¿—" />
  <meta name="description" content="ï¼ˆé¢˜å›¾ï¼šç å¤´@å¤åŒ—æ°´é•‡ Apr 30,2016ï¼‰ å‰è¨€ åœ¨å®‰è£…å¥½äº†Kubernetesé›†ç¾¤ã€é…ç½®å¥½äº†flannelç½‘ç»œã€å®‰è£…äº†Kubernetes Das">
  <meta property="og:description" content="ï¼ˆé¢˜å›¾ï¼šç å¤´@å¤åŒ—æ°´é•‡ Apr 30,2016ï¼‰ å‰è¨€ åœ¨å®‰è£…å¥½äº†Kubernetesé›†ç¾¤ã€é…ç½®å¥½äº†flannelç½‘ç»œã€å®‰è£…äº†Kubernetes Das">
  <meta name="twitter:description" content="ï¼ˆé¢˜å›¾ï¼šç å¤´@å¤åŒ—æ°´é•‡ Apr 30,2016ï¼‰ å‰è¨€ åœ¨å®‰è£…å¥½äº†Kubernetesé›†ç¾¤ã€é…ç½®å¥½äº†flannelç½‘ç»œã€å®‰è£…äº†Kubernetes Das">
  <meta name="author" content="{Description { .Site.Author.name }}"/>
  <link href='https://jimmysong.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://jimmysong.io/img/avatar-icon.png" />
  <meta name="twitter:image" content="https://jimmysong.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@jimmysongio" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/posts/kubernetes-fluentd-elasticsearch-installation/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Jimmy Song" />

  <meta name="generator" content="Hugo 0.30-DEV" />
  <link rel="canonical" href="https://jimmysong.io/posts/kubernetes-fluentd-elasticsearch-installation/" />
  <link rel="alternate" href="https://jimmysong.io/index.xml" type="application/rss+xml" title="Jimmy Song">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="https://jimmysong.io/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  

<meta name="baidu-site-verification" content="g8IYR9SNLF" />
<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>

<link rel="stylesheet" href="https://jimmysong.io/css/prism.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://jimmysong.io/">Jimmy Song</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Articles</a>
              <div class="navlinks-children">
                
                  <a href="/posts">Posts</a>
                
                  <a href="/tags">Tags</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Categories</a>
              <div class="navlinks-children">
                
                  <a href="/categories/kubernetes">kubernetes</a>
                
                  <a href="/categories/cloud-native">Cloud Native</a>
                
                  <a href="/categories/github">Github</a>
                
                  <a href="/categories/devops">Devops</a>
                
                  <a href="/categories/docker">Docker</a>
                
                  <a href="/categories/code">Code</a>
                
                  <a href="/categories/architecture/">Architecture</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Books</a>
              <div class="navlinks-children">
                
                  <a href="/cloud-native-go">Cloud Native Go</a>
                
                  <a href="/posts/cloud-native-python">Cloud Native Python</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Projects</a>
              <div class="navlinks-children">
                
                  <a href="/kubernetes-handbook">Kubernetes handbook</a>
                
                  <a href="/spark-on-k8s">Spark on kubernetes</a>
                
                  <a href="/awesome-cloud-native">Awesome Cloud Native</a>
                
                  <a href="/migrating-to-cloud-native-application-architectures"> Migrating to Cloud native</a>
                
                  <a href="http://istio.doczh.cn">Istio service mesh</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/about">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Jimmy Song" href="https://jimmysong.io/">
            <img class="avatar-img" src="https://jimmysong.io/img/avatar-icon.png" alt="Jimmy Song" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
            
          <div class="col-lg-12 col-md-12 col-md-offset-0">
            <div class="posts-heading">
                <h1 align="center">ä½¿ç”¨Fluentdå’ŒElasticSearchæ”¶é›†Kubernetesé›†ç¾¤æ—¥å¿—</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            
            <div>
                <section id="datecount">
                    <h4 id="date"> Fri Apr 7, 2017</h4>
                </section>
                <h5 id="wc">3700 Words|Read in about 8 Min</h5>
                <h5 id="tags">Tags: 
                    <a href="https://jimmysong.io//tags/kubernetes">kubernetes</a> &nbsp;
                    <a href="https://jimmysong.io//tags/fluentd">fluentd</a> &nbsp;
                    <a href="https://jimmysong.io//tags/elasticsearch">elasticsearch</a> &nbsp;
                </h5>

            </div>
            <article role="main" class="blog-post">
                

<p><img src="https://res.cloudinary.com/jimmysong/image/upload/images/20160430080.jpg" alt="å¤åŒ—æ°´é•‡" /></p>

<p><em>ï¼ˆé¢˜å›¾ï¼šç å¤´@å¤åŒ—æ°´é•‡ Apr 30,2016ï¼‰</em></p>

<h2 id="å‰è¨€">å‰è¨€</h2>

<p>åœ¨<a href="https://jimmysong.io/blogs/kubernetes-installation-on-centos/">å®‰è£…å¥½äº†Kubernetesé›†ç¾¤</a>ã€<a href="https://jimmysong.io/blogs/kubernetes-network-config/">é…ç½®å¥½äº†flannelç½‘ç»œ</a>ã€<a href="https://jimmysong.io/blogs/kubernetes-dashboard-installation/">å®‰è£…äº†Kubernetes Dashboard</a>å’Œ<a href="https://jimmysong.io/blogs/kubernetes-heapster-installation/">é…ç½®Heapsterç›‘æ§æ’ä»¶</a>åï¼Œè¿˜æœ‰ä¸€é¡¹é‡è¦çš„å·¥ä½œï¼Œä¸ºäº†è°ƒè¯•å’Œæ•…éšœæ’æŸ¥ï¼Œè¿˜éœ€è¦è¿›è¡Œæ—¥å¿—æ”¶é›†å·¥ä½œã€‚</p>

<p><strong>å®˜æ–¹æ–‡æ¡£</strong></p>

<p><a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/">Kubernetes Logging and Monitoring Cluster Activity</a></p>

<p><a href="https://kubernetes.io/docs/tasks/debug-application-cluster/logging-elasticsearch-kibana/">Logging Using Elasticsearch and Kibana</a>ï¼šä¸è¿‡è¿™ç¯‡æ–‡ç« æ˜¯åœ¨GCEä¸Šé…ç½®çš„ï¼Œå‚è€ƒä»·å€¼ä¸å¤§ã€‚</p>

<h2 id="å®¹å™¨æ—¥å¿—çš„å­˜åœ¨å½¢å¼">å®¹å™¨æ—¥å¿—çš„å­˜åœ¨å½¢å¼</h2>

<p>ç›®å‰å®¹å™¨æ—¥å¿—æœ‰ä¸¤ç§è¾“å‡ºå½¢å¼ï¼š</p>

<p><strong>stdout,stderræ ‡å‡†è¾“å‡º</strong></p>

<p>è¿™ç§å½¢å¼çš„æ—¥å¿—è¾“å‡ºæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>docker logs</code>æŸ¥çœ‹æ—¥å¿—ï¼Œkubernetesé›†ç¾¤ä¸­åŒæ ·å¯ä»¥ä½¿ç”¨<code>kubectl logs</code>ç±»ä¼¼çš„å½¢å¼æŸ¥çœ‹æ—¥å¿—ã€‚</p>

<p><strong>æ—¥å¿—æ–‡ä»¶è®°å½•</strong></p>

<p>è¿™ç§æ—¥å¿—è¾“å‡ºæˆ‘ä»¬æ— æ³•ä»ä»¥ä¸Šæ–¹æ³•æŸ¥çœ‹æ—¥å¿—å†…å®¹ï¼Œåªèƒ½<code>tail</code>æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹ã€‚</p>

<h2 id="fluentdä»‹ç»">Fluentdä»‹ç»</h2>

<p><a href="https://github.com/fluent/fluentd">Fluentd</a>æ˜¯ä½¿ç”¨Rubyç¼–å†™çš„ï¼Œé€šè¿‡åœ¨åç«¯ç³»ç»Ÿä¹‹é—´æä¾›<strong>ç»Ÿä¸€çš„æ—¥å¿—è®°å½•å±‚</strong>æ¥ä»åç«¯ç³»ç»Ÿä¸­è§£è€¦æ•°æ®æºã€‚
æ­¤å±‚å…è®¸å¼€å‘äººå‘˜å’Œæ•°æ®åˆ†æäººå‘˜åœ¨ç”Ÿæˆæ—¥å¿—æ—¶ä½¿ç”¨å¤šç§ç±»å‹çš„æ—¥å¿—ã€‚
ç»Ÿä¸€çš„æ—¥å¿—è®°å½•å±‚å¯ä»¥è®©æ‚¨å’Œæ‚¨çš„ç»„ç»‡æ›´å¥½åœ°ä½¿ç”¨æ•°æ®ï¼Œå¹¶æ›´å¿«åœ°åœ¨æ‚¨çš„è½¯ä»¶ä¸Šè¿›è¡Œè¿­ä»£ã€‚
ä¹Ÿå°±æ˜¯è¯´fluentdæ˜¯ä¸€ä¸ªé¢å‘å¤šç§æ•°æ®æ¥æºä»¥åŠé¢å‘å¤šç§æ•°æ®å‡ºå£çš„æ—¥å¿—æ”¶é›†å™¨ã€‚å¦å¤–å®ƒé™„å¸¦äº†æ—¥å¿—è½¬å‘çš„åŠŸèƒ½ã€‚</p>

<p><img src="https://camo.githubusercontent.com/c4abfe337c0b54b36f81bce78481f8965acbc7a9/687474703a2f2f646f63732e666c75656e74642e6f72672f696d616765732f666c75656e74642d6172636869746563747572652e706e67" alt="arch" /></p>

<p>Fluentdæ”¶é›†çš„<strong>event</strong>ç”±ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ç»„æˆï¼š</p>

<ul>
<li><strong>Tag</strong>ï¼šå­—ç¬¦ä¸²ï¼Œä¸­é—´ç”¨ç‚¹éš”å¼€ï¼Œå¦‚myapp.access</li>
<li><strong>Time</strong>ï¼šUNIXæ—¶é—´æ ¼å¼</li>
<li><strong>Record</strong>ï¼šJSONæ ¼å¼</li>
</ul>

<h3 id="fluentdç‰¹ç‚¹">Fluentdç‰¹ç‚¹</h3>

<ol>
<li>éƒ¨ç½²ç®€å•çµæ´»</li>
<li>å¼€æº</li>
<li>ç»è¿‡éªŒè¯çš„å¯é æ€§å’Œæ€§èƒ½</li>
<li>ç¤¾åŒºæ”¯æŒï¼Œæ’ä»¶è¾ƒå¤š</li>
<li>ä½¿ç”¨jsonæ ¼å¼äº‹ä»¶æ ¼å¼</li>
<li>å¯æ‹”æ’çš„æ¶æ„è®¾è®¡</li>
<li>ä½èµ„æºè¦æ±‚</li>
<li>å†…ç½®é«˜å¯é æ€§</li>
</ol>

<h2 id="å®‰è£…">å®‰è£…</h2>

<p>æŸ¥çœ‹<code>cluster/addons/fluentd-elasticsearch</code>æ’ä»¶ç›®å½•ï¼Œè·å–åˆ°éœ€è¦ç”¨åˆ°çš„dockeré•œåƒåç§°ã€‚</p>

<pre><code class="language-Bash">$grep -rn &quot;gcr.io&quot; *.yaml
es-controller.yaml:24:      - image: gcr.io/google_containers/elasticsearch:v2.4.1-2
fluentd-es-ds.yaml:26:        image: gcr.io/google_containers/fluentd-elasticsearch:1.22
kibana-controller.yaml:22:        image: gcr.io/google_containers/kibana:v4.6.1-1
</code></pre>

<p><strong>éœ€è¦ç”¨åˆ°çš„é•œåƒ</strong></p>

<ul>
<li>gcr.io/google_containers/kibana:v4.6.1-1</li>
<li>gcr.io/google_containers/elasticsearch:v2.4.1-2</li>
<li>gcr.io/google_containers/fluentd-elasticsearch:1.22</li>
</ul>

<p>å› ä¸ºè¿™äº›é•œåƒåœ¨å¢™å¤–ï¼Œæ‰€ä»¥æˆ‘ç‰¹æ„å¤‡ä»½äº†ä¸€ä»½åœ¨æœ¬åœ°è¿˜æœ‰æ—¶é€Ÿäº‘ä¸Šã€‚</p>

<p><strong>æµ‹è¯•ç¯å¢ƒé•œåƒåç§°</strong></p>

<pre><code class="language-ini">sz-pg-oam-docker-hub-001.tendcloud.com/library/elasticsearch:v2.4.1-2
sz-pg-oam-docker-hub-001.tendcloud.com/library/kibana:v4.6.1-1
sz-pg-oam-docker-hub-001.tendcloud.com/library/fluentd-elasticsearch:1.22
</code></pre>

<p><strong>å¤‡ä»½åˆ°æ—¶é€Ÿäº‘ä¸Šçš„é•œåƒåç§°</strong></p>

<pre><code class="language-ini">index.tenxcloud.com/jimmy/elasticsearch:v2.4.1-2
index.tenxcloud.com/jimmy/kibana:v4.6.1-1
index.tenxcloud.com/jimmy/fluentd-elasticsearch:1.22
</code></pre>

<p>ä¿®æ”¹ä¸Šé¢çš„é‚£ä¸‰ä¸ªyamlæ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„é•œåƒåç§°æ”¹æˆæˆ‘ä»¬æµ‹è¯•ç¯å¢ƒä¸­çš„ã€‚</p>

<h3 id="å¯åŠ¨é›†ç¾¤">å¯åŠ¨é›†ç¾¤</h3>

<p>ä½¿ç”¨åˆšä¿®æ”¹å¥½yamlæ–‡ä»¶çš„é‚£ä¸ªç›®å½•å¯åŠ¨fluentd-elasticsearchã€‚</p>

<pre><code class="language-bash">$kubectl create -f flucentd-elasticsearch
$kubectl get -f fluentd-elasticsearch/
NAME                          DESIRED   CURRENT   READY     AGE
rc/elasticsearch-logging-v1   2         2         2         13m

NAME                        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
svc/elasticsearch-logging   10.254.107.114   &lt;none&gt;        9200/TCP   13m

NAME                  DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE-SELECTOR                              AGE
ds/fluentd-es-v1.22   0         0         0         0            0           beta.kubernetes.io/fluentd-ds-ready=true   13m

NAME                    DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deploy/kibana-logging   1         1         1            1           13m

NAME                 CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
svc/kibana-logging   10.254.104.215   &lt;none&gt;        5601/TCP   13m

$kubectl cluster-info
Kubernetes master is running at http://sz-pg-oam-docker-test-001:8080
Elasticsearch is running at http://sz-pg-oam-docker-test-001:8080/api/v1/proxy/namespaces/kube-system/services/elasticsearch-logging
Heapster is running at http://sz-pg-oam-docker-test-001:8080/api/v1/proxy/namespaces/kube-system/services/heapster
Kibana is running at http://sz-pg-oam-docker-test-001:8080/api/v1/proxy/namespaces/kube-system/services/kibana-logging
monitoring-grafana is running at http://sz-pg-oam-docker-test-001:8080/api/v1/proxy/namespaces/kube-system/services/monitoring-grafana
monitoring-influxdb is running at http://sz-pg-oam-docker-test-001:8080/api/v1/proxy/namespaces/kube-system/services/monitoring-influxdb

To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
</code></pre>

<p>å¯åŠ¨å®Œæˆï¼Œä½†æ˜¯æŸ¥çœ‹podçš„æ—¥å¿—åä¼šå‘ç°å‡ºé”™äº†ã€‚</p>

<p>å¦‚ä½•ä¿è¯æ¯ä¸ªèŠ‚ç‚¹å¯åŠ¨ä¸€ä¸ªFluentdå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨DaemonSetã€‚</p>

<h3 id="æ’é”™">æ’é”™</h3>

<p>æŸ¥çœ‹å¯åŠ¨çš„podã€‚</p>

<pre><code class="language-bash">$kubectl --namespace=kube-system get all
NAME                                       READY     STATUS    RESTARTS   AGE
po/elasticsearch-logging-v1-nshz2          1/1       Running   0          16m
po/elasticsearch-logging-v1-q515j          1/1       Running   0          16m
po/heapster-3669180046-06n3d               1/1       Running   0          23h
po/kibana-logging-4247188994-h8jxx         1/1       Running   0          16m
po/kubernetes-dashboard-1074266307-hsgxx   1/1       Running   0          1d
po/monitoring-grafana-127711743-xl9v1      1/1       Running   0          23h
po/monitoring-influxdb-1411048194-cvxmm    1/1       Running   0          23h
</code></pre>

<p>åº”è¯¥åœ¨ä¸ªnodeèŠ‚ç‚¹ä¸Šå¯åŠ¨çš„<strong>fluentd</strong>æ²¡æœ‰çœ‹åˆ°ã€‚æŸ¥çœ‹logging podçš„æ—¥å¿—ã€‚</p>

<pre><code class="language-bash">$kubectl -n kube-system logs po/elasticsearch-logging-v1-nshz2
F0406 08:30:05.488197       7 elasticsearch_logging_discovery.go:49] Failed to make client: open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
goroutine 1 [running]:
...
[2017-04-06 08:30:23,450][WARN ][discovery.zen.ping.unicast] [elasticsearch-logging-v1-nshz2] failed to send ping to [{#zen_unicast_1#}{127.0.0.1}{127.0.0.1:9300}]
SendRequestTransportException[[][127.0.0.1:9300][internal:discovery/zen/unicast]]; nested: NodeNotConnectedException[[][127.0.0.1:9300] Node not connected];
	at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:340)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPingRequestToNode(UnicastZenPing.java:440)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPings(UnicastZenPing.java:426)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.ping(UnicastZenPing.java:240)
	at org.elasticsearch.discovery.zen.ping.ZenPingService.ping(ZenPingService.java:106)
	at org.elasticsearch.discovery.zen.ping.ZenPingService.pingAndWait(ZenPingService.java:84)
	at org.elasticsearch.discovery.zen.ZenDiscovery.findMaster(ZenDiscovery.java:945)
	at org.elasticsearch.discovery.zen.ZenDiscovery.innerJoinCluster(ZenDiscovery.java:360)
	at org.elasticsearch.discovery.zen.ZenDiscovery.access$4400(ZenDiscovery.java:96)
	at org.elasticsearch.discovery.zen.ZenDiscovery$JoinThreadControl$1.run(ZenDiscovery.java:1296)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: NodeNotConnectedException[[][127.0.0.1:9300] Node not connected]
	at org.elasticsearch.transport.netty.NettyTransport.nodeChannel(NettyTransport.java:1141)
	at org.elasticsearch.transport.netty.NettyTransport.sendRequest(NettyTransport.java:830)
	at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:329)
	... 12 more
...
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŠ¥é”™ä¸­æœ‰è¿™æ ·çš„æè¿°ï¼š</p>

<pre><code class="language-bash">discovery.zen.ping.unicast failed to send ping to [{#zen_unicast_1#}{127.0.0.1}{127.0.0.1:9300}]
SendRequestTransportException[[internal:discovery/zen/unicast]]; nested: NodeNotConnectedException[ Node not connected]
</code></pre>

<p>è¿™é‡Œé¢æœ‰ä¸¤ä¸ªé”™è¯¯ï¼š</p>

<ul>
<li>æ— æ³•è®¿é—®åˆ°API Server</li>
<li>elasticsearchä¸¤ä¸ªèŠ‚ç‚¹é—´äº’pingå¤±è´¥</li>
</ul>

<p>è¿™ä¸ªæ˜¯é•œåƒä¸­çš„é…ç½®é—®é¢˜ï¼Œé…ç½®æ–‡ä»¶åœ¨<code>fluentd-es-image/td-agent.conf</code>ã€‚</p>

<p>å‚è€ƒ<a href="http://tonybai.com/2017/03/03/implement-kubernetes-cluster-level-logging-with-fluentd-and-elasticsearch-stack/">ä½¿ç”¨Fluentdå’ŒElasticSearch Stackå®ç°Kubernetesçš„é›†ç¾¤Logging</a>ï¼ŒTony Baiä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬äº†è§£ä¸‹<a href="https://kubernetes.io/docs/user-guide/configmap/">ConfigMap</a>è¿˜æœ‰<a href="https://github.com/fabric8io/fluent-plugin-kubernetes_metadata_filter">fluent-plugin-kubernetes_metadata_filter</a>ã€‚</p>

<p>å‚è€ƒæˆ‘çš„å¦ä¸€ç‰‡è¯‘æ–‡<a href="rootsongjc.github.io/blogs/kubernetes-configmap-introduction">Kubernetesä¸­ConfigMapè§£æ</a>ã€‚</p>

<h2 id="é—®é¢˜æ’æŸ¥">é—®é¢˜æ’æŸ¥</h2>

<p>å‰é¢å†™çš„æ˜¯ç›´æ¥ä½¿ç”¨<code>kubectl create -f flucentd-elasticsearch</code>å‘½ä»¤å¯åŠ¨æ•´ä¸ªfluentd+elasticsearché›†ç¾¤ï¼Œè¿™æ ·å¯åŠ¨çœ‹ä¼¼å¾ˆç®€å•ï¼Œä½†æ˜¯å¯¹äºé—®é¢˜æ’æŸ¥çš„æ—¶å€™ä¸ä¾¿äºæˆ‘ä»¬åˆ†æå‡ºé”™åŸå› ï¼Œå› ä¸ºä½ æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œå¯åŠ¨é¡ºåºï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬ä¾æ¬¡å¯åŠ¨æ¯ä¸ªæœåŠ¡ï¼Œçœ‹çœ‹èƒŒåéƒ½åšäº†ä»€ä¹ˆã€‚</p>

<h3 id="å¯åŠ¨fluentd">å¯åŠ¨fluentd</h3>

<p>é¦–å…ˆå¯åŠ¨fluentdæ”¶é›†æ—¥å¿—çš„æœåŠ¡ï¼Œä»<code>fluentd-es-ds.yaml</code>çš„é…ç½®ä¸­å¯ä»¥çœ‹åˆ°fluentdæ˜¯ä»¥<a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a>æ–¹å¼æ¥è¿è¡Œçš„ã€‚</p>

<p><strong>DaemonSetç®€ä»‹</strong></p>

<p>DaemonSetèƒ½å¤Ÿè®©æ‰€æœ‰ï¼ˆæˆ–è€…ä¸€äº›ç‰¹å®šï¼‰çš„NodeèŠ‚ç‚¹è¿è¡ŒåŒä¸€ä¸ªpodã€‚å½“èŠ‚ç‚¹åŠ å…¥åˆ°kubernetesé›†ç¾¤ä¸­ï¼Œpodä¼šè¢«ï¼ˆDaemonSetï¼‰è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå½“èŠ‚ç‚¹ä»kubernetesé›†ç¾¤ä¸­è¢«ç§»é™¤ï¼Œè¢«ï¼ˆDaemonSetï¼‰è°ƒåº¦çš„podä¼šè¢«ç§»é™¤ï¼Œå¦‚æœåˆ é™¤DaemonSetï¼Œæ‰€æœ‰è·Ÿè¿™ä¸ªDaemonSetç›¸å…³çš„podséƒ½ä¼šè¢«åˆ é™¤ã€‚</p>

<p><a href="http://www.dockerinfo.net/1139.html">DaemonSetè¯¦ç»†ä»‹ç»</a>ï¼Œè¿™æ˜¯å®˜æ–¹æ–‡æ¡£çš„ä¸­æ–‡ç¿»è¯‘ï¼Œå…¶ä¸­è¿˜æœ‰ç¤ºä¾‹ã€‚</p>

<p><strong>å¯åŠ¨fluentd</strong></p>

<pre><code class="language-bash">$kubectl create -f fluentd-es-ds.yaml
daemonset &quot;fluentd-es-v1.22&quot; created
$kubectl get -f fluentd-es-ds.yaml 
NAME               DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE-SELECTOR                              AGE
fluentd-es-v1.22   0         0         0         0            0           beta.kubernetes.io/fluentd-ds-ready=true   2m
</code></pre>

<p>æˆ‘ä»¬åœ¨æ²¡æœ‰ä¿®æ”¹<code>fluentd-es-ds.yaml</code>çš„æƒ…å†µä¸‹ç›´æ¥å¯åŠ¨fluentdï¼Œå®é™…ä¸Šä¸€ä¸ªPodä¹Ÿæ²¡æœ‰å¯åŠ¨èµ·æ¥ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º<strong>NODE-SELECTOR</strong>é€‰æ‹©çš„labelæ˜¯<code>beta.kubernetes.io/fluentd-ds-ready=true</code>ã€‚</p>

<p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹<strong>node</strong>çš„<strong>label</strong>ã€‚</p>

<pre><code class="language-bash">$kubectl describe node sz-pg-oam-docker-test-001.tendcloud.com
Name:			sz-pg-oam-docker-test-001.tendcloud.com
Role:			
Labels:			beta.kubernetes.io/arch=amd64
			beta.kubernetes.io/os=linux
			kubernetes.io/hostname=sz-pg-oam-docker-test-001.tendcloud.com
Annotations:		node.alpha.kubernetes.io/ttl=0
			volumes.kubernetes.io/controller-managed-attach-detach=true
</code></pre>

<p>æˆ‘ä»¬æ²¡æœ‰ç»™nodeè®¾ç½®<code>beta.kubernetes.io/fluentd-ds-ready=true</code>çš„labelï¼Œæ‰€ä»¥DaemonSetæ²¡æœ‰è°ƒåº¦ä¸Šå»ã€‚</p>

<p>æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç»™kubernetesé›†ç¾¤çš„ä¸‰ä¸ªnodeæ·»åŠ labelã€‚</p>

<pre><code class="language-bash">$kubectl label node sz-pg-oam-docker-test-001.tendcloud.com beta.kubernetes.io/fluentd-ds-ready=true
node &quot;sz-pg-oam-docker-test-001.tendcloud.com&quot; labeled
</code></pre>

<p>ç»™å¦å¤–ä¸¤ä¸ªnodeæ‰§è¡ŒåŒæ ·çš„æ“ä½œã€‚</p>

<p>ç°åœ¨å†æŸ¥çœ‹ä¸‹DaemonSetçš„çŠ¶æ€ã€‚</p>

<pre><code class="language-bash">$kubectl get -f fluentd-es-ds.yaml 
NAME               DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE-SELECTOR                              AGE
fluentd-es-v1.22   3         3         0         3            0           beta.kubernetes.io/fluentd-ds-ready=true   31m
</code></pre>

<p>ç°åœ¨å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªDeamonSetéƒ½å¯åŠ¨èµ·æ¥äº†ã€‚</p>

<p>æŸ¥çœ‹ä¸‹fluentdçš„æ—¥å¿—<code>/var/log/fluentd.log</code>ï¼Œæ—¥å¿—æ˜¯mountåˆ°æœ¬åœ°çš„ã€‚</p>

<pre><code class="language-bash">2017-04-07 03:53:42 +0000 [info]: adding match pattern=&quot;fluent.**&quot; type=&quot;null&quot;
2017-04-07 03:53:42 +0000 [info]: adding filter pattern=&quot;kubernetes.**&quot; type=&quot;kubernetes_metadata&quot;
2017-04-07 03:53:42 +0000 [error]: config error file=&quot;/etc/td-agent/td-agent.conf&quot; error=&quot;Invalid Kubernetes API v1 endpoint https://10.254.0.1:443/api: SSL_connect returned=1 errno=0 state=error: certificate verify failed&quot;
2017-04-07 03:53:42 +0000 [info]: process finished code=256
2017-04-07 03:53:42 +0000 [warn]: process died within 1 second. exit.
</code></pre>

<p>ä»æ—¥å¿—çš„æœ€åå‡ è¡Œä¸­å¯ä»¥çœ‹åˆ°ï¼Œ<code>Invalid Kubernetes API v1 endpoint https://10.254.0.1:443/api: SSL_connect returned=1 errno=0 state=error: certificate verify failed</code>è¿™æ ·çš„é”™è¯¯ï¼Œè¿™äº›éœ€è¦åœ¨<code>/etc/td-agent/td-agent.conf</code>æ–‡ä»¶ä¸­é…ç½®çš„ã€‚</p>

<p>ä½†æ˜¯è¿™äº›é…ç½®å·²ç»åœ¨åˆ›å»º<code>gcr.io/google_containers/fluentd-elasticsearch:1.22</code>é•œåƒï¼ˆè¯¥é•œåƒæ˜¯è¿è¡Œå¸¦æœ‰elasticsearchæ’ä»¶çš„fluentdçš„ï¼‰çš„æ—¶å€™å°±å·²ç»copyè¿›å»äº†ï¼Œä»<code>fluentd-elasticsearch/fluentd-es-image/Dockerfile</code>æ–‡ä»¶ä¸­å°±å¯ä»¥çœ‹åˆ°ï¼š</p>

<pre><code class="language-bash"># Copy the Fluentd configuration file.
COPY td-agent.conf /etc/td-agent/td-agent.conf
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="https://jimmysong.io/blogs/kubernetes-configmap-introduction/">ConfigMap</a>ï¼Œä¸ç”¨é‡æ–°å†buildé•œåƒï¼Œé€šè¿‡æ–‡ä»¶æŒ‚è½½çš„å½¢å¼æ›¿æ¢é•œåƒä¸­å·²æœ‰çš„td-agent.confæ–‡ä»¶ã€‚</p>

<p><a href="tonybai.com">Tony Bai</a>ç»™å‡ºçš„ä¸¤ç‚¹å»ºè®®ï¼š</p>

<ul>
<li>åœ¨åŸºäºtd-agent.confåˆ›å»ºconfigmapèµ„æºä¹‹å‰ï¼Œéœ€è¦å°†td-agent.confä¸­çš„æ³¨é‡Šè¡Œéƒ½åˆ æ‰ï¼Œå¦åˆ™ç”Ÿæˆçš„configmapçš„å†…å®¹å¯èƒ½ä¸æ­£ç¡®ï¼›</li>
<li>fluentd podå°†åˆ›å»ºåœ¨kube-systemä¸‹ï¼Œå› æ­¤ConfigMapèµ„æºä¹Ÿéœ€è¦åˆ›å»ºåœ¨kube-system namespaceä¸‹é¢ï¼Œå¦åˆ™kubectl createæ— æ³•æ‰¾åˆ°å¯¹åº”çš„ConfigMapã€‚</li>
</ul>

<p>åœ¨td-agent.confçš„é…ç½®æ–‡ä»¶çš„<filter kubernetes.**>ä¸­å¢åŠ ä¸¤æ¡é…ç½®é…ç½®ï¼š</p>

<pre><code class="language-bash">&lt;filter kubernetes.**&gt;
  type kubernetes_metadata
  kubernetes_url sz-pg-oam-docker-test-001.tendcloud.com:8080
  verify_ssl false
&lt;/filter&gt;
</code></pre>

<p><strong>åˆ›å»ºConfigMap</strong></p>

<pre><code class="language-bash">kubectl create configmap td-agent-config --from-file=fluentd-elasticsearch/fluentd-es-image/td-agent.conf -n kube-system
</code></pre>

<p>æŸ¥çœ‹åˆšåˆ›å»ºçš„ConfigMap</p>

<pre><code class="language-bash">$kubectl -n kube-system get configmaps td-agent-config -o yaml
apiVersion: v1
data:
  td-agent.conf: |
    &lt;match fluent.**&gt;
      type null
    &lt;/match&gt;
...
&lt;filter kubernetes.**&gt;
  type kubernetes_metadata
  kubernetes_url http://sz-pg-oam-docker-test-001.tendcloud.com:8080
  verify_ssl false
&lt;/filter&gt;
...
</code></pre>

<blockquote>
<p>âš ï¸ kubernetes_urlåœ°å€è¦åŠ ä¸Š<strong>http</strong>ã€‚</p>
</blockquote>

<p>ä¿®æ”¹<code>fluentd-es-ds.yaml</code>æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å¢åŠ <code>td-agent.conf</code>æ–‡ä»¶çš„volumeã€‚</p>

<p>è¯¥æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼š</p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: DaemonSet
metadata:
...
    spec:
     ...
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
        - name: td-agent-config
          mountPath: /etc/td-agent
...
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers
      - name: td-agent-config
        configMap:
          name: td-agent-config
</code></pre>

<p>å¯åŠ¨æ—¥å¿—æ”¶é›†æœåŠ¡</p>

<pre><code class="language-bash">kubectl create -f ./fluentd-elasticsearch
</code></pre>

<p>ç°åœ¨å†æŸ¥çœ‹<code>/var/log/fluentd.log</code>æ—¥å¿—é‡Œé¢å°±æ²¡æœ‰é”™è¯¯äº†ã€‚</p>

<p>æŸ¥çœ‹ä¸‹elasticsearch podæ—¥å¿—ï¼Œå‘ç°é‡Œé¢è¿˜æœ‰é”™è¯¯ï¼Œè·Ÿä»¥å‰çš„ä¸€æ ·ï¼š</p>

<pre><code class="language-bash">[2017-04-07 10:54:57,858][WARN ][discovery.zen.ping.unicast] [elasticsearch-logging-v1-wxd5f] failed to send ping to [{#zen_unicast_1#}{127.0.0.1}{127.0.0.1:9300}]
SendRequestTransportException[[][127.0.0.1:9300][internal:discovery/zen/unicast]]; nested: NodeNotConnectedException[[][127.0.0.1:9300] Node not connected];
	at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:340)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPingRequestToNode(UnicastZenPing.java:440)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPings(UnicastZenPing.java:426)
	at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.ping(UnicastZenPing.java:240)
	at org.elasticsearch.discovery.zen.ping.ZenPingService.ping(ZenPingService.java:106)
	at org.elasticsearch.discovery.zen.ping.ZenPingService.pingAndWait(ZenPingService.java:84)
	at org.elasticsearch.discovery.zen.ZenDiscovery.findMaster(ZenDiscovery.java:945)
	at org.elasticsearch.discovery.zen.ZenDiscovery.innerJoinCluster(ZenDiscovery.java:360)
	at org.elasticsearch.discovery.zen.ZenDiscovery.access$4400(ZenDiscovery.java:96)
	at org.elasticsearch.discovery.zen.ZenDiscovery$JoinThreadControl$1.run(ZenDiscovery.java:1296)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: NodeNotConnectedException[[][127.0.0.1:9300] Node not connected]
	at org.elasticsearch.transport.netty.NettyTransport.nodeChannel(NettyTransport.java:1141)
	at org.elasticsearch.transport.netty.NettyTransport.sendRequest(NettyTransport.java:830)
	at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:329)
</code></pre>

<p>æŸ¥çœ‹ä¸‹elasticsearch:v2.4.1-2é•œåƒçš„ä»£ç ï¼Œåœ¨<code>fluentd-elasticsearch/es-image</code>ç›®å½•ä¸‹ï¼Œè¯¥ç›®å½•ç»“æ„ï¼š</p>

<pre><code class="language-bash">config
Dockerfile
elasticsearch_logging_discovery.go
Makefile
run.sh
template-k8s-logstash.json
</code></pre>

<p>ä»<strong>Dockerfile</strong>ä¸­å¯ä»¥çœ‹åˆ°ï¼š</p>

<pre><code class="language-Dockerfile">RUN mkdir -p /elasticsearch/config/templates
COPY template-k8s-logstash.json /elasticsearch/config/templates/template-k8s-logstash.json

COPY config /elasticsearch/config

COPY run.sh /
COPY elasticsearch_logging_discovery /

RUN useradd --no-create-home --user-group elasticsearch \
    &amp;&amp; mkdir /data \
    &amp;&amp; chown -R elasticsearch:elasticsearch /elasticsearch

VOLUME [&quot;/data&quot;]
EXPOSE 9200 9300

CMD [&quot;/run.sh&quot;]
</code></pre>

<p>å°†æœ¬åœ°çš„<code>config</code>ç›®å½•ä½œä¸ºé…ç½®æ–‡ä»¶æ‹·è´åˆ°äº†é•œåƒé‡Œï¼Œ<code>run.sh</code>å¯åŠ¨è„šæœ¬ä¸­æœ‰ä¸‰è¡Œï¼š</p>

<pre><code class="language-shell">/elasticsearch_logging_discovery &gt;&gt; /elasticsearch/config/elasticsearch.yml
chown -R elasticsearch:elasticsearch /data
exec gosu elasticsearch /elasticsearch/bin/elasticsearch
</code></pre>

<p>æˆ‘ä»¬å†è¿›å…¥åˆ°é•œåƒé‡ŒæŸ¥çœ‹ä¸‹</p>

<pre><code class="language-ini">/elasticsearch/config/elasticsearch.yml
</code></pre>

<p>æ–‡ä»¶çš„å†…å®¹ã€‚</p>

<pre><code class="language-yaml">cluster.name: kubernetes-logging

node.name: ${NODE_NAME}
node.master: ${NODE_MASTER}
node.data: ${NODE_DATA}

transport.tcp.port: ${TRANSPORT_PORT}
http.port: ${HTTP_PORT}

path.data: /data

network.host: 0.0.0.0

discovery.zen.minimum_master_nodes: ${MINIMUM_MASTER_NODES}
discovery.zen.ping.multicast.enabled: false
</code></pre>

<p><strong>è®°å½•å‡ ä¸ªé—®é¢˜</strong></p>

<ul>
<li>Kubernetesä¸­çš„DNSæ²¡æœ‰é…ç½®ã€‚</li>
<li>ElasticSearchçš„é…ç½®æœ‰é—®é¢˜ã€‚</li>
<li>æ˜¯å¦è¦ç”¨ServiceAccountï¼Ÿ</li>
</ul>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<ul>
<li><a href="http://tonybai.com/2017/03/03/implement-kubernetes-cluster-level-logging-with-fluentd-and-elasticsearch-stack/">ä½¿ç”¨Fluentdå’ŒElasticSearch Stackå®ç°Kubernetesçš„é›†ç¾¤Logging</a></li>
<li><a href="https://my.oschina.net/newlife111/blog/714574">åœ¨Kubernetesä¸Šæ­å»ºEFKï¼ˆFluentdï¼‹Elasticsearchï¼‹Kibanaï¼‰</a></li>
<li><a href="http://www.cnblogs.com/muzhiye/p/elasticsearch_set_cluster.html">elasticsearch2.2 é›†ç¾¤æ­å»ºå„ç§å‘</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/addons/fluentd-elasticsearch/es-image/elasticsearch_logging_discovery.go">elasticsearch_logging_discovery.go</a></li>
<li><a href="https://github.com/fabric8io/fluent-plugin-kubernetes_metadata_filter">fluent-plugin-kubernetes_metadata_filter</a></li>
</ul>

<p><strong>To be continuedâ€¦</strong></p>

            </article>

            <ul class="pager blog-pager">
                
                <li class="previous">
                    <a href="https://jimmysong.io/posts/kubernetes-configmap-introduction/" data-toggle="tooltip" data-placement="top" title="Kubernetesçš„ConfigMapè§£æ">&larr; Previous Post</a>
                </li>
                 
                <li class="next">
                    <a href="https://jimmysong.io/posts/cloud-computing-architecture-practice/" data-toggle="tooltip" data-placement="top" title="äº‘è®¡ç®—æŠ€æœ¯æ¶æ„ä¸å®è·µï¼ˆç¬¬äºŒç‰ˆï¼‰è¯»åæ„Ÿ">Next Post &rarr;</a>
                </li>
                
            </ul>
            <div>
                 
                <h2>See Also</h2>
                <ul>
                    
                    <li><a href="/posts/kubernetes-configmap-introduction/">Kubernetesçš„ConfigMapè§£æ</a></li>
                    
                    <li><a href="/posts/kubernetes-heapster-installation/">Kubernetes heapsterç›‘æ§æ’ä»¶å®‰è£…æ–‡æ¡£</a></li>
                    
                    <li><a href="/posts/kubernetes-dashboard-installation/">Kubernetes Dashboard/Web UIå®‰è£…å…¨è®°å½•</a></li>
                    
                    <li><a href="/posts/kubernetes-network-config/">KubernetesåŸºäºflannelçš„ç½‘ç»œé…ç½®</a></li>
                    
                    <li><a href="/posts/kubernetes-installation-on-centos/">åœ¨CentOSä¸Šå®‰è£…kubernetesè¯¦ç»†æŒ‡å—</a></li>
                    
                </ul>
                
            </div>
            
            <div>
                <section id="datecount">
                    <h4 id="date"> Fri Apr 7, 2017</h4>
                </section>
                <h5 id="wc">3700 Words|Read in about 8 Min</h5>
                <h5 id="tags">Tags: 
                    <a href="https://jimmysong.io//tags/kubernetes">kubernetes</a> &nbsp;
                    <a href="https://jimmysong.io//tags/fluentd">fluentd</a> &nbsp;
                    <a href="https://jimmysong.io//tags/elasticsearch">elasticsearch</a> &nbsp;
                </h5>
            </div>
            
            <aside id=comments>
                <div>
                    <h2> Comments </h2>
                </div>
                <div id="container"></div>
                <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
                <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
                <script>
                    var gitment = new Gitment({
                        owner: 'rootsongjc', 
                        repo: 'rootsongjc.github.io', 
                        oauth: {
                            client_id: '93a0df08e0f93ff0c8a3',
                            client_secret: '3bdbf0b42c525f78582600bd38cf7f722ee40541',
                        },
                    })
                    gitment.render('container')
                </script>
            </aside>

        </div>
    </div>
    </section>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:rootsongjc@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/jimmysongio" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/rootsongjc" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/jimmysongio" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/jimmysongio" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
        &copy;2017
          
            
              Jimmy Song
                      
          
          
          &nbsp;&bull;&nbsp;
          October 4,2017
          updated
          
            &nbsp;&bull;&nbsp;
            <a href="https://jimmysong.io/">Jimmy Song</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.30-DEV</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

<script src="https://jimmysong.io/js/main.js"></script>

<script> renderMathInElement(document.body); </script>

<script src="https://jimmysong.io/js/prism.js"></script>
<script src="https://jimmysong.io/js/load-photoswipe.js"></script>
<script src="https://cdn.bootcss.com/photoswipe/4.1.1/photoswipe.min.js"></script>
<script src="https://cdn.bootcss.com/photoswipe/4.1.1/photoswipe-ui-default.min.js"></script>




  </body>
</html>

