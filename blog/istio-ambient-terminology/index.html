<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>Istio Ambient 模式：图解及概念解读 - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="本文通过一份详细的 Istio Ambient 模式的术语表，帮助你更好地理解其中的关键概念及其背后的技术实现。">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.145.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/blog/istio-ambient-terminology/" />
  <meta property="og:title" content="Istio Ambient 模式：图解及概念解读 | Jimmy Song" />
  <meta property="twitter:title" content="Istio Ambient 模式：图解及概念解读 | Jimmy Song" />

  
  <meta property="og:description" content="本文通过一份详细的 Istio Ambient 模式的术语表，帮助你更好地理解其中的关键概念及其背后的技术实现。" />
  <meta property="twitter:description" content="本文通过一份详细的 Istio Ambient 模式的术语表，帮助你更好地理解其中的关键概念及其背后的技术实现。" />

  
  <meta property="og:image" content="https://jimmysong.io/images/backgrounds/favicon.png" />
  <meta property="twitter:image" content="https://jimmysong.io/images/backgrounds/favicon.png" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">博客</a>
              
            </li>
            
            
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
                aria-expanded="false">
                资料
              </a>
              <div class="dropdown-menu">
                
                <a class="dropdown-item" href="/book">书籍</a>
                
                <a class="dropdown-item" href="/slide">幻灯片</a>
                
              </div>
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">标签</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">公告</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">联系</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">关于</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">社区</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">视频 <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>搜索</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>站内搜索</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="关闭"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="请输入搜索词" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="请输入搜索词">
        
        <div class="mt-4">
          <span>搜索类型: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">所有</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">原创</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">译文</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">资料</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">公告</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    Istio Ambient 模式：图解及概念解读
                </p>
                <p class="page-description">
                    本文通过一份详细的 Istio Ambient 模式的术语表，帮助你更好地理解其中的关键概念及其背后的技术实现。
                </p>
                
                <div class="page-metadata">
                  <ul class="list-inline d-flex">
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-calendar"></i>
                        </span>2025/02/13</li>
                    
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-folder-open"></i>
                        </span><a
                        href="/categories/istio"> 
                        Istio</a> </li>
                    
                    
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-clock"></i>
                        </span>16 分钟</li>
                    <li class="list-inline-item mr-2 mb-md-0 d-sm-block d-none"><span><i class="fa-regular fa-file-word"></i>
                        </span>3419 字</li>
                    
                    
                  </ul>
                </div>
                
            </div>
        </div>
    </div>
</section>

        


  <div class="container-xl blog mb-4">
    <div class="row">
      <div class="col-xl-8">
        <div class="row">
          
          <div class="col-12 content py-md-3">

            
            
            
              <div class="alert alert-note-container mt-2">
    <div class="alert-note-title px-2 py-2">
      版权声明
    </div>
    <div class="alert-tip px-2">
      本文为 Jimmy Song 原创。转载请注明来源： <a title=https://jimmysong.io/blog/istio-ambient-terminology/>https://jimmysong.io/blog/istio-ambient-terminology/</a>
     </div>
  </div>
            

            
              <details class="mobile-toc d-sm-none d-block mb-0">
  <summary>查看本文大纲</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#ambient-模式">Ambient 模式</a></li>
    <li><a href="#控制平面与数据平面">控制平面与数据平面</a></li>
    <li><a href="#istio-control-plane-istiod">Istio Control Plane (<code>istiod</code>)</a></li>
    <li><a href="#透明性与非侵入性">透明性与非侵入性</a></li>
    <li><a href="#sidecar-proxy">Sidecar Proxy</a></li>
    <li><a href="#ztunnel-zero-trust-tunnel">Ztunnel (Zero-Trust Tunnel)</a></li>
    <li><a href="#waypoint-proxy">Waypoint Proxy</a></li>
    <li><a href="#geneve-隧道-generic-network-virtualization-encapsulation">GENEVE 隧道 (Generic Network Virtualization Encapsulation)</a></li>
    <li><a href="#hbone-http-based-overlay-network-environment">HBONE (HTTP-Based Overlay Network Environment)</a></li>
    <li><a href="#istioin-和-istioout-虚拟接口">Istioin 和 Istioout 虚拟接口</a></li>
    <li><a href="#iptables-和流量重定向">iptables 和流量重定向</a></li>
    <li><a href="#流量拦截与重定向-traffic-redirection">流量拦截与重定向 (Traffic Redirection)</a></li>
    <li><a href="#流量路径分类">流量路径分类</a></li>
    <li><a href="#tproxy">TPROXY</a></li>
    <li><a href="#mutual-tls-mtls">Mutual TLS (mTLS)</a></li>
    <li><a href="#spiffe-id">SPIFFE ID</a></li>
    <li><a href="#ebpf-extended-berkeley-packet-filter">eBPF (Extended Berkeley Packet Filter)</a></li>
    <li><a href="#waypoint-proxy-的弹性扩展">Waypoint Proxy 的弹性扩展</a></li>
    <li><a href="#ztunnel-的弹性和故障恢复">Ztunnel 的弹性和故障恢复</a></li>
    <li><a href="#ip-set-和-ztunnel-pods-ips">IP Set 和 ztunnel-pods-ips</a></li>
    <li><a href="#连接多路复用-connection-multiplexing">连接多路复用 (Connection Multiplexing)</a></li>
    <li><a href="#节点网络的虚拟接口对-veth">节点网络的虚拟接口对 (veth)</a></li>
    <li><a href="#waypoint-proxy-的流量路径">Waypoint Proxy 的流量路径</a></li>
    <li><a href="#istio-cni-container-network-interface">Istio CNI (Container Network Interface)</a></li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
</details>

            
            <p>Istio 的 Ambient 模式是一种创新的、无 Sidecar 的服务网格部署方式，通过 ztunnel 和 waypoint proxy 分离数据平面功能，简化了操作并降低了资源消耗。本篇博客将通过一份详细的术语表，帮助你更好地理解 Istio Ambient 模式中的关键概念及其背后的技术实现。</p>
<h2 id="ambient-模式">Ambient 模式</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/ambient-mode-architecture.svg" data-img="/blog/istio-ambient-terminology/ambient-mode-architecture.svg" alt="image" data-caption="Ambient 模式架构图">
        
      
    
  
  
  <figcaption>Ambient 模式架构图</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：Istio 的一种无 Sidecar 的数据平面模式，通过 ztunnel 和 waypoint proxy 实现服务之间的安全通信和管理。相较于 Sidecar 模式，Ambient 模式更加轻量，降低了资源消耗并简化了配置。</li>
<li><strong>架构</strong>：数据平面功能分为 L4 层的安全覆盖层（由 ztunnel 提供）和 L7 层的策略处理层（由 waypoint proxy 提供）。</li>
</ul>
<h2 id="控制平面与数据平面">控制平面与数据平面</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/control-plane-and-data-plane.svg" data-img="/blog/istio-ambient-terminology/control-plane-and-data-plane.svg" alt="image" data-caption="控制平面与数据平面">
        
      
    
  
  
  <figcaption>控制平面与数据平面</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：在 Ambient 模式中，控制平面（<code>istiod</code>）负责管理集群内 ztunnel 和 waypoint proxy 的配置和策略，而数据平面由 ztunnel 和 waypoint proxy 组成，负责处理实际的网络流量。</li>
<li><strong>组件交互</strong>：ztunnel 使用 xDS APIs 从 <code>istiod</code> 获取配置并执行策略，管理 Pod 之间的 L4 和 L7 流量。</li>
</ul>
<h2 id="istio-control-plane-istiod">Istio Control Plane (<code>istiod</code>)</h2>
<ul>
<li><strong>定义</strong>：Istio 的控制平面组件，负责与 ztunnel 和 waypoint proxy 通信，提供 xDS 接口用于动态配置。</li>
<li><strong>功能</strong>：<code>istiod</code> 使用 xDS APIs 进行配置推送，动态管理 Ambient 模式中的流量策略、证书分发以及与 Kubernetes 集群的交互。</li>
</ul>
<h2 id="透明性与非侵入性">透明性与非侵入性</h2>
<ul>
<li><strong>定义</strong>：Ambient 模式的架构旨在减少对应用的侵入性，应用无需感知数据平面的存在，Pod 无需重启或注入 Sidecar 即可加入网格。</li>
<li><strong>优势</strong>：提高了服务网格的灵活性，降低了操作复杂度，使应用和基础设施的生命周期更加解耦。</li>
</ul>
<h2 id="sidecar-proxy">Sidecar Proxy</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/sidecar-mode.svg" data-img="/blog/istio-ambient-terminology/sidecar-mode.svg" alt="image" data-caption="Sidecar 模式">
        
      
    
  
  
  <figcaption>Sidecar 模式</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：传统 Istio 中的 Envoy 代理，与应用容器共同部署在一个 Pod 中。</li>
<li><strong>问题</strong>：对应用具有侵入性，Sidecar 必须在 Pod 中注入并伴随应用运行，增加了资源开销，并且使应用与代理的生命周期耦合。</li>
</ul>
<h2 id="ztunnel-zero-trust-tunnel">Ztunnel (Zero-Trust Tunnel)</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/ztunnel.svg" data-img="/blog/istio-ambient-terminology/ztunnel.svg" alt="image" data-caption="ztunnel">
        
      
    
  
  
  <figcaption>ztunnel</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：Ambient 模式中的关键组件，部署为 DaemonSet，为每个节点提供 L4 层的零信任隧道。</li>
<li><strong>功能</strong>:
<ul>
<li><strong>安全</strong>：提供 mTLS 加密和基于 SPIFFE ID 的身份验证，确保节点和工作负载之间的安全通信。</li>
<li><strong>可观测性</strong>：收集 L4 层的 TCP 指标和日志。</li>
<li><strong>连接多路复用和均衡</strong>：在节点之间建立安全的流量隧道，以优化连接和网络性能。</li>
<li><strong>多租户架构</strong>：单个 ztunnel 可以代表同一节点上的多个工作负载进行 L4 数据平面功能处理，这与每个应用 Pod 拥有自己代理的 Sidecar 模式形成对比。</li>
<li><strong>证书管理</strong>：ztunnel 代表节点内的所有 Pod 从 Istio 控制平面 (<code>istiod</code>) 获取 mTLS 证书，并负责证书的管理和轮换。</li>
</ul>
</li>
<li><strong>接口</strong>:
<ul>
<li><strong><code>pistioin</code> 和 <code>pistioout</code></strong>：用于与节点上的 <code>istioin</code> 和 <code>istioout</code> 接口通过 GENEVE 隧道连接。</li>
</ul>
</li>
</ul>
<h2 id="waypoint-proxy">Waypoint Proxy</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/waypoint-proxy.svg" data-img="/blog/istio-ambient-terminology/waypoint-proxy.svg" alt="image" data-caption="Waypoint Proxy">
        
      
    
  
  
  <figcaption>Waypoint Proxy</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：Ambient 模式中的 L7 层代理，部署在每个命名空间级别，用于处理 L7 层请求。</li>
<li><strong>功能</strong>：提供 L7 授权策略，如基于 HTTP headers 的访问控制、L7 级别的遥测等。Waypoint Proxy 只处理需要的 L7 代理流量，其他 L4 流量由 ztunnel 处理。</li>
</ul>
<h2 id="geneve-隧道-generic-network-virtualization-encapsulation">GENEVE 隧道 (Generic Network Virtualization Encapsulation)</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/geneve.svg" data-img="/blog/istio-ambient-terminology/geneve.svg" alt="image" data-caption="GENEVE 协议组成">
        
      
    
  
  
  <figcaption>GENEVE 协议组成</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：用于在 Kubernetes 节点之间建立虚拟隧道连接，将流量从节点上的 Pod 转发到 ztunnel。</li>
<li><strong>在 Ambient 模式中的应用</strong>：GENEVE 隧道用于连接节点上的虚拟网络接口（<code>istioin</code> 和 <code>istioout</code>）与 ztunnel 内的接口（<code>pistioin</code> 和 <code>pistioout</code>）。</li>
</ul>
<h2 id="hbone-http-based-overlay-network-environment">HBONE (HTTP-Based Overlay Network Environment)</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/hbone.svg" data-img="/blog/istio-ambient-terminology/hbone.svg" alt="image" data-caption="HBONE 数据包格式">
        
      
    
  
  
  <figcaption>HBONE 数据包格式</figcaption>
  
</figure>
<!--
```
+-----------------+
|    IP Header    | <-- 源 IP，目标 IP，协议类型
+-----------------+
|    TCP Header   | <-- 源端口，目标端口，序列号，确认号，标志位等
+-----------------+
|    TLS Header   | <-- 握手消息，证书，加密应用数据
+-----------------+
| HTTP/2 & CONNECT| <-- HTTP 方法，目标地址，请求头，路径等
+-----------------+
|  Application    | <-- 应用层数据，字节流，例如 HTTP 请求
+-----------------+
```
-->
<ul>
<li><strong>定义</strong>：Istio 特有的安全隧道协议，用于在 Ambient 模式组件之间传输数据。HBONE 是一种基于 HTTP/2 和 HTTP CONNECT 建立的安全 mTLS 加密通道。</li>
<li><strong>实现方式</strong>：通过 HTTP/2 进行多路复用，通过 HTTP CONNECT 建立隧道，并使用 mTLS 确保安全性。详见 <a href="https://istio.io/latest/docs/ambient/architecture/hbone/" title="Istio 文档" target="_blank" rel="noopener">Istio 文档</a>。</li>
</ul>
<h2 id="istioin-和-istioout-虚拟接口">Istioin 和 Istioout 虚拟接口</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/ambient-ztunnel-routing.svg" data-img="/blog/istio-ambient-terminology/ambient-ztunnel-routing.svg" alt="image" data-caption="Ambient 模式中两个位于两个不同节点上的 Pod 访问路径">
        
      
    
  
  
  <figcaption>Ambient 模式中两个位于两个不同节点上的 Pod 访问路径</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：由 Istio CNI 插件在每个节点上配置的两个虚拟接口，用于处理进入和离开节点的流量。</li>
<li><strong>功能</strong>：<code>istioin</code> 处理进入节点的流量，<code>istioout</code> 处理离开节点的流量。两者通过 GENEVE 隧道连接到 ztunnel 中相应的接口。</li>
</ul>
<h2 id="iptables-和流量重定向">iptables 和流量重定向</h2>
<ul>
<li><strong>定义</strong>：用于配置 Linux 内核中的流量规则，将来自 Ambient 工作负载的流量进行重定向和标记。</li>
<li><strong>在 Ambient 模式中的应用</strong>：Istio CNI 插件通过 iptables 规则，将流量标记并重定向到 <code>istioin</code> 或 <code>istioout</code>，然后通过 GENEVE 隧道传递给 ztunnel。</li>
</ul>
<h2 id="流量拦截与重定向-traffic-redirection">流量拦截与重定向 (Traffic Redirection)</h2>
<ul>
<li><strong>定义</strong>：Ambient 模式中，ztunnel 负责透明拦截所有进出 &ldquo;in-mesh&rdquo; Pod 的流量并将其加密后重定向到其他节点上的目标 Pod，确保网络流量符合服务网格的安全策略。</li>
<li><strong>机制</strong>：通过 Istio CNI 插件安装的 iptables 规则或 eBPF 程序，ztunnel 能够透明地捕获工作负载的流量，并在不改变客户端应用的情况下进行安全代理。</li>
</ul>
<h2 id="流量路径分类">流量路径分类</h2>
<ul>
<li><strong>Out of Mesh</strong>：Pod 没有加入服务网格，流量不会被 Ambient 数据平面处理。</li>
<li><strong>In Mesh</strong>：Pod 被纳入 Ambient 数据平面，L4 层的流量被 ztunnel 拦截和处理，提供 L4 授权和安全加密。</li>
<li><strong>In Mesh, Waypoint Enabled</strong>：Pod 被纳入 Ambient 数据平面且启用了 waypoint proxy，L7 层的流量通过 waypoint 进行高级策略处理。</li>
</ul>
<h2 id="tproxy">TPROXY</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/tproxy.svg" data-img="/blog/istio-ambient-terminology/tproxy.svg" alt="image" data-caption="TPROXY 作为透明代理，客户端和服务端都对其无感知">
        
      
    
  
  
  <figcaption>TPROXY 作为透明代理，客户端和服务端都对其无感知</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：Linux 内核功能，用于透明拦截和重定向网络流量。</li>
<li><strong>在 Ambient 模式中的应用</strong>：ztunnel 使用 TPROXY 来拦截和处理流量，保留原始源 IP 和端口信息，从而实现透明代理功能。</li>
</ul>
<h2 id="mutual-tls-mtls">Mutual TLS (mTLS)</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/istio-mtls-process.svg" data-img="/blog/istio-ambient-terminology/istio-mtls-process.svg" alt="image" data-caption="Istio 中的安全身份架构（以 Sidecar 模式为例）">
        
      
    
  
  
  <figcaption>Istio 中的安全身份架构（以 Sidecar 模式为例）</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：一种双向 TLS 认证机制，确保通信双方的身份验证和数据加密。</li>
<li><strong>在 Ambient 模式中的应用</strong>：通过 ztunnel 和 waypoint proxy 确保工作负载之间的 mTLS 加密，实现零信任安全。</li>
</ul>
<p>详见 <a href="/blog/understanding-the-tls-encryption-in-istio/" title="如何理解 Istio 中的 MTLS 流量加密？">如何理解 Istio 中的 MTLS 流量加密？</a></p>
<h2 id="spiffe-id">SPIFFE ID</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/spiffe.svg" data-img="/blog/istio-ambient-terminology/spiffe.svg" alt="image" data-caption="SPIFFE ID 格式">
        
      
    
  
  
  <figcaption>SPIFFE ID 格式</figcaption>
  
</figure>
<p>Istio 服务网格中所有工作负载将根据其服务账户注册 SPIFFE 标准的服务身份格式：<code>spiffe://&lt;trust-domain&gt;/ns/&lt;namespace&gt;/sa/&lt;service-account&gt;</code>。</p>
<ul>
<li><strong>定义</strong>：用于标识工作负载的身份标识符，在服务网格中用于身份管理。</li>
<li><strong>在 Ambient 模式中的应用</strong>：SPIFFE ID 被用于对节点和工作负载进行身份验证，以确保网络通信的安全性。</li>
</ul>
<p>详见 <a href="/blog/why-istio-need-spire/" title="为什么 Istio 要使用 SPIRE 做身份认证？">为什么 Istio 要使用 SPIRE 做身份认证？</a></p>
<h2 id="ebpf-extended-berkeley-packet-filter">eBPF (Extended Berkeley Packet Filter)</h2>
<ul>
<li><strong>定义</strong>：eBPF 是 Linux 内核中的一种技术，用于在内核空间中运行沙盒程序，实现网络数据包处理等功能。</li>
<li><strong>在 Ambient 模式中的应用</strong>：eBPF 可以替代传统的 iptables 和 GENEVE 隧道，用于流量重定向和管理。eBPF 更高效、复杂度更低且易于管理。</li>
<li><strong>eBPF 程序</strong>:
<ul>
<li>应用入站</li>
<li>应用出站</li>
<li>Ztunnel 主机入站</li>
<li>Ztunnel 入站</li>
</ul>
</li>
<li><strong>作用</strong>：Istio CNI 使用 eBPF 程序将它们挂载在特定的 TC 点，用于处理应用和 ztunnel 的网络流量。</li>
</ul>
<h2 id="waypoint-proxy-的弹性扩展">Waypoint Proxy 的弹性扩展</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/ambient-waypoint-proxy-scale.svg" data-img="/blog/istio-ambient-terminology/ambient-waypoint-proxy-scale.svg" alt="image" data-caption="Waypoing Proxy 作为 Deployment 部署在 Kubernetes 中">
        
      
    
  
  
  <figcaption>Waypoing Proxy 作为 Deployment 部署在 Kubernetes 中</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：在 Ambient 模式中，waypoint proxy 可以根据流量需求动态扩展，而无需为每个工作负载实例部署独立代理。</li>
<li><strong>优势</strong>：通过动态扩展 waypoint proxy，可以降低基础设施成本并提高资源利用率。</li>
</ul>
<h2 id="ztunnel-的弹性和故障恢复">Ztunnel 的弹性和故障恢复</h2>
<ul>
<li><strong>定义</strong>：ztunnel 部署为 DaemonSet，如果 ztunnel 容器失效，Kubernetes 会自动重新调度，以确保节点流量的继续处理。</li>
<li><strong>特点</strong>：使得故障的影响范围最小化，仅影响该节点上的工作负载。</li>
</ul>
<h2 id="ip-set-和-ztunnel-pods-ips">IP Set 和 ztunnel-pods-ips</h2>
<ul>
<li><strong>定义</strong>：IP Set 是用于存储 IP 地址的工具，<code>ztunnel-pods-ips</code> 是每个节点上用于存储 Ambient 网格 Pod IP 的集合。</li>
<li><strong>在 Ambient 模式中的应用</strong>：Istio CNI 插件会将每个加入 Ambient 网格的 Pod IP 添加到 <code>ztunnel-pods-ips</code> 中，以确保这些 Pod 的流量可以被 iptables 规则识别和处理。</li>
</ul>
<h2 id="连接多路复用-connection-multiplexing">连接多路复用 (Connection Multiplexing)</h2>
<ul>
<li><strong>定义</strong>：在单个物理连接中传输多条逻辑连接的技术。</li>
<li><strong>在 Ambient 模式中的应用</strong>：ztunnel 实现了连接多路复用，使多个工作负载可以共享相同的连接，提升网络效率。</li>
</ul>
<h2 id="节点网络的虚拟接口对-veth">节点网络的虚拟接口对 (veth)</h2>
<ul>
<li>定义：每个 Pod 在运行时会在节点上创建一个虚拟接口对，用于将 Pod 的网络连接到节点的网络。</li>
<li>在 Ambient 模式中的应用：veth 接口用于将 Pod 的流量连接到节点的虚拟接口（如 <code>istioin</code> 和 <code>istioout</code>），从而将流量引导至 ztunnel 进行处理。</li>
</ul>
<h2 id="waypoint-proxy-的流量路径">Waypoint Proxy 的流量路径</h2>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/blog/istio-ambient-terminology/waypoint-proxy-routing.svg" data-img="/blog/istio-ambient-terminology/waypoint-proxy-routing.svg" alt="image" data-caption="Waypoint Proxy 的流量路径">
        
      
    
  
  
  <figcaption>Waypoint Proxy 的流量路径</figcaption>
  
</figure>
<ul>
<li><strong>定义</strong>：Waypoint Proxy 只参与服务器端的流量路径，作为 L7 代理执行服务端的请求。</li>
<li><strong>应用场景</strong>：当部署了 Waypoint Proxy 时，来自同一服务账户的工作负载将通过 ztunnel 重定向至 Waypoint Proxy 进行处理，然后到达目标 Pod，确保 L7 级别的策略和认证得以执行。</li>
</ul>
<h2 id="istio-cni-container-network-interface">Istio CNI (Container Network Interface)</h2>
<ul>
<li><strong>定义</strong>：Istio 的容器网络接口插件，用于在 Kubernetes 集群中自动配置流量拦截规则。</li>
<li><strong>功能</strong>：Istio CNI 负责为每个新创建或加入网格的 Pod 设置必要的网络重定向规则。它通过修改 iptables 规则或应用 eBPF 程序来确保所有流量能够被 ztunnel 或 waypoint proxy 拦截和处理，从而实现服务网格的透明流量管理。</li>
<li><strong>Istio CNI Node Agent</strong>：Istio CNI Node Agent 负责在每个节点上安装 Istio CNI 插件，并更新节点的 CNI 配置，确保当 Pod 加入服务网格时能够正确地配置流量重定向规则。在 Sidecar 模式中，CNI 插件通过 iptables 配置 Pod 的网络。在 Ambient 模式中，CNI 插件负责将新的 Pod 事件推送到 Ambient 监控服务器，以便配置 Pod 的网络重定向规则。</li>
</ul>
<h2 id="总结">总结</h2>
<p>Istio Ambient 模式通过将数据平面功能分为 L4 和 L7 层的独立组件，为用户提供了更轻量且灵活的服务网格解决方案。这种方式不仅简化了服务的部署，还大幅降低了资源开销。通过术语表的方式，我们探讨了 Ambient 模式中的各种核心概念，从 ztunnel 到 waypoint proxy，再到 iptables 和 eBPF 的使用，帮助你全面了解 Istio Ambient 模式的架构和运行机制。如果你对服务网格感兴趣或正在考虑如何优化微服务通信，希望这篇文章对你有所帮助。</p>

            <div class="border-bottom mb-2"></div>
          </div>
          <div class="col-12">
            <p>最后更新于 2025/02/13</p>
            


            


          </div>
          
          <div class="col-12">
              <div class="list-inline-item text-light">
              
              <a href="/tags/istio" class="badge"> 
                  Istio</a> 
              <a href="/tags/ambient" class="badge">  
                  Ambient</a> 
              <a href="/tags/hbone" class="badge">  
                  HBONE</a> </div>
          </div>
          
          <div class="col-12">
            









    

    

    

    

    
        
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    






    



    


<div class="pager blog-pager d-flex justify-content-between">
    
    <div class="previous mr-4">
        <a href="https://jimmysong.io/blog/istio-installation-deep-dive/" class="d-flex flex-column align-items-start">
            <span class="nav mb-2 text-color-dark">&larr; 上一篇</span>
            <span class="text-align-left">Istio 安装方式深度剖析——选择与实践指南</span>
        </a>
    </div>
    

    
    <div class="next">
        <a href="https://jimmysong.io/blog/free-ai-drawing-tool-raphael/" class="d-flex flex-column align-items-end">
            <span class="nav mb-2 text-color-dark">下一篇 &rarr;</span>
            <span class="text-align-right">免费的 AI 绘图工具推荐：Raphael.app</span>
        </a>
    </div>
     
</div>

          </div>

          
          
          <div class="col-12">
            <script src="https://giscus.app/client.js"
        data-repo="rootsongjc/rootsongjc.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzMTQ1MzczNA=="
        data-category="Announcements"
        data-category-id="DIC_kwDOAd_yJs4CPNtR"
        data-mapping="pathname"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        
        data-lang="zh-CN"
        
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
          </div>
          
        </div>
      </div>
      <!-- sidebar -->
      <aside class="px-2 col-xl-4 py-md-3 d-none d-xl-block">
          <div class="sidebar">
          <!-- recommend -->
          











<div>
  <p class="related-sidebar-title">
  相关文章
  </p>
  <!-- related-blog-item -->
    <ul class="related-list">
    
      <li>
          <a href="/blog/http2-envoy-tunnel-demo/">
            使用 Envoy 实现 HTTP/2 CONNECT 隧道：原理与实践
          </a>
      </li>
    
      <li>
          <a href="/blog/ambient-mesh-l4-traffic-path/">
            Istio Ambient 模式中的透明流量劫持四层网络路由路径详解
          </a>
      </li>
    
      <li>
          <a href="/blog/istio-ambient-l7-flow-analysis/">
            深入 Istio Ambient 模式：从 ztunnel 到 Waypoint 代理的 L7 流量路径解析
          </a>
      </li>
    
      <li>
          <a href="/blog/istio-sidecar-vs-ambient-network-cost-performance/">
            Istio sidecar 和 ambient 模式的网络成本对比
          </a>
      </li>
    
      <li>
          <a href="/blog/istio-ambient-traffic-interception/">
            Istio Ambient 模式中的透明流量拦截过程详解
          </a>
      </li>
    
    </ul>
</div>


          <!-- /recommend -->
          <!-- toc -->
          
  <div class="bg-white sticky-top aside-toc">
    <p class="toc-sidebar-title">
      目录
    </p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ambient-模式">Ambient 模式</a></li>
    <li><a href="#控制平面与数据平面">控制平面与数据平面</a></li>
    <li><a href="#istio-control-plane-istiod">Istio Control Plane (<code>istiod</code>)</a></li>
    <li><a href="#透明性与非侵入性">透明性与非侵入性</a></li>
    <li><a href="#sidecar-proxy">Sidecar Proxy</a></li>
    <li><a href="#ztunnel-zero-trust-tunnel">Ztunnel (Zero-Trust Tunnel)</a></li>
    <li><a href="#waypoint-proxy">Waypoint Proxy</a></li>
    <li><a href="#geneve-隧道-generic-network-virtualization-encapsulation">GENEVE 隧道 (Generic Network Virtualization Encapsulation)</a></li>
    <li><a href="#hbone-http-based-overlay-network-environment">HBONE (HTTP-Based Overlay Network Environment)</a></li>
    <li><a href="#istioin-和-istioout-虚拟接口">Istioin 和 Istioout 虚拟接口</a></li>
    <li><a href="#iptables-和流量重定向">iptables 和流量重定向</a></li>
    <li><a href="#流量拦截与重定向-traffic-redirection">流量拦截与重定向 (Traffic Redirection)</a></li>
    <li><a href="#流量路径分类">流量路径分类</a></li>
    <li><a href="#tproxy">TPROXY</a></li>
    <li><a href="#mutual-tls-mtls">Mutual TLS (mTLS)</a></li>
    <li><a href="#spiffe-id">SPIFFE ID</a></li>
    <li><a href="#ebpf-extended-berkeley-packet-filter">eBPF (Extended Berkeley Packet Filter)</a></li>
    <li><a href="#waypoint-proxy-的弹性扩展">Waypoint Proxy 的弹性扩展</a></li>
    <li><a href="#ztunnel-的弹性和故障恢复">Ztunnel 的弹性和故障恢复</a></li>
    <li><a href="#ip-set-和-ztunnel-pods-ips">IP Set 和 ztunnel-pods-ips</a></li>
    <li><a href="#连接多路复用-connection-multiplexing">连接多路复用 (Connection Multiplexing)</a></li>
    <li><a href="#节点网络的虚拟接口对-veth">节点网络的虚拟接口对 (veth)</a></li>
    <li><a href="#waypoint-proxy-的流量路径">Waypoint Proxy 的流量路径</a></li>
    <li><a href="#istio-cni-container-network-interface">Istio CNI (Container Network Interface)</a></li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
  </div>



          <!-- /toc -->
          <!-- ad-->
          

          <!-- /ad -->
          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">联系</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">微信公众号</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">博客</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/kubecon-eu-2025-london-recap/">KubeCon EU 2025 参会报告：塑造云原生格局的洞察与趋势</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/mastering-github-copilot-for-open-source/">探索 GitHub Copilot：当 AI 成为你的贴身编码助手</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/beyond-sidecar/">超越 Sidecar：深入解析 Istio Ambient Mode 的流量机制与成本效益</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">链接</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio 服务网格
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate 公司
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  云原生学院|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  云原生开源项目大全
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnativecn.com" target="_blank" rel="noopener noreferrer">
                  云原生社区（中国）
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">教程</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes 基础教程
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/envoy-made-simple/" >
                  简明 Envoy 教程
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">通知</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/kcd-beijing-2025/">KCD Beijing 2025 - 提交议题及参会报名</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/cloud-native-community-domain-migration/">云原生社区网站域名变更通知</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/nist-sp-800-233-service-mesh-proxy-models/">资料分享：云原生应用服务网格代理模型的威胁分析指南</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2025 Jimmy Song 保留所有权利</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />





<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
