<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" width="2251" height="1153" version="1.1" viewBox="1326 60 2251 1153"><defs><marker id="FilledArrow_Marker" stroke-linejoin="miter" stroke-miterlimit="10" color="#000" markerHeight="8" markerUnits="strokeWidth" markerWidth="10" orient="auto" overflow="visible" viewBox="-1 -4 10 8"><g><path fill="currentColor" stroke="currentColor" stroke-width="1" d="M 8 0 L 0 -3 L 0 3 Z"/></g></marker></defs><g id="Ambient_Mesh_L7_Traffic" fill="none" fill-opacity="1" stroke="none" stroke-dasharray="none" stroke-opacity="1"><title>Ambient Mesh L7 Traffic</title><rect width="2251" height="1153" x="1326" y="60" fill="#fff"/><g id="Ambient_Mesh_L7_Traffic_Layer_2"><title>Layer 2</title><g id="Graphic_266"><rect width="2249.645" height="1151.614" x="1326.614" y="60.945" fill="#fff"/></g><g id="Graphic_265"><rect width="566.929" height="1105.512" x="1357.795" y="83.996" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1362.7953 1165.0439)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Node A</tspan></text></g><g id="Graphic_264"><rect width="566.929" height="1105.512" x="2970.532" y="83.996" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2975.5315 1165.0439)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Node B</tspan></text></g><g id="Graphic_263"><title>ztunnel a pod</title><rect width="501.732" height="588.431" x="1390.394" y="402.652" fill="#f3f9ff"/><rect width="501.732" height="588.431" x="1390.394" y="402.652" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1395.3937 966.6187)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Ztunnel A Pod</tspan></text></g><g id="Graphic_262"><rect width="501.732" height="529.769" x="3005.256" y="306.516" fill="#f3f9ff"/><rect width="501.732" height="529.769" x="3005.256" y="306.516" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3010.256 811.8205)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Ztunnel B Pod</tspan></text></g><g id="Graphic_261"><rect width="391.181" height="68.031" x="1444.22" y="120.847" fill="#333"/><rect width="391.181" height="68.031" x="1444.22" y="120.847" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#fff" transform="translate(1449.22 125.8466)"><tspan x="137.247" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Service A Pod</tspan></text></g><g id="Graphic_260"><rect width="391.181" height="46.772" x="1444.22" y="306.516" fill="#dadada"/><rect width="391.181" height="46.772" x="1444.22" y="306.516" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1449.22 310.94566)"><tspan x="162.015" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">istioout</tspan> <tspan x="139.439" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.127.1</tspan></text></g><g id="Graphic_259"><rect width="245.969" height="46.772" x="1516.826" y="402.652" fill="#dadada"/><rect width="245.969" height="46.772" x="1516.826" y="402.652" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1521.8259 407.0821)"><tspan x="84.521" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">pistioout</tspan> <tspan x="66.833" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.127.2</tspan></text></g><g id="Graphic_258"><rect width="391.181" height="365.669" x="1445.669" y="514.862" fill="#fff"/><rect width="391.181" height="365.669" x="1445.669" y="514.862" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1450.6693 856.0675)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Envoy Proxy</tspan></text></g><g id="Line_257"><line x1="1639.811" x2="1639.811" y1="188.878" y2="206.184" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_256"><line x1="1639.811" x2="1639.811" y1="353.288" y2="392.752" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_255"><line x1="1639.935" x2="1640.232" y1="449.424" y2="504.962" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_254"><rect width="391.181" height="68.031" x="3058.405" y="120.847" fill="#333"/><rect width="391.181" height="68.031" x="3058.405" y="120.847" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#fff" transform="translate(3063.4055 125.8466)"><tspan x="137.095" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Service B Pod</tspan></text></g><g id="Graphic_253"><rect width="391.181" height="57.734" x="3058.405" y="908.878" fill="#dadada"/><rect width="391.181" height="57.734" x="3058.405" y="908.878" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 918.7889)"><tspan x="167.655" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">istioin</tspan> <tspan x="139.439" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.126.1</tspan></text></g><g id="Graphic_252"><rect width="391.181" height="199.755" x="3058.405" y="346.729" fill="#fff"/><rect width="391.181" height="199.755" x="3058.405" y="346.729" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 522.02035)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Envoy Proxy</tspan></text></g><g id="Graphic_251"><rect width="232.441" height="34.99" x="3137.776" y="438.663" fill="#0a55a8"/><text fill="#fff" transform="translate(3142.7756 446.42634)"><tspan x="14.188" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Ztunnel_inbound Listener</tspan></text></g><g id="Graphic_250"><rect width="232.441" height="34.99" x="3137.776" y="378.17" fill="#0a55a8"/><text fill="#fff" transform="translate(3142.7756 385.93327)"><tspan x="22.196" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Virtual_inbound Cluster</tspan></text></g><g id="Line_249"><line x1="3253.996" x2="3253.996" y1="1134.064" y2="976.512" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_248"><line x1="3253.996" x2="3253.996" y1="908.878" y2="720.459" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_247"><line x1="3253.996" x2="3253.996" y1="652.825" y2="635.131" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><g id="Line_246"><line x1="3253.996" x2="3253.996" y1="438.663" y2="423.06" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_245"><line x1="3253.996" x2="3253.996" y1="306.516" y2="292.319" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_244"><rect width="232.441" height="28.346" x="1525.039" y="572.685" fill="#0a55a8"/><text fill="#fff" transform="translate(1530.0394 577.1265)"><tspan x="8.548" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Ztunnel_outbound Listener</tspan></text></g><g id="Graphic_243"><rect width="232.441" height="28.346" x="1525.039" y="652.825" fill="#0a55a8"/><text fill="#fff" transform="translate(1530.0394 657.26605)"><tspan x="45.436" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Service A Cluster</tspan></text></g><g id="Graphic_242"><rect width="232.441" height="28.346" x="1525.039" y="732.964" fill="#0a55a8"/><text fill="#fff" transform="translate(1530.0394 737.4056)"><tspan x="9.316" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Internal Upstream Listener</tspan></text></g><g id="Line_241"><line x1="1641.26" x2="1641.26" y1="601.032" y2="642.925" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_240"><rect width="243.071" height="24.336" x="1516.826" y="611.72" fill="#fff"/><text fill="#000" transform="translate(1521.8259 616.7198)"><tspan x="7.173" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">Match the destination port and cluster IP</tspan></text></g><g id="Graphic_239"><rect width="232.441" height="28.346" x="1525.039" y="813.104" fill="#0a55a8"/><text fill="#fff" transform="translate(1530.0394 817.5451)"><tspan x="16.244" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Outbound Tunnel Cluster</tspan></text></g><g id="Line_238"><line x1="1641.26" x2="1641.26" y1="681.171" y2="723.064" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_237"><line x1="1641.26" x2="1641.26" y1="761.311" y2="803.204" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_236"><rect width="243.071" height="24.336" x="1519.724" y="361.602" fill="#fff"/><text fill="#000" transform="translate(1524.7244 366.6016)"><tspan x="77.859" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">Geneve tunnel</tspan></text></g><g id="Graphic_235"><rect width="42.608" height="24.336" x="1619.956" y="689.909" fill="#fff"/><text fill="#000" transform="translate(1624.9559 694.9094)"><tspan x="4.526" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">EDS</tspan></text></g><g id="Graphic_234"><rect width="391.181" height="28.346" x="1445.669" y="1134.232" fill="#dadada"/><rect width="391.181" height="28.346" x="1445.669" y="1134.232" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1450.6693 1138.6736)"><tspan x="173.991" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_233"><rect width="391.181" height="25.348" x="1445.669" y="466.139" fill="#f3f9ff"/><text fill="#000" transform="translate(1450.6693 469.0807)"><tspan x="166.583" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">tproxy</tspan></text></g><g id="Graphic_232"><rect width="98.922" height="28.346" x="1590.35" y="160.532" fill="#dadada"/><text fill="#000" transform="translate(1595.3495 164.9728)"><tspan x="27.861" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_231"><rect width="391.181" height="28.346" x="1444.22" y="216.084" fill="#dadada"/><rect width="391.181" height="28.346" x="1444.22" y="216.084" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1449.22 220.52522)"><tspan x="161.391" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">vethxxx</tspan></text></g><g id="Line_230"><line x1="1639.811" x2="1639.811" y1="244.43" y2="296.616" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_229"><rect width="289.936" height="39.684" x="1494.843" y="250.783" fill="#fff"/><text fill="#000" transform="translate(1499.8426 255.78316)"><tspan x="34.992" y="12" fill="#000" font-family="Helvetica Neue" font-size="12" font-weight="bold">iptables chain ztunnel-PREROUTING</tspan> <tspan x="89.946" y="26.348" fill="#000" font-family="Helvetica Neue" font-size="12">mark 0x100/0x100</tspan></text></g><g id="Graphic_228"><rect width="70.752" height="28.346" x="1605.884" y="514.862" fill="#0a55a8"/><text fill="#fff" transform="translate(1610.8839 519.3035)"><tspan x="8.136" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">15001</tspan></text></g><g id="Graphic_227"><rect width="136.772" height="24.336" x="1572.874" y="770.696" fill="#fff"/><text fill="#000" transform="translate(1577.874 775.69585)"><tspan x="10.934" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">HTTP Tunnel config</tspan></text></g><g id="Graphic_226"><rect width="219.685" height="28.346" x="1531.417" y="962.736" fill="#dadada"/><rect width="219.685" height="28.346" x="1531.417" y="962.736" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1536.4173 967.1775)"><tspan x="88.243" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_225"><rect width="391.181" height="28.346" x="1445.669" y="1016.595" fill="#dadada"/><rect width="391.181" height="28.346" x="1445.669" y="1016.595" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(1450.6693 1021.0358)"><tspan x="161.391" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">vethxxx</tspan></text></g><g id="Line_224"><line x1="1641.26" x2="1641.26" y1="543.209" y2="562.785" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_223"><line x1="1641.26" x2="1641.26" y1="841.45" y2="952.836" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_222"><rect width="391.181" height="46.772" x="1445.669" y="892.474" fill="#f3f9ff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 1445.6693 892.4741 L 1836.8504 892.4741 L 1836.8504 939.2457 L 1445.6693 939.2457 Z"/><text fill="#000" transform="translate(1450.6693 896.9038)"><tspan x="140.535" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">init container</tspan> <tspan x="79.767" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules for ztunnel</tspan></text></g><g id="Line_221"><line x1="1641.26" x2="1641.26" y1="991.083" y2="1006.695" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_220"><line x1="1641.26" x2="1641.26" y1="1044.941" y2="1124.332" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_219"><rect width="391.181" height="50.616" x="1445.669" y="1064.165" fill="#fff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 1445.6693 1064.1651 L 1836.8504 1064.1651 L 1836.8504 1114.781 L 1445.6693 1114.781 Z"/><text fill="#000" transform="translate(1450.6693 1070.517)"><tspan x="157.727" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Istio CNI</tspan> <tspan x="38.559" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules and veth pair for node</tspan></text></g><g id="Graphic_218"><rect width="391.181" height="28.514" x="3058.405" y="1134.064" fill="#dadada"/><rect width="391.181" height="28.514" x="3058.405" y="1134.064" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 1138.5897)"><tspan x="173.991" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_217"><rect width="391.181" height="57.734" x="3058.405" y="1057.047" fill="#fff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 3058.4055 1057.0472 L 3449.5866 1057.0472 L 3449.5866 1114.781 L 3058.4055 1114.781 Z"/><text fill="#000" transform="translate(3063.4055 1066.958)"><tspan x="157.727" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Istio CNI</tspan> <tspan x="38.559" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules and veth pair for node</tspan></text></g><g id="Graphic_216"><rect width="391.181" height="57.734" x="3058.405" y="652.825" fill="#dadada"/><rect width="391.181" height="57.734" x="3058.405" y="652.825" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 662.7357)"><tspan x="162.767" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">pistioin</tspan> <tspan x="139.439" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.126.2</tspan></text></g><g id="Graphic_215"><rect width="391.181" height="57.734" x="3058.405" y="733.938" fill="#f3f9ff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 3058.4055 733.9384 L 3449.5866 733.9384 L 3449.5866 791.6721 L 3058.4055 791.6721 Z"/><text fill="#000" transform="translate(3063.4055 743.8492)"><tspan x="140.535" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">init container</tspan> <tspan x="79.767" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules for ztunnel</tspan></text></g><g id="Graphic_214"><rect width="70" height="28" x="3182.374" y="518.154" fill="#0a55a8"/><text fill="#fff" transform="translate(3187.374 522.4216)"><tspan x="7.76" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">15006</tspan></text></g><g id="Graphic_213"><rect width="391.181" height="19.355" x="3058.405" y="615.776" fill="#f3f9ff"/><text fill="#000" transform="translate(3063.4055 615.7211)"><tspan x="166.583" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">tproxy</tspan></text></g><g id="Graphic_212"><rect width="289.936" height="39.684" x="3111.154" y="998.08" fill="#fff"/><text fill="#000" transform="translate(3116.154 1003.0796)"><tspan x="34.992" y="12" fill="#000" font-family="Helvetica Neue" font-size="12" font-weight="bold">iptables chain ztunnel-PREROUTING</tspan> <tspan x="89.946" y="26.348" fill="#000" font-family="Helvetica Neue" font-size="12">mark 0x200/0x200</tspan></text></g><g id="Graphic_211"><rect width="243.071" height="24.336" x="3132.461" y="856.196" fill="#fff"/><text fill="#000" transform="translate(3137.4607 861.1956)"><tspan x="77.859" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">Geneve tunnel</tspan></text></g><g id="Graphic_210"><rect width="136.772" height="21.258" x="3185.61" y="306.516" fill="#dadada"/><rect width="136.772" height="21.258" x="3185.61" y="306.516" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3190.6103 307.4126)"><tspan x="46.786" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_209"><rect width="98.922" height="28.346" x="3204.535" y="160.532" fill="#dadada"/><text fill="#000" transform="translate(3209.535 164.9728)"><tspan x="27.861" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_208"><rect width="391.181" height="21.258" x="3058.405" y="261.162" fill="#dadada"/><rect width="391.181" height="21.258" x="3058.405" y="261.162" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 262.05826)"><tspan x="161.391" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">vethxxx</tspan></text></g><g id="Graphic_207"><rect width="391.181" height="21.258" x="3058.405" y="214.391" fill="#dadada"/><rect width="391.181" height="21.258" x="3058.405" y="214.391" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(3063.4055 215.28777)"><tspan x="161.391" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">vethxxx</tspan></text></g><g id="Line_206"><line x1="3253.996" x2="3253.996" y1="261.162" y2="245.549" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_205"><line x1="3253.996" x2="3253.996" y1="214.391" y2="198.778" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_204"><rect width="70.752" height="28.346" x="3252.693" y="518.138" fill="#0a55a8"/><text fill="#fff" transform="translate(3257.693 522.5792)"><tspan x="8.136" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">15008</tspan></text></g><g id="Line_203"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 3253.996 615.7757 L 3253.996 595.9887 L 3288.069 595.9887 L 3288.069 556.38446"/></g><g id="Graphic_202"><rect width="58.11" height="24.336" x="3259.014" y="566.681" fill="#f3f9ff"/><text fill="#000" transform="translate(3264.0138 571.6807)"><tspan x="13.387" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">TLS</tspan></text></g><g id="Line_201"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 3217.374 518.1537 L 3217.374 495.9036 L 3253.996 495.9036 L 3253.996 483.5535"/></g><g id="Line_200"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 3288.069 518.138 L 3288.069 495.89574 L 3253.996 495.89574 L 3253.996 483.5535"/></g><g id="Line_199"><line x1="3253.996" x2="3253.996" y1="378.17" y2="337.673" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_198"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 3253.996 615.7757 L 3253.996 596.0178 L 3217.374 596.0178 L 3217.374 556.0537"/></g><g id="Graphic_197"><rect width="58.11" height="24.336" x="3188.319" y="566.1" fill="#f3f9ff"/><text fill="#000" transform="translate(3193.319 571.09956)"><tspan x="10.945" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">Plain</tspan></text></g><g id="Line_196"><line x1="1836.85" x2="2230.532" y1="1148.385" y2="1148.343" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_195"><text fill="#000" transform="translate(1954.108 1128.9011)"><tspan x="13.624" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">HBONE Tunnel</tspan> <tspan x="0" y="35.464" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Waypoint IP:15006</tspan></text></g><g id="Line_194"><line x1="2631.613" x2="3048.506" y1="1148.322" y2="1148.322" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_193"><text fill="#000" transform="translate(2789.5822 1128.8576)"><tspan x="1.192" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">HBONE Tunnel</tspan> <tspan x="0" y="35.464" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Pod B IP:15008</tspan></text></g><g id="Graphic_192"><rect width="566.929" height="1105.512" x="2147.864" y="83.996" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2152.8642 1165.0439)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Node C</tspan></text></g><g id="Graphic_191"><rect width="501.732" height="719.737" x="2180.463" y="169.036" fill="#f3f9ff"/><rect width="501.732" height="719.737" x="2180.463" y="169.036" stroke="#a5a5a5" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2185.4626 864.308)"><tspan x="0" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Waypoint Proxy B Pod</tspan></text></g><g id="Graphic_190"><rect width="391.181" height="57.734" x="2240.432" y="934.001" fill="#dadada"/><rect width="391.181" height="57.734" x="2240.432" y="934.001" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2245.4322 943.9123)"><tspan x="167.655" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">istioin</tspan> <tspan x="139.439" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.126.1</tspan></text></g><g id="Line_189"><line x1="2436.023" x2="2436.023" y1="1134.064" y2="1001.635" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_188"><line x1="2436.023" x2="2436.023" y1="934.001" y2="800.598" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_187"><line x1="2436.023" x2="2436.023" y1="732.964" y2="716.745" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><g id="Graphic_186"><rect width="391.181" height="28.514" x="2240.432" y="1134.064" fill="#dadada"/><rect width="391.181" height="28.514" x="2240.432" y="1134.064" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2245.4322 1138.5897)"><tspan x="173.991" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_185"><rect width="391.181" height="57.734" x="2240.432" y="732.964" fill="#dadada"/><rect width="391.181" height="57.734" x="2240.432" y="732.964" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2245.4322 742.87525)"><tspan x="162.767" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">pistioin</tspan> <tspan x="139.439" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">192.168.126.2</tspan></text></g><g id="Graphic_184"><rect width="391.181" height="43.04" x="2240.432" y="813.104" fill="#f3f9ff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 2240.4322 813.104 L 2631.6133 813.104 L 2631.6133 856.1441 L 2240.4322 856.1441 Z"/><text fill="#000" transform="translate(2245.4322 815.668)"><tspan x="140.535" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">init container</tspan> <tspan x="79.767" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules for ztunnel</tspan></text></g><g id="Graphic_183"><rect width="391.181" height="19.355" x="2240.432" y="697.39" fill="#f3f9ff"/><text fill="#000" transform="translate(2245.4322 697.3358)"><tspan x="166.583" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">tproxy</tspan></text></g><g id="Graphic_182"><rect width="289.936" height="39.684" x="2293.181" y="1010.926" fill="#fff"/><text fill="#000" transform="translate(2298.1807 1015.9258)"><tspan x="34.992" y="12" fill="#000" font-family="Helvetica Neue" font-size="12" font-weight="bold">iptables chain ztunnel-PREROUTING</tspan> <tspan x="89.946" y="26.348" fill="#000" font-family="Helvetica Neue" font-size="12">mark 0x200/0x200</tspan></text></g><g id="Graphic_181"><rect width="243.071" height="24.336" x="2314.487" y="899.219" fill="#fff"/><text fill="#000" transform="translate(2319.4873 904.2188)"><tspan x="77.859" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">Geneve tunnel</tspan></text></g><g id="Graphic_180"><rect width="289.936" height="28.514" x="2291.055" y="168.952" fill="#dadada"/><rect width="289.936" height="28.514" x="2291.055" y="168.952" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2296.0547 173.47674)"><tspan x="123.368" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">eth0</tspan></text></g><g id="Graphic_179"><rect width="391.181" height="463.567" x="2240.432" y="217.225" fill="#fff"/><rect width="391.181" height="463.567" x="2240.432" y="217.225" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2245.4322 653.7911)"><tspan x="0" y="17" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">E</tspan> <tspan y="17" fill="#000" font-family="PingFang SC" font-size="16" font-weight="bold">nvoy Proxy</tspan></text></g><g id="Graphic_178"><rect width="322.616" height="27.67" x="2274.715" y="607.831" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 611.9334)"><tspan x="2.836" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">inbound_CONNECT_terminate Listnener</tspan></text></g><g id="Graphic_177"><rect width="322.616" height="27.67" x="2274.715" y="561.821" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 565.9242)"><tspan x="48.924" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Internal Inbound VIP Cluster</tspan></text></g><g id="Graphic_176"><rect width="322.616" height="27.67" x="2274.715" y="506.214" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 510.3164)"><tspan x="76.908" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Inbound VIP Listener</tspan></text></g><g id="Graphic_175"><rect width="322.616" height="27.67" x="2274.715" y="450.606" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 454.70867)"><tspan x="80.316" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Inbound VIP Cluster</tspan></text></g><g id="Graphic_174"><rect width="322.616" height="27.833" x="2274.715" y="293.217" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 298.2173)"><tspan x="10.396" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">inbound_CONNECT_originate Listener</tspan></text></g><g id="Graphic_173"><rect width="322.616" height="27.833" x="2274.715" y="240.481" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 245.48125)"><tspan x="13.804" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">inbound_CONNECT_originate Cluster</tspan></text></g><g id="Line_172"><line x1="2436.023" x2="2436.023" y1="607.831" y2="599.391" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_171"><line x1="2436.023" x2="2436.023" y1="561.821" y2="543.783" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_170"><line x1="2436.023" x2="2436.023" y1="506.214" y2="488.175" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_169"><line x1="2436.023" x2="2436.023" y1="293.217" y2="278.215" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_168"><rect width="322.616" height="27.67" x="2274.715" y="398.198" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 402.3004)"><tspan x="74.532" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Inbound Pod Listener</tspan></text></g><g id="Graphic_167"><rect width="322.616" height="27.67" x="2274.715" y="345.789" fill="#0a55a8"/><text fill="#fff" transform="translate(2279.7146 349.89215)"><tspan x="77.94" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">Inbound Pod Cluster</tspan></text></g><g id="Graphic_166"><rect width="135.968" height="27.331" x="2367.637" y="653.84" fill="#0a55a8"/><text fill="#fff" transform="translate(2372.637 657.7736)"><tspan x="40.744" y="16" fill="#fff" font-family="Helvetica Neue" font-size="16" font-weight="bold">15006</tspan></text></g><g id="Line_165"><line x1="2436.023" x2="2436.023" y1="697.39" y2="691.063" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_164"><line x1="2436.023" x2="2436.023" y1="450.606" y2="435.767" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_163"><line x1="2436.023" x2="2436.023" y1="398.198" y2="383.359" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_162"><line x1="2436.023" x2="2436.023" y1="345.789" y2="330.951" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_161"><line x1="2435.621" x2="2435.621" y1="653.84" y2="645.392" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Line_160"><line x1="2436.023" x2="2436.023" y1="240.481" y2="207.366" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)"/></g><g id="Graphic_159"><rect width="391.181" height="28.346" x="2240.432" y="120.847" fill="#dadada"/><rect width="391.181" height="28.346" x="2240.432" y="120.847" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text fill="#000" transform="translate(2245.4322 125.28777)"><tspan x="161.391" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">vethxxx</tspan></text></g><g id="Line_158"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 2436.0227 168.95162 L 2436.0227 159.07234 L 2436.0227 159.11431 L 2436.0227 159.09305"/></g><g id="Line_157"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" marker-end="url(#FilledArrow_Marker)" d="M 2631.6133 135.01982 L 2698.4804 135.01982 L 2698.4804 1029.524 L 2595.6624 1029.524 L 2595.6624 1124.1645"/></g><g id="Graphic_156"><text fill="#000" transform="translate(2649.6574 116.57183)"><tspan x="7.416" y="15" fill="#000" font-family="Helvetica Neue" font-size="16">To</tspan> <tspan x="0" y="33.448" fill="#000" font-family="Helvetica Neue" font-size="16">eth0</tspan></text></g><g id="Graphic_155"><text fill="#000" transform="translate(2446.25 542.48546)"><tspan x="2.483" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">STATIC</tspan></text></g><g id="Graphic_154"><text fill="#000" transform="translate(2446.25 431.98833)"><tspan x="4.526" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">EDS</tspan></text></g><g id="Graphic_153"><text fill="#000" transform="translate(2446.25 327.10644)"><tspan x="2.483" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">STATIC</tspan></text></g><g id="Graphic_152"><text fill="#000" transform="translate(2441.998 222.22455)"><tspan x="4.967" y="11" fill="#000" font-family="Helvetica Neue" font-size="12">ORIGINAL_DST</tspan></text></g><g id="Graphic_151"><rect width="391.181" height="57.734" x="2240.432" y="1057.047" fill="#fff"/><path stroke="gray" stroke-dasharray="4 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M 2240.4322 1057.0472 L 2631.6133 1057.0472 L 2631.6133 1114.781 L 2240.4322 1114.781 Z"/><text fill="#000" transform="translate(2245.4322 1066.958)"><tspan x="157.727" y="16" fill="#000" font-family="Helvetica Neue" font-size="16" font-weight="bold">Istio CNI</tspan> <tspan x="38.559" y="34.464" fill="#000" font-family="Helvetica Neue" font-size="16">Setup iptables rules and veth pair for node</tspan></text></g><g id="Graphic_150"><rect width="98.02" height="24" x="1592.25" y="848.28" fill="#fff"/><text fill="#000" transform="translate(1597.25 853.2805)"><tspan x="0" y="11" fill="#000" font-family="Helvetica" font-size="12">ORIGINAL_DST</tspan></text></g></g></g></svg>