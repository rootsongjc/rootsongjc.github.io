<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>åšå®¢ Â· Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="Jimmy Song çš„åŸåˆ›åšå®¢åŠè¯‘æ–‡ã€‚">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.129.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/blog/" />
  <meta property="og:title" content="åšå®¢ | Jimmy Song" />
  <meta property="twitter:title" content="åšå®¢ | Jimmy Song" />

  
  <meta property="og:description" content="Jimmy Song çš„åŸåˆ›åšå®¢åŠè¯‘æ–‡ã€‚" />
  <meta property="twitter:description" content="Jimmy Song çš„åŸåˆ›åšå®¢åŠè¯‘æ–‡ã€‚" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">åšå®¢</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/book">èµ„æ–™</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">æ ‡ç­¾</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">å…¬å‘Š</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">è”ç³»</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">å…³äº</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">ç¤¾åŒº</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">è§†é¢‘ <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    <a class="nav-link" href="/en/blog/">English</a>
                    
                  
                
              
              
              
                
                  
                    
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>æœç´¢</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">âŒ˜</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>ç«™å†…æœç´¢</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="å…³é—­"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="è¯·è¾“å…¥æœç´¢è¯" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="è¯·è¾“å…¥æœç´¢è¯">
        
        <div class="mt-4">
          <span>æœç´¢ç±»å‹: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">æ‰€æœ‰</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">åŸåˆ›</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">è¯‘æ–‡</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">èµ„æ–™</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">å…¬å‘Š</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    åšå®¢
                </p>
                <p class="page-description">
                    Jimmy Song çš„åŸåˆ›åšå®¢åŠè¯‘æ–‡ã€‚
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/battle-of-the-pods-kubernetes-autoscaling-showdown-keda-vs-vanilla-kubernetes/">[è¯‘] KEDA vs. åŸç”Ÿ Kubernetesï¼šè°æ˜¯äº‘åŸç”Ÿåº”ç”¨çš„è‡ªåŠ¨ä¼¸ç¼©ç‹è€…ï¼Ÿ</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/12</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/kubernetes"> 
             Kubernetes
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.kedify.io/blog-posts/battle-of-the-pods-kubernetes-autoscaling-showdown-keda-vs-vanilla-kubernetes" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('KEDA vs. åŸç”Ÿ Kubernetesï¼šè°æ˜¯äº‘åŸç”Ÿåº”ç”¨çš„è‡ªåŠ¨ä¼¸ç¼©ç‹è€…ï¼Ÿ', 'æœ¬æ–‡æ¯”è¾ƒäº† Kubernetes çš„å†…ç½®è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼ˆHPA å’Œ VPAï¼‰å’Œ KEDA é¡¹ç›®çš„ä¼˜ç¼ºç‚¹ï¼Œåˆ†æäº†å®ƒä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹çš„é€‚ç”¨æ€§å’Œæ•ˆæœï¼Œå±•ç¤ºäº† KEDA å¦‚ä½•è§£å†³ HPA å’Œ VPA æ— æ³•è¦†ç›–çš„å¤æ‚éœ€æ±‚ã€‚', '\n### 1. å¼•è¨€ï¼šè‡ªåŠ¨ä¼¸ç¼©çš„é‡è¦æ€§\n\nåœ¨ä»Šå¤©çš„äº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæ³¢åŠ¨çš„å·¥ä½œè´Ÿè½½å’ŒåŠ¨æ€çš„æµé‡æ¨¡å¼æ˜¯å¸¸æ€ã€‚é€‚åº”è¿™ç§ä¸å¯é¢„æµ‹çš„è¡Œä¸ºéœ€è¦èƒ½å¤Ÿå®æ—¶è°ƒæ•´çš„ç³»ç»Ÿã€‚è‡ªåŠ¨ä¼¸ç¼©æ˜¯å¿…éœ€çš„ï¼Œå¯ä»¥ç¡®ä¿èµ„æºçš„æœ€ä½³åˆ†é…ï¼Œéåˆ¶è¿‡åº¦æˆæœ¬ï¼Œå¹¶ä¿ƒè¿›èµ„æºçš„é«˜æ•ˆä½¿ç”¨ã€‚\n\nè‡ªåŠ¨ä¼¸ç¼©ä¸ä»…å…³ä¹æˆæœ¬ã€‚å®ƒåœ¨ç»´æŠ¤åº”ç”¨æ€§èƒ½å’Œååé‡æ–¹é¢å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚é€šè¿‡é¿å…æ¬ é…ç½®ï¼ˆå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ï¼‰å’Œè¿‡åº¦é…ç½®ï¼ˆå¯¼è‡´ä¸å¿…è¦çš„æˆæœ¬ï¼‰ï¼Œè‡ªåŠ¨ä¼¸ç¼©å¯ä»¥å®ç°åˆç†çš„å¹³è¡¡ã€‚\n\n### 2. ç«äº‰è€…ï¼šäº†è§£åŸºç¡€çŸ¥è¯†\n\n### æ°´å¹³ Pod è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼ˆHPAï¼‰\n\n[HPA](https:\/\/kubernetes.io\/docs\/tasks\/run-application\/horizontal-pod-autoscale\/)ï¼Œä½œä¸º Kubernetes çš„æœ¬åœ°è§£å†³æ–¹æ¡ˆï¼Œæ ¹æ®è§‚å¯Ÿåˆ°çš„æŒ‡æ ‡ï¼ˆä¸»è¦æ˜¯ CPU å’Œå†…å­˜ï¼‰æ¥æ‰©å±• Pod çš„æ•°é‡ã€‚è™½ç„¶å¯¹äºç»Ÿä¸€çš„å·¥ä½œè´Ÿè½½æ¥è¯´éå¸¸ç›´æ¥å’Œæœ‰ç›Šï¼Œä½†å½“è€ƒè™‘åˆ°å…¶æ— æ³•æ‰©å±•åˆ°é›¶å¹¶ä¸”å®Œå…¨ä¾èµ– CPU å’Œå†…å­˜æŒ‡æ ‡æ—¶ï¼Œå®ƒçš„å±€é™æ€§å°±å˜å¾—æ˜æ˜¾äº†ã€‚\n\n![HPA æ”¹å˜ Pod çš„æ•°é‡](1.jpg)\n\n### å‚ç›´ Pod è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼ˆVPAï¼‰\n\n[VPA](https:\/\/github.com\/kubernetes\/autoscaler\/tree\/master\/vertical-pod-autoscaler#intro)æ›´å¤šåœ°æ¶‰åŠèµ„æºçš„è°ƒæ•´è€Œä¸æ˜¯æ‰©å±•å®ƒä»¬ã€‚å®ƒè¯„ä¼°éœ€æ±‚å¹¶åŠ¨æ€è°ƒæ•´èµ„æºï¼Œç¡®ä¿å·¥ä½œè´Ÿè½½çš„åˆé€‚é€‚é…ã€‚ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¢å¼ºå‹çš„ Pod å¹¶ä¸ä¸€å®šæ›´å¥½ã€‚æœ‰æ—¶ï¼Œæ‹¥æœ‰æ›´å¤šçš„å·¥ä½œè¿›ç¨‹æ¥å¤„ç†æ•°æ®æ¯”æ‹¥æœ‰ä¸€ä¸ªå¤§è€Œå¼ºå¤§çš„å·¥ä½œè¿›ç¨‹æ›´é«˜æ•ˆã€‚\n\n![VPA è°ƒæ•´ Pod çš„å¤§å°](2.jpg)\n\n## 3. é™åˆ¶ï¼šå½“åŸç”Ÿ Kubernetes è‡ªåŠ¨ä¼¸ç¼©å™¨ä¸è¶³ä»¥åº”å¯¹æ—¶\n\nå°½ç®¡å†…ç½®çš„ Kubernetes è‡ªåŠ¨ä¼¸ç¼©å™¨å¦‚ HPA å’Œ VPA æä¾›äº†åŸºæœ¬çš„æ‰©å±•èƒ½åŠ›ï¼Œä½†å®ƒä»¬åœ¨èŒƒå›´ä¸Šå¤©ç„¶æœ‰é™ã€‚å®ƒä»¬ä¸»è¦å…³æ³¨ CPU å’Œå†…å­˜æŒ‡æ ‡å¯èƒ½å¯¹äºç°ä»£åº”ç”¨æ¥è¯´æ˜¯ä¸€ä¸ªé‡å¤§é™åˆ¶ï¼Œå› ä¸ºè¿™äº›åº”ç”¨å¯èƒ½éœ€è¦å¯¹å„ç§æŒ‡æ ‡åšå‡ºååº”ï¼Œå…¶ä¸­ä¸€äº›ç”šè‡³å¯èƒ½ä¸æ˜¯æ¥è‡ªåº”ç”¨ç¨‹åºæœ¬èº«çš„æŒ‡æ ‡ã€‚\n\nç°ä»£åº”ç”¨é¢ä¸´çš„å¼•äººæ³¨ç›®çš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯æ ¹æ®å¤–éƒ¨ç³»ç»Ÿçš„äº‹ä»¶æ¥è¿›è¡Œæ‰©å±•ã€‚ä¾‹å¦‚ï¼š\n\n- **æ¶ˆæ¯é˜Ÿåˆ—ï¼š** åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦æ ¹æ®é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°é‡ï¼ˆå¦‚ RabbitMQ æˆ– Kafkaï¼‰æ¥è¿›è¡Œæ‰©å±•ã€‚å¦‚æœæœ‰å¤§é‡æœªå¤„ç†çš„æ¶ˆæ¯æ¶Œå…¥ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ‰©å±•çš„æŒ‡æ ‡ã€‚\n- **æ•°æ®åº“è§¦å‘å™¨ï¼š** æ•°æ®åº“ä¸­çš„æ›´æ”¹æˆ–æ›´æ–°ï¼ˆå¦‚æŸä¸ªè¡¨çš„è¡Œçªç„¶å¢åŠ ï¼‰å¯èƒ½éœ€è¦å°†åº”ç”¨ç¨‹åºè¿›è¡Œæ‰©\n\nå±•ä»¥å¤„ç†æˆ–åˆ†ææ•°æ®çš„æ¶Œå…¥ã€‚\n- **å¤–éƒ¨ Webhookï¼š** æ¥è‡ªç¬¬ä¸‰æ–¹æœåŠ¡çš„ä¼ å…¥ Webhookï¼ˆä¾‹å¦‚ GitHub æ¨é€æˆ–ç”µå­å•†åŠ¡äº¤æ˜“äº‹ä»¶ï¼‰å¯èƒ½éœ€è¦æ›´å¤šçš„èµ„æºæ¥å¤„ç†é¢å¤–çš„è´Ÿè½½ã€‚\n- â€**IoT ä¿¡å·ï¼š** å¯¹äºè¿æ¥åˆ°ç‰©è”ç½‘è®¾å¤‡çš„åº”ç”¨ç¨‹åºï¼Œæ¥è‡ªè¿™äº›è®¾å¤‡çš„ä¿¡å·å¯èƒ½æ˜¯éœ€è¦æ‰©å±•çš„æŒ‡æ ‡ã€‚\n\næ­¤å¤–ï¼Œè¿˜å­˜åœ¨å°†æ‰©å±•åˆ°é›¶çš„å¿…è¦æ¥æœ‰æ•ˆç®¡ç†èµ„æºçš„æƒ…å†µï¼Œæˆ–è€…å­˜åœ¨ä¸åŒæŒ‡æ ‡çš„ç»„åˆå†³å®šæ‰©å±•é€»è¾‘çš„æƒ…å†µï¼Œä¾‹å¦‚ CPU åˆ©ç”¨ç‡ä¸æ•°æ®åº“è¯»\/å†™é€Ÿç‡ã€‚è¿™äº›å¾®å¦™çš„éœ€æ±‚çªæ˜¾äº†å†…ç½® Kubernetes è‡ªåŠ¨ä¼¸ç¼©å™¨çš„ä¸è¶³ä¹‹å¤„ã€‚â€\n\n### HPA çš„è‡ªå®šä¹‰æŒ‡æ ‡æ‰©å±•\n\nKubernetes å¼•å…¥äº†ä¸€ä¸ª[è‡ªå®šä¹‰æŒ‡æ ‡](https:\/\/kubernetes.io\/docs\/tasks\/run-application\/horizontal-pod-autoscale\/#scaling-on-custom-metrics)çš„æ¥å£ï¼Œæ—¨åœ¨ä¸ºæ°´å¹³ Pod è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼ˆHPAï¼‰æä¾›æ›´å¤šè¶…è¶Š CPU å’Œå†…å­˜æŒ‡æ ‡çš„é€‚åº”æ€§ã€‚ç„¶è€Œï¼Œå®é™…å®ç°ä¸­å‡ºç°äº†æŒ‘æˆ˜ã€‚\n\nå°½ç®¡å¼ºå¤§ï¼Œä½†è‡ªå®šä¹‰æŒ‡æ ‡ API å¹¶ä¸ç›´è§‚æ˜“ç”¨ã€‚å®ƒè¦æ±‚å¯¹ Kubernetes å†…éƒ¨æœ‰è¯¦ç»†çš„äº†è§£ï¼Œä½¿è®¾ç½®å’Œè°ƒæ•´å˜å¾—ç¹çã€‚â€\n\n### æ’æ›²ï¼šPrometheus é€‚é…å™¨\n\n[Prometheus é€‚é…å™¨](https:\/\/github.com\/kubernetes-sigs\/prometheus-adapter)è¯•å›¾é€šè¿‡åˆ©ç”¨è‡ªå®šä¹‰æŒ‡æ ‡ API æ¥å¼¥åˆè¿™ä¸€å·®è·ï¼Œå¼•å…¥äº† Prometheus çš„å¹¿æ³›æŒ‡æ ‡ã€‚ä½†å®ƒä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼šå¤æ‚ã€ä¸ç›´è§‚çš„é…ç½®ä»¥åŠä»…ä¸ Prometheus æŒ‡æ ‡ç›¸å…³è”ã€‚å®æ–½å’Œç»´æŠ¤é…ç½®éœ€è¦ä¸æ–­çš„è­¦è§‰æ€§ã€‚åŸºç¡€æ¶æ„æˆ–åº”ç”¨ç¨‹åºçš„æ›´æ”¹å¯èƒ½ä¼šè§¦å‘é‡æ–°é…ç½®çš„éœ€æ±‚ã€‚\n\n### 4. ç™»åœº KEDAï¼šå¯¹å†³ä¸­çš„è‹±é›„\n\n[Kubernetes äº‹ä»¶é©±åŠ¨è‡ªåŠ¨ä¼¸ç¼©ï¼ˆKEDAï¼‰](https:\/\/keda.sh\/)ä¸ä»…ä¸ Kubernetes çš„è‡ªå®šä¹‰æŒ‡æ ‡ API é›†æˆï¼Œè¿˜ä½¿å…¶å˜å¾—æ›´åŠ å¯è®¿é—®ã€‚è¿™æ˜¯ç”¨æˆ·å‹å¥½ç•Œé¢å¦‚ä½•æ”¹å˜ä½“éªŒçš„è¯æ˜ï¼Œä½¿è‡ªåŠ¨ä¼¸ç¼©çœŸæ­£å…·æœ‰å¯å®šåˆ¶æ€§å’Œå¤šåŠŸèƒ½æ€§ã€‚\n\n### KEDA çš„å¥½å¤„\n\nKEDA æä¾›äº†å¤šä¸ªæŠ€æœ¯ä¼˜åŠ¿ï¼š\n\n- **äº‹ä»¶é©±åŠ¨è‡ªåŠ¨ä¼¸ç¼©ï¼š** KEDA èƒ½å¤Ÿå“åº”ç‰¹å®šäº‹ä»¶ï¼Œç”šè‡³æ‰©å±•åˆ°é›¶ï¼Œç¡®ä¿èµ„æºå¾—åˆ°æ˜æ™ºåœ°ä½¿ç”¨ã€‚\n- **æ˜“äºä½¿ç”¨ï¼š** å…¶ç›´è§‚çš„é…ç½®ä½¿å®æ–½å˜å¾—è½»æ¾ï¼Œå…è®¸å¼€å‘äººå‘˜ä¸“æ³¨äºåº”ç”¨é€»è¾‘è€Œä¸æ˜¯é…ç½®è¯­æ³•ã€‚\n- **å¹¿æ³›åº”ç”¨ï¼š** é™¤äº†ä»…æ‰©å±• Pod å¤–ï¼ŒKEDA è¿˜å¯ä»¥åŸºäºäº‹ä»¶å®‰æ’ Kubernetes ä½œä¸šï¼Œé€‚ç”¨äºä¸éœ€è¦æŒç»­è¿è¡Œä½†å¯èƒ½éœ€è¦å®šæœŸå¤§é‡èµ„æºçš„ä»»åŠ¡ã€‚\n- **å¤šåŠŸèƒ½é›†æˆï¼š** æ”¯æŒå¤šç§èº«ä»½éªŒè¯æä¾›ç¨‹åºï¼Œé›†æˆ KEDA æ—¢ç®€å•åˆå®‰å…¨ã€‚â€\n\n### KEDA åœ¨å®è·µä¸­çš„åº”ç”¨\n\n![KEDA æ‰©å±• Kafka Consumer åº”ç”¨ç¨‹åº](3.jpg)\n\nè™½ç„¶ä¼ ç»Ÿçš„æŒ‡æ ‡å¦‚ CPU å’Œå†…å­˜æä¾›äº†ä¸€äº›è§è§£ï¼Œä½†ç°å®ä¸–ç•Œçš„åº”ç”¨ç¨‹åºé€šå¸¸éœ€è¦æ›´ç²¾ç»†å’Œå¤šæ ·åŒ–çš„æŒ‡æ ‡æ¥è¿›è¡Œæœ‰æ•ˆçš„è‡ªåŠ¨ä¼¸ç¼©ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›è¦è€ƒè™‘çš„æƒ…æ™¯ï¼š\n\n- **äº‹ä»¶é©±åŠ¨åº”ç”¨ç¨‹åºï¼š** è€ƒè™‘ä¸€ä¸ªåŸºäº Kafka çš„è®¾ç½®ã€‚è™½ç„¶ CPU ä½¿ç”¨ç‡å¯èƒ½ä¿æŒç¨³å®šï¼Œä½†ä¼ å…¥ Kafka äº‹ä»¶çš„æ¿€å¢æ˜¯ç¡®å®šè´Ÿè½½çš„çœŸæ­£æŒ‡æ ‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨ä¼¸ç¼©åº”è¯¥ç†æƒ³åœ°å¯¹å…¥ç«™äº‹ä»¶çš„é€Ÿç‡æˆ–æ¶ˆæ¯ç§¯å‹åšå‡ºå“åº”ã€‚\n- **ç”µå­å•†åŠ¡äº¤æ˜“ï¼š** åœ¨ç”µå­å•†åŠ¡æ¡†æ¶ä¸­ï¼Œç‰¹æ®Šé”€å”®æ´»åŠ¨å¯èƒ½ä¼šå¯¼è‡´è®¢å•ç»“å¸æ¿€å¢ã€‚CPU å¯èƒ½ä¸å—å½±å“ï¼Œä½†çœŸæ­£çš„è´Ÿè½½å¯èƒ½æ˜¯æ•°æ®åº“é˜Ÿåˆ—ä¸­ç§¯ç´¯çš„æœªå¤„ç†è®¢å•ã€‚\n- **æµæ•°æ®ç®¡é“ï¼š** ä»å¹³å°ï¼ˆå¦‚ Apache Kafka æˆ– AWS Kinesisï¼‰å¤„ç†æ•°æ®æµçš„åº”ç”¨ç¨‹åºä¼šç»å†å¯å˜çš„æ•°æ®æµå…¥ç‡ã€‚åœ¨è¿™é‡Œï¼Œç›¸å…³çš„æŒ‡æ ‡å¯èƒ½æ˜¯å¤„ç†çš„ç§¯å‹æˆ–æ»åï¼Œè€Œä¸æ˜¯ CPU æˆ–å†…å­˜æ¶ˆè€—ã€‚\n- **Selenium æµ‹è¯•å·¥ä½œè€…ï¼š** åœ¨æŒç»­é›†æˆï¼ˆCIï¼‰æµæ°´çº¿ä¸­ï¼Œå½“æäº¤æ–°ä»£ç æ—¶ï¼Œå¯èƒ½ä¼šè§¦å‘ä¸€ç³»åˆ— Selenium æµ‹è¯•ã€‚è¿™é‡ŒçœŸæ­£çš„åº¦é‡æ ‡å‡†å¯èƒ½æ˜¯ç­‰å¾…æµ‹è¯•çš„é˜Ÿåˆ—ã€‚å¦‚æœæœ‰å¤§é‡ç­‰å¾…æµ‹è¯•çš„æµ‹è¯•å­˜åœ¨ç“¶é¢ˆï¼ŒåŸºäºè¿™ä¸ªé˜Ÿåˆ—æ¥è‡ªåŠ¨ä¼¸ç¼© Selenium å·¥ä½œè€…æ¯”ä»…ä»…è§‚å¯Ÿ CPU æˆ–å†…å­˜æŒ‡æ ‡æ›´æœ‰æ•ˆã€‚\n- **API é€Ÿç‡é™åˆ¶ï¼š** å¯¹äºå¤§é‡ä¾èµ–ç¬¬ä¸‰æ–¹ API ä¸”å…·æœ‰é€Ÿç‡é™åˆ¶çš„åº”ç”¨ç¨‹åºï¼Œæ¥è¿‘é€Ÿç‡é™åˆ¶å¯èƒ½æ˜¯éœ€è¦è¿›è¡Œä¼¸ç¼©çš„ä¿¡å·ã€‚ä¸å¯¹é€Ÿç‡é™åˆ¶é”™è¯¯çš„è¢«åŠ¨ååº”ä¸åŒï¼ŒåŸºäº API è°ƒç”¨é¢‘ç‡è¿›è¡Œä¸»åŠ¨ä¼¸ç¼©å¯ä»¥ç¡®ä¿æ“ä½œé¡ºåˆ©è¿›è¡Œã€‚\n\nè¿™æ ·å¤šæ ·åŒ–çš„ç°å®åœºæ™¯å¼ºè°ƒäº†éœ€è¦ä¸€ç§å¤šåŠŸèƒ½çš„è‡ªåŠ¨ä¼¸ç¼©è§£å†³æ–¹æ¡ˆï¼Œèƒ½å¤Ÿç†è§£å¹¶å“åº”å¤šç§åº¦é‡æ ‡å‡†ã€‚KEDA å‡­å€Ÿå…¶çµæ´»æ€§å’Œé€‚åº”æ€§æœ‰æ•ˆåœ°åº”å¯¹äº†è¿™äº›æŒ‘æˆ˜ã€‚\n\n### 5. ç»“è®ºï¼šKEDA è‡ªåŠ¨ä¼¸ç¼©çš„æœªæ¥\n\nå°½ç®¡ Kubernetes æ‹¥æœ‰åŸç”Ÿçš„è‡ªåŠ¨ä¼¸ç¼©å·¥å…·å¦‚ HPA å’Œ VPAï¼Œä»¥åŠåƒ Prometheus é€‚é…å™¨è¿™æ ·çš„æ‰©å±•ï¼Œä½†å®ƒä»¬é€šå¸¸ä¼´éšç€å¤æ‚æ€§ã€‚è€Œ KEDA æä¾›äº†ä¸€ä¸ªç®€å•çš„å¹³å°ï¼Œé€‚ç”¨äºå„ç§å„æ ·çš„è‡ªåŠ¨ä¼¸ç¼©éœ€æ±‚ã€‚å®ƒå¤„ç†äº‹ä»¶é©±åŠ¨çš„æ‰©å±•ï¼ŒåŒ…æ‹¬ç¼©å‡åˆ°é›¶ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡å¤§ä¼˜åŠ¿ã€‚æ­¤å¤–ï¼Œè®¾ç½® KEDA æ›´åŠ ç®€å•ï¼Œå‡å°‘äº†ç”¨æˆ·åœ¨å¤„ç† Kubernetes è‡ªå®šä¹‰æŒ‡æ ‡æ—¶é€šå¸¸ä¼šé‡åˆ°çš„å…¸å‹éšœç¢ã€‚\n\nKEDA çš„æ´»è·ƒç¤¾åŒºè¯æ˜äº†å®ƒçš„å®ç”¨æ€§ã€‚å¯¹è¯¥é¡¹ç›®çš„å®šæœŸè´¡çŒ®ã€åƒ Kedify æˆ– Microsoft è¿™æ ·çš„ä¾›åº”å•†ä»¥åŠä¸æ–­å¢åŠ çš„[ä¼ä¸šé‡‡ç”¨](https:\/\/keda.sh\/community\/#end-users)æ˜¾ç¤ºå‡ºå®ƒåœ¨ Kubernetes ç”Ÿæ€ç³»ç»Ÿä¸­æ—¥ç›Šé‡è¦ã€‚\n', '\/trans\/battle-of-the-pods-kubernetes-autoscaling-showdown-keda-vs-vanilla-kubernetes\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡æ¯”è¾ƒäº† Kubernetes çš„å†…ç½®è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼ˆHPA å’Œ VPAï¼‰å’Œ KEDA é¡¹ç›®çš„ä¼˜ç¼ºç‚¹ï¼Œåˆ†æäº†å®ƒä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹çš„é€‚ç”¨æ€§å’Œæ•ˆæœï¼Œå±•ç¤ºäº† KEDA å¦‚ä½•è§£å†³ HPA å’Œ VPA æ— æ³•è¦†ç›–çš„å¤æ‚éœ€æ±‚ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/why-the-latest-advances-in-opentelemetry-are-significant/">[è¯‘] OpenTelemetry çš„æœ€æ–°è¿›å±•åŠå…¶å¯¹å¯è§‚æµ‹æ€§çš„å½±å“</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/12</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7"> 
             å¯è§‚æµ‹æ€§
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thenewstack.com/why-the-latest-advances-in-opentelemetry-are-significant" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('OpenTelemetry çš„æœ€æ–°è¿›å±•åŠå…¶å¯¹å¯è§‚æµ‹æ€§çš„å½±å“', 'OpenTelemetry æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–è§‚æµ‹æ€§å’Œé¥æµ‹æ•°æ®æ ¼å¼çš„é¡¹ç›®ï¼Œæ”¯æŒå¤šç§å·¥å…·çš„äº’æ“ä½œã€‚æœ¬æ–‡ä»‹ç»äº†è¯¥é¡¹ç›®çš„æ–°ç‰¹æ€§ï¼Œå¦‚æ–°çš„è½¬æ¢è¯­è¨€ã€æ—¥å¿—æ”¯æŒå’Œè‡ªåŠ¨åŒ–ä¿®å¤èƒ½åŠ›ã€‚', '\nä»Šå¹´ï¼Œåœ¨äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼ˆCloud Native Computing Foundationï¼‰ä¸­ï¼Œä¸€ä¸ªå¤‡å—å…³æ³¨çš„é¡¹ç›®æ˜¯[OpenTelemetry](https:\/\/thenewstack.io\/observability-in-2024-more-opentelemetry-less-confusion\/)å’Œ[OpenTelemetry Collector](https:\/\/thenewstack.io\/how-the-opentelemetry-collector-scales-observability\/)ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯è§‚æµ‹é¢†åŸŸçš„ä¸€ä¸ªéå¸¸ä»¤äººå…´å¥‹çš„è¿åŠ¨ï¼Œæ—¨åœ¨è·¨è¡Œä¸šåˆä½œï¼Œè¾¾æˆè§‚æµ‹å’Œé¥æµ‹çš„æ ‡å‡†æ•°æ®æ ¼å¼ã€‚\n\nè¿™æœ¬èº«å°±éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå…è®¸å¤šä¸ªè§‚æµ‹å’Œåˆ†æå·¥å…·è¿›è¡Œäº’æ“ä½œï¼Œè€Œä»¥å‰çš„å›¢é˜Ÿå¦‚æœæƒ³è¦ä¸€ä¸ªå·¥å…·ä¸å¦ä¸€ä¸ªå·¥å…·è¿›è¡Œäº’æ“ä½œï¼Œå°±å¿…é¡»å¤šæ¬¡è½¬æ¢æ•°æ®ã€‚éšç€è§‚æµ‹é¢†åŸŸå›´ç»•äººå·¥æ™ºèƒ½\/æœºå™¨å­¦ä¹ çš„ç‚’ä½œï¼Œå…¬å¸æ›´æœ‰å¯èƒ½ä»ä¸€ä¸ªç³»ç»Ÿä¸­å­˜å‚¨å’ŒæŸ¥çœ‹æ•°æ®ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªç³»ç»Ÿä¸­è¿›è¡Œæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒã€‚\n\næ›´æ£’çš„æ˜¯ï¼Œç”±äºè¡Œä¸šä¾›åº”å•†å’Œä¸ªäººåœ¨[OpenTelemetry Collector](https:\/\/opentelemetry.io\/docs\/collector\/)ä¸Šåˆä½œï¼Œè¿™ä¸ªé¡¹ç›®ç»§ç»­ä¸æ–­å‘å±•ã€‚å®ƒæ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„ä»£ç†å’Œé¥æµ‹æ”¶é›†å™¨ï¼Œæä¾›é«˜ååé‡çš„é¥æµ‹æ•°æ®æ”¶é›†å’Œåˆ†æã€‚è¯¥æ”¶é›†å™¨å·²ç»æ”¯æŒè·Ÿè¸ªå’Œåº¦é‡æ•°æ®ä¸€æ®µæ—¶é—´äº†ï¼Œä½†ç›´åˆ°å»å¹´çš„[KubeCon Detroit 2022](https:\/\/thenewstack.io\/kubeconcloudnativecon-2022-rolls-into-detroit\/)ï¼Œç¤¾åŒºæ‰å¸çº³äº† OpenLogs é¡¹ç›®ï¼Œå¹¶å¼€å§‹å®æ–½æ—¥å¿—æ”¶é›†å’Œåˆ†æåŠŸèƒ½ã€‚ç°åœ¨ï¼Œæ—¥å¿—æ”¯æŒå·²ç»å®Œå…¨æˆç†Ÿã€‚\n\nåœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘å°†åˆ†äº«ä¸€äº›å…³äºè¿™ä¸ªé¡¹ç›®çš„æ–°ç‰¹æ€§ä»¥åŠå®ƒä»¬å¯¹ç¤¾åŒºçš„é‡è¦æ€§ã€‚\n\n## 1. æ–°çš„è½¬æ¢è¯­è¨€\n\næˆ‘å‘ç°è®¸å¤šä»£ç†çš„è¯­æ³•ä½¿å¾—è¿›è¡Œæœ‰æ„ä¹‰çš„è½¬æ¢éå¸¸å›°éš¾ï¼Œéœ€è¦ä½¿ç”¨ä¸€äº›å¥‡æ€ªçš„ YAML æˆ– TOMLã€‚Otel Collector ä»ç„¶ä¾èµ–äº YAML æ ¼å¼ï¼Œä½†å®ƒçš„æ–°è½¬æ¢è¯­è¨€å…è®¸ä½¿ç”¨åŸºäºå‡½æ•°çš„è¯­å¥ï¼Œæ‰§è¡Œèµ·æ¥éå¸¸å¿«é€Ÿï¼Œå¯ä»¥ç®¡ç†å¤æ‚æ€§ã€‚æŸ¥çœ‹ä¸€äº›[è¯­æ³•ç¤ºä¾‹](https:\/\/github.com\/open-telemetry\/opentelemetry-collector-contrib\/blob\/main\/pkg\/ottl\/README.md)ã€‚\n\n## 2. æ—¥å¿—æ­£å¼å‘å¸ƒ\n\nåœ¨å¤§çº¦ä¸€å¹´çš„å¼€å‘æ—¶é—´å†…ï¼Œæ—¥å¿—æ”¶é›†å’Œåˆ†æç°åœ¨å·²ç»æ­£å¼å‘å¸ƒã€‚è¯¥å®æ–½æœ‰ä¸€äº›æ”¶é›†æ—¥å¿—çš„æ–¹æ³•ï¼š\n\n- é¦–å…ˆï¼Œå®ƒä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ä»£ç†è¿è¡Œï¼Œå¹¶ä»æ–‡ä»¶ç³»ç»Ÿæ”¶é›†æ—¥å¿—ã€‚å®ƒå¯ä»¥ç›´æ¥å‘é€åˆ°æœ€ç»ˆç›®çš„åœ°ï¼Œä¹Ÿå¯ä»¥è½¬å‘åˆ°ä»¥æ”¶é›†å™¨æ¨¡å¼è¿è¡Œçš„ OpenTelemetry Collectorï¼Œå¯ä»¥å³æ—¶è®¡ç®—æ—¥å¿—æŒ‡æ ‡ã€‚\n- å…¶æ¬¡ï¼Œå­˜åœ¨è®¸å¤šæ—¥å¿— SDKï¼Œå¯ä»¥ç›´æ¥åœ¨åº”ç”¨ç¨‹åºä¸­å®æ–½ï¼Œå¹¶å°†æ—¥å¿—å‘é€åˆ°ä¸­å¤®æ”¶é›†å™¨æˆ–ç›´æ¥å‘é€åˆ°æœ€ç»ˆç›®çš„åœ°ï¼Œè¿™æœ‰åŠ©äºå‡å°‘ç£ç›˜ IO çš„å½±å“ã€‚\n\n## 3. è‡ªåŠ¨ä»ªå™¨æˆç†Ÿåº¦\n\nè‡ªåŠ¨ä»ªå™¨æ˜¯è‡ªåŠ¨å°†åº”ç”¨ç¨‹åºè¿æ¥åˆ°å‘å‡ºè·Ÿè¸ªå’Œåº¦é‡æ•°æ®è€Œæ— éœ€æˆ–ä»…éœ€è¿›è¡Œæœ€å°‘ä»£ç æ›´æ”¹çš„èƒ½åŠ›ã€‚Java å’Œ.Net å¾—åˆ°äº†å…¨é¢æ”¯æŒï¼Œå…¶ä»–è¯­è¨€æ­£å¤„äºä¸åŒå¼€å‘å’Œå‘å¸ƒé˜¶æ®µã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ä¸€äº›ä¸“æœ‰è§£å†³æ–¹æ¡ˆå±•ç¤ºå‡ºæ¥çš„ç‰¹è‰²ï¼Œå› ä¸ºå®ƒé€šè¿‡å‡å°‘å¼€å‘äººå‘˜çš„æ—¶é—´æ¥é™ä½éƒ¨ç½²å¤æ‚æ€§ï¼Œç°åœ¨å®ƒå°†åŒæ ·å¼ºå¤§çš„åŠŸèƒ½å¸¦åˆ°äº† OpenTelemetry ç”Ÿæ€ç³»ç»Ÿä¸­ã€‚\n\n## 4. è¯­ä¹‰çº¦å®š\n\nè¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå¹¶ä¸”æ­£åœ¨ä» ElasticSearch å‘ OpenTelemetry é¡¹ç›®æèµ  ECSï¼ˆElastic Common Schemaï¼‰è€Œå—ç›Šã€‚è§„èŒƒåŒ–æ—¥å¿—å’Œé¥æµ‹ç»“æ„å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºä¼¼ä¹å‡ ä¹æ¯ä¸ªäººéƒ½ä»¥ç¨å¾®ä¸åŒçš„æ ¼å¼ç”Ÿæˆé¥æµ‹æ•°æ®ï¼›ä½†è¦èƒ½å¤Ÿåˆ†æã€åˆ›å»ºè­¦æŠ¥å¹¶ä»¥äººæ€§åŒ–çš„æ–¹å¼å‘ˆç°æ•°æ®ï¼Œæ‰€æœ‰é¥æµ‹å­—æ®µéƒ½éœ€è¦ä»¥æŸç§æ–¹å¼æ˜ å°„ã€‚å¦‚æœæ¯ä¸ªäººå’Œæ¯ä¸ªç³»ç»Ÿéƒ½ç•¥æœ‰ä¸åŒï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºå¯é‡ç”¨çš„ä»ªè¡¨æ¿å’Œç»„ä»¶æ–¹é¢å°±ä¼šå‡ºç°æŒ‘æˆ˜ã€‚ç°åœ¨ï¼Œè½¯ä»¶ä¾›åº”å•†å¯ä»¥è´Ÿè´£åœ¨å¤šä¸ªå¹³å°ä¸Šåˆ›å»ºä»ªè¡¨æ¿ï¼Œåˆç†åœ°ç¡®ä¿æ•°æ®å°†ä»¥å¤šä¸ªå¹³å°ä¸Šçš„æ­£ç¡®æ ¼å¼è¿›è¡Œå‘é€ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ç®¡ç†å¤§é‡é¥æµ‹æ•°æ®çš„äººå¯ä»¥é€šè¿‡ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„å­—æ®µåç§°æ¥æé«˜æ‘„å–å’ŒæŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶ä¸”åœ¨å¤§å¤šæ•°å®¢æˆ·å‘é€çš„å†…å®¹ä¾èµ–äºè¿™äº›å­—æ®µåç§°æ—¶ï¼Œå¯ä»¥æä¾›æ›´é«˜çº§çš„åŠŸèƒ½ï¼ŒåŒæ—¶å‡å°‘è®¡ç®—èµ„æºå’Œå†…å­˜å¼€é”€ã€‚\n\nå®Œæ•´çš„æ¶æ„ä»ç„¶éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½æœ€ç»ˆç¡®å®šï¼Œä½†é€æ­¥æ­£åœ¨æ‰¹å‡†è¿™äº›çº¦å®šã€‚ä¾‹å¦‚ï¼Œåœ¨ KubeCon ä¸Šï¼Œä»–ä»¬å®£å¸ƒäº† HTTP æ¶æ„çš„æœ€ç»ˆç¡®å®šã€‚\n\n## 5. æ’ä»¶æ¡†æ¶å’Œç”Ÿæ€ç³»ç»Ÿ\n\nç”Ÿæ€ç³»ç»Ÿæ­£åœ¨ä¸æ–­æˆç†Ÿã€‚å¯æ‰©å±•æ€§æ¡†æ¶å…è®¸è‡ªå®šä¹‰ä»»ä½•æ‘„å–ç®¡é“\n\nçš„ä»»ä½•é˜¶æ®µã€‚æœ‰è¶Šæ¥è¶Šå¤šçš„æ¥æ”¶å™¨ç”¨äºå„ç§ç³»ç»Ÿï¼Œå¤„ç†å™¨å…·æœ‰è¶Šæ¥è¶Šå…ˆè¿›çš„åŠŸèƒ½ï¼Œç›®æ ‡ä¹Ÿåœ¨å¢åŠ ã€‚æˆ‘ç‰¹åˆ«å¯¹æ–°ç‰ˆæœ¬çš„ OpenSearch æ‰©å±•æ„Ÿåˆ°å…´å¥‹ï¼Œå®ƒå¯ä»¥å‘é€é¢„æ‰“åŒ…åœ¨ç®€åŒ–çš„é¥æµ‹æˆ– ECS æ ¼å¼ä¸­çš„æ—¥å¿—æ•°æ®ã€‚\n\nä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘å‘ç°æ¨¡å¼å’Œå†…éƒ¨â€œpâ€æ¶ˆæ¯æ¨¡å¼çš„ç»“æ„éå¸¸å‘¨åˆ°ï¼Œå†…ç½®äº† protobufã€‚å®ƒåœ¨åŠŸèƒ½è‡ªç”±åº¦å’Œæœ€å°å¤æ‚åº¦ä¹‹é—´æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¹³è¡¡ã€‚\n\n## 6. ç¤¾åŒºåˆä½œ\n\nè¿™å¯¹äº CNCF ç¤¾åŒºæ¥è¯´å¹¶ä¸æ˜¯å¾ˆæ–°é²œï¼Œä½†è¿™ä¸ªé¡¹ç›®çš„é€Ÿåº¦å’Œå½±å“ä½“ç°äº† CNCF ç¤¾åŒºå“²å­¦çš„ç²¾ç¥ã€‚ç«äº‰å…¬å¸æ­£åœ¨å…±åŒåŠªåŠ›ï¼Œä½¿è®¡ç®—çš„ä¸€éƒ¨åˆ†å˜å¾—æ›´å¥½ã€æ›´å®¹æ˜“ï¼Œä»¥é€ ç¦æˆ‘ä»¬å…¶ä»–äººã€‚æœ‰äº›äººå¯èƒ½æ‹…å¿ƒå»é™¤ä¾›åº”å•†é”å®šä¼šå¯¼è‡´å®¢æˆ·ç¦»å¼€ï¼Œæˆ–è€…å…±äº«ä»£ç å¯èƒ½æ³„æ¼ä¸“æœ‰ IPã€‚\n\nç„¶è€Œï¼Œåœ¨é¥æµ‹é¢†åŸŸï¼Œä»£ç†å’Œæ”¶é›†å™¨çš„æ ¸å¿ƒæ¶æ„é€šå¸¸æ˜¯å·²è§£å†³çš„é—®é¢˜ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¸åˆ¶ä½œä¸€äº›éµå¾ªæƒ¯ä¾‹å¹¶åœ¨å„ä¸ªå¹³å°ä¸Šè¿è¡Œçš„ä¸œè¥¿ï¼Œä»¥ä¾¿å…¬å¸ä¸å†å¿…é¡»ç»´æŠ¤ä»£ç†ä»£ç ï¼Œå…¶ä¸­ 80% éƒ½æ˜¯é‡å¤çš„å‘¢ï¼Ÿè¿™ä½¿å…¬å¸å¯ä»¥åœ¨äº’æ“ä½œæ€§å’Œåˆ›æ–°å¯ä»¥é€šè¿‡è¿™ä¸ªæ¡†æ¶ä¼ é€’çš„ä¸“æœ‰å¤„ç†å™¨æ–¹é¢å…±åŒå¼€å‘æ’ä»¶ã€‚å¥½å¤„ä¹Ÿå»¶ä¼¸åˆ°æ‰€æœ‰è¿è¥å•†å’Œè½¯ä»¶ä¾›åº”å•†ã€‚å€ŸåŠ©æ ‡å‡†åŒ–çš„ Otel Collector SDKï¼Œä¾›åº”å•†å¯ä»¥åˆ›å»ºä¸€ä¸ªå•ä¸€çš„é›†æˆæ¥ä¸ºå…¶åº”ç”¨ç¨‹åºæ·»åŠ é¥æµ‹ï¼Œå¹¶æå¤§ç®€åŒ–äº†æ”¶é›†è¿‡ç¨‹ï¼Œè¯•å›¾è®©æ‰€æœ‰ä¸»è¦çš„è§‚æµ‹æä¾›å•†ä¸ºä½ çš„åº”ç”¨ç¨‹åºå®æ–½æ”¯æŒã€‚\n\nè¿è¥å•†ä¹Ÿä»â€œéšå¤„æ”¶é›†â€å’Œâ€œéšå¤„å‘é€â€çš„ç†å¿µä¸­å—ç›Šã€‚é€šè¿‡æ ‡å‡†çš„é…ç½®æ–‡ä»¶æ ¼å¼ç®€åŒ–äº†è®¾ç½®ï¼Œå‡å°‘äº†æ–°ç³»ç»Ÿçš„å¼•å…¥å¤æ‚æ€§ã€‚æˆ‘è¿˜æ€€ç–‘ï¼Œè®¸å¤šæ—¥å¿—ç³»ç»Ÿçš„è¿è¥å•†åœ¨è§‚æµ‹æ•°æ®çš„è¯­ä¹‰çº¦å®šé¡¹ç›®å‡å°‘äº†è®¸å¤šé—®é¢˜åï¼Œå°†å¤§å¤§å‡å°‘å­—æ®µæ˜ å°„çš„åŸºæ•°é—®é¢˜ã€‚\n\n## æ€»ç»“\n\nå‘æ‰€æœ‰é¡¹ç›®è´¡çŒ®è€…å’Œç¤¾åŒºæˆå‘˜è¡¨ç¤ºè¡·å¿ƒçš„â€œæ„Ÿè°¢â€ï¼è¿™é‡Œæœ‰å¤ªå¤šäººè¦åˆ—å‡ºæ¥äº†ï¼Œä½†ä½ å¯ä»¥åœ¨[GitHub ä¸Šçš„ OpenTelemetry é¡¹ç›®](https:\/\/github.com\/open-telemetry\/community\/blob\/main\/community-members.md)ä¸Šæ‰¾åˆ°ä»–ä»¬ã€‚\n\nOpenTelemetry å’Œ OpenTelemetry Collector çš„åŠŸèƒ½å’Œæœªæ¥è·¯å¾„æ­£åœ¨ä»¥æå¿«çš„é€Ÿåº¦å‰è¿›ï¼Œè¿‡å»ä¸€å¹´æ˜¯ CNCF ç»„åˆä¸­è´¡çŒ®ç¬¬äºŒå¤šçš„é¡¹ç›®ï¼Œä»…æ¬¡äº Kubernetesã€‚æœ‰è¿™ä¹ˆå¤šè´¡çŒ®è€…ä¿æŒç»„ç»‡å’Œåˆä½œï¼Œæˆç†Ÿåº¦å°†ç»§ç»­åŠ é€Ÿã€‚è¿™å°†æœ‰æœ›é€šè¿‡å¢åŠ äº’æ“ä½œæ€§å¹¶ç®€åŒ–ä»ªè¡¨ç³»ç»Ÿçš„ä»ªå™¨åŒ–è¿‡ç¨‹æ¥ä¿ƒè¿›è§‚æµ‹é¢†åŸŸçš„åˆ›æ–°ã€‚\n', '\/trans\/why-the-latest-advances-in-opentelemetry-are-significant\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">OpenTelemetry æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–è§‚æµ‹æ€§å’Œé¥æµ‹æ•°æ®æ ¼å¼çš„é¡¹ç›®ï¼Œæ”¯æŒå¤šç§å·¥å…·çš„äº’æ“ä½œã€‚æœ¬æ–‡ä»‹ç»äº†è¯¥é¡¹ç›®çš„æ–°ç‰¹æ€§ï¼Œå¦‚æ–°çš„è½¬æ¢è¯­è¨€ã€æ—¥å¿—æ”¯æŒå’Œè‡ªåŠ¨åŒ–ä¿®å¤èƒ½åŠ›ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/application-traffic-with-ebpf/">[è¯‘] ç”¨ eBPF æ´å¯Ÿåº”ç”¨å±‚ç½‘ç»œæµé‡</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/10</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%85%b6%e4%bb%96"> 
             å…¶ä»–
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thebsdbox.co.uk/2023/12/08/Application-traffic-with-eBPF/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ç”¨ eBPF æ´å¯Ÿåº”ç”¨å±‚ç½‘ç»œæµé‡', 'æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ eBPF ç¨‹åºæ•è·ã€åˆ†æå’Œä¿®æ”¹åº”ç”¨å±‚çš„ç½‘ç»œæ•°æ®ï¼ŒåŒ…æ‹¬ HTTP å¤´éƒ¨å’Œ URL è·¯å¾„ã€‚ä½œè€…è¿˜å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ eBPF map åœ¨å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´ä¼ é€’æ•°æ®ã€‚', 'åœ¨[å…ˆå‰çš„å¸–å­](..\/ebpf-adventures-in-networking\/)ä¸­ï¼Œæˆ‘ç¨å¾®è°ˆåˆ°äº†å»ºç«‹ eBPF çŸ¥è¯†ï¼Œä»¥å¼€å§‹æ›´å¤šåœ°äº†è§£ç½‘ç»œé€‚é…å™¨çš„è¾“å…¥å’Œè¾“å‡ºæƒ…å†µã€‚åŸºæœ¬ä¸Šï¼Œå°†ä»¥å¤ªç½‘å¸§å¹¶å‰¥ç¦»æ ‡å¤´ï¼ˆä»¥å¤ªç½‘æ ‡å¤´\u002bIP æ ‡å¤´\u002bTCP\/UDP æ ‡å¤´ï¼‰ï¼Œæœ€ç»ˆä½ å°†å¾—åˆ°æ¥è‡ªåº”ç”¨ç¨‹åºæˆ–æ•°æ®è§’åº¦çš„æ•°æ®åŒ…ä¸­å‰©ä½™çš„å†…å®¹ã€‚\n\næ‰€æœ‰çš„ä»£ç éƒ½åœ¨â€œå­¦ä¹  eBPFâ€å­˜å‚¨åº“ä¸­ï¼Œå…·ä½“çš„ eBPF ä»£ç åœ¨[è¿™é‡Œ](https:\/\/github.com\/thebsdbox\/learning-ebpf\/blob\/main\/ebpf\/http\/http.c)ã€‚è¿™ç¯‡æ–‡ç« çš„è®¡åˆ’æ˜¯é€æ­¥ä»‹ç»æˆ‘è®¤ä¸ºæœ‰ç”¨æˆ–å¯èƒ½é‡è¦çš„éƒ¨åˆ†...\n\n**æ³¨æ„**ï¼šæ­¤ä»£ç ç¡®å®å¯¹å…¥å£\/å‡ºå£æ•°æ®åŒ…è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œå› æ­¤éœ€è¦ 6.1\u002b çš„ Linux å†…æ ¸æ‰èƒ½ä½¿ç”¨ä¸€äº› eBPF åŠ©æ‰‹å‡½æ•°ã€‚\n\n## æ˜ å°„ï¼\n\nä½ å¯èƒ½ä»¥å‰é‡åˆ°è¿‡è¿™äº›å§ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä¸ç”¨æ‹…å¿ƒï¼ç®€è€Œè¨€ä¹‹ï¼ŒeBPF æ˜ å°„æ˜¯åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ä¸­çš„ eBPF ç¨‹åºä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œéå¸¸é…·çš„ä¸€ç‚¹æ˜¯è¿™äº›æ˜ å°„ä½¿ç”¨é”®å’Œå€¼...æ‰€ä»¥æˆ‘ä¸å¿…å¾ªç¯æ¯”è¾ƒæ•°æ®å¹¶å¯»æ‰¾åŒ¹é…çš„å†…å®¹ï¼Œæˆ‘ä¼ é€’ä¸€ä¸ªé”®ï¼Œå¦‚æœæœ‰åŒ¹é…çš„å†…å®¹ï¼Œæˆ‘å°±å¾—åˆ°ç›¸åº”çš„æ•°æ®:D\n\nä¸‹é¢æ˜¯æˆ‘å°†è¦ä½¿ç”¨çš„æ˜ å°„ï¼Œç§°ä¸º\u0060url_map\u0060ï¼Œé”®æ˜¯ 20 ä¸ªå­—ç¬¦é•¿ï¼ˆå¯ä»¥è¯´æ˜¯æœ‰ç•Œçš„â€œå­—ç¬¦ä¸²â€ï¼‰ï¼Œåˆ†é…ç»™è¯¥é”®çš„å€¼æ˜¯æˆ‘åœ¨ä¸Šé¢å®šä¹‰çš„ç»“æ„ä½“ã€‚\n\n\u0060\u0060\u0060\n\/\/ å®šä¹‰ä¸é”®å…³è”çš„ä¸åŒURL\nstruct url_path {\n  __u8 path_len;\n  __u8 path[max_path_len]; \/\/ è¿™åº”è¯¥æ˜¯ä¸€ä¸ªcharï¼Œä½†åœ¨è¿™é‡Œå’ŒGoä¹‹é—´çš„ä»£ç ç”Ÿæˆæœ‰ç‚¹ä¸åŒ...\n};\n\n\/\/ å®šä¹‰æˆ‘çš„URLæ˜ å°„\nstruct {\n  __uint(type, BPF_MAP_TYPE_HASH);\n  __uint(max_entries, 1024);\n  __type(key, char[max_path_len]);\n  __type(value, struct url_path);\n}\nurl_map SEC(\u0022.maps\u0022);\n\u0060\u0060\u0060\n\n## eBPF ç¨‹åºï¼\n\nä»£ç ä¸­å®šä¹‰äº†ä¸¤ä¸ª eBPF ç¨‹åº\u0060tc_egress\u0060å’Œ\u0060tc_ingress\u0060ï¼Œå¦‚æœä½ èƒ½çŒœåˆ°å®ƒä»¬æ˜¯å¦‚ä½•è¿æ¥çš„ï¼Œé‚£å°±åŠ åˆ†ï¼åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åªå…³æ³¨\u0060tc_ingress\u0060ç¨‹åºã€‚\n\nå°±åƒæˆ‘ä»¬åœ¨å·²ç»å­˜åœ¨çš„ä¼—å¤šç¤ºä¾‹ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ ‡å¤´è¯†åˆ«çš„æ“ä½œã€‚\n\n1. è¿›è¡Œåˆç†æ€§æ£€æŸ¥ï¼Œå¹¶å°†\u0060data\u0060å¼ºåˆ¶è½¬æ¢ä¸º\u0060ethhdr\u0060ç±»å‹ï¼ˆ[ä»¥å¤ªç½‘æ ‡å¤´](https:\/\/en.wikipedia.org\/wiki\/Ethernet_frame)ï¼‰ã€‚\n2. é€šè¿‡è¯»å–ä»¥å¤ªç½‘æ ‡å¤´å†…éƒ¨çš„\u0060h_proto\u0060ï¼ˆä¹Ÿç§°ä¸º\u0060Ethertype\u0060ï¼‰æ¥æŸ¥æ‰¾ä»¥å¤ªç½‘å¸§å†…éƒ¨çš„åè®®ã€‚\n3. å°†ä»¥å¤ªç½‘æ ‡å¤´åçš„æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸º\u0060iphdr\u0060ç±»å‹ï¼ˆ[IP æ ‡å¤´](https:\/\/en.wikipedia.org\/wiki\/Internet_Protocol_version_4#Header)ï¼‰ã€‚\n4. åœ¨ IP æ ‡å¤´å†…æŸ¥æ‰¾åè®®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®å®š IP æ ‡å¤´çš„å¤§å°ï¼ˆåŸæ¥å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å¤§å°ï¼\u0060Â¯\\_(ãƒ„)_\/Â¯\u0060ï¼‰ã€‚\n5. ä¸ºäº†ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼Œæˆ‘ä»¬å°†å…¶å€¼ä¹˜ä»¥å››ï¼Œä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆï¼å¥½å§ï¼Œè¿™ä¸ªå€¼ä¹˜ä»¥ 32 ä½ä»¥ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼Œæ‰€ä»¥å¦‚æœå€¼ä¸º 6ï¼Œé‚£ä¹ˆæ ‡å¤´å°†æ˜¯ 192 ä½ï¼ˆæˆ– 24 å­—èŠ‚ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ç®€å•åœ°ç¡®å®š IP æ ‡å¤´çš„å­—èŠ‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå€¼ä¹˜ä»¥ 4ï¼\n6. å°†ä»¥ IP æ ‡å¤´åçš„æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸º\u0060tcphdr\u0060ç±»å‹ï¼ˆ[TCP æ ‡å¤´](https:\/\/en.wikipedia.org\/wiki\/Transmission_Control_Protocol#TCP_segment_structure)ï¼‰ã€‚\n7. åƒæ­¥éª¤ï¼ˆ5ï¼‰ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®š TCP æ ‡å¤´çš„å¤§å°ï¼ˆå®ƒä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„ï¼‰ï¼Œåœ¨è¿™é‡Œçš„æ­¥éª¤ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å€¼\u0060doff\u0060ä¹˜ä»¥å››æ¥ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚\n8. é€šè¿‡è®¡ç®—æ‰€æœ‰è¿™äº›ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¨æ–­å‡ºæ•°æ®ä½äºä»¥å¤ªç½‘æ ‡å¤´å¤§å°ã€IP æ ‡å¤´å¤§å°å’Œ TCP æ ‡å¤´å¤§å°çš„æœ«å°¾ã€‚\n9. æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä» IP æ ‡å¤´ä¸­å‡å» IP å’Œ TCP æ ‡å¤´çš„å¤§å°æ¥ç¡®å®šåº”ç”¨ç¨‹åºæ•°æ®çš„å¤§å°ï¼Œä½¿ç”¨\u0060tot_len\u0060ï¼ˆæ€»é•¿åº¦ï¼‰ã€‚\n\n### åº”ç”¨æ•°æ®ï¼ï¼\n\nä¸ºäº†è¯»å–è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸Šé¢æåˆ°çš„ä¸€äº›ä¸œè¥¿ï¼\n\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ•°æ®åç§»é‡ï¼ˆæ•°æ®èµ·å§‹ä½ç½®ï¼‰ï¼Œå®ƒä½äºä»¥å¤ªç½‘æ ‡å¤´\u002bIP æ ‡å¤´å¤§å°ï¼ˆä¸€æ—¦è®¡ç®—å‡ºæ¥ï¼‰å’Œ TCP æ ‡å¤´ï¼ˆå†æ¬¡ï¼Œä¸€æ—¦è®¡ç®—å‡ºæ¥ï¼‰ä¹‹åã€‚æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªç¼“å†²åŒºæ¥å­˜å‚¨æˆ‘ä»¬å°†ä»å¥—æ¥å­—ç¼“å†²åŒºä¸­è¯»å–çš„æ•°æ®ã€‚\n\n\u0060\u0060\u0060c\n\/\/ ç”¨äºå­˜å‚¨æˆ‘ä»¬åº”ç”¨ç¨‹åºæ•°æ®çš„æ•°æ®ç¼“å†²åŒº\nchar pdata[60];\n\n\/\/ è®¡ç®—æ•°æ®å®é™…ä½ç½®çš„åç§»é‡\npoffset = ETH_HLEN \u002b ip_hlen \u002b tcp_hlen;\n\n\/\/ ä»å¥—æ¥å­—ç¼“å†²åŒºåŠ è½½æ•°æ®ï¼Œpoffset ä» TCP æ ‡å¤´çš„æœ«å°¾å¼€å§‹\nint ret = bpf_skb_load_bytes(skb, poffset, pdata, 60);\nif (ret != 0) {\n   return 0;\n}\n\u0060\u0060\u0060\n\næˆ‘ä»¬ä½¿ç”¨\u0060bpf_skb_load_bytes\u0060ä»å¥—æ¥å­—ç¼“å†²åŒºï¼ˆ\u0060skb\u0060ï¼‰ä¸­è¯»å–ä¸€å®šé‡çš„æ•°æ®ï¼ˆ60 ä¸ªå­—èŠ‚ï¼‰åˆ°æˆ‘ä»¬çš„ç¼“å†²åŒºï¼ˆ\u0060pdata\u0060ï¼‰ï¼Œèµ·å§‹ä½ç½®æ˜¯æˆ‘ä»¬çŸ¥é“æ•°æ®ä½äºçš„åç§»é‡ï¼ˆ\u0060poffset\u0060ï¼‰ï¼\n\næ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰äº† 60 å­—èŠ‚çš„æ•°æ®ï¼Œåº”è¯¥è¶³å¤Ÿè®©æˆ‘ä»¬ç¼–å†™ä¸€äº›ä»£ç æ¥ç†è§£å®ƒã€‚\n\n### HTTP æ•°æ® :-)\n\nè®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬å°è¯•è¿›è¡Œ HTTP è¯·æ±‚æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼\n\n\u0060\u0060\u0060plaintext\n ~ curl code\/test -vvv\n*   Trying 192.168.0.22:80...\n* Connected to code (192.168.0.22) port 80 (#0)\n\u003e GET \/test HTTP\/1.1\n\u003e Host: code\n\u003e User-Agent: curl\/7.87.0\n\u003e Accept: *\/*\n\n...\n\u0060\u0060\u0060\n\næˆ‘æ­£åœ¨ä½¿ç”¨\u0060curl\u0060ä»ä¸»æœº\u0060code\u0060ï¼ˆcode æ˜¯æˆ‘çš„å¼€å‘ VMï¼Œè¿è¡Œ code-serverï¼‰è¯·æ±‚ URL \u0060\/test\u0060ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼ˆæ¯è¡Œä»¥\u0060\u003e\u0060å¼€å¤´ï¼Œç”¨äºç¡®å®šé€šä¿¡çš„æ–¹å‘ï¼‰ã€‚HTTP è¯·æ±‚ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®é€šå¸¸æ˜¯ä¸€ä¸ª*åŠ¨è¯*ï¼Œåé¢æ˜¯æˆ‘ä»¬å¸Œæœ›ä¸ä¹‹äº¤äº’çš„èµ„æºï¼Œç„¶åæ˜¯ HTTP è§„èŒƒå’Œå›è½¦ç¬¦ï¼Œå¦‚[HTTP æ ‡å‡†](https:\/\/en.wikipedia.org\/wiki\/HTTP#HTTP\/1.1_request_messages)ä¸­å®šä¹‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å…³å¿ƒçš„è¡Œæ˜¯\u0060GET \/test\u0060ï¼ˆåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬\/æˆ‘ä¸å¤ªå…³å¿ƒ HTTP è§„èŒƒ:Dï¼‰ã€‚\n\nç¬¬ä¸€æ­¥æ˜¯è¯»å–\u0060pdata\u0060çš„å‰ä¸‰ä¸ªå­—ç¬¦ï¼ŒæŸ¥æ‰¾\u0060pdata[0] == G\u0060ï¼Œ\u0060pdata[1] == E\u0060å’Œ\u0060pdata[2] == T\u0060ï¼Œè¿™å°†æœ‰æ•ˆåœ°å¸®åŠ©æˆ‘ä»¬ç¡®å®šé¦–å…ˆæ˜¯å¦æ˜¯ HTTP è¯·æ±‚ï¼Œç‰¹åˆ«æ˜¯æ˜¯å¦æ˜¯ HTTP è¯·æ±‚ï¼\n\nä¸€æ—¦æˆ‘ä»¬éªŒè¯äº†è¿™å‰ 3 ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å°†æƒ³è¦ä»ç¬¬ 4 ä¸ªå­—èŠ‚ï¼ˆè¯·æ±‚çš„å‰ä¸‰ä¸ªå­—èŠ‚åŠ ä¸Šä¸€ä¸ªç”¨äºåˆ†éš”çš„ç©ºæ ¼ï¼‰å¼€å§‹è¯»å–æ›´å¤šæ•°æ®ï¼\n\n\u0060\u0060\u0060c\nchar path[max_path_len];\nmemset(\u0026path, 0, sizeof(path));\n\nint path_len = 0;\n\n\/\/ æŸ¥æ‰¾è¯·æ±‚ URIï¼ˆä»åç§»é‡ 4 å¼€å§‹ï¼‰ï¼Œä»¥ç©ºæ ¼ç»“æŸ\nfor (int i = 4; i \u003c sizeof(pdata) ; i\u002b\u002b)\n{\n    if (pdata[i] != \u0027 \u0027) {\n        path[i-4] = pdata[i];\n    } else {\n        path[i-4] = \u0027\\0\u0027;\n        path_len = i-4;\n        break;\n    }\n}\n\u0060\u0060\u0060\n\nä¸Šé¢çš„å‡½æ•°å°†ä» HTTP æ•°æ®çš„ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆä»ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹ï¼‰è¯»å–å…¶ä½™çš„æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç©ºæ ¼ä¸ºæ­¢ï¼Œç•™ä¸‹æˆ‘ä»¬è¦\u0060GET\u0060çš„ URLï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªè°ƒè¯•æ‰“å°è¯­å¥æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼š\n\n\u0060\u0060\u0060c\nbpf_printk(\u0022\u003c- incoming path [%s], length [%d]\u0022, path, path_len);\n\u0060\u0060\u0060\n\nè¿™å°†åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºå¦‚ä¸‹ï¼š\n\n\u0060\u0060\u0060plaintext\n\u003cidle\u003e-0       [001] dNs3. 2252901.017812: bpf_trace_printk: \u003c- incoming path [\/test], length [5]\n\u0060\u0060\u0060\n\n### å¯¹ HTTP åº”ç”¨ç¨‹åºè¯·æ±‚é‡‡å–è¡ŒåŠ¨\n\nä¸Šè¿°è§£é‡Šè¯¦ç»†è¯´æ˜äº†æˆ‘ä»¬å¦‚ä½•è¯»å–æ•°æ®ä»¥åŠå¦‚ä½•è¯»å–æ•°æ®ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³è¦â€œåŠ¨æ€â€æŸ¥æ‰¾ HTTP è¯·æ±‚ï¼Œæˆ‘ä»¬å°†éœ€è¦ä½¿ç”¨ eBPF æ˜ å°„ã€‚\n\nåœ¨æˆ‘ä»¬çš„ Go ç”¨æˆ·ç©ºé—´ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\n\n\u0060\u0060\u0060go\npath := flag.String(\u0022path\u0022, \u0022\u0022, \u0022The URL Path to watch for\u0022)\nflag.Parse()\n\n\/\/ ...\n\n\/\/ åˆ›å»ºä¸€ä¸ª uint8 æ•°ç»„\nvar urlPath [20]uint8\n\/\/ å°†æˆ‘ä»¬çš„å­—èŠ‚å¤åˆ¶åˆ° uint8 æ•°ç»„ä¸­ï¼ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢ï¼‰\ncopy(urlPath[:], *path)\n\n\/\/ å°†æˆ‘ä»¬çš„ urlPath ä½œä¸ºé”®\nerr = objs.UrlMap.Put(urlPath,\n  bpfUrlPath{\n    Path:    urlPath,\n    PathLen: uint8(len(urlPath)),\n  })\nif err != nil {\n  panic(err)\n}\n\u0060\u0060\u0060\n\næ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œå½“æˆ‘ä»¬å¯åŠ¨ Go ç¨‹åºæ—¶ï¼Œå®ƒå°†ä»æ ‡å¿—\u0060-path\u0060ä¸­è¯»å–ï¼Œå¹¶å°†å…¶ç”¨ä½œæˆ‘ä»¬ eBPF æ˜ å°„ä¸­çš„**é”®**ï¼Œå¯ä»¥æš‚æ—¶å¿½ç•¥å€¼ã€‚\n\n\u0060\u0060\u0060c\nstruct url_path *found_path = bpf_map_lookup_elem(\u0026url_map, path);\nif (found_path \u003e 0) {\n    bpf_printk(\u0022Looks like we\u0027ve found your path [%s]\u0022, path);\n    \/\/ å¯èƒ½è¿›è¡Œæ›´å¤šæ“ä½œï¼Œé˜»æ­¢æµé‡æˆ–é‡å®šå‘ï¼Ÿ\n}\n\u0060\u0060\u0060\n\nåœ¨æˆ‘ä»¬çš„ eBPF ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†å¯¹ HTTP è¯·æ±‚è¿›è¡Œæ˜ å°„æŸ¥æ‰¾ï¼Œå¦‚æœè¯¥è¯·æ±‚ä½œä¸º char æ•°ç»„å­˜åœ¨äº**é”®**ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œï¼\n\nç°åœ¨å¯åŠ¨æˆ‘ä»¬çš„ Go ç¨‹åº \u0060sudo .\/http -interface ens160 -path \/test\u0060 å°†å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š\n\n\u0060\u0060\u0060plaintext\nINFO[0000] Starting ğŸ the eBPF HTTP watcher, on interface [ens160] for path [\/test]\nINFO[0000] Loaded TC QDisc\nINFO[0000] Press Ctrl-C to exit and remove the program\n          \u003cidle\u003e-0       [001] d.s3. 2252901.015575: bpf_trace_printk: \u003c- 0.0.0.0:56345 -\u003e 0.0.0.0:80\n          \u003cidle\u003e-0       [001] D.s3\n\n. 2252901.015642: bpf_trace_printk: -\u003e 192.168.0.22:80 -\u003e 192.168.0.180:56345\n          \u003cidle\u003e-0       [001] d.s3. 2252901.017552: bpf_trace_printk: \u003c- 0.0.0.0:56345 -\u003e 0.0.0.0:80\n          \u003cidle\u003e-0       [001] d.s3. 2252901.017793: bpf_trace_printk: \u003c- 0.0.0.0:56345 -\u003e 0.0.0.0:80\n          \u003cidle\u003e-0       [001] dNs3. 2252901.017812: bpf_trace_printk: \u003c- incoming path [\/test], length [5]\n          \u003cidle\u003e-0       [001] dNs3. 2252901.017814: bpf_trace_printk: Looks like we\u0027ve found your path [\/test]\n\u0060\u0060\u0060\n\n## ç»“è®º\n\nè§£æ HTTP å¹¶ä¸å¤ªå›°éš¾ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åè®®ï¼Œå®ƒä½¿ç”¨ç®€å•çš„åŠ¨è¯å’Œç»“æ„çš„ç®€å•æ–¹æ³•ï¼Œä½¿ç”¨ç©ºæ ¼å’Œå›è½¦ç¬¦æ¥åŒºåˆ†ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¹Ÿé€‚ç”¨äºå…¶ä»–åè®®ï¼Œå¦‚ DNSã€POP3 æˆ– SMTPã€‚å½“æ•°æ®åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§è§£å¯†çš„æ–¹æ³•ï¼Œç„¶åæ‰èƒ½è§£ææ•°æ®ï¼ˆè¿™è¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›...ï¼‰ã€‚ä½†æ˜¯ï¼Œæˆ‘å¸Œæœ›è¿™ä¼šæ¿€å‘ä½ æ›´å¤šåœ°å°è¯•ä½¿ç”¨ eBPF æ¥è§£æå’Œæ“ä½œåº”ç”¨ç¨‹åºçš„æƒ³æ³•ï¼\n\næˆ‘ä¸€ç›´æƒ³å†™ä¸€äº›æœ‰å¸Œæœ›æœ‰ç”¨çš„å…³äº eBPF çš„å¸–å­ï¼Œå°½ç®¡é€šå¸¸åœ¨æˆ‘æƒ³å‡ºå¯èƒ½æœ‰ç”¨çš„ä¸œè¥¿ä¹‹åï¼Œåˆ«äººå·²ç»æŠ¢å…ˆä¸€æ­¥ã€‚é‰´äºæˆ‘å·²ç»åœ¨ä¸€æ®µæ—¶é—´é‡Œä»¥æŸç§æ–¹å¼å…³æ³¨ç½‘ç»œï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯æˆ‘å…³æ³¨çš„é¢†åŸŸï¼Œå°½ç®¡æˆ‘ç¡®å®ä¸ºæœ€è¿‘çš„ eBPF å³°ä¼š 2023 ç¼–å†™äº†ä¸€äº›æœ‰è¶£çš„å†…å®¹ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæœ‰å¾ˆå¤šäººå¼€å§‹æ’°å†™ eBPF å†…å®¹ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½ä¼šå‚è€ƒä»–ä»¬çš„å¸–å­ï¼Œè€Œä¸æ˜¯é‡å¤å†…å®¹ã€‚\n', '\/trans\/application-traffic-with-ebpf\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ eBPF ç¨‹åºæ•è·ã€åˆ†æå’Œä¿®æ”¹åº”ç”¨å±‚çš„ç½‘ç»œæ•°æ®ï¼ŒåŒ…æ‹¬ HTTP å¤´éƒ¨å’Œ URL è·¯å¾„ã€‚ä½œè€…è¿˜å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ eBPF map åœ¨å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/ebpf-adventures-in-networking/">[è¯‘] å¦‚ä½•ç”¨ eBPF æ”¹å˜ç½‘ç»œç¼–ç¨‹çš„æ¸¸æˆè§„åˆ™</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/10</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%85%b6%e4%bb%96"> 
             å…¶ä»–
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thebsdbox.co.uk/2023/11/18/eBPF-adventures-in-networking/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('å¦‚ä½•ç”¨ eBPF æ”¹å˜ç½‘ç»œç¼–ç¨‹çš„æ¸¸æˆè§„åˆ™', 'è¿™ç¯‡æ–‡ç« ä»‹ç»äº† eBPF åœ¨ç½‘ç»œé¢†åŸŸçš„ä¸€äº›åº”ç”¨å’Œå®è·µï¼ŒåŒ…æ‹¬ XDPã€TC å’Œ sysprobes ä¸‰ç§ä¸åŒçš„ eBPF ç¨‹åºæŒ‚è½½æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ eBPF å®ç°ç½‘ç»œæ•°æ®çš„æ•è·ã€åˆ†æå’Œä¿®æ”¹ã€‚ä½œè€…è¿˜åˆ†äº«äº†ä¸€äº›æœ‰ç”¨çš„ eBPF å·¥å…·å’Œèµ„æºï¼Œä»¥åŠè‡ªå·±å¼€å‘çš„ä¸€ä¸ª eBPF ç½‘ç»œä»£ç†çš„é¡¹ç›®ã€‚', '\næˆ‘ä¸€ç›´æƒ³å†™ä¸€äº›å…³äº eBPF çš„å¸–å­ï¼Œå¸Œæœ›å®ƒä»¬èƒ½æœ‰æ‰€å¸®åŠ©ï¼Œå°½ç®¡é€šå¸¸åœ¨æˆ‘æƒ³åˆ°å¯èƒ½æœ‰ç”¨çš„ä¸œè¥¿æ—¶ï¼Œå…¶ä»–äººå·²ç»å…ˆæˆ‘ä¸€æ­¥äº†ã€‚é‰´äºæˆ‘å·²ç»åœ¨ç½‘ç»œæ–¹é¢é›†ä¸­ç²¾åŠ›ä¸€æ®µæ—¶é—´ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯æˆ‘ä¸“æ³¨çš„é¢†åŸŸï¼Œå°½ç®¡æˆ‘ç¡®å®è®¾æ³•ä¸ºæœ€è¿‘çš„ eBPF å³°ä¼š 2023 å‡†å¤‡äº†ä¸€äº›æˆ‘è®¤ä¸ºå¾ˆæœ‰è¶£çš„ä¸œè¥¿ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæœ‰å¾ˆå¤šäººå¼€å§‹æ’°å†™å…³äº eBPF çš„å†…å®¹ï¼Œå› æ­¤æˆ‘å¯èƒ½ä¼šå‚è€ƒä»–ä»¬çš„å¸–å­ï¼Œè€Œä¸æ˜¯é‡å¤å†…å®¹ã€‚\n\næˆ‘å°†ä»ä¸€äº›åœ¨ Linux å†…æ ¸ä¸­å¯èƒ½æˆ–å¯èƒ½ä¸ä¼šé‡åˆ°çš„é¦–å­—æ¯ç¼©å†™æˆ–æŠ€æœ¯å¼€å§‹ã€‚ä½†åŸºæœ¬ä¸Šä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›æ˜¯ä½ ä¿®æ”¹æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿä»¥ä¸ç½‘ç»œæ•°æ®äº¤äº’çš„ä¸»è¦é€‰é¡¹ã€‚\n\n### XDP\n\nå…³äº eXpress Data Plane å·²ç»å­˜åœ¨å¤§é‡ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä¸ä¼šæ·±å…¥æ¢è®¨å¤ªå¤šç»†èŠ‚ã€‚\u0060tl;dr\u0060æ˜¯ XDP eBPF ç¨‹åºæŒ‚é’©åˆ° XDP å°†ä½¿å…¶èƒ½å¤Ÿè®¿é—®ç”±å†…æ ¸è‡ªèº«å¤„ç†ä¹‹å‰çš„ä¼ å…¥ç½‘ç»œå¸§ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒeBPF ç¨‹åºå°†åŠ è½½åˆ° NIC é©±åŠ¨ç¨‹åºæœ¬èº«ä¸­ï¼Œè¿™å°†æœ‰æ•ˆåœ°å°†ç¨‹åºå¸è½½åˆ° NIC æœ¬èº«ã€‚\n\n### ä¼˜ç‚¹\n\n- æœ€ä½³æ€§èƒ½\n- éå¸¸é€‚ç”¨äºé˜²ç«å¢™ã€DDoS é˜²æŠ¤æˆ–è´Ÿè½½å‡è¡¡ç­‰ç”¨ä¾‹\n- åœ¨ä»»ä½•å…¶ä»–å†…å®¹è¿›è¡Œä¿®æ”¹ä¹‹å‰çœ‹åˆ°ä¼ å…¥çš„æµé‡\n\n### ç¼ºç‚¹\n\n- ä»…æ”¯æŒå…¥ç«™æµé‡ï¼Œä½¿ç”¨ XDP ç¨‹åºçœ‹åˆ°çš„ä»»ä½•æµé‡éƒ½åªæ˜¯ä¼ å…¥æµé‡ï¼Œç›®å‰æ— æ³•çœ‹åˆ°å‡ºç«™æµé‡\n- ä½¿ç”¨\u0060XDP\u0060æ•°æ®ç»“æ„ï¼Œä¸å¤§å¤šæ•°å¥—æ¥å­—ç¼–ç¨‹çš„é»˜è®¤æ•°æ®ç»“æ„\u0060SKB\u0060æœ‰ä¸€äº›ä¸åŒã€‚\n\n### TCï¼ˆTraffic Controlï¼‰æˆ–æµé‡æ§åˆ¶\n\nTraffic Control æ˜¯å†…æ ¸ç½‘ç»œç»“æ„çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬æ·»åŠ è¯¸å¦‚ qdisc å’Œè¿‡æ»¤å™¨ä¹‹ç±»çš„åŠŸèƒ½åˆ°æ¥å£çš„èƒ½åŠ›ã€‚qdisc ä¸»è¦é›†ä¸­åœ¨ä¸º TBDï¼ˆå¾…å®šï¼‰æä¾›æœåŠ¡ï¼Œè€Œè¿‡æ»¤å™¨é€šå¸¸åœ¨åº•å±‚å®é™…ä¸Šæ˜¯ä¸€ä¸ª eBPF ç¨‹åºã€‚\n\nå¸¸è§çš„å·¥ä½œæµç¨‹æ˜¯ï¼š\n\n1. åˆ›å»ºä¸€ä¸ªå…³æ³¨å…¥å£æˆ–å‡ºå£çš„ qdiscï¼Œæˆ–è€…æ›¿æ¢ä¸€ä¸ªç°æœ‰çš„ qdiscã€‚qdisc å°†é™„åŠ åˆ°æ¥å£ä¸Šã€‚\n2. åŠ è½½ä½ çš„ eBPF ç¨‹åºã€‚\n3. åˆ›å»ºä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå°†å…¶é™„åŠ åˆ°é€šè¿‡æ¥å£ä¸Šçš„ qdisc ä¸Šçš„å…¥å£æˆ–å‡ºå£ä¹‹ä¸€ã€‚è¯¥è¿‡æ»¤å™¨å°†ä¸ eBPF ç¨‹åºç›¸å…³è”ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ä¼ å…¥æˆ–ä¼ å‡ºçš„æµé‡ç°åœ¨éƒ½ä¼šé€šè¿‡ä¸€ä¸ªç¨‹åºè¿è¡Œï¼ˆå¦‚æœè¿æ¥ï¼‰ã€‚\n4. è·åˆ© ğŸ’°\n\n### ä¼˜ç‚¹\n\n- æä¾›å…¥å£å’Œå‡ºå£çš„æŒ‚é’©ç‚¹\n- ä½¿ç”¨ä¼ ç»Ÿçš„\u0060SKB\u0060æ•°æ®ç»“æ„\n\n### ç¼ºç‚¹\n\n- å°† TC ç¨‹åºé™„åŠ åˆ°å…¥å£æˆ–å‡ºå£é˜Ÿåˆ—ç¨å¾®å¤æ‚ä¸€äº›ã€‚ç”¨æˆ·éœ€è¦ä½¿ç”¨ qdisc æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼ŒæŸäº› eBPF SDK ä¸ä¼šåŸç”Ÿæ”¯æŒ TC ç¨‹åºçš„ä½¿ç”¨ã€‚\n- TC eBPF ç¨‹åºçœ‹åˆ°çš„æµé‡å¯èƒ½å·²ç»è¢«ä¹‹å‰çš„ XDP ç¨‹åºæˆ–å†…æ ¸æœ¬èº«ä¿®æ”¹ã€‚\n\n### ç³»ç»Ÿè°ƒç”¨\n\nä¸å…¶ä»–ä¸¤ç§ä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†ç½‘ç»œçš„æ–¹æ³•ç›¸æ¯”ï¼Œè¿™å¯èƒ½ä¼šæ˜¾å¾—æœ‰äº›å¥‡æ€ªï¼Œå› ä¸ºå®ƒæ˜¯å°†ä¸€äº› eBPF ä»£ç é™„åŠ åˆ°å†…æ ¸ä¸­çš„ç³»ç»Ÿè°ƒç”¨çš„ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œå…·ä½“æ¥è¯´æ˜¯\u0060tcp4_connect()\u0060 \/ \u0060tcp6_connect()\u0060ç­‰è°ƒç”¨ã€‚è¿™åœ¨åè®®æ ˆä¸­ç•¥å¾®é åï¼Œå› ä¸ºåœ¨æ­¤æ—¶ï¼Œä¼ å…¥æ•°æ®åŒ…å·²ç»ç»è¿‡äº†å¾ˆå¤šå†…æ ¸é€»è¾‘ï¼Œè€Œ eBPF å†…çœç‚¹æ˜¯å½“æµé‡å³å°†ä¸åº”ç”¨ç¨‹åºæœ¬èº«äº¤äº’æ—¶ã€‚\n\n## ç¼–å†™ç½‘ç»œç¨‹åºï¼\n\næ‰€ä»¥åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬ï¼ˆå¸Œæœ›ï¼‰æ„è¯†åˆ°æˆ‘ä»¬æœ‰è®¸å¤šä¸åŒçš„å…¥å£ç‚¹ï¼Œå…è®¸æˆ‘ä»¬åœ¨â€œä¼ é€å¸¦â€ä¸Šæ³¨å…¥æˆ‘ä»¬çš„ä»£ç ï¼Œè¿™ä¸ªä¼ é€å¸¦ä» NIC å¼€å§‹ï¼Œä¸€ç›´åˆ°åº”ç”¨ç¨‹åºï¼ˆä»¥åŠåœ¨å‡ºç«™çš„æƒ…å†µä¸‹ï¼‰ã€‚\n\n### å›é¡¾\n\nåœ¨æˆ‘ä»¬æ‰€è°“çš„â€œä¼ é€å¸¦â€çš„å¼€å¤´ï¼Œæˆ‘ä»¬å¯ä»¥é™„åŠ æˆ‘ä»¬çš„ XDP ç¨‹åºå¹¶è·å¾—æœªç»è§¦ç¢°çš„åŸå§‹ç½‘ç»œæ•°æ®ã€‚åœ¨â€œä¼ é€å¸¦â€çš„ä¸­é—´ï¼Œæˆ‘ä»¬çš„ TC ç¨‹åºå°†æˆä¸ºé€šè¿‡å†…æ ¸çš„è·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶æ¥æ”¶å¯èƒ½è¢«ä¿®æ”¹çš„ç½‘ç»œæ•°æ®ã€‚åœ¨ä¼ é€å¸¦çš„æœ«ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç é™„åŠ åˆ°åº”ç”¨ç¨‹åºå°†åœ¨å®ƒè¢«è¿è¡Œä¹‹å‰è·å–ç½‘ç»œæ•°æ®çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥åœ¨ä¼ é€å¸¦çš„æœ«ç«¯è¿›è¡Œé™„åŠ ã€‚\n\n### æ•°æ®è¡¨ç¤º\n\nä½ çš„ç¨‹åºé™„åŠ åˆ°çš„ä½ç½®å†³å®šäº†ä¸¤ä¸ªä¸»è¦äº‹ç‰©ï¼Œä¸€ä¸ªæ˜¯æ½œåœ¨çš„æµé‡ä¿®æ”¹çš„ç›¸å¯¹çº§åˆ«ï¼Œå¦ä¸€ä¸ªæ˜¯æµé‡çš„è¡¨ç¤ºæ–¹å¼ã€‚\n\n### XDP ç»“æ„\n\næˆ‘ä¼šå†™å…³äºå®ƒçš„å†…å®¹ï¼Œä½†æ˜¯ DataDog å·²ç»åšäº†ï¼Œä½ å¯ä»¥åœ¨[è¿™é‡Œ](https:\/\/www.datadoghq.com\/blog\/xdp-intro\/#the-flow-of-an-xdp-program)é˜…è¯»ã€‚\n\n### SKBï¼ˆå¥—æ¥å­—ç¼“å†²åŒºï¼‰\n\nSKB æ˜¯åœ¨ eBPF æ·»åŠ åˆ°å†…æ ¸ä¹‹å‰å°±å­˜åœ¨äºå†…æ ¸ä¸­çš„æ•°æ®ç±»å‹ï¼Œå®ƒå·²ç»å…·å¤‡äº†ä¸€äº›ä½¿ä¸ SKB å¯¹è±¡äº¤äº’å˜å¾—ç¨å¾®å®¹æ˜“ä¸€äº›çš„è¾…åŠ©åŠŸèƒ½ã€‚æœ‰å…³æ›´æ·±å…¥çš„ SKB ä»‹ç»ï¼Œä½ å¯ä»¥é˜…è¯»æ­¤æ–‡ -\u003e http:\/\/vger.kernel.org\/~davem\/skb_data.html\n\n### è§£ææ•°æ®\n\næ— è®ºä¸å“ªä¸ªç»“æ„è¿›è¡Œäº¤äº’ï¼Œå®ƒä»¬éƒ½å…±äº«ä¸€äº›å…±åŒä¹‹å¤„ï¼Œè¿™ä¸»è¦æ˜¯ä¸¤ä¸ªå˜é‡ï¼Œå¯¹äºè¿™ä¸¤ç§æ•°æ®ç±»å‹æ¥è¯´æ˜¯ç›¸åŒçš„ã€‚\n\nè¿™äº›å˜é‡æ˜¯ï¼š\n\n- \u0060data\u0060ï¼Œå®ƒæ˜¯ eBPF ç¨‹åºæ¥æ”¶åˆ°çš„æ•°æ®çš„æŒ‡é’ˆ\n\n- \u0060data_len\u0060ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šäº†æœ‰å¤šå°‘æ•°æ®å¯ç”¨ï¼ˆä»¥å¸®åŠ©ç¡®ä¿ä½ æ°¸è¿œä¸ä¼šè®¿é—®\u0060data\u0060è¶…è¿‡\u0060data_len\u0060ï¼ˆæ˜¾è€Œæ˜“è§çš„çœŸç† ğŸ¤“ï¼‰ï¼‰\n\næ‰€ä»¥è¿™ä¸€åˆ‡ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†ç­‰ç­‰... \u0060*data\u0060ä¸­å®é™…ä¸Šæœ‰ä»€ä¹ˆï¼Ÿï¼ˆè¿™å–å†³äºä½ çš„å‘ç°ï¼‰\n\né€šè¿‡ä¸æ–­â€œè½¬æ¢â€\u0060*data\u0060å¹¶æ²¿ç€å®ƒç§»åŠ¨ä»¥å‰¥ç¦»å„ç§æ ‡å¤´ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£å’ŒæŸ¥æ‰¾åº•å±‚æ•°æ®ï¼\n\n### è½¬æ¢ï¼Ÿ\n\nå¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥è·³è¿‡æ­¤éƒ¨åˆ†ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿï¼ˆä¸”ç³Ÿç³•ï¼‰çš„ç¤ºä¾‹ï¼Œè¯´æ˜äº†æˆ‘ä»¬é€šå¸¸å¦‚ä½•å°†ä¸€äº›åŸå§‹æ•°æ®è½¬æ¢ä¸ºæœ‰æ„ä¹‰çš„ä¸œè¥¿ã€‚ç›®å‰ï¼Œ\u0060*data\u0060å°†åªæ˜¯ä¸€ä¸²éšæœºæ•°æ®ï¼Œæ¯«æ— æ„ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦æœ‰æ•ˆåœ°ä¸ºå…¶æ·»åŠ â€œæ ¼å¼â€ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç†è§£å…¶å¤–è§‚ã€‚\n\nè€ƒè™‘ä¸€ä¸‹éšæœºæ•°æ®è¡Œï¼šâ€œBobby0004500100.503 Harvard Drive90210â€ï¼Œå…¶ä¸­ä¸€äº›å¯¹è£¸çœ¼æ¥è¯´æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æœ‰äº›æ˜¯ä¸æ¸…æ¥šçš„ã€‚\n\næƒ³è±¡ä¸€ä¸‹åä¸ºâ€œpersonâ€çš„æ•°æ®ç»“æ„ï¼š\n\n\u0060\u0060\u0060bash\nName: string\nAge: number\nBalance: float\nStreet: string\nZipCode: number\n\u0060\u0060\u0060\n\nå¦‚æœæˆ‘ä»¬è¦å°†æˆ‘ä»¬çš„éšæœºæ•°æ®â€œè½¬æ¢â€ä¸ºä¸Šé¢çš„â€œpersonâ€ç»“æ„ï¼Œå®ƒå°†çªç„¶å˜æˆï¼š\n\n\u0060\u0060\u0060bash\nName: Bobby\nAge: 45\nBalance: 100.50\nStreet: 3 Harvard Drive\nZipCode: 90210\n\u0060\u0060\u0060\n\nç°åœ¨çªç„¶é—´ï¼Œæˆ‘èƒ½å¤Ÿç†è§£å¹¶è®¿é—®ç»“æ„ä¸­çš„åº•å±‚å˜é‡ï¼Œå› ä¸ºå®ƒä»¬ç°åœ¨æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå³ person-\u003eNameï¼Œå¹¶ä¸”å‘ç°æ­¤ç‰¹å®šçš„ person ç±»å‹å¯¹è±¡å…·æœ‰åç§°å˜é‡â€œBobbyâ€ï¼\n\nè¿™æ­£æ˜¯æˆ‘ä»¬å°†å¯¹æˆ‘ä»¬çš„\u0060*data\u0060æ‰€åšçš„ï¼\n\n### æ•°æ®ä¸­åŒ…å«ä»€ä¹ˆï¼Ÿ\n\nå› æ­¤ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¡®å®šæ•°æ®æ˜¯å¦ä»¥ä»¥å¤ªç½‘å¸§å¼€å¤´ï¼å‡ ä¹æ‰€æœ‰ä¼ è¾“çš„æ•°æ®éƒ½ä»¥ä»¥å¤ªç½‘å¸§å¼€å¤´ï¼Œè¿™ç›¸å½“ç®€å•ï¼Œä½†å…¶ä½œç”¨æ˜¯å…·æœ‰æºå’Œç›®æ ‡ç¡¬ä»¶åœ°å€ï¼ˆæ— è®ºè™šæ‹ŸåŒ–\/å®¹å™¨åŒ–\/æœ‰çº¿ç½‘ç»œè¿˜æ˜¯ WiFi å¦‚ä½•ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯å°†æˆ‘ä»¬çš„\u0060*data\u0060è½¬æ¢ä¸ºç±»å‹\u0060ETHHDR\u0060ï¼Œå¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬ç°åœ¨å°†èƒ½å¤Ÿäº†è§£ç»„æˆä»¥å¤ªç½‘å¤´æ•°æ®ç±»å‹çš„å˜é‡ã€‚è¿™äº›åŒ…æ‹¬æºå’Œç›®æ ‡ MAC åœ°å€ï¼Œä½†æ›´é‡è¦çš„æ˜¯å‰©ä½™æ•°æ®çš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚å†æ¬¡ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»¥å¤ªç½‘å¤´ä¹‹åçš„\u0060*data\u0060å†…å®¹é€šå¸¸æ˜¯ IP å¤´ï¼Œä½†æˆ‘ä»¬å°†é€šè¿‡æ£€æŸ¥ä»¥å¤ªç½‘å¸§çš„ TBD å˜é‡æ¥éªŒè¯ã€‚\n\nä¸€æ—¦æˆ‘ä»¬éªŒè¯ä¸‹ä¸€ç»„æ•°æ®æ˜¯ IP å¤´ï¼Œæˆ‘ä»¬å°†éœ€è¦å°†ä»¥å¤ªç½‘å¤´ä¹‹åçš„æ•°æ®è½¬æ¢ä¸º IPHDR ç±»å‹ã€‚ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿè®¿é—® IP ç‰¹å®šçš„æ•°æ®ï¼Œä¾‹å¦‚æº IPï¼ˆ\u0060saddr\u0060ï¼‰æˆ–ç›®æ ‡åœ°å€ï¼ˆ\u0060daddr\u0060ï¼‰ï¼Œå†æ¬¡é‡è¦çš„æ˜¯ IP å¤´åŒ…å«ä¸€ä¸ªå˜é‡ï¼Œè¯¦ç»†è¯´æ˜äº† IP å¤´ä¹‹åçš„æ•°æ®æ˜¯ä»€ä¹ˆã€‚è¿™é€šå¸¸æ˜¯ TCP å¤´æˆ– UDP å¤´ï¼Œä½†è¿˜æœ‰å…¶ä»–é€‰æ‹©ï¼Œä¾‹å¦‚ sctp ç­‰ã€‚\n\nä¸€æ—¦æˆ‘ä»¬æŸ¥çœ‹äº† IP å¤´çš„å†…éƒ¨å¹¶ç¡®å®šæ•°æ®ç±»å‹æ˜¯ TCPï¼ˆä¹Ÿå¯èƒ½æ˜¯ UDP æˆ–å…¶ä»–å†…å®¹ï¼‰ï¼Œæˆ‘ä»¬å°†æŠŠä»¥å¤ªç½‘å¤´å’Œ IP å¤´ä¹‹åçš„æ•°æ®éƒ½è½¬æ¢ä¸º TCP å¤´ç±»å‹ï¼ï¼ˆå‡ ä¹å®Œæˆäº†ï¼‰ã€‚é€šè¿‡è®¿é—® TCP å¤´çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾— TCP ç‰¹å®šçš„æ•°æ®ï¼Œä¾‹å¦‚æºç«¯å£æˆ–ç›®æ ‡ç«¯å£ï¼Œç”¨äºéªŒè¯æ•°æ®çš„æœ‰æ•ˆæ€§çš„æ ¡éªŒå’Œä»¥åŠå…¶ä»–æœ‰ç”¨çš„å˜é‡ã€‚\n\nç°åœ¨æˆ‘ä»¬å‡ ä¹æ‹¥æœ‰ä¸€åˆ‡ï¼Œä½†æ˜¯ TCP å¤´çš„é•¿åº¦å¯èƒ½æ˜¯å¯å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡æŸ¥çœ‹ tcl_len å˜é‡æ¥ç¡®å®šè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä¹˜ä»¥ 4ã€‚ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†è®¿é—®æœ€ç»ˆæ•°æ®æ‰€éœ€çš„ä¸€åˆ‡ï¼\n\nå› æ­¤ï¼Œ\u0060*data\u0060æŒ‡å‘æ•°æ®çš„å¼€å¤´ï¼æˆ‘ä»¬å·²ç»ç¡®å®šäº†ä»¥å¤ªç½‘å¤´ä¹‹åæ˜¯ IP å¤´ï¼Œæœ€åæ˜¯ TCP å¤´ï¼Œè¿™æ„å‘³ç€\u0060*data \u002b ä»¥å¤ªç½‘å¤´ \u002b IP å¤´ \u002b TCP å¤´ = å®é™…åº”ç”¨ç¨‹åºæ•°æ®ï¼\n\n### æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›ä¿¡æ¯åšä»€ä¹ˆï¼Ÿ\n\nå½“æˆ‘ä»¬è§£æå„ç§æ ‡å¤´æ—¶ï¼Œå®é™…ä¸Šåœ¨ OSI æ¨¡å‹çš„ä¸åŒå±‚æ¬¡ä¸Šè§£é”äº†è¶Šæ¥è¶Šå¤šçš„ä¿¡æ¯ï¼\n\n**[ç¬¬ 2 å±‚]** ä»¥å¤ªç½‘å¤´ä¸ºæˆ‘ä»¬æä¾›äº†æºå’Œç›®æ ‡ç¡¬ä»¶åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥æ½œåœ¨åœ°é˜»æ­¢ä»æˆ‘ä»¬çŸ¥é“å±é™©çš„æº MAC åœ°å€å¤„ç†çš„å¸§ã€‚\n\n**[ç¬¬ 3 å±‚]** IP å¤´åŒ…å«æºå’Œç›®æ ‡ IP åœ°å€ï¼Œå†æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥åƒé˜²ç«å¢™ä¸€æ ·è¿ä½œï¼Œé€šè¿‡ä½¿ç”¨ eBPF ç¨‹åºä¸¢å¼ƒç‰¹å®š IP åœ°å€çš„æ‰€æœ‰æµé‡ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® IP åœ°å€é‡å®šå‘æµé‡ï¼Œæˆ–è€…ç”šè‡³åœ¨è¿™ä¸€å±‚å®æ–½è´Ÿè½½å‡è¡¡é€»è¾‘ï¼Œä»¥å°†æµé‡é‡å®šå‘åˆ°å…¶ä»–åº•å±‚ IP åœ°å€é›†åˆã€‚\n\n**[ç¬¬ 4 å±‚]** TCP æˆ– UDP æ ‡å¤´å®šä¹‰äº†ç›®æ ‡ç«¯å£å·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥ç¡®å®šåº”ç”¨ç¨‹åºåè®®æ˜¯ä»€ä¹ˆï¼ˆå³ç«¯å£ 80 é€šå¸¸æ„å‘³ç€å‰©ä½™çš„*data å¯èƒ½æ˜¯ HTTP æ•°æ®ï¼‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ‰§è¡Œè´Ÿè½½å‡è¡¡ç­‰æ“ä½œï¼ŒåŸºäºç›®æ ‡ï¼ˆå³åœ¨å¤šä¸ªå…¶ä»–è´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹‹é—´å¹³è¡¡ï¼‰ã€‚\n\n**[ç¬¬ 7 å±‚]** æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œå„ç§æ ‡å¤´é›†åˆçš„æœ«å°¾çš„æ•°æ®æ˜¯å®é™…çš„åº”ç”¨ç¨‹åºæ•°æ®ï¼Œåªè¦æˆ‘ä»¬çŸ¥é“æ ¼å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è§£æå®ƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¤–éƒ¨ Web æµè§ˆå™¨å°è¯•è®¿é—®æˆ‘çš„è®¡ç®—æœºä¸Šçš„\u0060\/index.html\u0060å¹¶é™„åŠ äº† eBPF ç¨‹åºï¼Œæˆ‘ä¼šè§£æåˆ° TCPï¼Œç„¶åç¡®å®šå®ƒæ˜¯ç«¯å£ 80ï¼Œç„¶ååº”ç”¨ç¨‹åºæ•°æ®åº”è¯¥æ˜¯ HTTP æ ¼å¼ã€‚æˆ‘å¯ä»¥é€šè¿‡æŸ¥çœ‹åº”ç”¨ç¨‹åºæ•°æ®çš„å‰ä¸‰ä¸ªå­—ç¬¦ï¼ˆåœ¨æ‰€æœ‰æ ‡å¤´ä¹‹åï¼‰æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨ä»¥ä¸‹ä¼ªä»£ç ï¼š\n\n\u0060\u0060\u0060bash\nApplicationData = EthernetHDR \u002b IPHDR \u002b TCPHDR \/\/ å°†æ‰€æœ‰æ ‡å¤´é•¿åº¦ç›¸åŠ ä»¥æ‰¾åˆ°æ•°æ®\nIf ( data[ApplicationData] = \u0022G\u0022 \u0026\u0026 data[ApplicationData\u002b1] = \u0022E\u0022 \u0026\u0026 data[ApplicationData\u002b2] = \u0022T\u0022 ) {\n\t\/\/ è¿™æ˜¯ä¸€ä¸ªHTTP GETè¯·æ±‚\n\t\/\/ åšä¸€äº›ä»¤äººå…´å¥‹çš„äº‹æƒ…\n}\n\u0060\u0060\u0060\n\n## æ€»ç»“\n\nç°åœ¨æˆ‘ä»¬â€œæœ‰ç‚¹â€ç†è§£äº†è¿™ä¸ªé€»è¾‘ï¼Œä¹Ÿè®¸æˆ‘ä»¬åº”è¯¥è€ƒè™‘å®æ–½ä¸€äº›ä»£ç æ¥å®Œæˆæ‰€æœ‰è¿™äº›...ä½†è¿™å°†æ˜¯å¦ä¸€å¤©çš„äº‹æƒ…ã€‚\n', '\/trans\/ebpf-adventures-in-networking\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">è¿™ç¯‡æ–‡ç« ä»‹ç»äº† eBPF åœ¨ç½‘ç»œé¢†åŸŸçš„ä¸€äº›åº”ç”¨å’Œå®è·µï¼ŒåŒ…æ‹¬ XDPã€TC å’Œ sysprobes ä¸‰ç§ä¸åŒçš„ eBPF ç¨‹åºæŒ‚è½½æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ eBPF å®ç°ç½‘ç»œæ•°æ®çš„æ•è·ã€åˆ†æå’Œä¿®æ”¹ã€‚ä½œè€…è¿˜åˆ†äº«äº†ä¸€äº›æœ‰ç”¨çš„ eBPF å·¥å…·å’Œèµ„æºï¼Œä»¥åŠè‡ªå·±å¼€å‘çš„ä¸€ä¸ª eBPF ç½‘ç»œä»£ç†çš„é¡¹ç›®ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/securing-cloud-natives-most-important-use-cases/">[è¯‘] äº‘åŸç”Ÿè½¯ä»¶çš„å…³é”®ç”¨ä¾‹å®‰å…¨ä¿éšœä¹‹é“</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/10</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e4%b8%9a%e6%80%81"> 
             ä¸šæ€
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.chainguard.dev/unchained/securing-cloud-natives-most-important-use-cases" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('äº‘åŸç”Ÿè½¯ä»¶çš„å…³é”®ç”¨ä¾‹å®‰å…¨ä¿éšœä¹‹é“', 'äº‘åŸç”Ÿè½¯ä»¶å¼€å‘æ„å‘³ç€ä¸ºå…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„ç‰¹æ€§ä¼˜åŒ–åº”ç”¨å’Œç¯å¢ƒã€‚Chainguard æ—¨åœ¨æä¾›ä¸å½±å“å¼€å‘è€…ä½“éªŒçš„è½¯ä»¶ä¾›åº”é“¾å®‰å…¨å·¥å…·ï¼Œé€šè¿‡æä¾›æœ€å°åŒ–ã€å¼ºåŒ–çš„å®¹å™¨é•œåƒï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®åœ°æ‰«ææ¼æ´å¹¶æ¶ˆé™¤ CVE è­¦æŠ¥ã€‚æœ¬æ–‡ä»‹ç»äº† Chainguard Images ä¸º Istio å’Œ Cilium è¿™ä¸¤ä¸ªäº‘åŸç”ŸåŸºç¡€æŠ€æœ¯æä¾›çš„å®‰å…¨å¢å¼ºæ–¹æ¡ˆã€‚', '\næ‘˜è¦ï¼šäº‘åŸç”Ÿè½¯ä»¶å¼€å‘æ„å‘³ç€ä¸ºå…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„ç‰¹æ€§ä¼˜åŒ–åº”ç”¨å’Œç¯å¢ƒã€‚Chainguard æ—¨åœ¨æä¾›ä¸å½±å“å¼€å‘è€…ä½“éªŒçš„è½¯ä»¶ä¾›åº”é“¾å®‰å…¨å·¥å…·ï¼Œé€šè¿‡æä¾›æœ€å°åŒ–ã€å¼ºåŒ–çš„å®¹å™¨é•œåƒï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®åœ°æ‰«ææ¼æ´å¹¶æ¶ˆé™¤ CVE è­¦æŠ¥ã€‚æœ¬æ–‡ä»‹ç»äº† Chainguard Images ä¸º Istio å’Œ Cilium è¿™ä¸¤ä¸ªäº‘åŸç”ŸåŸºç¡€æŠ€æœ¯æä¾›çš„å®‰å…¨å¢å¼ºæ–¹æ¡ˆã€‚\n\n---\n\nä»æ ¹æœ¬ä¸Šè¯´ï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€æ„å»ºé’ˆå¯¹å…¬å…±å’Œç§æœ‰äº‘ç‰¹æ€§è¿›è¡Œä¼˜åŒ–çš„åº”ç”¨ç¨‹åºå’Œç¯å¢ƒã€‚å¼€å‘äº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€ç®¡ç†ä¸€å®šç¨‹åº¦çš„æ··ä¹±ï¼Œè¿™ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„è½¯ä»¶éƒ½éœ€è¦çš„ã€‚\n\nè¿™åœ¨æ–°çš„ä¸€å¹´å°¤å…¶é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸäº§å“å°†è¶‹å‘äºä¼˜å…ˆè€ƒè™‘å¼€å‘è€…ä½“éªŒï¼Œå¹¶ä¸”å¹³å°å·¥ç¨‹çš„å´›èµ·ã€‚è‰¯å¥½çš„å·¥ç¨‹å’Œå·¥å…·ä½¿å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºæ„å»ºå’Œåˆ›æ–°ã€‚å·²ç»æ„å»ºçš„æ‰€æœ‰å†…éƒ¨å¼€å‘è€…å¹³å°å’Œå³å°†æ¨å‡ºçš„å¹³å°éƒ½éœ€è¦å°½é‡å°†åŸºç¡€è®¾æ–½ç®¡ç†ä»å¼€å‘è€…é‚£é‡ŒæŠ½è±¡å‡ºæ¥ã€‚\n\nè¿™æ­£æ˜¯ Chainguard æƒ³è¦è§£å†³çš„é—®é¢˜é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åœ¨å®‰å…¨æ€§å’Œæ¼æ´ç®¡ç†æ–¹é¢ã€‚æˆ‘ä»¬è‡´åŠ›äºæä¾›ä¸å¦¨ç¢å¼€å‘è€…ä½“éªŒçš„å·¥å…·ï¼Œä»¥ç¡®ä¿è½¯ä»¶ä¾›åº”é“¾çš„å®‰å…¨ã€‚æˆ‘ä»¬é€šè¿‡æä¾›æœ€å°åŒ–ã€åŠ å›ºçš„å®¹å™¨é•œåƒæ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œè¿™ä½¿æˆ‘ä»¬çš„ç”¨æˆ·å¯ä»¥è·å¾—å‡†ç¡®çš„æ‰«æç»“æœï¼Œå¹¶å°† CVE æ”¶ä»¶ç®±è­¦æŠ¥é™è‡³é›¶ã€‚\n\n### æ¨å‡ºæ–°çš„ Chainguard Images æ†ç»‘åŒ…ï¼Œé€‚ç”¨äº Cilium å’Œ Istio\n\nä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å¯†åˆ‡å…³æ³¨æœ€å—æ¬¢è¿çš„å¼€æºé¡¹ç›®ï¼Œä½†ä¹Ÿå…³æ³¨é‚£äº›å¦‚æœç»è¿‡åŠ å›ºï¼Œå°†ä¸ºæ•´ä¸ªå¼€æºç”Ÿæ€ç³»ç»Ÿæä¾›é‡è¦çš„å®‰å…¨æ”¹è¿›çš„é¡¹ç›®ã€‚ä¸ºäº†åœ¨æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­äº§ç”Ÿæœ€å¤§çš„å½±å“ï¼Œæˆ‘ä»¬åº”è¯¥å¸®åŠ©åŠ å›ºé‚£äº›ä½œä¸ºäº‘åŸç”Ÿè½¯ä»¶åŸºçŸ³çš„æŠ€æœ¯ã€‚Istio å’Œ Cilium æ­£æ˜¯è¿™æ ·çš„æ˜æ˜¾ç¤ºä¾‹ï¼Œå®ƒä»¬æ˜¯äº‘åŸç”Ÿè½¯ä»¶ç”Ÿæ€ç³»ç»Ÿçš„åŸºç¡€æ„å»ºæ¨¡å—ä¹‹ä¸€ã€‚é€šè¿‡æä¾›æ–°çš„ Chainguard Images Istio å’Œ Cilium æ†ç»‘åŒ…ï¼Œæˆ‘ä»¬ä¸ºè¿™äº›é¡¹ç›®çš„ç”¨æˆ·æä¾›äº†ä¸€ä¸ªå®‰å…¨åœ°å°†å®ƒä»¬å¼•å…¥å…¶æ„å»ºæµç¨‹çš„ç®€ä¾¿æ–¹æ³•ã€‚\n\nåœ¨ä»»ä½•ç»™å®šçš„ä¾›åº”é“¾ä¸­ï¼Œæœ‰äº›åŸææ–™æ¯”å…¶ä»–åŸææ–™æ›´ä¸ºåŸºç¡€ã€‚å¦‚æœè¿™äº›åŸææ–™å¾—åˆ°äº†å¦¥å–„ä¿æŠ¤ï¼Œé‚£ä¹ˆè¿™å°†å¯¹åç»­å·¥ä½œäº§ç”Ÿè¿é”æ•ˆåº”ï¼ˆæˆ–è€…å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œå¯ä»¥è¯´æ˜¯å¯¹æ•´ä¸ªå †æ ˆäº§ç”Ÿä¸Šä¸‹æ¸¸å½±å“ï¼‰ã€‚\n\nCilium å’Œ Istio æŠ€æœ¯éƒ½æ¶µç›–äº†å¯¹ Kubernetes ç¯å¢ƒå…·æœ‰åŸºç¡€ä½œç”¨çš„å„ç§ç”¨ä¾‹ã€‚Cilium å’Œ Istio æ˜¯ä¸¤ä¸ªæµè¡Œçš„å·¥å…·ï¼Œé€šè¿‡æä¾›æµé‡è·¯ç”±ã€è´Ÿè½½å¹³è¡¡ã€æœåŠ¡å‘ç°ç­‰åŠŸèƒ½æ¥å¸®åŠ©è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚è¿™äº›åŠŸèƒ½å¯¹äºç¡®ä¿ Kubernetes å’Œå…¶ä»–äº‘åŸç”Ÿè½¯ä»¶éƒ¨ç½²çš„é¡ºåˆ©ã€é«˜æ•ˆå’Œå®‰å…¨è¿è¡Œè‡³å…³é‡è¦ã€‚æœ€ç»ˆï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€åˆ›å»ºä¸“ä¸ºäº‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œè€Œ Cilium å’Œ Istio åœ¨å¸®åŠ©å¼€å‘è€…å®ç°è¿™ä¸€ç›®æ ‡æ–¹é¢å‘æŒ¥äº†å…³é”®ä½œç”¨ã€‚\n\n### Istio å’Œ Cilium åœ¨äº‘è®¡ç®—ä¸­ä¸å¯æˆ–ç¼ºçš„ä½œç”¨\n\næ ¹æ® 2022 å¹´çš„ [CNCF å¹´åº¦è°ƒæŸ¥](https:\/\/www.cncf.io\/reports\/cncf-annual-survey-2022\/)ï¼ŒIstio æ˜¯å—è®¿è€…ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼ï¼Œ73% çš„å—è®¿å…¬å¸ä½¿ç”¨å®ƒã€‚è¿™ç§å¹¿æ³›çš„é‡‡ç”¨è¯æ˜äº† Istio åœ¨è§£å†³å„ç§æœåŠ¡ç®¡ç†æŒ‘æˆ˜æ–¹é¢çš„æœ‰æ•ˆæ€§ï¼Œä½¿å…¶æˆä¸ºç°ä»£ä¼ä¸šå¯»æ±‚æ„å»ºå¼ºå¤§ã€å®‰å…¨å’Œå¯æ‰©å±•çš„å¾®æœåŠ¡æ¶æ„çš„é‡è¦å·¥å…·ã€‚Istio åœ¨ GitHub ä¸Šæ‹¥æœ‰è¶…è¿‡ 34,000 é¢—æ˜Ÿæ˜Ÿï¼Œä½¿å…¶æˆä¸º CNCF ä¸­æœ€å—æ¬¢è¿çš„é¡¹ç›®ä¹‹ä¸€ã€‚\n\nä»åŒä¸€ä»½ CNCF è°ƒæŸ¥ä¸­ï¼Œæœ‰ 47% çš„å—è®¿è€…å°† Cilium ä½œä¸ºä»–ä»¬å®¹å™¨ç¼–æ’å¹³å°ï¼ˆå¦‚ Kubernetesï¼‰çš„é¦–é€‰ç½‘ç»œæ’ä»¶ã€‚å®ƒä¹Ÿå—æ¬¢è¿äºç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œæœ‰ 43% çš„å—è®¿è€…å°†å…¶ç”¨äºæ­¤ç›®çš„ã€‚eBPF çš„æœªæ¥å’ŒåŠ›é‡æ˜¯ä¸å¯æ€è®®çš„ï¼Œæ‰€æœ‰äººéƒ½åŒæ„è¿™ä¸€ç‚¹ã€‚\n\næœ€è¿‘ï¼Œæˆ‘ä»¬æ¨å‡ºäº†æˆ‘ä»¬çš„æ–°çš„ [Chainguard Images ç›®å½•](https:\/\/images.chainguard.dev\/)ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¬å¼€å¯ç”¨çš„ç½‘ç«™ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­æµè§ˆæˆ‘ä»¬åº“å­˜ä¸­çš„æ‰€æœ‰é•œåƒã€‚åœ¨æ¯ä¸ª Chainguard\n\n Image åˆ—è¡¨ä¸­ï¼Œä½ å°†æ‰¾åˆ°æœ‰å…³å®‰è£…ã€åŸºç¡€è®¾æ–½ã€ç­¾åå’Œ SBOM çš„æºæ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥åŠæ›´å¤šå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚Chainguard Images ç›®å½•è¿˜åŒ…æ‹¬ä¸€ä¸ªæ–°çš„[å®‰å…¨é€šæŠ¥](https:\/\/images.chainguard.dev\/security)é¡µé¢ï¼Œæ˜¾ç¤ºç”¨æˆ·å·²çŸ¥çš„ CVEï¼Œä¿®å¤çš„çŠ¶æ€ç­‰ä¿¡æ¯ã€‚\n\nå¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´å¤šå…³äºå¦‚ä½•åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¯åŠ¨ Chainguard Images Cilium æˆ– Istio æ†ç»‘åŒ…çš„æŠ€æœ¯æŒ‡å¯¼ï¼Œè¯·æŸ¥çœ‹ Chainguard å·¥ç¨‹å¸ˆ[Nghia Tran](https:\/\/www.linkedin.com\/in\/tcnghia\/)åœ¨ Chainguard Academy ä¸Šæä¾›çš„è¿™äº›æ–¹ä¾¿å…¥é—¨çš„æŒ‡å—ã€‚éå¸¸æ„Ÿè°¢æˆ‘ä»¬çš„æœ‹å‹[Isovalent](https:\/\/www.linkedin.com\/in\/feroz-salam-372a4113\/)çš„ Feroz Salam åœ¨ Cilium Images æ–¹é¢ç»™äº†æˆ‘ä»¬å¸®åŠ©ï¼Œä»¥åŠå¤šå¹´æ¥å¸®åŠ©æˆ‘ä»¬çš„ Istio çš„[John Howard](https:\/\/www.linkedin.com\/in\/-johnhoward\/)ï¼ä»¥ä¸‹æ˜¯æŒ‡å—ï¼š\n\n- [å¼€å§‹ä½¿ç”¨ Istio](https:\/\/edu.chainguard.dev\/chainguard\/chainguard-images\/getting-started\/getting-started-istio\/)\n- [å¼€å§‹ä½¿ç”¨ Cilium](https:\/\/edu.chainguard.dev\/chainguard\/chainguard-images\/getting-started\/getting-started-cilium\/)\n\nChainguard Developer Images æä¾›äº†å¸¦æœ‰ \u0060:latest\u0060 å’Œ \u0060:latest-dev\u0060 æ ‡ç­¾çš„å…è´¹é•œåƒï¼Œä¾›ä½ åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚åœ¨æ–°çš„ç›®å½•ä¸­ï¼Œæ¯ä¸ªé•œåƒé¡µé¢è¿˜åŒ…æ‹¬é‡è¦çš„ç‰¹å®šäºé•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ç‰ˆæœ¬æ ‡ç­¾å’Œå…¶ä»–å˜ä½“ï¼Œå¦‚ FIPS å’Œé•¿æœŸæ”¯æŒï¼ˆLTSï¼‰ï¼Œè¿™äº›éƒ½é€‚ç”¨äºè´­ä¹°äº†è¿™äº›è§£å†³æ–¹æ¡ˆçš„ Chainguard Images å®¢æˆ·ã€‚å¦‚æœä½ æƒ³äº†è§£æœ‰å…³æˆ‘ä»¬çš„ Production Images ä¸­é¢å‘ä¼ä¸šçš„åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·[è”ç³»æˆ‘ä»¬çš„å›¢é˜Ÿ](https:\/\/www.chainguard.dev\/contact)ã€‚\n', '\/trans\/securing-cloud-natives-most-important-use-cases\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">äº‘åŸç”Ÿè½¯ä»¶å¼€å‘æ„å‘³ç€ä¸ºå…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„ç‰¹æ€§ä¼˜åŒ–åº”ç”¨å’Œç¯å¢ƒã€‚Chainguard æ—¨åœ¨æä¾›ä¸å½±å“å¼€å‘è€…ä½“éªŒçš„è½¯ä»¶ä¾›åº”é“¾å®‰å…¨å·¥å…·ï¼Œé€šè¿‡æä¾›æœ€å°åŒ–ã€å¼ºåŒ–çš„å®¹å™¨é•œåƒï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®åœ°æ‰«ææ¼æ´å¹¶æ¶ˆé™¤ CVE è­¦æŠ¥ã€‚æœ¬æ–‡ä»‹ç»äº† Chainguard Images ä¸º Istio å’Œ Cilium è¿™ä¸¤ä¸ªäº‘åŸç”ŸåŸºç¡€æŠ€æœ¯æä¾›çš„å®‰å…¨å¢å¼ºæ–¹æ¡ˆã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits/">[è¯‘] å¦‚ä½•ä½¿ç”¨ Calico æ„å»ºå’Œç®¡ç† Kubernetes Cluster Mesh</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/09</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/kubernetes"> 
             Kubernetes
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.tigera.io/blog/deep-dive/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('å¦‚ä½•ä½¿ç”¨ Calico æ„å»ºå’Œç®¡ç† Kubernetes Cluster Mesh', 'è¿™ç¯‡æ–‡ç« ä»‹ç»äº†é›†ç¾¤ç½‘æ ¼çš„æ¦‚å¿µå’Œä¼˜åŠ¿ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Calico Open Source çš„å¤šç§æ–¹æ³•ï¼Œå®ç°è·¨é›†ç¾¤çš„æœåŠ¡é—´é€šä¿¡å’Œè´Ÿè½½å‡è¡¡ã€‚', '\nKubernetes æ˜¯æ„å»ºçµæ´»å¯æ‰©å±•åŸºç¡€è®¾æ–½ä»¥è¿è¡ŒåŠ¨æ€å·¥ä½œè´Ÿè½½çš„ä¼˜ç§€è§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œéšç€æˆ‘ä»¬çš„é›†ç¾¤æ‰©å±•ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé¢ä¸´åŒæ—¶æ‰©å±•å’Œç®¡ç†å¤šä¸ªé›†ç¾¤çš„ä¸å¯é¿å…æƒ…å†µã€‚è¿™ä¸ªæ¦‚å¿µå¯èƒ½ä¼šç»™æˆ‘ä»¬çš„æ—¥å¸¸å·¥ä½œè´Ÿè½½ç»´æŠ¤å¸¦æ¥å¾ˆå¤šå¤æ‚æ€§ï¼Œå¹¶å¢åŠ åœ¨æ‰€æœ‰ç¯å¢ƒä¸­ä¿æŒæ‰€æœ‰ç­–ç•¥å’ŒæœåŠ¡çš„æœ€æ–°æ€§çš„éš¾åº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ[é›†ç¾¤ç½‘æ ¼](https:\/\/www.tigera.io\/blog\/using-calico-to-create-a-kubernetes-cluster-mesh-for-multi-cluster-environments\/) å¯ä»¥åœ¨è¿™äº›é›†ç¾¤ä¹‹é—´å»ºç«‹æ— ç¼çš„è¿æ¥ï¼Œå¹¶å°†å·¥ä½œè´Ÿè½½é›†æˆåˆ°ç»Ÿä¸€çš„ç½‘ç»œç¯å¢ƒä¸­ã€‚\n\né›†ç¾¤ç½‘æ ¼æ˜¯è¿æ¥ç‹¬ç«‹ Kubernetes é›†ç¾¤å¹¶åœ¨ä¸åŒé›†ç¾¤ä¸­çš„èµ„æºä¹‹é—´æä¾›è¿æ¥æ€§çš„ç»ä½³æ–¹å¼ï¼Œä»¥æä¾›è¶…å‡ºå•ä¸ªé›†ç¾¤æƒ…å†µä¸‹å¯èƒ½çš„å®¹é”™æ€§å’Œé«˜å¯ç”¨æ€§ã€‚\n\nåœ¨æœ¬åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¼•å¯¼ä½ å®Œæˆæ„å»ºå¤šé›†ç¾¤ç¯å¢ƒå¹¶å»ºç«‹é›†ç¾¤ç½‘æ ¼æ‰€éœ€çš„æ­¥éª¤ï¼Œåˆ©ç”¨ Calico Open Source çš„å¤šåŠŸèƒ½èƒ½åŠ›ã€‚æˆ‘ä»¬å°†æ¢è®¨ä¸åŒçš„æ–¹æ³•ï¼Œå¦‚é¡¶çº§æœºæ¶ (TOR) å’Œ overlayï¼Œä»¥å»ºç«‹é›†ç¾¤ç½‘æ ¼ï¼Œè§£å†³ä¸åŒç¯å¢ƒæå‡ºçš„ç‹¬ç‰¹ç½‘ç»œæŒ‘æˆ˜ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸º Calico æä¾›äº†å»ºç«‹å¤šé›†ç¾¤ç¯å¢ƒçš„å¤šç§æ–¹æ³•ï¼Œçµæ´»é€‚åº”ä½ çš„ç½‘ç»œåŸºç¡€è®¾æ–½å’Œç‰¹å®šè¦æ±‚ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•åŠ å…¥ DNS è¿é€šæ€§ä»¥å¢å¼ºé›†ç¾¤é—´é€šä¿¡ã€‚\n\néšç€ä½ çš„é›†ç¾¤ç½‘æ ¼ç¯å¢ƒæ‰©å±•ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ¶‰åŠ[è”é‚¦](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-federation\/)å’Œä½¿ç”¨ Calico Enterprise è¿›è¡Œå¤šé›†ç¾¤ç®¡ç†çš„ä¸‹ä¸€æ­¥ï¼Œä»¥åŠæ¶‰åŠè”é‚¦é›†ç¾¤ã€‚æˆ‘ä»¬å°†å±•ç¤º Calico å¦‚ä½•æä¾›å¤šé›†ç¾¤ç®¡ç†å¹³é¢ï¼Œå…è®¸åœ¨é›†ç¾¤é—´æ— ç¼å®æ–½å®‰å…¨æ€§å’Œå¯è§‚æµ‹æ€§ã€‚\n\næœ€åï¼Œæˆ‘ä»¬å°†æ¶‰åŠåˆ° Calico Enterprise è”é‚¦èº«ä»½å¦‚ä½•åœ¨[å¤šé›†ç¾¤](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-networking\/kubernetes-multi-cluster\/)ç¯å¢ƒä¸­å¼¥åˆå·®è·ï¼Œæä¾›ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥å®šåˆ¶ç½‘ç»œç­–ç•¥ï¼Œå¯ä»¥å¼•ç”¨æ¥è‡ªä¸åŒé›†ç¾¤çš„èµ„æºå¹¶æ„å»ºè·¨é›†ç¾¤è¾¹ç•Œè´Ÿè½½å¹³è¡¡è¯·æ±‚çš„æœåŠ¡ã€‚\n\n## ä»€ä¹ˆæ˜¯é›†ç¾¤ç½‘æ ¼ï¼Ÿ\n\né›†ç¾¤ç½‘æ ¼è¿æ¥äº†ä¸¤ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹é›†ç¾¤å†…éƒ¨èµ„æºã€‚é€šå¸¸ï¼Œæ¯ä¸ª Kubernetes é›†ç¾¤å°†ä¸ºå†…éƒ¨èµ„æºåˆ†é…ç§æœ‰ IP åœ°å€ï¼Œé™¤éå°†**èŠ‚ç‚¹ç«¯å£**æˆ–**è´Ÿè½½å‡è¡¡å™¨**æœåŠ¡ä¸å®ƒä»¬å…³è”ï¼Œå¦åˆ™è¿™äº›èµ„æºå¯¹ä»»ä½•å¤–éƒ¨å®ä½“éƒ½ä¸å¯è§ã€‚ç„¶è€Œï¼Œå°†èµ„æºæš´éœ²ç»™æ‰€æœ‰äººå¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ï¼Œå¹¶ç ´åä½ åº”è¯¥ä¿æŒçš„[é›¶ä¿¡ä»»å®‰å…¨](https:\/\/www.tigera.io\/learn\/guides\/zero-trust\/zero-trust-security\/)å§¿æ€ï¼Œä»¥ä¿æŠ¤ä½ çš„ç¯å¢ƒã€‚æ­¤å¤–ï¼Œå®ƒå¯ä»¥é€šè¿‡å…è®¸æ¶æ„ç”¨æˆ·åˆ©ç”¨æ¼æ´å¹¶åœ¨å…³é”®æœåŠ¡ä¸­å æ®ç«‹è¶³ç‚¹æ¥å±åŠæ•´ä¸ªç¯å¢ƒã€‚\n\nåœ¨å¤šé›†ç¾¤ç¯å¢ƒä¸­å»ºç«‹é›†ç¾¤ç½‘æ ¼æä¾›äº†ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œç”¨äºä¿ƒè¿›é›†ç¾¤ä¹‹é—´çš„ç›´æ¥é€šä¿¡ã€‚è¿™ç§é€šä¿¡å¯ä»¥é€šè¿‡æŒ‡å®šçš„é›†ç¾¤æœåŠ¡æˆ–ç§æœ‰ IP åœ°å€è¿›è¡Œï¼Œç¡®ä¿å¼ºå¤§è€Œå—æ§åˆ¶çš„äº¤äº’ï¼ŒåŒæ—¶å‡è½»äº†å°†å†…éƒ¨èµ„æºæš´éœ²ç»™æ›´å¹¿æ³›ç½‘ç»œçš„é£é™©ã€‚\n\n### å¦‚ä½•æ„å»ºå¤šé›†ç¾¤ç¯å¢ƒå¹¶å»ºç«‹é›†ç¾¤ç½‘æ ¼\n\nä»¥ä¸‹å›¾ç‰‡è¯´æ˜äº† Calico å¦‚ä½•åœ¨ä½ çš„é›†ç¾¤ä¹‹é—´å»ºç«‹é›†ç¾¤ç½‘æ ¼è¿æ¥ã€‚\n\n![](1.png)\n\nCalico æä¾›äº†ä¸åŒçš„æ–¹å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹å¼æ¥æ„å»ºå¤šé›†ç¾¤ç¯å¢ƒï¼Œä»è€Œæä¾›äº†ä¸ä½ çš„ç½‘ç»œåŸºç¡€è®¾æ–½å’Œéœ€æ±‚ç›¸åŒ¹é…çš„çµæ´»æ€§ã€‚Calico æœ€å¥½çš„éƒ¨åˆ†æ˜¯ï¼Œåœ¨å°†ä¸¤ä¸ªé›†ç¾¤è¿æ¥åœ¨ä¸€èµ·åï¼Œå®ƒå°†è‡ªåŠ¨æä¾›é›†ç¾¤ç½‘æ ¼ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å®ƒä»¬çš„å†…éƒ¨é›†ç¾¤æœåŠ¡å’Œ IP åœ°å€å¼€å§‹åœ¨ä¸åŒçš„é›†ç¾¤ä¸­ä½¿ç”¨èµ„æºã€‚\n\n### åœ¨æ‰å¹³ç½‘ç»œç¯å¢ƒä¸­çš„é›†ç¾¤ç½‘æ ¼\n\né›†ç¾¤ç½‘æ ¼çš„é…ç½®å¯ä»¥æ ¹æ®åº•å±‚åŸºç¡€è®¾æ–½çš„ä¸åŒè€Œå˜åŒ–ï¼Œä½†å…¶åŸºæœ¬ç›®çš„ä¿æŒä¸å˜ï¼Œå®è´¨ä¸Šæ˜¯ç”¨äºå»ºç«‹ç‹¬ç«‹é›†ç¾¤ä¹‹é—´çš„è¿æ¥ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„é›†ç¾¤çš„å‚ä¸èŠ‚ç‚¹é€šè¿‡å¹¿æ’­åŸŸç›´æ¥è¿æ¥çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ æ’­å†…éƒ¨è·¯ç”±åˆ°å¤–éƒ¨å®ä½“çš„è·¯ç”±åè®®æ¥å¿«é€Ÿå»ºç«‹ä¸€ä¸ªç½‘æ ¼ã€‚è¿™å°†å…è®¸æˆ‘ä»¬å¹¿å‘Šå†…éƒ¨è·¯ç”±ï¼Œè€Œæ— éœ€é€šè¿‡**èŠ‚ç‚¹ç«¯å£**æœåŠ¡å°†å®ƒä»¬æš´éœ²ç»™æˆ‘ä»¬çš„ç›®æ ‡æœåŠ¡ã€‚\n\nä»¥ä¸‹å›¾ç‰‡è¯´æ˜äº†æ‰å¹³ç½‘ç»œçš„å¸¸è§è®¾è®¡ï¼š\n\n![](2.png)\n\nè€ƒè™‘è§‚çœ‹æˆ‘ä»¬çš„è§†é¢‘ï¼Œ[ä½¿ç”¨ Calico å¼€æºè¿›è¡Œ Kubernetes çš„ BGP](https:\/\/www.youtube.com\/watch?v=PefluN8YM9o\u0026ab_channel=ProjectCalico)ï¼Œä»¥äº†è§£ä½¿ç”¨å…¨ç½‘æ ¼æ–¹æ³•éƒ¨ç½²é›†ç¾¤ç½‘æ ¼çš„å…¨é¢æ•™ç¨‹ã€‚\n\n### åœ¨ä¼ä¸šæˆ–äº‘ç½‘ç»œç¯å¢ƒä¸­çš„é›†ç¾¤ç½‘æ ¼\n\nåœ¨å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œä¾‹å¦‚äº‘æˆ–ä¼ä¸šç½‘ç»œï¼Œå½¢æˆé›†ç¾¤çš„åŸºç¡€è®¾æ–½èµ„æºé€šå¸¸åˆ†ä¸ºå•ç‹¬çš„å¹¿æ’­åŸŸã€‚è¿™æ˜¯å› ä¸ºè¿™äº›åŸŸä¸­çš„æ¯ä¸ªå®ä½“éƒ½è¢«è¦æ±‚é€šè¿‡ç½‘å…³æ¥åˆ°è¾¾å…¶ç›®çš„åœ°ã€‚ä½†æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé¢å¤–çš„è·³è·ƒï¼ˆç½‘å…³ï¼‰éœ€è¦äº†è§£æˆ‘ä»¬åœ¨ Kubernetes é›†ç¾¤ä¸­åˆ›å»ºçš„å†…éƒ¨é›†ç¾¤èµ„æºã€‚å› æ­¤ï¼Œç½‘å…³ä¼šä¸¢å¼ƒå‰å¾€è¿™äº›å†…éƒ¨èµ„æºçš„æ•°æ®åŒ…ï¼Œä½¿ç®€å•çš„è·¯ç”±æ–¹æ³•æ— æ³•æ»¡è¶³è¦æ±‚ã€‚\n\nä»¥ä¸‹å›¾ç‰‡è¯´æ˜äº†å¤æ‚ç½‘ç»œç¯å¢ƒçš„å¸¸è§è®¾è®¡ï¼š\n\n![](3.png)\n\næ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†é—®é¢˜ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ©ç”¨ Calico æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\nä¸ºäº†åœ¨è¿™æ ·çš„ç¯å¢ƒä¸­å»ºç«‹é›†ç¾¤ç½‘æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹æ³•ï¼š\n\n- é¡¶å±‚æœºæ¶ï¼ˆTORï¼‰\n- overlay\n\n#### TOR æ–¹æ³•ï¼ˆæ¨èï¼‰\n\nåœ¨ä¼ä¸šæˆ–äº‘ç¯å¢ƒä¸­ï¼Œèµ„æºé€šå¸¸é€šè¿‡ä¸­é—´ç½‘å…³äº’è¿ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å»ºè®®æˆ‘ä»¬çš„å®¢æˆ·ä½¿ç”¨ TORï¼Œå› ä¸ºé€šè¿‡ä¸äº‘æä¾›å•†è‡ªåŠ¨å»ºç«‹è·¯ç”±ä¼ æ’­æœºåˆ¶æ¥ä½¿ä½ çš„é›†ç¾¤äº†è§£ä½ ç›‘ç®¡ä¸‹çš„æ‰€æœ‰äº‘èµ„æºï¼Œä»è€Œä½¿ä½ çš„é›†ç¾¤å…·å¤‡é«˜å¯ç”¨æ€§ã€‚è¿™ä¹Ÿåœ¨äº‘æä¾›å•†çš„åº•å±‚ç½‘ç»œåŸºç¡€è®¾æ–½ä¸Šå‘æŒ¥äº†ä½œç”¨ï¼Œä»è€Œä½¿ä½ çš„é›†ç¾¤åœ¨ç½‘ç»œåŸºç¡€è®¾æ–½çš„æ”¯æŒä¸‹å…·å¤‡é«˜å¯ç”¨æ€§ã€‚\n\nå‡è®¾ä½ å¯ä»¥é…ç½®äº‘ç½‘å…³å¹¶å°†å…¶ä¸åƒ Calico è¿™æ ·çš„å¼ºå¤§çš„[å®¹å™¨ç½‘ç»œæ¥å£ï¼ˆCNIï¼‰](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-networking\/kubernetes-cni\/)é…å¯¹ï¼Œé‚£ä¹ˆä½ å¯ä»¥åˆ©ç”¨ BGP è·¯ç”±æ¥å»ºç«‹é›†ç¾¤ç½‘æ ¼ã€‚Calico BGP é›†æˆæä¾›äº†åŠ¨æ€è·¯ç”±ï¼Œå…è®¸ä½ å°†å†…éƒ¨ Pod å’Œé›†ç¾¤ IP è·¯ç”±ä¼ æ’­åˆ°ç½‘ç»œåŸºç¡€è®¾æ–½ä¸­çš„å…¶ä»–èµ„æºã€‚\n\nä»¥ä¸‹å›¾ç‰‡è¯´æ˜äº†æ”¯æŒ BGP çš„äº‘ç¯å¢ƒçš„å¸¸è§è®¾è®¡ï¼š\n\n![](4.png)\n\nåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒTORï¼ˆé¡¶å±‚æœºæ¶ï¼‰æé«˜äº†é«˜å¯ç”¨æ€§å’Œå®¹é”™æ€§ã€‚è¿™ç§æ–¹æ³•ä¼˜åŒ–äº†ç½‘ç»œæµé‡åˆ†å¸ƒï¼Œå‡è½»äº†å•ç‚¹æ•…éšœï¼Œå¹¶è¿›ä¸€æ­¥å¢å¼ºäº†ä½ çš„åŸºç¡€è®¾æ–½çš„å¯é æ€§å’Œå¼¹æ€§ã€‚\n\næ³¨æ„ï¼šè¦äº†è§£ä½¿ç”¨ TOR æ–¹æ³•éƒ¨ç½²é›†ç¾¤ç½‘æ ¼çš„è¯¦ç»†æŒ‡å—ï¼Œè¯·æŸ¥çœ‹[æ­¤å¤„](https:\/\/docs.tigera.io\/calico\/latest\/networking\/configuring\/bgp#top-of-rack-tor)çš„æ•™ç¨‹ã€‚\n\n#### IPIP overlay\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æ— æ³•è®¿é—®ç½‘å…³ä»¥ä¿®æ”¹å…¶è®¾ç½®ï¼Œæˆ–è€…å®ƒå¯èƒ½ä¸æ”¯æŒ BGP å¯¹ç­‰è¿æ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ IPIP overlay æ¥å°è£…æµå‘ç›®æ ‡é›†ç¾¤çš„æµé‡ã€‚overlay ç½‘ç»œå…è®¸ç½‘ç»œè®¾å¤‡åœ¨åº•å±‚ç½‘ç»œï¼ˆç§°ä¸ºåº•å±‚ï¼‰ä¸Šç›¸äº’é€šä¿¡ï¼Œè€Œåº•å±‚ç½‘ç»œä¸éœ€è¦äº†è§£è¿æ¥åˆ° overlay ç½‘ç»œçš„è®¾å¤‡ã€‚\n\næ³¨æ„ï¼šå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº overlay ç½‘ç»œçš„ä¿¡æ¯ï¼Œè¯·å•å‡»[æ­¤å¤„](https:\/\/docs.tigera.io\/calico\/latest\/about\/kubernetes-training\/about-networking#overlay-networks)ã€‚\n\n#### VXLAN overlay (Calico Enterprise)\n\nå³å°†å‘å¸ƒçš„ Calico Enterpriseï¼ˆ3.18\u002bï¼‰ç‰ˆæœ¬å°†åœ¨å¤šé›†ç¾¤ç¯å¢ƒä¸‹å¯ç”¨ VXLAN ç½‘ç»œã€‚è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªæ˜¾è‘—ä¼˜åŠ¿ä¹‹ä¸€æ˜¯èƒ½å¤Ÿä½¿ç”¨èº«ä»½æ„ŸçŸ¥ç­–ç•¥æ¥ä¿æŠ¤è·¨é›†ç¾¤çš„æµé‡ï¼ˆä½ å°†åœ¨æ¥ä¸‹æ¥çš„è”é‚¦éƒ¨åˆ†äº†è§£æœ‰å…³æ­¤åŠŸèƒ½çš„ä¿¡æ¯ï¼‰ã€‚é€šè¿‡å…¶å¤šé›†ç¾¤ç½‘ç»œåŠŸèƒ½ï¼ŒCalico Enterprise è‡ªåŠ¨æ‰©å±• overlay ç½‘ç»œï¼Œä»¥åœ¨é›†ç¾¤ä¹‹é—´å»ºç«‹ Pod IP è·¯ç”±ã€‚\n\nåœ¨ä½¿ç”¨ VXLAN çš„ Calico Enterprise é›†ç¾¤ç½‘æ ¼è®¾ç½®ä¸­ï¼Œæ¯ä¸ªé›†ç¾¤éƒ½å……å½“æœ¬åœ°é›†ç¾¤å’Œè¿œç¨‹é›†ç¾¤ï¼Œæœ¬åœ°é›†ç¾¤é…ç½®ä¸ºä»è¿œç¨‹é›†ç¾¤çš„åŠ å¯†é€šé“ä¸­æ£€ç´¢ç«¯ç‚¹å’Œè·¯ç”±æ•°æ®ã€‚VXLAN é›†ç¾¤ç½‘æ ¼æä¾›äº†ä¸€ç§å®‰å…¨ã€å¯æ‰©å±•å’Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œç”¨äºç®¡ç†å¤šé›†ç¾¤ç½‘ç»œï¼Œå®ç°äº†è·¨é›†ç¾¤çš„æ— ç¼é€šä¿¡å’Œèº«ä»½æ„ŸçŸ¥ç­–ç•¥å¼ºåˆ¶æ‰§è¡Œã€‚\n\næ³¨æ„ï¼šå¦‚æœä½ æƒ³äº†è§£æœ‰å…³ VXLAN overlay çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å•å‡»[æ­¤å¤„](https:\/\/www.tigera.io\/news\/tigera-introduces-powerful-enhancements-to-calico-open-source-and-calico-cloud-to-elevate-security-scalability-and-performance\/)ã€‚\n\nä»¥ä¸‹å›¾ç‰‡è¯´æ˜äº†æ²¡æœ‰ BGP èƒ½åŠ›çš„äº‘ç¯å¢ƒçš„å¸¸è§è®¾è®¡ï¼š\n\n![](5.png)\n\næ³¨æ„ï¼šè¦äº†è§£ä½¿ç”¨ TOR æ–¹æ³•éƒ¨ç½²é›†ç¾¤ç½‘æ ¼çš„å…¨é¢æŒ‡å—ï¼Œè¯·æŸ¥çœ‹[æ­¤æ•™ç¨‹](https:\/\/youtu.be\/rv-DnExi6SM?t=2287)ã€‚\n\n### DNS è¿æ¥\n\nåœ¨å»ºç«‹å¤šé›†ç¾¤ä¹‹åï¼Œå„ä¸ªé›†ç¾¤å¯ä»¥åœ¨ IP çº§åˆ«è¿›è¡Œé€šä¿¡ã€‚ç„¶è€Œï¼Œæ ¹æ®ä½ çš„ç½‘ç»œè§„æ¨¡ä»¥åŠ Kubernetes IP åœ°å€çš„æ€§è´¨ï¼Œè¿™äº›åœ°å€å¯ä»¥éšæ—¶åŠ¨æ€æ›´æ”¹ï¼Œå› æ­¤ä½ éœ€è¦å®ç°ä¸€ç§æ›´å®¹æ˜“å»ºç«‹è¿™äº›é›†ç¾¤ä¹‹é—´è¿æ¥çš„æ–¹å¼ã€‚åŸŸåè§£æå¯ä»¥æˆä¸ºä½ çš„é›†ç¾¤ç½‘æ ¼çš„é‡è¦è¡¥å……ï¼Œå…è®¸æ›´å®¹æ˜“è¿›è¡Œé›†ç¾¤é—´é€šä¿¡ã€‚\n\nåœ¨å¤§å¤šæ•° Kubernetes éƒ¨ç½²ä¸­ï¼ŒCoreDNS ä½œä¸ºè´Ÿè´£è§£æé›†ç¾¤åŸŸåçš„ä¸»è¦å·¥ä½œè´Ÿè½½ã€‚è¦å°† DNS ä¸é›†ç¾¤ç½‘æ ¼æ— ç¼é›†æˆï¼Œåªéœ€å¯¹ CoreDNS é…ç½®æ˜ å°„è¿›è¡Œç®€å•çš„ä¿®æ”¹å³å¯ã€‚å…·ä½“æ¥è¯´ï¼Œä½ éœ€è¦å°†å…¶ä»–é›†ç¾¤çš„ CoreDNS å†…éƒ¨æœåŠ¡ IP æ·»åŠ ä¸ºè½¬å‘å™¨åˆ°ä½ çš„é…ç½®ä¸­ã€‚\n\nè¿™ä¸ªç®€å•çš„è°ƒæ•´ä½¿ä½ çš„é›†ç¾¤èƒ½å¤Ÿé€šè¿‡å‘å…¶ä»–é›†ç¾¤å‘é€æŸ¥è¯¢æ¥è§£æåç§°ï¼Œå¹¶æ£€ç´¢æ‰€éœ€èµ„æºçš„ç›¸åº” IP åœ°å€ã€‚è¿™ç§é›†æˆå¤§å¤§ç®€åŒ–äº†é›†ç¾¤ç½‘æ ¼å†…çš„é€šä¿¡ï¼Œå¢å¼ºäº†æ•´ä½“è¿é€šæ€§ï¼Œå¹¶æé«˜äº†ç®¡ç†æ•ˆç‡ã€‚\n\næ³¨æ„ï¼šè€ƒè™‘è§‚çœ‹[æ­¤è§†é¢‘](https:\/\/youtu.be\/rv-DnExi6SM?t=2574)ä»¥äº†è§£æœ‰å…³ DNS è¿æ¥çš„å…¨é¢æ•™ç¨‹ã€‚\n\n## è”é‚¦å’Œå¤šé›†ç¾¤ç®¡ç†ï¼ˆä¸‹ä¸€æ­¥ï¼‰\n\néšç€ä½ çš„ç¯å¢ƒæ‰©å±•ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å¤šä¸ªå›¢é˜Ÿå¿…é¡»åŒæ—¶åœ¨æ‰€æœ‰é›†ç¾¤ä¸Šå·¥ä½œçš„æƒ…å†µã€‚å¤šé›†ç¾¤ç®¡ç†ï¼ˆMCMï¼‰é€šå¸¸è§£å†³çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯ä»¥é›†ä¸­çš„æ–¹å¼å¤„ç†æ¥è‡ªä¸åŒé›†ç¾¤çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ç½‘ç»œç­–ç•¥ã€Podã€[åˆè§„æ€§](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-compliance\/)æŠ¥å‘Šã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨æ—¥å¿—ã€‚\n\nè™½ç„¶ä»æŠ€æœ¯ä¸Šè®²ï¼Œå¯ä»¥é€šè¿‡ kubectl ä¸ºæ¯ä¸ªé›†ç¾¤æ‰‹åŠ¨åˆ›å»ºç­–ç•¥ã€ç½‘ç»œé›†å’Œå…¶ä»–èµ„æºï¼Œä½†è¿™ç§æ–¹æ³•ä¼šåœ¨ä½ çš„æ—¥å¸¸ç»´æŠ¤ä»»åŠ¡ä¸­å¼•å…¥ç›¸å½“å¤æ‚æ€§ï¼Œå¹¶å¯èƒ½ä¸ºæ„å¤–çš„å‡­æ®æ³„æ¼å¼€è¾Ÿä¸€æ¡é€”å¾„ã€‚æ­¤å¤–ï¼Œä¸æˆ‘ä»¬åœ¨å‰ä¸€èŠ‚ä¸­æ¢è®¨çš„ç±»ä¼¼ï¼Œå®ƒåæ˜ äº†æ²¡æœ‰è‰¯å¥½ç»“æ„çš„å¤šé›†ç¾¤ç¯å¢ƒæ‰€é¢ä¸´çš„æŒ‘æˆ˜ï¼Œç‰¹åˆ«æ˜¯åœ¨é›†ç¾¤ç®¡ç†ã€ç½‘ç»œã€æ•…éšœæ’é™¤å’Œå¯è§‚æµ‹æ€§æ–¹é¢ã€‚\n\n### ä½¿ç”¨ Calico Enterprise è¿›è¡Œå¤šé›†ç¾¤ç®¡ç†\n\nCalico Enterprise æä¾›äº†ä¸€ä¸ª MCM å¹³é¢ï¼Œé€šè¿‡åœ¨è¿™äº›é›†ç¾¤ä¹‹é—´å»ºç«‹å®‰å…¨è¿æ¥ï¼Œå®ç°äº†å¤šé›†ç¾¤çš„å®‰å…¨å’Œå¯è§‚æµ‹æ€§ã€‚è¯¥æ¶æ„è¿˜æ”¯æŒè·¨é›†ç¾¤è”é‚¦[ç½‘ç»œç­–ç•¥](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-network-policy\/)èµ„æºï¼Œå¹¶ä¸ºçœŸæ­£çš„é›†ä¸­å¼ç®¡ç†ã€å¯è§‚æµ‹æ€§å’Œé›†ç¾¤ç»´æŠ¤å¥ å®šäº†åŸºç¡€ã€‚\n\nä»¥ä¸‹å›¾åƒæ˜¯åˆ—å‡ºæ‰€æœ‰å·²è¿æ¥é›†ç¾¤çš„ MCM é¡µé¢çš„ç¤ºä¾‹ã€‚\n\n![](6.png)\n\nMCM çš„å®‰å…¨åŠŸèƒ½ä¸ä»…é™äºé›†ç¾¤çš„ç½‘ç»œæ–¹é¢ã€‚ç”±äº MCM å®Œå…¨é›†æˆäº† Kubernetes åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ï¼Œä½ å¯ä»¥åˆ¶å®šæˆæƒï¼Œå…è®¸ç”¨æˆ·ä»…æŸ¥çœ‹ä»–ä»¬éœ€è¦æŸ¥çœ‹çš„ä¿¡æ¯ã€‚\n\næ³¨æ„ï¼šä½¿ç”¨[è¿™ä¸ª](https:\/\/www.tigera.io\/tutorials\/?_sft_tutorial_product=calico-enterprise)å®é™…æ“ä½œçš„å·¥ä½œåŠæ¥äº†è§£æ›´å¤šå…³äºå¤šé›†ç¾¤ç®¡ç†çš„ä¿¡æ¯ã€‚\n\n### åˆ©ç”¨ Calico Enterprise çš„è”é‚¦èº«ä»½å’Œç»Ÿä¸€ç­–ç•¥æ‰§è¡Œ\n\nCalico Enterprise è”é‚¦å°†å·¥ä½œè´Ÿè½½å’ŒæœåŠ¡ç«¯ç‚¹ä¸åœ¨é›†ç¾¤ä¹‹é—´å…±äº«çš„å”¯ä¸€èº«ä»½å…³è”èµ·æ¥ã€‚\n\nè”é‚¦èº«ä»½å¯ä»¥ä¸ç½‘ç»œå®‰å…¨ç­–ç•¥å…³è”ï¼Œä»¥åˆ›å»ºå¼•ç”¨ä½äºä¸åŒé›†ç¾¤ä¸­çš„ç«¯ç‚¹çš„å”¯ä¸€èµ„æºï¼Œä»è€Œå®ç°å¯¹é›†ç¾¤é—´å®‰å…¨çš„æ— ç¼æ§åˆ¶ã€‚\n\næ­¤å¤–ï¼Œé€šè¿‡è”é‚¦æœåŠ¡ï¼Œä½ å¯ä»¥å‘ç°å¹¶ä¸ä½äºä¸åŒé›†ç¾¤ä¸­çš„è¿œç¨‹ Pod äº’åŠ¨ã€‚è¿™ä¸¤ä¸ªå…³é”®åŠŸèƒ½ä½¿å¾—å¯ä»¥åˆ›å»ºç²¾ç¡®ã€ç»†ç²’åº¦çš„å®‰å…¨æ§åˆ¶ï¼ŒåŠ å¼ºäº†è·¨å¤šä¸ªé›†ç¾¤çš„æ•´ä½“å®‰å…¨å§¿æ€ã€‚\n\n![](7.png)\n\né€šè¿‡å®æ–½è”é‚¦å±‚å’Œç­–ç•¥ï¼Œä½ å¯ä»¥çµæ´»åœ°å®šä¹‰ç½‘ç»œå®‰å…¨ç­–ç•¥ï¼Œè¿™äº›ç­–ç•¥å¯ä»¥æ™®éé€‚ç”¨äºæ‰€æœ‰é›†ç¾¤ï¼Œä¹Ÿå¯ä»¥ä¸“é—¨é’ˆå¯¹ä¸€ç»„å®šä¹‰çš„é›†ç¾¤ã€‚è¿™ç§æ–¹æ³•æä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ‰‹æ®µï¼Œä»¥åœ¨æ‰©å±•éƒ¨ç½²ä»¥åŒ…æ‹¬å¤šä¸ªé›†ç¾¤çš„åŒæ—¶æ‰©å±•å®‰å…¨æªæ–½ã€‚é€šè¿‡å°†è¿™äº›å®‰å…¨æ§åˆ¶æ‰©å±•åˆ°ç°æœ‰å’Œæ–°çš„é›†ç¾¤ï¼Œä½ æœ‰æ•ˆåœ°å‡å°‘äº†ç­–ç•¥çš„é‡å¤å’Œç®€åŒ–äº†ä»åˆ›å»ºåˆ°ç»´æŠ¤çš„æ•´ä¸ªè¿‡ç¨‹ã€‚\n\n## ç»“è®º\n\næ€»ç»“ä¸€ä¸‹ï¼Œé›†ç¾¤ç½‘æ ¼è¿æ¥ä¸åŒ Kubernetes é›†ç¾¤ä¸­çš„å†…éƒ¨èµ„æºã€‚Calico çš„çµæ´»é›†ç¾¤ç½‘æ ¼è®¾ç½®ä¸ºåœ¨ä»»ä½•ç¯å¢ƒä¸­è¿æ¥åˆ°å¤šä¸ªé›†ç¾¤æä¾›äº†æ„å»ºå—ã€‚\n\nCalico Enterprise MCMã€è”é‚¦å’Œè”é‚¦ç­–ç•¥å¼ºåˆ¶æ‰§è¡Œæˆä¸ºå¤šé›†ç¾¤æ¶æ„çš„ç¼ºå¤±ç¯èŠ‚ï¼Œå…è®¸æ— ç¼é€šä¿¡ï¼ŒåŒæ—¶ä¼˜å…ˆè€ƒè™‘å®‰å…¨æ€§ã€‚Calico åœ¨è¿™ä¸ªé¢†åŸŸçš„èƒ½åŠ›ä½¿ä½ èƒ½å¤Ÿæ— ç¼æä¾›å¤šé›†ç¾¤ç®¡ç†ã€å¯è§‚æµ‹æ€§ã€è”é‚¦æœåŠ¡å’Œèº«ä»½ï¼Œä»è€Œä½¿ä½ çš„ç»„ç»‡èƒ½å¤Ÿè‡ªä¿¡è€Œé«˜æ•ˆåœ°åº”å¯¹ç°ä»£ç½‘ç»œçš„å¤æ‚æ€§ã€‚éšç€ç»„ç»‡çš„ç»§ç»­æ‰©å±•å’Œæ‰©å¤§è§„æ¨¡ï¼Œæ•´åˆè¿™äº›ç­–ç•¥å°†åœ¨å¡‘é€ å¤šé›†ç¾¤ç¯å¢ƒçš„æœªæ¥ä¸­å‘æŒ¥å…³é”®ä½œç”¨ã€‚\n', '\/trans\/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">è¿™ç¯‡æ–‡ç« ä»‹ç»äº†é›†ç¾¤ç½‘æ ¼çš„æ¦‚å¿µå’Œä¼˜åŠ¿ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Calico Open Source çš„å¤šç§æ–¹æ³•ï¼Œå®ç°è·¨é›†ç¾¤çš„æœåŠ¡é—´é€šä¿¡å’Œè´Ÿè½½å‡è¡¡ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/cilium-gateway-api/">[è¯‘] ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/04</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%85%b6%e4%bb%96"> 
             å…¶ä»–
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://blog.ogenki.io/post/cilium-gateway-api/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—', 'è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Cilium éƒ¨ç½²å’Œé…ç½® Gateway APIï¼Œä¸€ä¸ªæ–°çš„æœåŠ¡ç½‘æ ¼ APIï¼Œç”¨äºç®¡ç† Kubernetes ä¸­çš„æœåŠ¡é—´é€šä¿¡ã€‚æ–‡ç« è¯¦ç»†è¯´æ˜äº† Gateway API çš„æ¦‚å¿µå’Œç»„ä»¶ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Cilium çš„ç‰¹æ€§å’Œå·¥å…·ï¼Œå®ç°é«˜æ•ˆå’Œçµæ´»çš„è·¯ç”±ç­–ç•¥ã€‚', '\nåœ¨ Kubernetes ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºåï¼Œé€šå¸¸çš„ä¸‹ä¸€æ­¥æ˜¯è®©ç”¨æˆ·å¯ä»¥è®¿é—®å®ƒã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨[**Ingress æ§åˆ¶å™¨**](https:\/\/kubernetes.io\/docs\/concepts\/services-networking\/ingress-controllers\/)ï¼Œä¾‹å¦‚ Nginxã€Haproxyã€Traefik æˆ–æ¥è‡ªäº‘æä¾›å•†çš„æ§åˆ¶å™¨ï¼Œæ¥å¼•å¯¼ä¼ å…¥çš„æµé‡åˆ°åº”ç”¨ç¨‹åºï¼Œç®¡ç†è´Ÿè½½å¹³è¡¡ã€TLS ç»ˆæ­¢ç­‰ç­‰ã€‚\n\nç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä»ä¼—å¤š[å¯ç”¨çš„é€‰é¡¹](https:\/\/kubernetes.io\/docs\/concepts\/services-networking\/ingress-controllers\/) ä¸­è¿›è¡Œé€‰æ‹©ã€‚Cilium æ˜¯å…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„é€‰é¡¹ï¼Œæ—¨åœ¨å¤„ç†æ‰€æœ‰è¿™äº›ç½‘ç»œæ–¹é¢çš„é—®é¢˜ã€‚\n\n[**Cilium**](https:\/\/cilium.io\/) æ˜¯ä¸€ä¸ªåŸºäº eBPF çš„å¼€æºç½‘ç»œå’Œå®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œå…¶é‡‡ç”¨é€Ÿåº¦å¢é•¿è¿…çŒ›ã€‚å®ƒå¯èƒ½æ˜¯æä¾›æœ€å¤šåŠŸèƒ½çš„ç½‘ç»œæ’ä»¶ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ä¼šæ¶µç›–æ‰€æœ‰åŠŸèƒ½ï¼Œä½†å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ¶‰åŠä½¿ç”¨[**Gateway API**](https:\/\/gateway-api.sigs.k8s.io\/) (\u0060GAPI\u0060) ç®¡ç†ä¼ å…¥æµé‡ã€‚\n\n## æˆ‘ä»¬çš„ç›®æ ‡\n\n- å‡†ç¡®äº†è§£ **Gateway API** æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•ä»£è¡¨ä» \u0060Ingress\u0060 API è¿›åŒ–è€Œæ¥ã€‚\n- æ¼”ç¤ºä»¥ GitOps æ–¹å¼éƒ¨ç½²çš„çœŸå®åœºæ™¯ã€‚\n- å½“å‰çš„é™åˆ¶å’Œå³å°†æ¨å‡ºçš„æ–°åŠŸèƒ½ã€‚\n\n{{\u003ccallout note æç¤º\u003e}}\n\næœ¬æ–‡ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤éƒ½æ¥è‡ªè¿™ä¸ª[**git å­˜å‚¨åº“**](https:\/\/github.com\/Smana\/cilium-gateway-api)ã€‚\n\næˆ‘é¼“åŠ±ä½ æ¢ç´¢å®ƒï¼Œå› ä¸ºå®ƒè¿œè¿œè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼š\n\n- ä½¿ç”¨å¯ç”¨äº† kube-proxy æ›¿ä»£å¹¶å…·æœ‰ä¸“ç”¨ Daemonset ç”¨äº \u0060Envoy\u0060 çš„ \u0060Cilium\u0060 é…ç½®çš„ **EKS** é›†ç¾¤çš„å®‰è£…ã€‚\n- æå‡ºäº†å…·æœ‰ä¾èµ–å…³ç³»ç®¡ç†å’Œæˆ‘è®¤ä¸ºéå¸¸é«˜æ•ˆçš„ DRY ä»£ç çš„ \u0060Flux\u0060 ç»“æ„ã€‚\n- ç®€åŒ–äº†ç”¨äºå¹³å°ç»„ä»¶çš„ IAM æƒé™ç®¡ç†çš„ \u0060Crossplane\u0060 å’Œ [IRSA](https:\/\/docs.aws.amazon.com\/eks\/latest\/userguide\/iam-roles-for-service-accounts.html) ç»„åˆã€‚\n- ä½¿ç”¨ \u0060External-DNS\u0060 å’Œ \u0060Let\u0027s Encrypt\u0060 è‡ªåŠ¨ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚\n\nè¿™ä¸ªæƒ³æ³•æ˜¯åªéœ€å‡ åˆ†é’Ÿå†…è®¾ç½®å¥½ä¸€åˆ‡ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚\n\n{{\u003c\/callout\u003e}}\n\n## ä»‹ç» Gateway API\n\næ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæœ‰è®¸å¤š**Ingress æ§åˆ¶å™¨**é€‰é¡¹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹å®šæ€§å’Œç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ‰æ—¶ä¼šä½¿å®ƒä»¬çš„ä½¿ç”¨å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼ŒKubernetes ä¸­ä¼ ç»Ÿçš„ \u0060Ingress\u0060 API å…·æœ‰éå¸¸æœ‰é™çš„å‚æ•°ã€‚ä¸€äº›è§£å†³æ–¹æ¡ˆç”šè‡³åˆ›å»ºäº†è‡ªå·±çš„[CRDs](https:\/\/kubernetes.io\/docs\/concepts\/extend-kubernetes\/api-extension\/custom-resources\/)ï¼ˆKubernetes è‡ªå®šä¹‰èµ„æºï¼‰ï¼Œè€Œå…¶ä»–è§£å†³æ–¹æ¡ˆåˆ™ä½¿ç”¨ \u0060annotations\u0060 æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚\n\nè¿™å°±æ˜¯**Gateway API**çš„ç”¨æ­¦ä¹‹åœ°ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§**æ ‡å‡†**ï¼Œå…è®¸å£°æ˜é«˜çº§ç½‘ç»œåŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº•å±‚æ§åˆ¶å™¨è¿›è¡Œç‰¹å®šæ‰©å±•ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰æ§åˆ¶å™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ APIï¼Œå› æ­¤å¯ä»¥åœ¨ä¸æ”¹å˜é…ç½®çš„æƒ…å†µä¸‹ä»ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆKubernetes æ¸…å•æè¿°äº†å¦‚ä½•è·¯ç”±ä¼ å…¥æµé‡ï¼‰ã€‚\n\nåœ¨æˆ‘ä»¬å°†è¦æ¢è®¨çš„æ¦‚å¿µä¸­ï¼ŒGAPI å¼•å…¥äº†ä¸€ä¸ªç²¾ç»†çš„æˆæƒæ¨¡å‹ï¼Œå®šä¹‰äº†å…·æœ‰ä¸åŒæƒé™çš„**æ˜¾å¼è§’è‰²**ï¼ˆæœ‰å…³ GAPI å®‰å…¨æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[è¿™é‡Œ](https:\/\/gateway-api.sigs.k8s.io\/concepts\/security-model\/#roles-and-personas)ï¼‰ã€‚\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡¹ç›®ç”±[sig-network-kubernetes](https:\/\/github.com\/kubernetes\/community\/tree\/master\/sig-network)å·¥ä½œç»„æ¨åŠ¨ï¼Œè¿˜æœ‰ä¸€ä¸ª Slack [é¢‘é“](https:\/\/kubernetes.slack.com\/archives\/CR0H13KGA)ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶è”ç³»ä»–ä»¬ã€‚\n\nè®©æˆ‘ä»¬çœ‹çœ‹åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨ GAPI ä¸ Ciliumï¼\n\n## å…ˆå†³æ¡ä»¶\n\nåœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾å·²éƒ¨ç½²äº†ä¸€ä¸ª EKS é›†ç¾¤ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨[æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•](https:\/\/github.com\/Smana\/cilium-gateway-api\/tree\/main\/terraform\/eks)ä½œä¸ºæœ¬æ–‡çš„åŸºç¡€ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›**è¦æ£€æŸ¥çš„è¦ç‚¹**ï¼Œä»¥ä¾¿ä½¿ç”¨ GAPIã€‚\n\næ­¤å¤„æè¿°çš„å®‰è£…æ–¹æ³•åŸºäº \u0060Helm\u0060ï¼Œæ‰€æœ‰çš„ \u0060values\u0060 å¯ä»¥åœ¨[è¿™é‡Œ](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/terraform\/eks\/helm_values\/cilium.yaml)æŸ¥çœ‹ã€‚\n\n- åœ¨[Gateway API](https:\/\/github.com\/kubernetes-sigs\/gateway-api\/tree\/main\/config\/crd)å­˜å‚¨åº“ä¸­**å®‰è£…**å¯ç”¨çš„ \u0060CRDs\u0060ã€‚\n\n  {{\u003ccallout note æ³¨æ„\u003e}}\n\n  å¦‚æœ Cilium è®¾ç½®ä¸ºæ”¯æŒ \u0060GAPI\u0060ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œå¹¶ä¸”ç¼ºå°‘ CRDsï¼Œåˆ™å®ƒå°†æ— æ³•å¯åŠ¨ã€‚åœ¨[æ¼”ç¤ºå­˜å‚¨åº“](https:\/\/github.com\/Smana\/cilium-gateway-api)ä¸­ï¼Œ**GAPI CRDs**åœ¨é›†ç¾¤åˆ›å»ºæœŸé—´å®‰è£…ä¸€æ¬¡ï¼Œä»¥ä¾¿ Cilium å¯ä»¥å¯åŠ¨ï¼Œç„¶åç”± Flux ç®¡ç†ã€‚\n\n  {{\u003c\/callout\u003e}}\n\n- ä½¿ç”¨ Cilium å’Œ \u0060eBPF\u0060 çš„ç½‘ç»œè½¬å‘åŠŸèƒ½**æ›¿æ¢** \u0060kube-proxy\u0060ã€‚\n\n  \u0060\u0060\u0060yaml\n  kubeProxyReplacement: true\n  \u0060\u0060\u0060\n\n- **å¯ç”¨** Gateway API æ”¯æŒã€‚\n\n  \u0060\u0060\u0060yaml\n  gatewayAPI:\n    enabled: true\n  \u0060\u0060\u0060\n\n- **æ£€æŸ¥**å®‰è£…ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å®‰è£…åä¸º \u0060cilium\u0060 çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æˆ‘ä¸ªäººä½¿ç”¨ [asdf](https:\/\/blog.ogenki.io\/post\/asdf\/asdf\/)ï¼š\n\n  \u0060\u0060\u0060console\n  asdf plugin-add cilium-cli\n  asdf install cilium-cli 0.15.7\n  asdf global cilium 0.15.7\n  \u0060\u0060\u0060\n\n  ä»¥ä¸‹å‘½ä»¤å…è®¸ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ­£å¸¸è¿è¡Œï¼š\n\n  \u0060\u0060\u0060console\n  cilium status --wait\n     \/Â¯Â¯\\\n  \/Â¯Â¯\\__\/Â¯Â¯\\    Cilium:             OK\n  \\__\/Â¯Â¯\\__\/    Operator:           OK\n  \/Â¯Â¯\\__\/Â¯Â¯\\    Envoy DaemonSet:    OK\n  \\__\/Â¯Â¯\\__\/    Hubble Relay:       disabled\n     \\__\/       ClusterMesh:        disabled\n  \n  Deployment             cilium-operator    Desired: 2, Ready: 2\/2, Available: 2\/2\n  DaemonSet              cilium             Desired: 2, Ready: 2\/2, Available: 2\/2\n  DaemonSet              cilium-envoy       Desired: 2, Ready: 2\/2, Available: 2\/2\n  Containers:            cilium             Running: 2\n                        cilium-operator    Running: 2\n                        cilium-envoy       Running: 2\n  Cluster Pods:          33\/33 managed by Cilium\n  Helm chart version:    1.14.2\n  Image versions         cilium             quay.io\/cilium\/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2\n                        cilium-operator    quay.io\/cilium\/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2\n                        cilium-envoy       quay.io\/cilium\/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2\n  \u0060\u0060\u0060\n\n  æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† Gateway API æ”¯æŒï¼š\n\n  \u0060\u0060\u0060console\n  cilium config view | grep -w \u0022enable-gateway-api\u0022\n  enable-gateway-api                                true\n  enable-gateway-api-secrets-sync                   true\n  \u0060\u0060\u0060\n\n  ä½ è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹ç«¯åˆ°ç«¯æµ‹è¯•ï¼š\n\n  \u0060\u0060\u0060console\n  cilium connectivity test\n  \u0060\u0060\u0060\n\n  ä½†æ˜¯ï¼Œæ­¤å‘½ä»¤ï¼ˆ\u0060connectivity test\u0060ï¼‰å½“å‰åœ¨å¯ç”¨ Envoy ä½œä¸º DaemonSet æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚([Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/28057))ã€‚\n\n{{\u003ccallout note æç¤º\u003e}}\n  **Envoy ä½œä¸º DaemonSet**\n\n  é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä»£ç†è¿˜åœ¨åŒä¸€ Pod ä¸­è¿è¡Œ \u0060Envoy\u0060ï¼Œå¹¶å§”æ‰˜ç»™å®ƒçº§åˆ« 7 çš„ç½‘ç»œæ“ä½œã€‚ä»ç‰ˆæœ¬ \u0060v1.14\u0060 å¼€å§‹ï¼Œå¯ä»¥å°† Envoy å•ç‹¬éƒ¨ç½²ï¼Œè¿™å¸¦æ¥äº†ä¸€äº›å¥½å¤„ï¼š\n\n  - å¦‚æœä¿®æ”¹\/é‡æ–°å¯åŠ¨ä¸€ä¸ªç»„ä»¶ï¼ˆæ— è®ºæ˜¯ Cilium è¿˜æ˜¯ Envoyï¼‰ï¼Œéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªç»„ä»¶ã€‚\n  - æ›´å¥½åœ°åˆ†é…èµ„æºç»™æ¯ä¸ªç»„ä»¶ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚\n  - åœ¨æŸä¸ª Pod è¢«æ”»å‡»çš„æƒ…å†µä¸‹é™åˆ¶æ”»å‡»é¢ã€‚\n  - Envoy æ—¥å¿—å’Œ Cilium ä»£ç†æ—¥å¿—ä¸ä¼šæ··åˆåœ¨ä¸€èµ·ã€‚\n\n  ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ­¤åŠŸèƒ½æ˜¯å¦å·²å¯ç”¨ï¼š\n\n  \u0060\u0060\u0060console\n  cilium status\n      \/Â¯Â¯\\\n   \/Â¯Â¯\\__\/Â¯Â¯\\    Cilium:             OK\n   \\__\/Â¯Â¯\\__\/    Operator:           OK\n   \/Â¯Â¯\\__\/Â¯Â¯\\    Envoy DaemonSet:    OK\n   \\__\/Â¯Â¯\\__\/    Hubble Relay:       disabled\n      \\__\/       ClusterMesh:        disabled\n  \u0060\u0060\u0060\n\n  [æ›´å¤šä¿¡æ¯](https:\/\/isovalent.com\/blog\/post\/cilium-release-114\/#h-envoy-daemonset)ã€‚\n{{\u003c\/callout\u003e}}\n\n## å…¥å£ç‚¹ï¼šGatewayClass å’Œ Gateway\n\n![ç½‘å…³](gateway.jpg)\n\nä¸€æ—¦æ»¡è¶³å…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¤šä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Gateway API CRDs å®šä¹‰çš„è‡ªå®šä¹‰èµ„æºã€‚è€Œä¸”ï¼Œåœ¨å®‰è£… Cilium åï¼Œä¸€ä¸ª \u0060GatewayClass\u0060 ç«‹å³å¯ç”¨ã€‚\n\n\u0060\u0060\u0060console\nkubectl get gatewayclasses.gateway.networking.k8s.io\nNAME     CONTROLLER                     ACCEPTED   AGE\ncilium   io.cilium\/gateway-controller   True       7m59s\n\u0060\u0060\u0060\n\nåœ¨ Kubernetes é›†ç¾¤ä¸Šï¼Œä½ å¯ä»¥é…ç½®å¤šä¸ª \u0060GatewayClasses\u0060ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ \u0060Gateway\u0060 é…ç½®ä¸­å¼•ç”¨ GatewayClass æ¥ä½¿ç”¨ \u0060Linkerd\u0060ã€‚\n\n\u0060Gateway\u0060 æ˜¯å…è®¸è§¦å‘åœ¨äº‘æä¾›å•†ä¸­åˆ›å»ºè´Ÿè½½å‡è¡¡ç»„ä»¶çš„èµ„æºã€‚\n\nè¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š[apps\/base\/echo\/gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/gateway.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: Gateway\nmetadata:\n  name: echo-gateway\n  namespace: echo\nspec:\n  gatewayClassName: cilium\n  listeners:\n    - protocol: HTTP\n      port: 80\n      name: echo-1-echo-server\n      allowedRoutes:\n        namespaces:\n          from: Same\n\u0060\u0060\u0060\n\nåœ¨ AWSï¼ˆEKSï¼‰ä¸Šï¼Œé…ç½® \u0060Gateway\u0060 æ—¶ï¼ŒCilium ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º \u0060LoadBalancer\u0060 çš„ \u0060Service\u0060ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆ[AWS Load Balancer Controller](https:\/\/kubernetes-sigs.github.io\/aws-load-balancer-controller)ï¼‰å¤„ç†äº‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆ[NLB](https:\/\/docs.aws.amazon.com\/elasticloadbalancing\/latest\/network\/introduction.html)ï¼‰çš„åˆ›å»ºã€‚\n\n\u0060\u0060\u0060console\nkubectl get svc -n echo cilium-gateway-echo\nNAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE\ncilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395\/TCP   2m58s\n\u0060\u0060\u0060\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹Ÿä¸ \u0060Gateway\u0060 ç›¸å…³è”ã€‚\n\n\u0060\u0060\u0060console\nkubectl get gateway -n echo echo\nNAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE\necho   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m\n\u0060\u0060\u0060\n\n## è·¯ç”±è§„åˆ™ï¼šHTTPRoute\n\n### åŸºæœ¬è§„åˆ™\n\n![HTTPRoute](httproute.jpg)\n\nç®€è€Œè¨€ä¹‹ï¼Œä¸Šé¢çš„å›¾è¡¨å¯æ€»ç»“ä¸ºå‡ å¥è¯ï¼š\u0060HTTPRoute\u0060 å…è®¸é€šè¿‡å¼•ç”¨ Gateway å¹¶å®šä¹‰æ‰€éœ€çš„è·¯ç”±å‚æ•°æ¥é…ç½®åˆ°æœåŠ¡çš„è·¯ç”±ã€‚\n\n{{\u003ccallout note æç¤º\u003e}}\n**Kyverno**\n\næˆªæ­¢ç›®å‰ï¼Œæ— æ³•é…ç½®ç”± \u0060Gateways\u0060 ç”Ÿæˆçš„æœåŠ¡çš„æ³¨é‡Šï¼ˆ[Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/25357)ï¼‰ã€‚å·²æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³åœ¨åˆ›å»º \u0060Gateway\u0060 åç«‹å³ä¿®æ”¹ç”± \u0060Gateway\u0060 åˆ›å»ºçš„æœåŠ¡ã€‚\n\nKyverno æ˜¯ä¸€ç§ç¡®ä¿é…ç½®ç¬¦åˆæœ€ä½³å®è·µå’Œå®‰å…¨è¦æ±‚çš„å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»…ä½¿ç”¨å®ƒæ¥è½»æ¾æè¿°[çªå˜](https:\/\/kyverno.io\/docs\/writing-policies\/mutate\/)è§„åˆ™ã€‚\n\n[security\/mycluster-0\/echo-gw-clusterpolicy.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/security\/mycluster-0\/echo-gw-clusterpolicy.yaml)\n\n\u0060\u0060\u0060yaml\nspec:\n  rules:\n    - name: mutate-svc-annotations\n      match:\n        any:\n          - resources:\n              kinds:\n                - Service\n              namespaces:\n                - echo\n              name: cilium-gateway-echo\n      mutate:\n        patchStrategicMerge:\n          metadata:\n            annotations:\n              external-dns.alpha.kubernetes.io\/hostname: echo.${domain_name}\n              service.beta.kubernetes.io\/aws-load-balancer-scheme: \u0022internet-facing\u0022\n              service.beta.kubernetes.io\/aws-load-balancer-backend-protocol: tcp\n          spec:\n            loadBalancerClass: service.k8s.aws\/nlb\n\u0060\u0060\u0060\n\nå› æ­¤ï¼ŒæœåŠ¡ \u0060cilium-gateway-echo\u0060 å°†æ·»åŠ  AWS æ§åˆ¶å™¨çš„æ³¨é‡Šï¼Œä»¥åŠä¸€ä¸ªå…è®¸è‡ªåŠ¨ DNS è®°å½•é…ç½®çš„æ³¨é‡Šã€‚\n{{\u003c\/callout\u003e}}\n\n[apps\/base\/echo\/httproute.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/httproute.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n  parentRefs:\n    - name: echo\n      namespace: echo\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n\u0060\u0060\u0060\n\nä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹éå¸¸ç®€å•ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° \u0060echo-1-echo-server\u0060 æœåŠ¡ã€‚\n\n\u0060parentRefs\u0060 æŒ‡ç¤ºä½¿ç”¨å“ªä¸ª \u0060Gateway\u0060ï¼Œç„¶ååœ¨ \u0060rules\u0060 éƒ¨åˆ†å®šä¹‰äº†è·¯ç”±è§„åˆ™ã€‚\n\nè·¯ç”±è§„åˆ™è¿˜å¯ä»¥åŸºäº \u0060path\u0060ã€‚\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  hostnames:\n  - foo.bar.com\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \/login\n\u0060\u0060\u0060\n\næˆ–è€…åŸºäº HTTP æ ‡å¤´\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  rules:\n  - matches:\n      headers:\n      - name: \u0022version\u0022\n        value: \u00222\u0022\n...\n\u0060\u0060\u0060\n\nè®©æˆ‘ä»¬æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯è®¿é—®ã€‚\n\n\u0060\u0060\u0060console\ncurl -s http:\/\/echo.cloud.ogenki.io | jq -rc \u0027.environment.HOSTNAME\u0027\necho-1-echo-server-fd88497d-w6sgn\n\u0060\u0060\u0060\n\næ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¯¥æœåŠ¡ä»¥ HTTP æ–¹å¼æš´éœ²ï¼Œæ²¡æœ‰è¯ä¹¦ã€‚è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n### é…ç½® TLS è¯ä¹¦\n\næœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ GAPI é…ç½® TLSã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¸¸è§çš„æƒ…å†µï¼šHTTPS åè®®å’Œåœ¨ Gateway ä¸Šç»ˆæ­¢ TLSã€‚\n\nå‡è®¾æˆ‘ä»¬æƒ³è¦é…ç½®ä¹‹å‰ä½¿ç”¨çš„åŸŸå \u0060echo.cloud.ogenki.io\u0060ã€‚é…ç½®ä¸»è¦é€šè¿‡é…ç½® \u0060Gateway\u0060 æ¥å®Œæˆã€‚\n\n[apps\/base\/echo\/tls-gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/tls-gateway.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: Gateway\nmetadata:\n  name: echo\n  namespace: echo\n  annotations:\n    cert-manager.io\/cluster-issuer: letsencrypt-prod\nspec:\n  gatewayClassName: cilium\n  listeners:\n    - name: http\n      hostname: \u0022echo.${domain_name}\u0022\n      port: 443\n      protocol: HTTPS\n      allowedRoutes:\n        namespaces:\n          from: Same\n      tls:\n        mode: Terminate\n        certificateRefs:\n          - name: echo-tls\n\u0060\u0060\u0060\n\nè¿™é‡Œçš„å…³é”®ç‚¹æ˜¯å¼•ç”¨ä¸€ä¸ªåŒ…å«åç§°ä¸º \u0060echo-tls\u0060 çš„è¯ä¹¦çš„å¯†é’¥ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ **Let\u0027s Encrypt** å’Œ \u0060cert-manager\u0060 æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚\n\n{{\u003ccallout note æç¤º\u003e}}}\n**cert-manager**\n\nä½¿ç”¨ \u0060cert-manager\u0060ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°ç”± \u0060Gateway\u0060 æš´éœ²çš„è¯ä¹¦éå¸¸ç®€å•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å…è®¸æ§åˆ¶å™¨è®¿é—® [route53](https:\/\/aws.amazon.com\/route53\/)ï¼Œä»¥è§£å†³ DNS01 æŒ‘æˆ˜ï¼ˆè¿™æ˜¯ä¸€ç§ç¡®ä¿å®¢æˆ·ç«¯åªèƒ½ä¸ºè‡ªå·±æ‹¥æœ‰çš„åŸŸè¯·æ±‚è¯ä¹¦çš„æœºåˆ¶ï¼‰ã€‚\n\n[ClusterIssuer](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/security\/base\/cert-manager\/cluster-issuer-staging.yaml) èµ„æºæè¿°äº†ä½¿ç”¨ cert-manager ç”Ÿæˆè¯ä¹¦æ‰€éœ€çš„é…ç½®ã€‚\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨é‡Š \u0060cert-manager.io\/cluster-issuer\u0060 å¹¶è®¾ç½®å­˜å‚¨è¯ä¹¦çš„ Kubernetes å¯†é’¥ã€‚\n\n[æ›´å¤šä¿¡æ¯](https:\/\/cert-manager.io\/docs\/usage\/gateway\/)\n\nåœ¨æ¼”ç¤ºå­˜å‚¨åº“ä¸­ï¼Œæƒé™æ˜¯ä½¿ç”¨ \u0060Crossplane\u0060 åˆ†é…çš„ï¼Œå®ƒè´Ÿè´£åœ¨ AWS ä¸­é…ç½®è¿™äº› IAM æƒé™ã€‚\n{{\u003c\/callout\u003e}}\n\nä¸ºäº†ä½¿è·¯ç”±æ­£å¸¸å·¥ä½œï¼Œä½ è¿˜éœ€è¦å°† \u0060HTTPRoute\u0060 é™„åŠ åˆ°æ­£ç¡®çš„ \u0060Gateway\u0060 å¹¶æŒ‡å®šåŸŸåã€‚\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n  parentRefs:\n    - name: echo\n      namespace: echo\n  hostnames:\n    - \u0022echo.${domain_name}\u0022\n...\n\u0060\u0060\u0060\n\nå‡ ç§’é’Ÿåï¼Œè¯ä¹¦å°†è¢«åˆ›å»ºã€‚\n\n\u0060\u0060\u0060console\nkubectl get cert -n echo\nNAME       READY   SECRET     AGE\necho-tls   True    echo-tls   43m\n\u0060\u0060\u0060\n\næœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯ä¹¦ç¡®å®æ¥è‡ª Let\u0027s Encryptï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n\u0060\u0060\u0060console\ncurl https:\/\/echo.cloud.ogenki.io -v 2\u003e\u00261 | grep -A 6 \u0027Server certificate\u0027\n* Server certificate:\n*  subject: CN=echo.cloud.ogenki.io\n*  start date: Sep 15 14:43:00 2023 GMT\n*  expire date: Dec 14 14:42:59 2023 GMT\n*  subjectAltName: host \u0022echo.cloud.ogenki.io\u0022 matched cert\u0027s \u0022echo.cloud.ogenki.io\u0022\n*  issuer: C=US; O=Let\u0027s Encrypt; CN=R3\n*  SSL certificate verify ok.\n\u0060\u0060\u0060\n\n{{\u003ccallout note æç¤º\u003e}}\nGAPI è¿˜å…è®¸ä½ é…ç½® **ç«¯åˆ°ç«¯çš„ TLS**ï¼Œä¸€ç›´åˆ°å®¹å™¨ã€‚è¿™æ˜¯é€šè¿‡é…ç½® \u0060Gateway\u0060 ä¸º \u0060Passthrough\u0060 æ¨¡å¼å¹¶ä½¿ç”¨ \u0060TLSRoute\u0060 èµ„æºæ¥å®Œæˆçš„ã€‚è¯ä¹¦ä¹Ÿå¿…é¡»ç”±æ‰§è¡Œ TLS ç»ˆæ­¢çš„ pod æºå¸¦ã€‚\n{{\u003c\/callout\u003e}}\n\n### åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº« Gateway\n\n![å…±äº«ç½‘å…³](shared-gateway.jpg)\n\nä½¿ç”¨ \u0060GAPI\u0060ï¼Œä½ å¯ä»¥åœ¨ \u0060å‘½åç©ºé—´\u0060 ä¹‹é—´è·¯ç”±æµé‡ã€‚è¿™å¾—ç›Šäºæ¯ä¸ªåŠŸèƒ½çš„ä¸åŒèµ„æºï¼šä¸€ä¸ª \u0060Gateway\u0060 å…è®¸é…ç½®åŸºç¡€è®¾æ–½ï¼Œä»¥åŠ \u0060*Routes\u0060ã€‚è¿™äº›è·¯ç”±å¯ä»¥é™„åŠ åˆ°ä½äºå¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ Gatewayã€‚å› æ­¤ï¼Œä¸åŒçš„å›¢é˜Ÿ\/é¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚\n\nä½†æ˜¯ï¼Œè¿™éœ€è¦æŒ‡å®šå“ªä¸ªè·¯ç”±å…è®¸å¼•ç”¨è¯¥ Gatewayã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºå†…éƒ¨å·¥å…·çš„ Gatewayï¼Œåä¸º \u0060platform\u0060ã€‚é€šè¿‡ä½¿ç”¨ \u0060allowedRoutes\u0060 å‚æ•°ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†å“ªäº›å‘½åç©ºé—´å…è®¸é™„åŠ åˆ°æ­¤ Gatewayã€‚\n\n[infrastructure\/base\/gapi\/platform-gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/infrastructure\/base\/gapi\/platform-gateway.yaml)\n\n\u0060\u0060\u0060yaml\n...\n      allowedRoutes:\n        namespaces:\n          from: Selector\n          selector:\n            matchExpressions:\n              - key: kubernetes.io\/metadata.name\n                operator: In\n                values:\n                  - observability\n                  - flux-system\n      tls:\n        mode: Terminate\n        certificateRefs:\n          - name: platform-tls\n\u0060\u0060\u0060\n\nåœ¨å‘½åç©ºé—´ \u0060observability\u0060 å’Œ \u0060flux-system\u0060 ä¸­é…ç½®çš„ \u0060HTTPRoutes\u0060 é™„åŠ åˆ°æ­¤å”¯ä¸€çš„ \u0060Gateway\u0060ã€‚\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  parentRefs:\n    - name: platform\n      namespace: infrastructure\n\u0060\u0060\u0060\n\nå› æ­¤ï¼Œä½¿ç”¨æ¥è‡ªäº‘æä¾›å•†çš„ç›¸åŒè´Ÿè½½å‡è¡¡å™¨ã€‚\n\n\u0060\u0060\u0060console\nNLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})\n\ndig \u002bshort ${NLB_DOMAIN}\n13.36.89.108\n\ndig \u002bshort grafana-mycluster-0.cloud.ogenki.io\n13.36.89.108\n\ndig \u002bshort gitops-mycluster-0.cloud.ogenki.io\n13.36.89.108\n\u0060\u0060\u0060\n\n{{\u003ccallout note æ³¨æ„\u003e}}\nè¿™äº›å†…éƒ¨å·¥å…·ä¸åº”è¯¥æš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œä½†æ˜¯ä½ çŸ¥é“ï¼šè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…éƒ¨ Gatewayï¼ˆç§æœ‰ IPï¼‰é€šè¿‡è°ƒæ•´æ³¨é‡Šå¹¶ä½¿ç”¨ç§æœ‰è¿æ¥ç³»ç»Ÿï¼ˆVPNã€éš§é“ç­‰ï¼‰æ¥å®ç°ã€‚\n{{\u003c\/callout\u003e}}\n\n### æµé‡åˆ†æµ\n\n![åˆ†æµ](split.jpg)\n\nç”±æœåŠ¡ç½‘æ ¼å¸¸å¸¸æä¾›çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨æ—¶ï¼ˆA\/B æµ‹è¯•æˆ–é‡‘ä¸é›€éƒ¨ç½²ï¼‰å¯¹éƒ¨åˆ†æµé‡æµ‹è¯•åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ã€‚\u0060GAPI\u0060é€šè¿‡ä½¿ç”¨æƒé‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿å…¶å˜å¾—éå¸¸ç®€å•ã€‚\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªå°† 5% çš„æµé‡è½¬å‘åˆ°æœåŠ¡ \u0060echo-2-echo-server\u0060 çš„ç¤ºä¾‹ï¼š\n\n[apps\/base\/echo\/httproute-split.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/httproute-split.yaml)\n\n\u0060\u0060\u0060yaml\n...\n  hostnames:\n    - \u0022split-echo.${domain_name}\u0022\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n          weight: 95\n        - name: echo-2-echo-server\n          port: 80\n          weight: 5\n\u0060\u0060\u0060\n\nè®©æˆ‘ä»¬æ£€æŸ¥åˆ†å‘æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œï¼š\n\n[scripts\/check-split.sh](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/scripts\/check-split.sh)\n\n\u0060\u0060\u0060console\n.\/scripts\/check-split.sh https:\/\/split-echo.cloud.ogenki.io\necho-1 çš„è¯·æ±‚æ¬¡æ•°ï¼š95\necho-2 çš„è¯·æ±‚æ¬¡æ•°ï¼š5\n\u0060\u0060\u0060\n\n### ä¿®æ”¹æ ‡å¤´\n\nè¿˜å¯ä»¥æ›´æ”¹ HTTP **æ ‡å¤´**ï¼šæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚è¿™äº›ä¿®æ”¹å¯ä»¥é€šè¿‡åœ¨ \u0060HTTPRoute\u0060 æ¸…å•ä¸­ä½¿ç”¨ [filters](https:\/\/gateway-api.sigs.k8s.io\/api-types\/httproute#filters-optional) åº”ç”¨äºè¯·æ±‚æ ‡å¤´æˆ–å“åº”æ ‡å¤´ã€‚\n\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ **è¯·æ±‚** ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n...\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/req-header-add\n      filters:\n        - type: RequestHeaderModifier\n          requestHeaderModifier:\n            add:\n              - name: foo\n                value: bar\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n...\n\u0060\u0060\u0060\n\næ­¤å‘½ä»¤å…è®¸æŸ¥çœ‹æ ‡å¤´æ˜¯å¦ç¡®å®å·²æ·»åŠ ï¼š\n\n\u0060\u0060\u0060console\ncurl -s https:\/\/echo.cloud.ogenki.io\/req-header-add | jq \u0027.request.headers\u0027\n{\n  \u0022host\u0022: \u0022echo.cloud.ogenki.io\u0022,\n  \u0022user-agent\u0022: \u0022curl\/8.2.1\u0022,\n  \u0022accept\u0022: \u0022*\/*\u0022,\n  \u0022x-forwarded-for\u0022: \u002281.220.234.254\u0022,\n  \u0022x-forwarded-proto\u0022: \u0022https\u0022,\n  \u0022x-envoy-external-address\u0022: \u002281.220.234.254\u0022,\n  \u0022x-request-id\u0022: \u0022320ba4d2-3bd6-4c2f-8a97-74296a9f3f26\u0022,\n  \u0022foo\u0022: \u0022bar\u0022\n}\n\u0060\u0060\u0060\n\n## åˆ†é…é€‚å½“çš„æƒé™\n\n\u0060GAPI\u0060 æä¾›äº†ä¸€ç§æ¸…æ™°çš„æƒé™å…±äº«æ¨¡å‹ï¼Œç”¨äºç®¡ç†æµé‡è·¯ç”±åŸºç¡€è®¾æ–½ï¼ˆç”±é›†ç¾¤ç®¡ç†å‘˜ç®¡ç†ï¼‰å’Œåº”ç”¨ç¨‹åºï¼ˆç”±å¼€å‘äººå‘˜ç®¡ç†ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚\n\nå¤šä¸ªè‡ªå®šä¹‰èµ„æºçš„å¯ç”¨æ€§å…è®¸ä½¿ç”¨ Kubernetes çš„ **RBAC** é…ç½®ä»¥å£°æ˜æ€§æ–¹å¼åˆ†é…æƒé™ã€‚æˆ‘å·²ç»æ·»åŠ äº†ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„æ¼”ç¤ºé›†ç¾¤ä¸­æ²¡æœ‰æ•ˆæœï¼Œä½†å¯èƒ½ä¼šç»™ä½ ä¸€ä¸ªæƒ³æ³•ã€‚\n\nä¸‹é¢çš„é…ç½®æˆäºˆ \u0060developers\u0060 ç»„çš„æˆå‘˜åœ¨ echo å‘½åç©ºé—´å†…ç®¡ç† \u0060HTTPRoutes\u0060 çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä»…æä¾›å¯¹ \u0060Gateways\u0060 çš„è¯»å–æƒé™ã€‚\n\n\u0060\u0060\u0060yaml\n---\napiVersion: rbac.authorization.k8s.io\/v1\nkind: Role\nmetadata:\n  namespace: echo\n  name: gapi-developer\nrules:\n  - apiGroups: [\u0022gateway.networking.k8s.io\u0022]\n    resources: [\u0022httproutes\u0022]\n    verbs: [\u0022*\u0022]\n  - apiGroups: [\u0022gateway.networking.k8s.io\u0022]\n    resources: [\u0022gateways\u0022]\n    verbs: [\u0022get\u0022, \u0022list\u0022]\n---\napiVersion: rbac.authorization.k8s.io\/v1\nkind: RoleBinding\nmetadata:\n  name: gapi-developer\n  namespace: echo\nsubjects:\n  - kind: Group\n    name: \u0022developers\u0022\n    apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: Role\n  name: gapi-developer\n  apiGroup: rbac.authorization.k8s.io\n\u0060\u0060\u0060\n\n## ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š\n\näººä»¬å¯èƒ½ä¼šå¯¹é€šå¸¸ç§°ä¸º \u0060API ç½‘å…³\u0060 çš„ä¸œè¥¿æ„Ÿåˆ°å›°æƒ‘ã€‚å·²ç»åˆ›å»ºäº† [FAQ](https:\/\/gateway-api.sigs.k8s.io\/faq\/) çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä»¥æ¾„æ¸…å®ƒä¸ \u0060Gateway API\u0060 çš„ä¸åŒä¹‹å¤„ã€‚å°½ç®¡ GAPI æä¾›äº†é€šå¸¸åœ¨ API ç½‘å…³ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ï¼Œä½†å®ƒä¸»è¦æ˜¯ Kubernetes çš„ä¸€ä¸ªç‰¹å®šå®ç°ã€‚ç„¶è€Œï¼Œé€‰æ‹©è¿™ä¸ªåç§°ç¡®å®å¯èƒ½å¼•èµ· **æ··æ·†**ã€‚\n\næ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡ä»…å…³æ³¨å…¥ç«™æµé‡ï¼Œé€šå¸¸ç”± *Ingress Controllers* ç®¡ç†ï¼Œç§°ä¸º [å—åŒ—](https:\/\/gateway-api.sigs.k8s.io\/concepts\/glossary\/#northsouth-traffic)ï¼Œè¿™å®é™…ä¸Šæ˜¯ GAPI çš„åˆå§‹èŒƒå›´ã€‚æœ€è¿‘çš„ä¸€ä¸ªåä¸º [**GAMMA**](https:\/\/gateway-api.sigs.k8s.io\/concepts\/gamma\/) çš„å€¡è®®æ—¨åœ¨å¤„ç† [ä¸œè¥¿æµé‡](https:\/\/gateway-api.sigs.k8s.io\/concepts\/glossary\/#eastwest-traffic) è·¯ç”±ï¼Œè¿™å°†åœ¨å°†æ¥æ ‡å‡†åŒ–æŸäº›å¸¸è§çš„åŠŸèƒ½ï¼Œé€šå¸¸ç”± \u0060Service Meshes\u0060 è§£å†³æ–¹æ¡ˆæä¾›ã€‚ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [æ­¤æ–‡ç« ](https:\/\/kubernetes.io\/blog\/2023\/08\/29\/gateway-api-v0-8\/)ï¼‰ã€‚\n\n## æœ€åçš„æƒ³æ³•\n\nè€å®è¯´ï¼Œæˆ‘å·²ç»çŸ¥é“ **Gateway API** æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚å°½ç®¡æˆ‘è¯»äº†ä¸€äº›æ–‡ç« ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰çœŸæ­£æ·±å…¥ç ”ç©¶è¿‡ã€‚æˆ‘ä¼šæƒ³ï¼šâ€œä¸ºä»€ä¹ˆè¦éº»çƒ¦å‘¢ï¼Ÿæˆ‘çš„ *Ingress Controller* å¯ä»¥å·¥ä½œï¼Œè€Œä¸”è¿™éœ€è¦å­¦ä¹ æ›²çº¿ã€‚â€\n\nGAPI æ­£åœ¨å´­éœ²å¤´è§’ï¼Œå³å°†å‘å¸ƒ GA ç‰ˆæœ¬ã€‚å¤šä¸ª [é¡¹ç›®](https:\/\/gateway-api.sigs.k8s.io\/implementations\/) å·²ç»æ‹¥æŠ±å®ƒï¼Œè¿™ä¸ªç”¨äºç®¡ç† Kubernetes å†…æµé‡çš„ API å°†è¿…é€Ÿæˆä¸ºæ ‡å‡†ã€‚\n\næˆ‘å¿…é¡»è¯´ï¼Œé…ç½® GAPI æ„Ÿè§‰ç›´è§‚è€Œæ˜ç¡®ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹å–å¾—äº†å¹³è¡¡ï¼Œèµ‹äºˆå¼€å‘äººå‘˜æƒåŠ›è€Œä¸ä¼šæŸå®³å®‰å…¨æ€§ã€‚è€Œä¸”æ— ç¼çš„åŸºç¡€è®¾æ–½ç®¡ç†ï¼Ÿä½ å¯ä»¥åœ¨ä¸è§¦åŠ \u0060*Routes\u0060 çš„æƒ…å†µä¸‹åœ¨ä¸åŒçš„å®ç°ä¹‹é—´åˆ‡æ¢ã€‚\n\nç°åœ¨å°±ç”¨ \u0060Cilium\u0060 äº¤æ¢æˆ‘çš„ Ingress Controller å—ï¼Ÿ**è¿˜æ²¡æœ‰ï¼Œä½†å®ƒå³å°†åˆ°æ¥**ã€‚\n\nå€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼ŒCilium çš„åŠŸèƒ½éå¸¸å¹¿æ³›ï¼šåœ¨ Kubernetes å‘¨å›´æœ‰å¤§é‡çš„å·¥å…·ï¼ŒCilium è„±é¢–è€Œå‡ºï¼Œæ‰¿è¯ºæä¾›æŒ‡æ ‡ã€è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ã€å®‰å…¨æ€§ï¼Œä»¥åŠ *Ingress Controller* ä¸ GAPIã€‚\n\nç„¶è€Œï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŒ‘æˆ˜ï¼š\n\n- [TCP å’Œ UDP æ”¯æŒ](https:\/\/github.com\/cilium\/cilium\/issues\/21929)\n- [GRPC æ”¯æŒ](https:\/\/github.com\/cilium\/cilium\/issues\/21928)\n- éœ€è¦ä½¿ç”¨å˜å¼‚è§„åˆ™æ¥é…ç½®äº‘ç»„ä»¶ï¼ˆ[Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/25357)ï¼‰ã€‚\n- æœ¬æ–‡è®¨è®ºçš„è®¸å¤šåŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µã€‚ä¾‹å¦‚ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ‘å†™ä½œæ—¶çš„ \u0060v1.14.2\u0060ï¼‰æ”¯æŒçš„ [æ‰©å±•åŠŸèƒ½](https:\/\/github.com\/cilium\/cilium\/pull\/27472)ã€‚æˆ‘å°è¯•è®¾ç½®ä¸€ä¸ªç®€å•çš„ HTTP\u003eHTTPS é‡å®šå‘ï¼Œä½†é‡åˆ°äº† [è¿™ä¸ªé—®é¢˜](https:\/\/github.com\/kubernetes-sigs\/gateway-api\/issues\/1185)ã€‚å› æ­¤ï¼Œæˆ‘é¢„è®¡ API å°†æ¥ä¼šæœ‰ä¸€äº›ä¿®æ”¹ã€‚\n\nè™½ç„¶æˆ‘åªæ˜¯æ¶‰åŠäº† Cilium çš„ GAPI èƒ½å¤Ÿæä¾›çš„ä¸€å°éƒ¨åˆ†å†…å®¹ï¼ˆè€å®è¯´ï¼Œè¿™ç¯‡æ–‡ç« å·²ç»ç›¸å½“é•¿äº†ï¼‰ï¼Œä½†æˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥å¾ˆå¿«åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒã€‚ä½†è€ƒè™‘åˆ°å‰é¢æåˆ°çš„å‡ ç‚¹ï¼Œæˆ‘å»ºè®®ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³ä¸ºæœªæ¥åšå‡†å¤‡ï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™äº†ï¼\n\n## å‚è€ƒèµ„æ–™\n\n- https:\/\/gateway-api.sigs.k8s.io\/\n- https:\/\/docs.cilium.io\/en\/latest\/network\/servicemesh\/gateway-api\/gateway-api\/#gs-gateway-api\n- https:\/\/isovalent.com\/blog\/post\/cilium-gateway-api\/\n- https:\/\/isovalent.com\/blog\/post\/tutorial-getting-started-with-the-cilium-gateway-api\/\n- Isovalent çš„ [labs](https:\/\/isovalent.com\/resource-library\/labs\/) æ˜¯å¼€å§‹ä½¿ç”¨ Gateway API å¹¶ä¸”ä½ å°†è·å¾—æ–°çš„å¾½ç« ä»¥æ·»åŠ åˆ°ä½ çš„æ”¶è—ä¸­çš„å¥½æ–¹æ³•\n', '\/trans\/cilium-gateway-api\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Cilium éƒ¨ç½²å’Œé…ç½® Gateway APIï¼Œä¸€ä¸ªæ–°çš„æœåŠ¡ç½‘æ ¼ APIï¼Œç”¨äºç®¡ç† Kubernetes ä¸­çš„æœåŠ¡é—´é€šä¿¡ã€‚æ–‡ç« è¯¦ç»†è¯´æ˜äº† Gateway API çš„æ¦‚å¿µå’Œç»„ä»¶ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Cilium çš„ç‰¹æ€§å’Œå·¥å…·ï¼Œå®ç°é«˜æ•ˆå’Œçµæ´»çš„è·¯ç”±ç­–ç•¥ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide/">ä½¿ç”¨ TIS å¢å¼º Istioï¼šå®‰è£…ä¸ç›‘æ§æŒ‡å—</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/03</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ä½¿ç”¨ TIS å¢å¼º Istioï¼šå®‰è£…ä¸ç›‘æ§æŒ‡å—', 'åœ¨è¿™ç¯‡åšå®¢ä¸­æˆ‘å°†æŒ‡å¯¼ä½ å¦‚ä½•å®‰è£… TIS å¹¶å¯ç”¨ç›‘æ§æ’ä»¶ã€‚', '\nåœ¨è¿™ç¯‡åšå®¢ä¸­æˆ‘å°†æŒ‡å¯¼ä½ å¦‚ä½•å®‰è£… TIS å¹¶å¯ç”¨ç›‘æ§æ’ä»¶ã€‚\n\n## ä»€ä¹ˆæ˜¯ TISï¼Ÿ\n\nTetrate Istio Subscriptionï¼ˆTISï¼‰æ˜¯ç”± Tetrate æä¾›çš„ä¼ä¸šçº§ã€å…¨é¢æ”¯æŒçš„äº§å“ï¼Œæä¾›äº†ç»è¿‡å…¨é¢æµ‹è¯•ä¸”é€‚ç”¨äºæ‰€æœ‰ä¸»è¦äº‘å¹³å°çš„ Istio ç‰ˆæœ¬ã€‚TIS åŸºäºå¼€æºçš„ Tetrate Istio Distro é¡¹ç›®ï¼Œå¢åŠ äº†å¯¹è¿™äº›æ„å»ºç‰ˆæœ¬çš„å…¨é¢é«˜çº§æ”¯æŒï¼Œå¹¶å¯é€‰æä¾› FIPS éªŒè¯çš„åŠ å¯†æ¨¡å—ã€‚æ­¤å¤–ï¼ŒTIS åŒ…å«ä¸€ç³»åˆ—ç»è¿‡æµ‹è¯•å’Œæ”¯æŒçš„ Add-Ons å’Œ Integrationsï¼Œä½¿å¾— Istio çš„åŠŸèƒ½æ‰©å±•å’Œä¸å¸¸ç”¨åŸºç¡€è®¾æ–½å·¥å…·çš„é›†æˆå˜å¾—ç®€å•å®‰å…¨ã€‚\n\n## ä¸ºä»€ä¹ˆä½¿ç”¨ TISï¼Ÿ\n\nTIS ä¸æ˜¯ Istio çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè€Œæ˜¯æä¾›é’ˆå¯¹ç‰¹å®šç¯å¢ƒè¿›è¡Œæµ‹è¯•çš„ä¸Šæ¸¸å‘è¡Œç‰ˆã€‚æˆ‘ä»¬å¯¹ Istio æ‰€åšçš„ä»»ä½•å¢å¼ºéƒ½ä¼šåº”ç”¨äºä¸Šæ¸¸ã€‚TIS ä¸æ™®é€šçš„ Istio ç›¸æ¯”æœ‰ä»¥ä¸‹å…³é”®ä¼˜åŠ¿ï¼š\n\n1. **é•¿æœŸæ”¯æŒ**ï¼šTIS æä¾› 14 ä¸ªæœˆçš„å®‰å…¨æ›´æ–°æ”¯æŒï¼Œç¡®ä¿ç¨³å®šæ€§å’Œå®‰å…¨æ€§ã€‚\n2. **å•†ä¸šæ”¯æŒ**ï¼šTIS æœ‰å•†ä¸šæ”¯æŒé€‰é¡¹ï¼Œé€‚ç”¨äºä¼ä¸šç”¨ä¾‹ï¼ŒåŒ…æ‹¬åˆè§„æ€§éœ€æ±‚ã€‚\n3. **æ˜“äºç®¡ç†**ï¼šTIS æä¾›ç®€åŒ–çš„å®‰è£…å’Œç®¡ç†è¿‡ç¨‹ï¼Œå‡å°‘äº†æ“ä½œå¤æ‚æ€§ã€‚\n4. **å¤šç¯å¢ƒé€‚é…**ï¼šTIS æ”¯æŒä¸åŒäº‘ç¯å¢ƒï¼Œæ»¡è¶³å„ç§éƒ¨ç½²éœ€æ±‚ã€‚\n5. **FIPS éªŒè¯**ï¼šæä¾› FIPS éªŒè¯ç‰ˆæœ¬ï¼Œé€‚ç”¨äºé«˜å®‰å…¨æ€§è¦æ±‚çš„åœºæ™¯ã€‚\n\næƒ³è¦äº†è§£ TIS çš„æ›´å¤šä¿¡æ¯è¯·è®¿é—®ï¼š\u003chttps:\/\/docs.tetrate.io\/istio-subscription\/\u003e\n\n## å‡†å¤‡æ¡ä»¶\n\nåœ¨å®‰è£… TIS åŠå…¶æ’ä»¶å‰ï¼Œä½ éœ€è¦å‡†å¤‡ï¼š\n\n- å®‰è£… [Terraform](https:\/\/www.terraform.io\/)ï¼šç”¨äºå¯¼å…¥ Dashboard åˆ° Grafana\n- å‘ Tetrate è¯·æ±‚å®‰è£… TIS æ‰€éœ€çš„ credentials\n\n## å®‰è£… Istio åŠ Monitoring addons\n\né¦–å…ˆä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ TIS æ”¯æŒçš„ Istio ç‰ˆæœ¬ï¼š\n\n\u0060\u0060\u0060bash\nhelm search repo tetratelabs\/base --versions\nNAME            \tCHART VERSION  \tAPP VERSION    \tDESCRIPTION\ntetratelabs\/base\t1.20.1\u002btetrate0\t1.20.1-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.20.0\u002btetrate0\t1.20.0-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.5\u002btetrate0\t1.19.5-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.4\u002btetrate0\t1.19.4-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.3\u002btetrate0\t1.19.3-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.6\u002btetrate0\t1.18.6-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.5\u002btetrate0\t1.18.5-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.3\u002btetrate0\t1.18.3-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.17.8\u002btetrate0\t1.17.8-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.17.6\u002btetrate0\t1.17.6-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.16.7\u002btetrate0\t1.16.7-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.16.6\u002btetrate0\t1.16.6-tetrate0\tHelm chart for deploying Istio cluster resource...\n\u0060\u0060\u0060\n\næˆ‘ä»¬å°†å®‰è£…å½“å‰æœ€æ–°çš„ Istio 1.20.1 ç‰ˆæœ¬ã€‚\n\n\u0060\u0060\u0060bash\nexport TIS_USER=\u003ctis_username\u003e\nexport TIS_PASS=\u003ctis-password\u003e\n# Helm chart version\nexport VERSION=1.20.1\u002btetrate0\n# Image tag\nexport TAG=1.20.1-tetrate0\nkubectl create namespace istio-system\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-system\n\n# Install Istio\nhelm install istio-base tetratelabs\/base -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION}\n\nhelm install istiod tetratelabs\/istiod -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# install ingress Gateway\nkubectl create namespace istio-ingress\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-ingress\n\nhelm install istio-ingress tetratelabs\/istio-ingress -n istio-ingress \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# Install TIS addon\nhelm install istio-monitoring-demo tis-addons\/istio-monitoring-demo --namespace tis --create-namespace\n\u0060\u0060\u0060\n\nç«¯å£è½¬å‘ Grafana æœåŠ¡ï¼Œç„¶ååœ¨æœ¬åœ°æµè§ˆå™¨ä¸­æ‰“å¼€ Grafanaï¼šhttp:\/\/localhost:3000\n\n\u0060\u0060\u0060bash\nkubectl port-forward --namespace tis svc\/grafana 3000:3000\n\u0060\u0060\u0060\n\næ³¨æ„ï¼šè¯·ä¿æŒè¯¥å‘½ä»¤æŒç»­è¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å‘ Grafana å¯¼å…¥ dashboard æ—¶è¿˜éœ€è¦è®¿é—®è¯¥ç«¯å£ã€‚\n\n## å®‰è£… Istio Monitoring Addons\n\nä½¿ç”¨é»˜è®¤çš„ç”¨æˆ·åå¯†ç  \u0060admin\/admin\u0060 ç™»å½•åï¼Œåœ¨å·¦ä¾§å¯¼èˆªæ ä¸­é€‰æ‹© Administration - Service accountsï¼Œå‚è€ƒ Grafana æ–‡æ¡£ä¸Šçš„è¯´æ˜åˆ›å»ºä¸€ä¸ª admin æƒé™çš„ Service accountã€‚\n\n![åœ¨ Grafana ä¸­åˆ›å»ºä¸€ä¸ª Service account](grafana-service-account.jpg)\n\nè®°ä¸‹è¿™ä¸ª Tokenï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„æ“ä½œä¸­ç”¨åˆ°ã€‚\n\nä½¿ç”¨ Terraform å‘ Grafana ä¸­å¯¼å…¥ dashboardï¼š\n\n\u0060\u0060\u0060bash\ncat\u003e~\/.terraformrc\u003c\u003cEOF\ncredentials \u0022terraform.cloudsmith.io\u0022 {\n  token = \u0022tetrate\/tis-containers\/kuhb8CPZhaOiR3v6\u0022\n}\nEOF\n\n# Create a terraform module file\ncat\u003eistio-monitoring-grafana.tf\u003c\u003cEOF\nmodule \u0022istio_monitoring_grafana\u0022 {\n  source = \u0022terraform.cloudsmith.io\/tis-containers\/istio-monitoring-grafana\/tetrate\u0022\n  version = \u0022v0.2.0\u0022\n  gf_url  = \u0022\u003chttp:\/\/localhost:3000\u003e\u0022\n  gf_auth = \u0022\u003cgrafana_token\u003e\u0022\n}\nEOF\n\n# Run the commands\nterraform init\nterraform plan\nterraform apply -auto-approve\n\u0060\u0060\u0060\n\næ­å–œä½ ç°åœ¨å·²ç»æˆåŠŸçš„å‘ Grafana ä¸­å¯¼å…¥äº†ä»¥ä¸‹å››ä¸ª dashboardï¼š\n\n- TIS Workload Dashboard\n- TIS Service Dashboard\n- TIS Wasm Extension Dashboard\n- TIS Control Plan Dashboard\n\nä½†æ˜¯ç°åœ¨æœ‰äº› dashboard è¿˜æ²¡æœ‰æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç½‘æ ¼ä¸­åˆ¶é€ ä¸€äº›æµé‡ã€‚\n\n## æµ‹è¯•ç›‘æ§\n\néƒ¨ç½² Bookinfo åº”ç”¨å’Œå…¥å£ç½‘å…³ï¼š\n\n\u0060\u0060\u0060bash\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n default\nkubectl label namespace default istio-injection=enabled\nkubectl apply -f samples\/bookinfo\/platform\/kube\/bookinfo.yaml -n default\nkubectl apply -f samples\/bookinfo\/networking\/bookinfo-gateway.yaml -n default\n\u0060\u0060\u0060\n\nè·å–å…¥å£ç½‘å…³çš„ IP å¹¶å‘é€ä¸€äº›æµé‡ï¼š\n\n\u0060\u0060\u0060bash\nexport GATEWAY_IP=$(kubectl -n istio-ingress get service istio-ingressgateway -o jsonpath=\u0027{.status.loadBalancer.ingress[0].ip}\u0027)\nfor i in $(seq 1 100);do curl http:\/\/$GATEWAY_IP\/productpage ; sleep 3;done\n\u0060\u0060\u0060\n\nç°åœ¨è®¿é—® Grafana dashboardï¼Œä½ å¯ä»¥çœ‹åˆ°ç›‘æ§æ•°æ®äº†ã€‚\n\n![TIS Workload Dashboard](istio-workload-dashboard.jpg)\n\né™¤æ­¤ä¹‹å¤–ï¼Œåœ¨å¯¼å…¥äº†è¿™äº› dashboard çš„åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯¼å…¥äº†ä»¥ä¸‹è­¦æŠ¥è§„åˆ™ï¼š\n\n![å¯¼å…¥çš„è­¦æŠ¥è§„åˆ™](alerting-rules.jpg)\n\nä½ ä¹Ÿå¯ä»¥åœ¨ Grafana ä¸­å®šä¹‰è­¦æŠ¥è§„åˆ™ï¼Œæ¯”å¦‚[æ•´åˆ Telegram](https:\/\/grafana.com\/blog\/2023\/12\/28\/how-to-integrate-grafana-alerting-and-telegram\/) æˆ– Slack æ¥å‘é€é€šçŸ¥ã€‚\n\n## æ¸…ç†\n\nè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¸…ç† Bookinfo åº”ç”¨å’Œ TISï¼š\n\n\u0060\u0060\u0060bash\nkubectl delete -f samples\/bookinfo\/platform\/kube\/bookinfo.yaml -n default\nkubectl delete -f samples\/bookinfo\/networking\/bookinfo-gateway.yaml -n default\nhelm uninstall istio-ingress -n istio-ingress\nhelm uninstall istio-monitoring-demo -n tis\nhelm uninstall istiod -n istio-system\nhelm uninstall istio-base -n istio-system\nkubectl delete namespace tis\nkubectl delete namespace istio-ingress\nkubectl delete namespace istio-system\n\u0060\u0060\u0060\n\n## æ€»ç»“\n\né€šè¿‡æ‰§è¡Œè¿™äº›æ­¥éª¤ï¼Œæ‚¨å·²ç»ä½¿ç”¨ TIS æˆåŠŸåœ°åœ¨ Istio ä¸­è®¾ç½®å’Œæµ‹è¯•äº†ç›‘è§†ã€‚åœ¨ Istio ç¯å¢ƒä¸­äº«å—å¢å¼ºç›‘æ§çš„è§è§£å’Œä¼˜åŠ¿ï¼\n', '\/blog\/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">åœ¨è¿™ç¯‡åšå®¢ä¸­æˆ‘å°†æŒ‡å¯¼ä½ å¦‚ä½•å®‰è£… TIS å¹¶å¯ç”¨ç›‘æ§æ’ä»¶ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/scaling-and-sizing-the-sidecar/">[è¯‘] Istio Sidecar çš„èµ„æºå’Œæ€§èƒ½ç®¡ç†ï¼šä»ç›‘æ§åˆ°è‡ªåŠ¨æ‰©ç¼©å®¹çš„æœ€ä½³å®è·µ</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/03</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://karlstoney.com/scaling-and-sizing-the-sidecar/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio Sidecar çš„èµ„æºå’Œæ€§èƒ½ç®¡ç†ï¼šä»ç›‘æ§åˆ°è‡ªåŠ¨æ‰©ç¼©å®¹çš„æœ€ä½³å®è·µ', 'è¿™ç¯‡åšå®¢ä»‹ç»äº†ä½œè€…åœ¨ä½¿ç”¨ Istio Sidecar æ—¶ï¼Œå¦‚ä½•é€šè¿‡å¯è§†åŒ–å’Œåˆ†æ Sidecar çš„æ•°æ®ï¼Œä»¥åŠä½¿ç”¨ HPA å’Œ VPA æ¥è‡ªåŠ¨è°ƒæ•´ Sidecar çš„å¤§å°ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„æ•ˆç‡å’Œç¨³å®šæ€§', '\næœ¬æ–‡è®¨è®ºæˆ‘ä»¬å¦‚ä½•åœ¨å·¥ä½œè´Ÿè½½ä¸­æ‰©å±• Istio Sidecarï¼Œä»¥åŠå¦‚ä½•è€ƒè™‘ Sidecar èµ„æºä¸åº”ç”¨ç¨‹åºç´§å¯†è€¦åˆçš„å…³ç³»ã€‚\n\nç›®å‰æœ‰å¾ˆå¤šå…³äº Istio æ–°çš„ [Ambient Mesh](https:\/\/istio.io\/v1.15\/blog\/2022\/introducing-ambient-mesh\/) çš„è®¨è®ºã€‚è¿™ç§éƒ¨ç½²æœåŠ¡ç½‘æ ¼çš„æ–°æ–¹æ³•æ”¾å¼ƒäº† Sidecarï¼Œè€Œé‡‡ç”¨äº†ä¸¤ä¸ªæ–°ç»„ä»¶ï¼Œ\u0060ztunnel\u0060ï¼Œä¸€ä¸ªç”¨äºå¤„ç†æ ¸å¿ƒ L4 ç½‘ç»œé—®é¢˜çš„æ¯èŠ‚ç‚¹ç»„ä»¶ï¼Œä»¥åŠï¼ˆå¦‚æœéœ€è¦ï¼‰\u0060waypoint proxy\u0060 æ¥å¤„ç† L7 é—®é¢˜ã€‚\n\n![](image.jpg)\n\næ¥æºï¼š\u003chttps:\/\/istio.io\/v1.15\/blog\/2022\/introducing-ambient-mesh\u003e\n\næˆ‘å¬åˆ°çš„è¿œç¦» Sidecar çš„ä¸€ä¸ªä¸»è¦åŸå› æ˜¯ï¼Œæ‰©å±• Sidecar å¾ˆå¤æ‚ã€‚å¦‚æœåªä½¿ç”¨ L4 åŠŸèƒ½ï¼Œæˆ‘åŒæ„è¿™ä¸€è§‚ç‚¹ã€‚ç„¶è€Œï¼Œä½œä¸º L7 åŠŸèƒ½çš„é‡åº¦ç”¨æˆ·ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œä¼¼ä¹æˆ‘ä»¬åªæ˜¯åœ¨ç®¡ç† Waypoint ä»£ç†çš„è§„æ¨¡ï¼Œè€Œä¸æ˜¯ Sidecarã€‚å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œä¹Ÿè®¸æœ‰ç‚¹è‡ªç§ï¼Œå®ƒæ„Ÿè§‰åƒæ˜¯ä¸€ä¸ªæ¨ªå‘ï¼ˆå……å…¶é‡ï¼‰çš„æ­¥éª¤ï¼Œè€Œä¸æ˜¯å‰è¿›ã€‚\n\næ­¤å¤–ï¼Œæˆ‘å¹¶ä¸è§‰å¾—ç®¡ç† Sidecar èµ„æºå¾ˆç—›è‹¦ï¼Œæ‰€ä»¥æˆ‘å¾ˆéš¾äº§ç”Ÿå…±é¸£ã€‚è¿™éƒ¨åˆ†æ˜¯å› ä¸ºæˆ‘ä»æ—©æœŸå°±å¼€å§‹ä½¿ç”¨ Istioï¼Œå¹¶å»ºç«‹äº†æœ‰åŠ©äºè¿™ä¸€è¿‡ç¨‹çš„å·¥å…·å’Œæµç¨‹ã€‚æˆ‘æ„è¯†åˆ°æˆ‘ä»æœªçœŸæ­£åˆ†äº«è¿‡å…³äºæˆ‘ä»¬å¦‚ä½•ç®¡ç†è¿™ä¸€è¿‡ç¨‹çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ã€‚\n\n### ä¸€äº›èƒŒæ™¯\n\nèƒŒæ™¯å¾ˆé‡è¦ï¼Œä½ å¦‚ä½•æ€è€ƒç›‘æ§å’Œä¼¸ç¼©å°†å–å†³äºä½ å¦‚ä½•æ„å»ºä½ çš„ Kubernetes è®¾ç½®ï¼Œä»¥åŠä½ çš„ç»„ç»‡ç»“æ„ã€‚ä¹Ÿæ²¡æœ‰ä¸€ç§å¤§å°é€‚åˆæ‰€æœ‰æƒ…å†µï¼Œè¿™åªæ˜¯å¯¹æˆ‘ä»¬æœ‰æ•ˆçš„æ–¹æ³•ã€‚å› æ­¤æˆ‘ç›¸ä¿¡ Ambient æ¨¡å¼å°†å‡å°‘æŸäº› Operator çš„å¤æ‚æ€§ï¼Œä½†å¯èƒ½ä¼šå¢åŠ å…¶ä»– Operator çš„å¤æ‚æ€§ï¼ˆæˆ‘æ‰¿è®¤ï¼Œè¿™å¯èƒ½æ˜¯å°‘æ•°æƒ…å†µï¼‰ã€‚\n\næˆ‘ä»¬è¿è¡Œå¤§çº¦ 700 ä¸ªä¸ªåˆ«æœåŠ¡ï¼ˆâ€œå·¥ä½œè´Ÿè½½â€ï¼‰ã€‚æ¯ä¸ªæœåŠ¡éƒ½æœ‰ï¼š\n\n- åœ¨è‡ªå·±çš„ \u0060Namespace\u0060 ä¸­è¿è¡Œ\n- ä½¿ç”¨è‡ªå·±çš„ \u0060Service Account\u0060\n- æ‹¥æœ‰è‡ªå·±çš„ \u0060Service\u0060\n- ç”±è‡ªå·±çš„éš”ç¦» CI\/CD æµæ°´çº¿éƒ¨ç½²\n- ä» Istio å’Œç½‘ç»œç­–ç•¥çš„è§’åº¦æ¥çœ‹ï¼Œéƒ½åœ¨é»˜è®¤æ‹’ç»çš„è®¾ç½®ä¸­è¿è¡Œ\n\n![](workload.png)\n\nå¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œå‘½åç©ºé—´æ˜¯å·¥ä½œè´Ÿè½½çš„è¾¹ç•Œï¼Œè¿™æ˜¯ä¸€ç§ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œè€Œä¸”æ˜¯ä¸€æ¡åšå†³çš„è§„åˆ™ã€‚å› æ­¤ï¼Œæˆ‘ç›¸ä¿¡æˆ‘ä»¬ä¹Ÿä¼šä¸ºæ¯ä¸ªå‘½åç©ºé—´åˆ›å»ºä¸€ä¸ª waypoint ä»£ç†ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨å¤šä¸ªå·¥ä½œè´Ÿè½½ä¹‹é—´å…±äº« waypoint ä»£ç†ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´è€¦åˆï¼ˆé£é™©\/å†²å‡»èŒƒå›´ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ç±»ä¼¼äºè¿™æ ·çš„ç»“æœï¼š\n\n![](waypoint.png)\n\nä¸å…¶æ‰©å±• \u0060Sidecar\u0060ï¼Œæˆ‘ä»¬å°†æ‰©å±• \u0060Waypoint\u0060 - è¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œæ˜¯æ¨ªå‘çš„ã€‚æˆ‘ä»¬ä»ç„¶éœ€è¦è€ƒè™‘æŸç§è§„æ¨¡çš„é—®é¢˜ã€‚\n\n### å¯è§‚æµ‹æ€§ï¼šåªæ˜¯å¦ä¸€ä¸ªå®¹å™¨\n\nè¿™åŸºæœ¬ä¸Šæ€»ç»“äº†æˆ‘å¯¹ Sidecar çš„çœ‹æ³•ã€‚å®ƒåªæ˜¯ä½ çš„å·¥ä½œè´Ÿè½½ä¸­çš„å¦ä¸€ä¸ªå®¹å™¨ã€‚ä¸ºäº†[æœ‰æ•ˆç®¡ç†](https:\/\/karlstoney.com\/managing-your-costs-on-kubernetes\/)æˆæœ¬ï¼ˆ\u0022åˆé€‚å¤§å°\u0022ï¼‰ï¼Œä½ åº”è¯¥å·²ç»åœ¨ç›‘æ§ä½ çš„å·¥ä½œè´Ÿè½½æ—¶ç›‘æ§å…³é”®æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡è‡ªç„¶æ‰©å±•åˆ°æ¶µç›– \u0060istio-proxy\u0060ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™äº›æŒ‡æ ‡åŒ…æ‹¬ï¼š\n\n- CPU å’Œå†…å­˜ **è¯·æ±‚**ï¼ˆä¾‹å¦‚ \u0060kube_pod_container_resource_requests\u0060ï¼‰\n- CPU å’Œå†…å­˜ **ä½¿ç”¨**ï¼ˆä¾‹å¦‚ \u0060container_memory_working_set_bytes\u0060ï¼‰\n- CPU å’Œå†…å­˜ **è®¡ç®—åˆ©ç”¨ç‡**ï¼ˆUsage \/ Requestsï¼‰ã€‚\n\næš‚æ—¶å¿½ç•¥ Istioï¼Œå¦‚æœä½ æ²¡æœ‰åšä¸Šè¿°æ“ä½œï¼Œé‚£ä¹ˆä½ åº”è¯¥å¼€å§‹åšã€‚ä¸ºäº†å¸®åŠ©ä½ ï¼Œè¿™æ˜¯æˆ‘ç”¨äº CPU è®¡ç®—åˆ©ç”¨ç‡çš„æŒ‡æ ‡ï¼š\n\n\u0060\u0060\u0060yaml\n - record: \u0022container_cpu_usage_against_request:pod:rate1m\u0022\n   expr: |\n    (   \n      count(kube_pod_container_resource_requests{resource=\u0022cpu\u0022, container!=\u0022\u0022}) by (container, pod, namespace)\n      *   \n      avg(\n        irate(\n          container_cpu_usage_seconds_total{container!=\u0022\u0022}[1m]\n        )   \n      ) by (container, pod, namespace)\n    )   \n    \/   \n    avg(\n      avg_over_time(\n        kube_pod_container_resource_requests{resource=\u0022cpu\u0022, container!=\u0022\u0022}[1m]\n      )   \n    ) by (container, pod, namespace) * 100 \n    *   \n    on(pod) group_left(workload) (\n      avg by (pod, workload) (\n        label_replace(kube_pod_info{created_by_kind=~\u0022ReplicaSet|Job\u0022}, \u0022workload\u0022, \u0022$1\u0022, \u0022created_by_name\u0022, \u0022^(.*)-([^-]\u002b)$\u0022)\n        or  \n        label_replace(kube_pod_info{created_by_kind=~\u0022DaemonSet|StatefulSet\u0022}, \u0022workload\u0022, \u0022$1\u0022, \u0022created_by_name\u0022, \u0022(.*)\u0022)\n        or  \n        label_replace(kube_pod_info{created_by_kind=\u0022Node\u0022}, \u0022workload\u0022, \u0022node\u0022, \u0022\u0022, \u0022\u0022) \n        or  \n        label_replace(kube_pod_info{created_by_kind=\u0022\u0022}, \u0022workload\u0022, \u0022none\u0022, \u0022\u0022, \u0022\u0022) \n      )   \n    )\n\u0060\u0060\u0060\n\nä½ ä¼šæ³¨æ„åˆ°åœ¨è¿™ä¸ªæŒ‡æ ‡ä¸­ï¼Œæˆ‘è¿˜ä¸ \u0060kube_pod_info\u0060 è¿›è¡Œäº†å…³è”ï¼Œè¿™ä¸ºæˆ‘çš„æŒ‡æ ‡æä¾›äº†ä¸€äº›é¢å¤–çš„ç»´åº¦ï¼Œç‰¹åˆ«æ˜¯ \u0060workload\u0060ã€‚è¿™ä»…åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªéƒ¨ç½²ä¸ä¸€ä¸ªå‘½åç©ºé—´ç›¸å¯¹åº”ï¼Œç­‰äºä¸€ä¸ªå·¥ä½œè´Ÿè½½çš„å…³ç³»æ—¶æ‰æœ‰æ•ˆã€‚è¿™æ˜¯å¯é€‰çš„ï¼Œåªæ˜¯å¸®åŠ©æˆ‘åœ¨å„ä¸ªçº§åˆ«æŸ¥çœ‹è¿™ä¸ªæŒ‡æ ‡ï¼ŒåŒ…æ‹¬ \u0060container\u0060ã€\u0060pod\u0060ã€\u0060node\u0060 æˆ– \u0060workload\u0060ã€‚è¿™æ ·åšå°†è‡ªç„¶åœ°ä¸ºä½ çš„æ‰€æœ‰å®¹å™¨æä¾›æ•°æ®ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ä½ çš„ Sidecarï¼š\n\n![](Screenshot-2023-10-03-at-08.33.17.jpg)\n\n### Sidecar ä¸å·¥ä½œè´Ÿè½½ä¸€èµ·æ‰©å±•\n\nå¯¹äº HTTP å·¥ä½œè´Ÿè½½ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ° Sidecar çš„æ‰©å±•æ–¹å¼ä¸åº•å±‚åº”ç”¨ç¨‹åºéå¸¸ç›¸ä¼¼ã€‚ä½ å¯ä»¥åœ¨ä¸Šé¢çš„æˆªå›¾ä¸­çœ‹åˆ° \u0060istio-proxy\u0060 å®¹å™¨çš„ \u0022è®¡ç®—åˆ©ç”¨ç‡\u0022 å¦‚ä½•ç´§å¯†è·Ÿéš \u0060master\u0060 å®¹å™¨ã€‚\n\nè¿™å°±æ˜¯æˆ‘çœŸæ­£å–œæ¬¢ Sidecar æ¨¡å¼çš„åœ°æ–¹ã€‚ä½ çš„ Sidecar åˆ©ç”¨ç‡ä¸ä½ çš„å·¥ä½œè´Ÿè½½åˆ©ç”¨ç‡ç´§å¯†è€¦åˆï¼Œè€Œå·¥ä½œè´Ÿè½½åˆ©ç”¨ç‡ä¸å·¥ä½œè´Ÿè½½çš„å‰¯æœ¬æ•°é‡ç´§å¯†è€¦åˆã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ°´å¹³æ‰©å±•å·¥ä½œè´Ÿè½½ï¼Œåˆ©ç”¨ç‡å°†ä¿æŒå¤§è‡´ç›¸åŒã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥çœ‹åˆ° \u0060master\u0060 å®¹å™¨çš„åˆ©ç”¨ç‡å³°å€¼ä¸º 75%ï¼Œè€Œ \u0060istio-proxy\u0060 çš„åˆ©ç”¨ç‡ä¸º 60%ï¼Œå¦‚æœæˆ‘ä»¬å°†å‰¯æœ¬æ•°é‡åŠ å€ï¼Œè¿™ä¸¤ä¸ªå€¼ä¼šæ¾æ•£å‡åŠï¼Œä½†ä¿æŒå¤§è‡´ä¸€è‡´ã€‚æˆ‘ä»¬åªæ˜¯æ°´å¹³æ‰©å±•ä¸€ä¸ª \u0060Deployment\u0060 å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸¤ä¸ªã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ›´å®¹æ˜“ç†è§£ã€‚\n\næˆ‘ä»¬å‘åº”ç”¨ç¨‹åºæ‰€æœ‰è€…æä¾›çš„æŒ‡å¯¼æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨ç‡åœ¨å³°å€¼æ—¶ä¿æŒåœ¨ 75% å·¦å³ã€‚åœ¨è¿™é‡Œï¼Œäººä»¬è‡ªç„¶ä¼šé—®ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä½¿ç”¨è‡ªåŠ¨æ‰©å±•ã€‚è‡ªåŠ¨æ‰©å±•ä¾èµ–äºåº•å±‚äº‘æä¾›å•†æä¾›çš„è®¡ç®—èµ„æºã€‚æˆ‘ä»¬æ›¾ç»é‡åˆ°è¿‡å¤šæ¬¡å½±å“å®¢æˆ·çš„äº‹ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•æŒ‰éœ€æ‰©å±•ï¼ŒåŸå› æ˜¯åº•å±‚äº‘æä¾›å•†çš„å®¹é‡å­˜åœ¨é—®é¢˜ã€‚æ­¤å¤–ï¼Œè‡ªåŠ¨æ‰©å±•ä¼šå¸¦æ¥å»¶è¿Ÿï¼Œå¾ˆéš¾å¯¹çªç„¶çš„è´Ÿè½½æ€¥å‰§å¢åŠ åšå‡ºå“åº”ï¼Œå› æ­¤å®ƒåªå¯¹å…·æœ‰æ˜æ˜¾é€æ¸å­£èŠ‚æ€§çš„å·¥ä½œè´Ÿè½½æœ‰æ•ˆï¼Œå°±åƒä¸Šé¢çš„å·¥ä½œè´Ÿè½½ä¸€æ ·ã€‚æˆ‘ä»¬è®¤ä¸ºä¸è‡ªåŠ¨æ‰©å±•ç›¸å…³çš„æˆæœ¬èŠ‚çœä¸å€¼å¾—ä¸ä¸èƒ½å¯¹éœ€æ±‚åšå‡ºååº”çš„é£é™©ç›¸åŒ¹é…ï¼Œå› æ­¤æˆ‘ä»¬ä¼šç•¥å¾®è¿‡åº¦é…ç½®æˆ‘ä»¬çš„å·¥ä½œè´Ÿè½½ï¼ˆå› æ­¤æ˜¯ 75%ï¼‰ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœä½ å¯¹è‡ªåŠ¨æ‰©å±•æ„Ÿåˆ°æ»¡æ„ï¼Œä½ å¯ä»¥åœ¨è‡ªåŠ¨æ‰©å±•é…ç½®ä¸­è®¾ç½®ç›®æ ‡ CPUï¼Œç„¶åå°±å¯ä»¥äº†ã€‚ä½ æœ‰ä¸€ä¸ªå·¥ä½œè´Ÿè½½ï¼Œä»¥åŠä¸€ä¸ªä¸ä¹‹ç´§å¯†ç›¸å…³çš„ Sidecarï¼Œå®ƒä»¬ä¸€èµ·æ‰©å±•ã€‚\n\nè¿™å°±æ˜¯æˆ‘å¯¹ Waypoint çš„çœ‹æ³•ã€‚å› ä¸ºåœ¨æˆ‘ä»¬çš„è®¾ç½®ä¸­ï¼Œæˆ‘ä»¬æ¯ä¸ªå·¥ä½œè´Ÿè½½éƒ½æœ‰ä¸€ä¸ª waypoint ä»£ç†ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªéœ€è¦ä»¥ä¸åŒæ–¹å¼ä½†åŒæ­¥æ‰©å±•çš„ç‹¬ç«‹éƒ¨ç½²ï¼Œè¿™å°†è§£è€¦äº†æˆ‘ä»¬è‡ªèº«æœ‰æ„å…³è”çš„ä¸œè¥¿ã€‚\n\n### è®¾ç½®æ­£ç¡®çš„ CPU å’Œå†…å­˜å€¼\n\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ‰ä¸€ä¸ªç›¸å¯¹å¥åº·çš„å·¥ä½œè´Ÿè½½ã€‚\u0060istio-proxy\u0060 å®¹å™¨è¢«åˆ†é…äº†é€‚åˆå·¥ä½œè´Ÿè½½é…ç½®æ–‡ä»¶çš„ \u0060CPU\u0060 é‡ï¼Œå…è®¸å…¶åˆ©ç”¨ç‡ç´§å¯†è·Ÿè¸ªåº•å±‚åº”ç”¨ç¨‹åºçš„åˆ©ç”¨ç‡ã€‚ç»éªŒå‘Šè¯‰æˆ‘ï¼Œä¸€æ—¦ä½ å°†è¿™ä¸¤è€…å¯¹é½ï¼Œå®ƒä»¬å°±ä¸ä¼šæ¾æ•£å¯¹é½ã€‚å®ƒä»¬ä¼šæ¼‚ç§»çš„å”¯ä¸€æ—¶é—´æ˜¯å¦‚æœä»»ä¸€å®¹å™¨çš„æ€§èƒ½é…ç½®å‘ç”Ÿäº†æ˜¾è‘—å˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå¼€å‘äººå‘˜å°†åº”ç”¨ç¨‹åºæ€§èƒ½æé«˜äº† 2 å€ï¼Œåˆ™ \u0060master\u0060 çš„åˆ©ç”¨ç‡ä¼šä¸‹é™ï¼‰ã€‚\n\nåœ¨ AutoTraderï¼Œæˆ‘ä»¬çš„å¹³å°å›¢é˜Ÿè´Ÿè´£æ„å»ºâ€œäº¤ä»˜å¹³å°â€ï¼Œå¼€å‘äººå‘˜å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°å…¶ä¸­ï¼Œä½†åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜è´Ÿè´£ç¡®å®šå…¶å·¥ä½œè´Ÿè½½çš„å¤§å°ï¼ˆCPU å’Œ RAMï¼‰ã€‚å¹³å°å›¢é˜Ÿæ„å»ºäº†å¸®åŠ©ä»–ä»¬åšå‡ºæ˜æ™ºå†³ç­–çš„å·¥å…·ï¼Œæ¶‰åŠè¿™äº›å€¼ã€‚\n\nè¿™æ„å‘³ç€ç®€å•çš„æŠ½è±¡ã€‚æˆ‘ä»¬ä¸è®©å¼€å‘äººå‘˜ç¼–å†™ 100 ä¸ª Kubernetes æ¸…å•æ¥éƒ¨ç½²å·¥ä½œè´Ÿè½½ã€‚ä»–ä»¬ä¸éœ€è¦å…³å¿ƒ Istio \u0060VirtualServices\u0060ã€\u0060Sidecars\u0060ã€Kubernetes \u0060Deployments\u0060 æˆ–è®°ä½åœ¨å“ªé‡Œæ”¾ç½®æ³¨é‡Šä»¥æ­£ç¡®è®¾ç½® Sidecar çš„è§„æ¨¡ã€‚ç›¸åï¼Œæˆ‘ä»¬è¦æ±‚åœ¨ä»–ä»¬çš„å­˜å‚¨åº“ä¸­æä¾›ä¸€ä¸ª yaml æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š\n\n\u0060\u0060\u0060yaml\ndeployment:\n  istio:\n    resources:\n      cpu: 500m\n      memory: 80Mi\n  container:\n    replicas: 6\n    resources:\n      cpu: 1000m\n      memory: 956Mi\n\u0060\u0060\u0060\n\nå› æ­¤ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡çš„æ‰€æœ‰è€…è´Ÿè´£è®¾ç½®å…¶ \u0060master\u0060 å®¹å™¨å’Œå…¶ \u0060istio-proxy\u0060 çš„èµ„æºã€‚æˆ‘ä»¬çš„è´£ä»»æ˜¯æ„å»ºå·¥å…·ï¼Œå¸®åŠ©ä»–ä»¬åœ¨é€‰æ‹©è¿™äº›å€¼æ—¶åšå‡ºæ˜æ™ºå†³ç­–ã€‚\n\nä½ å·²ç»çœ‹åˆ°äº†æˆ‘ä»¬å¦‚ä½•åœ¨ä¸Šé¢çš„ Grafana ä»ªè¡¨æ¿ä¸­ä½¿ç”¨ \u0022Utilisation\u0022 ç­‰æŒ‡æ ‡æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘ä»¬è¿˜åšäº†ä¸€äº›ç§°ä¸º \u0022å»ºè®®\u0022 çš„äº‹æƒ…ã€‚è¿™äº›æ˜¯æˆ‘ä»¬å‘åº”ç”¨ç¨‹åºæ‰€æœ‰è€…æä¾›çš„æœ‰å…³ä¼˜åŒ–é…ç½®å…¶æœåŠ¡çš„æç¤ºï¼š\n\n![](Screenshot-2023-10-03-at-09.19.52.jpg)\n\nå› æ­¤ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º \u0060ProxyMasterImbalance\u0060 çš„å»ºè®®ã€‚å¦‚æœæˆ‘ä»¬æ£€æµ‹åˆ°ç»™å®šå·¥ä½œè´Ÿè½½å†…çš„ \u0060master\u0060 å’Œ \u0060istio-proxy\u0060 å®¹å™¨ä¹‹é—´çš„æ¼‚ç§»è¶…è¿‡ 30%ï¼Œåˆ™æ­¤å»ºè®®å°†å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯æ­¤å»ºè®®è§¦å‘çš„ç¤ºä¾‹ï¼š\n\n![](Screenshot-2023-10-03-at-09.44.09.png)\n\n### æ€»ç»“\n\nå¸Œæœ›ä½ å¯ä»¥çœ‹åˆ°åœ¨å¤§å°è°ƒæ•´ Sidecar æ–¹é¢ï¼Œå®ƒå¦‚ä½•å¯ä»¥è½»æ¾åœ°èå…¥åˆ°ä½ ç°æœ‰çš„ç”¨äºå¤§å°è°ƒæ•´å·¥ä½œè´Ÿè½½çš„ä¸šåŠ¡æµç¨‹ä¸­ã€‚æ— è®ºå¦‚ä½•ï¼Œä½ éƒ½åº”è¯¥è¿™æ ·åšï¼Œä»¥ä¿æŒä½ çš„åŸºç¡€æ¶æ„çš„å¥åº·åˆ©ç”¨ç‡ã€‚\n\næˆ‘ä»¬å·²ç»å»ºç«‹äº†ä¸€ç§æ–‡åŒ–ï¼Œå°ç»„å…³å¿ƒå¹¶æ‹¥æœ‰ä»–ä»¬çš„è½¯ä»¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œï¼Œå…¶ä¸­åŒ…æ‹¬å…³é”®çš„ CFRï¼ˆæˆæœ¬ï¼‰ï¼Œä»–ä»¬çŸ¥é“é€šè¿‡æŒæ¡è¿™äº›äº‹ç‰©ï¼Œä»–ä»¬æ­£åœ¨ä¸ºæ›´å¤§çš„ç›®æ ‡åšå‡ºè´¡çŒ®ï¼Œæ€»ä½“è€Œè¨€ï¼Œä»–ä»¬åšåˆ°äº†ã€‚è‡³å…³é‡è¦çš„æ˜¯ï¼Œä»–ä»¬å·²ç»å…³å¿ƒä»–ä»¬çš„ \u0060master\u0060 å®¹å™¨åˆ©ç”¨ç‡ï¼Œå› æ­¤ \u0060istio-proxy\u0060 åªæ˜¯ä»–ä»¬éœ€è¦è®¾ç½® 2 ä¸ªå€¼ï¼ˆCPU\/å†…å­˜ï¼‰çš„å¦ä¸€ä¸ªå®¹å™¨ï¼Œæˆ‘ä»¬æä¾›äº†ä½¿å…¶å°½å¯èƒ½å®¹æ˜“çš„æ•°æ®ï¼Œè€Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ - è¿™åªæ˜¯ä½ éœ€è¦è°ƒæ•´ä¸€æ¬¡çš„äº‹æƒ…ã€‚\n\næˆ‘è¿˜æƒ³æŒ‡å‡ºï¼Œè¿™ç¯‡æ–‡ç« ä¸“é—¨æ€è€ƒäº†è§„æ¨¡çš„é—®é¢˜ã€‚å°†ä»£ç†ä¸åº”ç”¨ç¨‹åºåˆ†ç¦»å‡ºæ¥è¿˜å­˜åœ¨å…¶ä»–æ½œåœ¨ä¼˜åŠ¿ï¼ˆä¾‹å¦‚éš”ç¦»å‡çº§ï¼‰ã€‚ä¸è¿‡å†æ¬¡å¼ºè°ƒï¼Œæˆ‘ä¸ªäººè®¤ä¸ºè¿™æœ‰åˆ©æœ‰å¼Šï¼ˆå°±åƒæŠ€æœ¯ä¸­çš„å¤§å¤šæ•°å†³ç­–ä¸€æ ·ï¼‰ï¼Œä½†è¿™æ˜¯å¦ä¸€å¤©çš„åšå®¢æ–‡ç« ã€‚\n', '\/trans\/scaling-and-sizing-the-sidecar\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">è¿™ç¯‡åšå®¢ä»‹ç»äº†ä½œè€…åœ¨ä½¿ç”¨ Istio Sidecar æ—¶ï¼Œå¦‚ä½•é€šè¿‡å¯è§†åŒ–å’Œåˆ†æ Sidecar çš„æ•°æ®ï¼Œä»¥åŠä½¿ç”¨ HPA å’Œ VPA æ¥è‡ªåŠ¨è°ƒæ•´ Sidecar çš„å¤§å°ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„æ•ˆç‡å’Œç¨³å®šæ€§</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/opentelemetry-and-observability-looking-forward/">[è¯‘] OpenTelemetry ä¸å¯è§‚æµ‹æ€§ï¼šå±•æœ›æœªæ¥</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/02</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7"> 
             å¯è§‚æµ‹æ€§
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thenewstack.io/opentelemetry-and-observability-looking-forward/" target="_blank" rel="noopener">åŸæ–‡</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('OpenTelemetry ä¸å¯è§‚æµ‹æ€§ï¼šå±•æœ›æœªæ¥', 'æœ¬æ–‡å±•æœ› 2024 å¹´å¯è§‚æµ‹æ€§çš„å‘å±•ã€‚', '\nè®©æˆ‘ä»¬æ¢è®¨ä¸€äº›ä»¤äººå…´å¥‹çš„è¶‹åŠ¿ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬æœŸå¾… 2024 å¹´ä¼šæœ‰ä»€ä¹ˆæ ·çš„å¯è§‚æµ‹æ€§å‘å±•ã€‚\n\néšç€å¹´åº•çš„ä¸´è¿‘ï¼Œç°åœ¨æ˜¯ä¸€ä¸ªåœä¸‹æ¥æ€è€ƒçš„å¥½æ—¶æœºã€‚2023 å¹´å¯¹äº OpenTelemetry æ¥è¯´æ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘ï¼Œå› ä¸ºå…¶ä¸‰ä¸ªåŸºæœ¬ä¿¡å·ï¼Œè·Ÿè¸ªã€åº¦é‡å’Œæ—¥å¿—ï¼Œéƒ½è¾¾åˆ°äº†ç¨³å®šç‰ˆæœ¬ã€‚è¿™ä¸€æˆå°±æ ‡å¿—ç€[OpenTelemetry](https:\/\/thenewstack.io\/opentelemetry-gaining-traction-from-companies-and-vendors\/)æœ€åˆæ„¿æ™¯çš„å®ç°ï¼Œå³æä¾›ä¸€ä¸ªåŸºäºæ ‡å‡†çš„æ¡†æ¶ï¼Œç”¨äºä»ªå™¨åŒ–å’Œæ”¶é›†å¯è§‚æµ‹æ€§æ•°æ®ã€‚\n\nè®©æˆ‘ä»¬æŠ“ä½è¿™ä¸ªæœºä¼šï¼Œæ¢è®¨ä¸€ä¸‹æˆ‘ä»¬æ‰€è§è¯çš„ä¸€äº›ä»¤äººå…´å¥‹çš„è¶‹åŠ¿ï¼Œæ·±å…¥ç ”ç©¶åˆ›æ–°çš„äº§å“å’Œç”¨ä¾‹ï¼Œå¹¶åœ¨æœŸå¾… 2024 å¹´çš„åˆ°æ¥æ—¶æ·±æ€ç†Ÿè™‘åœ°è€ƒè™‘å¯è§‚æµ‹æ€§çš„ä¸æ–­æ¼”å˜ã€‚\n\n## åº¦é‡æ ‡å‡†çš„å´­éœ²å¤´è§’\n\nå°½ç®¡ OpenTelemetry å…³äºåº¦é‡çš„è§„èŒƒåœ¨ 2022 å¹´ 5 æœˆè¢«å®£å¸ƒä¸ºç¨³å®šç‰ˆæœ¬ï¼Œä½†ä»Šå¹´çœ‹åˆ°äº†å…¶è¢«å¹¿æ³›é‡‡ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä»ä¸šè€…çš„æ–‡ç« ï¼š\n\n- ç”± VMware çš„ Matthew Kocher å’Œ Carson Long æ’°å†™çš„æ–‡ç« ï¼Œæ ‡é¢˜ä¸ºâ€œ[ä½“éªŒæŠ¥å‘Šï¼šåœ¨ Cloud Foundry ä¸­é‡‡ç”¨ OpenTelemetry è¿›è¡Œåº¦é‡](https:\/\/opentelemetry.io\/blog\/2023\/cloud-foundry\/)â€ã€‚\n- æˆ‘ä»¬è‡ªå·±çš„ Matheus Nogueira æ’°å†™çš„æ–‡ç« ï¼Œæ ‡é¢˜ä¸ºâ€œ[åœ¨ä½ çš„ Go åº”ç”¨ç¨‹åºä¸­æ·»åŠ  OpenTelemetry åº¦é‡](https:\/\/tracetest.io\/blog\/adding-opentelemetry-metrics-in-your-go-app)â€ã€‚\n\nå±•æœ› 2024 å¹´ï¼Œå¯ä»¥é¢„æœŸä¼šçœ‹åˆ°ç±»ä¼¼çš„æ—¥å¿—è¿åŠ¨å’Œé‡‡ç”¨ã€‚\n\n## å…³æ³¨åœ¨è´Ÿè½½æµ‹è¯•ä¸­ä½¿ç”¨åˆ†å¸ƒå¼è·Ÿè¸ª\n\n2023 å¹´ï¼Œä¸¤ä¸ªé¢†å…ˆçš„è´Ÿè½½æµ‹è¯•å·¥å…·ï¼Œ[Grafana k6](https:\/\/k6.io\/)å’Œ[Artillery.io](https:\/\/artillery.io\/)ï¼Œéƒ½æ·»åŠ äº†å¯¹ OpenTelemetry çš„æ”¯æŒã€‚\n\n- Grafana k6 [å¼•å…¥äº†è·Ÿè¸ª](https:\/\/github.com\/grafana\/xk6-distributed-tracing)åŠŸèƒ½ï¼Œä½¿æ€§èƒ½å·¥ç¨‹å¸ˆèƒ½å¤Ÿåœ¨[è´Ÿè½½æµ‹è¯•](https:\/\/thenewstack.io\/trace-based-testing-the-next-step-in-observability\/)æœŸé—´è¯†åˆ«ç³»ç»Ÿç“¶é¢ˆæˆ–æ•…éšœã€‚\n- Artillery.io éšåä¹Ÿ[æ·»åŠ äº†åº¦é‡å’Œåˆ†å¸ƒå¼è·Ÿè¸ª](https:\/\/www.artillery.io\/blog\/introducing-opentelemetry-support)ï¼Œæä¾›äº†å¯¹ç³»ç»Ÿæ€§èƒ½æ›´è¯¦ç»†çš„åˆ†æã€‚\n\nTracetest åˆ©ç”¨äº† k6 æµ‹è¯•ä¸­æš´éœ²çš„åŠŸèƒ½ï¼Œä»¥[å¯ç”¨åŸºäºè·Ÿè¸ªçš„è´Ÿè½½æµ‹è¯•](https:\/\/docs.tracetest.io\/tools-and-integrations\/k6)ï¼Œåœ¨è¿è¡Œæµ‹è¯•æ—¶è¿›è¡Œæ·±å…¥çš„æ–­è¨€ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°è®¸å¤šå®¢æˆ·å¹¿æ³›ä½¿ç”¨äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚[Sigma Software](https:\/\/tracetest.io\/case-studies\/how-sigma-software-built-load-testing-for-their-microservices-with-k6-tracetest)ã€‚åœ¨ 2024 å¹´ï¼ŒTracetest å›¢é˜Ÿå°†è€ƒè™‘å°†è¿™ä¸€èƒ½åŠ›æ·»åŠ åˆ°[Artillery.io](http:\/\/artillery.io\/)å’Œå…¶ä»–è´Ÿè½½æµ‹è¯•å·¥å…·ä¸­ã€‚\n\n## OpenTelemetry çš„æ”¯æŒå’Œç”¨ä¾‹æ‰©å±•\n\nè¶Šæ¥è¶Šå¤šçš„ä¾›åº”å•†æ­£åœ¨é‡‡ç”¨ OpenTelemetry æ ‡å‡†ï¼Œä»¥æ”¯æŒå…¸å‹ä½†éå¸¸é‡è¦çš„é¥æµ‹æ•°æ®åˆ†æä¹‹å¤–çš„è¡ŒåŠ¨ã€‚\n\n- ä¸€äº›å…¬å¸ï¼Œæ¯”å¦‚[Tyk æ­£åœ¨ä»ªå™¨åŒ–å…¶ API ç½‘å…³ï¼Œä»¥åŸç”Ÿæ”¯æŒ OpenTelemetry](https:\/\/opentelemetry.io\/blog\/2023\/tyk-api-gateway\/)ã€‚\n- ç»ˆç«¯ç”¨æˆ·æ­£åœ¨å‘ç° OpenTelemetry çš„æ–°ç”¨ä¾‹ï¼Œæ¯”å¦‚[ä½¿ç”¨åˆ†å¸ƒå¼è·Ÿè¸ªæ¥è§‚å¯Ÿä½ çš„ CI\/CD æµæ°´çº¿](https:\/\/thenewstack.io\/how-to-observe-your-ci-cd-pipelines-with-opentelemetry\/)ã€‚\n- [Tracetest](https:\/\/tracetest.io\/)åˆ©ç”¨åˆ†å¸ƒå¼è·Ÿè¸ªæ•°æ®è¿›è¡Œé›†æˆå’Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚\n\n## å¼ºè°ƒ OpenTelemetry æ”¶é›†å™¨\n\n[OpenTelemetry æ”¶é›†å™¨](https:\/\/thenewstack.io\/how-adobe-uses-opentelemetry-collector\/)ä½äº OpenTelemetry ä¸–ç•Œçš„ä¸­å¿ƒï¼Œæ¥æ”¶æ¥è‡ªåº”ç”¨ç¨‹åºçš„ä¿¡å·ï¼Œå¤„ç†å’Œè½¬æ¢è¿™äº›ä¿¡å·ï¼Œç„¶åå°†å®ƒä»¬å¯¼å‡ºåˆ°ä»»æ„æ•°é‡çš„åç«¯ç³»ç»Ÿã€‚éšç€å¯¹ OpenTelemetry çš„é›†æˆå’Œä¾›åº”å•†æ”¯æŒçš„æ‰©å±•ï¼Œå¯¹è¿™ä¸ªé›†ä¸­å¼æ”¶é›†å™¨çš„éœ€æ±‚å’Œè¦æ±‚ä¹Ÿåœ¨å¢åŠ ã€‚\n\n2023 å¹´å¼•å…¥äº† OpenTelemetry Transformation Language (OTTL)ï¼Œå¢å¼ºäº† OpenTelemetry æ”¶é›†å™¨å¤„ç†å’Œè½¬æ¢ä¼ å…¥ä¿¡å·çš„èƒ½åŠ›ã€‚\n\nåœ¨ Tracetest ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨[åœ¨è¿‡æ»¤å™¨å¤„ç†å™¨ä¸­ä½¿ç”¨ OTTL](https:\/\/github.com\/open-telemetry\/opentelemetry-collector-contrib\/blob\/main\/processor\/filterprocessor\/README.md)çš„èƒ½åŠ›ï¼Œæ”¹è¿›äº†æˆ‘ä»¬ä»è¾“å‡ºå¤§é‡é¥æµ‹æ•°æ®çš„ç”Ÿäº§ç¯å¢ƒä¸­æ”¶é›†è·Ÿè¸ªæ•°æ®çš„æ–¹å¼ã€‚è¿™ä¸€å˜åŒ–å¯¹[OpenTelemetry æ”¶é›†å™¨çš„è¿‡æ»¤å™¨å¤„ç†å™¨](https:\/\/tracetest.io\/blog\/opentelemetry-collectors-new-filter-processor)ä½¿ Tracetest é€‚ç”¨äºåœ¨é«˜è´Ÿè½½ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•ï¼ŒåŒ…æ‹¬ç”Ÿäº§ç¯å¢ƒã€‚\n\n## æ— å¤„ä¸åœ¨çš„å¯è§‚æµ‹æ€§\n\nåœ¨æœ€è¿‘çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§å®¢æˆ·ä¸­ä¸æ–­å¢é•¿çš„è¶‹åŠ¿ï¼Œå³â€œæ— å¤„ä¸åœ¨çš„å¯è§‚æµ‹æ€§â€æ–¹æ³•ã€‚è¿™äº›å…¬å¸ä¸ä»…é™äºç”±ç½‘ç«™å¯é æ€§å·¥ç¨‹å¸ˆå’Œ DevOps ä¼ ç»Ÿä½¿ç”¨ï¼Œè¿˜åŒ…æ‹¬äº†æ¯ä¸ªäººï¼ŒåŒ…æ‹¬å¼€å‘äººå‘˜å’Œæµ‹è¯•äººå‘˜ï¼Œå‚ä¸åˆ°å¯è§‚æµ‹æ€§ä¸­ã€‚è¿™ç§è½¬å˜é‡æ–°å®šä¹‰\n\näº†å¯è§‚æµ‹æ€§ï¼Œä½¿å…¶ä»ç”Ÿäº§é—®é¢˜çš„ä¸€ç§ååº”æ€§å·¥å…·å˜æˆäº†åœ¨å¼€å‘å’Œæµ‹è¯•ä¸­éƒ½æœ‰ç›Šçš„ä¸€ç§ä¸»åŠ¨å·¥å…·ã€‚\n\n[Honeycomb](https:\/\/www.honeycomb.io\/)å¼ºè°ƒäº†[åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨å¯è§‚æµ‹æ€§](https:\/\/www.honeycomb.io\/blog\/observability-driven-development)ï¼Œè€Œåƒ[Digma.ai](http:\/\/digma.ai\/)å’Œ Tracetest è¿™æ ·çš„å·¥å…·æ­£åœ¨æ¨åŠ¨è¿™ä¸€å‰è¿›ã€‚\n\n## æµè§ˆå™¨\n\nOpenTelemetry çš„ä¸»è¦ä½œç”¨ä¸€ç›´å±€é™äºä»ªå™¨åŒ–åç«¯ç³»ç»Ÿï¼Œè€ŒåŸºäºå¼€æ”¾æ ‡å‡†çš„æµè§ˆå™¨ä»ªå™¨åŒ–ä»ç„¶æ˜¯å®éªŒæ€§çš„ï¼Œè¿›å±•ç¼“æ…¢ã€‚æ­£åœ¨åŠªåŠ›æ”¹è¿›å’Œæ ‡å‡†åŒ–è¿™ç§ä»ªå™¨åŒ–ã€‚\n\n- [Uzufly](https:\/\/tracetest.io\/case-studies\/how-uzufly-built-end-to-end-testing-serverless-web-app-with-distributed-traces)åœ¨è¿™æ–¹é¢è„±é¢–è€Œå‡ºã€‚å®ƒä½¿ç”¨ç°æœ‰çš„å®¢æˆ·ç«¯ä»ªå™¨åŒ–æ¥æ„å»ºæµ‹è¯•ã€‚å±•æœ›æœªæ¥ï¼Œå®ƒçš„é›„å¿ƒæ˜¯æ‰©å±•åŸºäºè·Ÿè¸ªçš„æµ‹è¯•ï¼Œä»¥è¦†ç›–æµè§ˆå™¨å†…éƒ¨å‘èµ·çš„å‰ç«¯æ“ä½œæ‰€è¿›è¡Œçš„æµ‹è¯•ã€‚\n\nè¿™å°†å®ç°å‰ç«¯å’Œåç«¯çš„å…¨é¢ç«¯åˆ°ç«¯æµ‹è¯•ã€‚è¯·å…³æ³¨ 2024 å¹´æ›´å¤šå…³äºè¿™ä¸ªä¸»é¢˜çš„ä¿¡æ¯ï¼\n\n## 2023 å·²ç»è¿‡å»\n\nå‘Šåˆ« 2023ï¼Œæˆ‘ä»¬æ€€ç€çƒ­æƒ…æœŸå¾… 2024 å¹´çš„åˆ°æ¥ã€‚OpenTelemetry å…·æœ‰åŠ¿å¤´ï¼Œå¾—åˆ°äº†æ ‡å‡†å’Œå¹¿æ³›é‡‡ç”¨çš„æ”¯æŒï¼Œæ¨åŠ¨äº†å…¶å¢é•¿ã€‚æ–°çš„ä¸€å¹´æ‰¿è¯ºå¸¦æ¥ä»¤äººå…´å¥‹çš„å‘å±•ï¼Œå›´ç»• OpenTelemetry å‡ºç°äº†åˆ›æ–°çš„äº§å“å’Œç”¨ä¾‹ã€‚æˆ‘è¿«ä¸åŠå¾…åœ°æƒ³çœ‹åˆ° 2024 å¹´å°†æ­ç¤ºçš„è¿›æ­¥å’Œåˆ›æ–°ã€‚æ„¿ OpenTelemetry é•¿å­˜ï¼\n', '\/trans\/opentelemetry-and-observability-looking-forward\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">æœ¬æ–‡å±•æœ› 2024 å¹´å¯è§‚æµ‹æ€§çš„å‘å±•ã€‚</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> é˜…è¯»åŸæ–‡è¯·è½¬åˆ°ï¼šhttps://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/">
         Â«Â«
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a href="/blog/page/5/" class="page-link">
         Â«
       </a>
     </li>
     
     
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/4/" class="page-link">
             4
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/5/" class="page-link">
             5
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item page-item active ">
           <a href="/blog/page/6/" class="page-link">
             6
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/7/" class="page-link">
             7
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/8/" class="page-link">
             8
           </a>
         </li>
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
     
     
     <li class="page-item">
       <a href="/blog/page/7/" class="page-link">
         Â»
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/page/25/">
         Â»Â»
       </a>
     </li>
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      ä¸“æ 
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(69)</span>
        </a>
      
        <a href="/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(38)</span>
        </a>
      
        <a href="/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(24)</span>
        </a>
      
        <a href="/categories/%e9%9a%8f%e7%ac%94" class="sidebar-item">
            <span>éšç¬”</span>
            <span>(20)</span>
        </a>
      
        <a href="/categories/%e4%b8%9a%e6%80%81" class="sidebar-item">
            <span>ä¸šæ€</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e5%85%b6%e4%bb%96" class="sidebar-item">
            <span>å…¶ä»–</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(16)</span>
        </a>
      
        <a href="/categories/%e4%ba%91%e5%8e%9f%e7%94%9f" class="sidebar-item">
            <span>äº‘åŸç”Ÿ</span>
            <span>(13)</span>
        </a>
      
        <a href="/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%ae%89%e5%85%a8" class="sidebar-item">
            <span>å®‰å…¨</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%bc%80%e6%ba%90" class="sidebar-item">
            <span>å¼€æº</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7" class="sidebar-item">
            <span>å¯è§‚æµ‹æ€§</span>
            <span>(5)</span>
        </a>
      
        <a href="/categories/%e6%97%85%e8%a1%8c" class="sidebar-item">
            <span>æ—…è¡Œ</span>
            <span>(4)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      èµ„æ–™
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/%e5%87%ba%e7%89%88%e7%89%a9" class="sidebar-item">
            <span>å‡ºç‰ˆç‰©</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e7%94%b5%e5%ad%90%e4%b9%a6" class="sidebar-item">
            <span>ç¿»è¯‘ç”µå­ä¹¦</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e6%96%87%e6%a1%a3" class="sidebar-item">
            <span>ç¿»è¯‘æ–‡æ¡£</span>
            <span>(7)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>ç¿»è¯‘å›¾ä¹¦</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8e%9f%e5%88%9b%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>åŸåˆ›å›¾ä¹¦</span>
            <span>(2)</span>
        </a>
      
        <a href="/categories/%e6%95%99%e7%a8%8b%e6%89%8b%e5%86%8c" class="sidebar-item">
            <span>æ•™ç¨‹æ‰‹å†Œ</span>
            <span>(1)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">è”ç³»</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">å¾®ä¿¡å…¬ä¼—å·</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">åšå®¢</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/envoy-gateway-integration-istio-mesh/">é›†æˆ Envoy Gateway ä½œä¸º Istio æœåŠ¡ç½‘æ ¼ä¸­çš„å…¥å£ç½‘å…³</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/istio-configuration-safety-common-misconfigurations/">Istio é…ç½®å®‰å…¨ï¼šå¦‚ä½•é¿å…é”™è¯¯é…ç½®</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/securing-istio-addressing-critical-security-gaps-and-best-practices/">ä¿éšœ Istio å®‰å…¨ï¼šè§£å†³å…³é”®å®‰å…¨æ¼æ´åŠæœ€ä½³å®è·µ</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">é“¾æ¥</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio æœåŠ¡ç½‘æ ¼
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate å…¬å¸
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿå­¦é™¢|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿå¼€æºé¡¹ç›®å¤§å…¨
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">æ•™ç¨‹</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy åŸºç¡€æ•™ç¨‹
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio åŸºç¡€æ•™ç¨‹
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes åŸºç¡€æ•™ç¨‹
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">é€šçŸ¥</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/kubecon-china-2024-panel/">KubeCon China 2024ï¼ˆé¦™æ¸¯ï¼‰</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/website-revamp-notice/">ç½‘ç«™æ”¹ç‰ˆé€šçŸ¥</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/cloud-native-meetup-dalian-2024/">2024 å¤§è¿äº‘åŸç”ŸæŠ€æœ¯å¼€æ”¾æ—¥</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">Â© 2017-2024 Jimmy Song ä¿ç•™æ‰€æœ‰æƒåˆ©</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>




<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
