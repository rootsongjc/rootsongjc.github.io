<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>博客 - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="专注开源技术、云原生与生活随笔的分享与思考。">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.136.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.f6911c0ac7d2b5b69c3f2d9f2a2b3b496b5da0608580347fdb4dc11ef74f3ec5.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.f6911c0ac7d2b5b69c3f2d9f2a2b3b496b5da0608580347fdb4dc11ef74f3ec5.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/blog/" />
  <meta property="og:title" content="博客 | Jimmy Song" />
  <meta property="twitter:title" content="博客 | Jimmy Song" />

  
  <meta property="og:description" content="专注开源技术、云原生与生活随笔的分享与思考。" />
  <meta property="twitter:description" content="专注开源技术、云原生与生活随笔的分享与思考。" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">博客</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/book">资料</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">标签</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">公告</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">联系</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">关于</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">社区</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">视频 <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    <a class="nav-link" href="/en/blog/">English</a>
                    
                  
                
              
              
              
                
                  
                    
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>搜索</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>站内搜索</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="关闭"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="请输入搜索词" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="请输入搜索词">
        
        <div class="mt-4">
          <span>搜索类型: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">所有</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">原创</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">译文</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">资料</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">公告</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    博客
                </p>
                <p class="page-description">
                    专注开源技术、云原生与生活随笔的分享与思考。
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/traffic-interception-with-geneve-tunnel-with-istio-ambient-mesh/">使用 Geneve 隧道实现 Istio Ambient Mesh 的流量拦截</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/24</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('使用 Geneve 隧道实现 Istio Ambient Mesh 的流量拦截', '本文介绍了什么是 Geneve 隧道，与 VXLAN 的区别，以及它在 Istio Ambient Mesh 中的应用，最后谈及使用 eBPF 优化流量拦截。', '\n在我[之前的博客](\/blog\/ambient-mesh-l4-traffic-path\/)分享中提到 Istio Ambient Mesh 使用 iptables 和 Geneve 隧道将应用程序 Pod 中的流量拦截到 Ztunnel 中。很多读者可能还不了解这种隧道协议，本文将为你介绍 Geneve 隧道的定义，报文结构，以及与 VXLAN 协议的比较有哪些优势。最后，本文将介绍 Istio Ambient Mesh 如何应用 Geneve 隧道来实现流量拦截，以及 Istio 1.18 中新推出的 eBPF 模式。\n\n## Geneve 隧道简介\n\nGENEVE（Generic Network Virtualization Encapsulation）是一种网络虚拟化封装（隧道）协议，它的设计的初衷是为了解决当前数据传输缺乏灵活性和安全性的问题。Geneve 只定义了一种数据封装格式，不包括控制平面的信息。GENEVE 相较于 VXLAN 封装的关键优势在于其通过添加 TLV 格式的选项来扩展可封装的协议类型。\n\n## Geneve vs VXLAN\n\nVXLAN 和 Geneve 都是网络虚拟化协议，它们之间有很多共同点。虚拟化协议是一种将虚拟网络与物理网络分离的技术，它允许网络管理员在虚拟环境中创建多个虚拟网络，每个虚拟网络都可以拥有自己的 VLAN 标识符、IP 地址和路由。此外，VXLAN 和 Geneve 协议都使用 UDP 封装，这使得它们能够通过现有网络基础设施进行扩展。VXLAN 和 Geneve 协议还具有灵活性，它们可以在不同的网络拓扑结构中使用，并且可以与不同的虚拟化平台兼容。\n\n图 1 展示了 VXLAN 与 Geneve 协议的报文结构及其各自的 Header 区别。\n\n![图 1：VXLAN 与 Geneve 报文格式示意图](vxlan-vs-geneve.svg)\n\n从图中我们可以看到，VXLAN 与 Geneve 隧道报文的结构类似，其主要区别在于使用不同的 UDP 端口号和协议头 ——VXLAN 使用 4789 端口，Geneve 使用 6081 端口；Geneve 协议头比 VXLAN 更具扩展性。\n\nGeneve 隧道协议比 VXLAN 更加可扩展是因为 Geneve 隧道协议中增加了变长选项，它可以包含零或多个 TLV 格式的选项数据。TLV 是指类型 - 长度 - 值（Type-Length-Value）格式，用于传输和解析网络包的元数据信息。在 Geneve 协议中，每个元数据信息都由一个 TLV 格式的字段组成，以便于灵活地添加、删除和修改这些元数据。\n\n具体来说，TLV 格式的字段包括：\n\n- Type：8 位的类型字段。\n- Length：5 位的选项长度字段，以 4 字节倍数表示，不包括选项头。\n- Data：可变长的选项数据字段，可以不存在或者为 4 到 128 字节之间。\n\n通过使用 TLV 格式，Geneve 协议可以轻松地扩展和修改元数据信息，同时保持兼容性和灵活性。\n\n关于 VXLAN 隧道报文的详细信息请参考 [RFC 7348 Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks](https:\/\/tools.ietf.org\/html\/rfc7348) 。\n\n关于 Geneve 隧道报文的详细信息请参考 [RFC 8926 Geneve: Generic Network Virtualization Encapsulation](https:\/\/www.rfc-editor.org\/rfc\/rfc8926#name-geneve-packet-format-over-i) 。\n\n### 工作原理\n\nGeneve 隧道主要应用在云计算和虚拟机化场景，它可以将数据包封装在一个新的数据包中，以便在虚拟网络中传输。Geneve 隧道使用一个 24 位的虚拟网络标识符 (VNI)，将数据包从一个物理网络传输到另一个物理网络。Geneve 隧道还可以使用安全性协议，如 IPsec、TL，来保护数据包的传输。\n\n当数据包到达目的主机时，Geneve 隧道协议会将数据包从 Geneve 协议头中解封装出来，并将其传递给虚拟网络中的目的地。在解封装过程中，Geneve 协议头中的 VNI 信息会被来判断数据包的目的地，以确保数据包被正确地路由到虚拟网络中的目的地。\n\n假设有一个虚拟网络，其 VNI 为 1001。当数据包从一个物理网络传输到另一个物理网络时，可以使用隧道将数据包从一个物理网络传输到另一个物理网络。在这种情况下，隧道将源物理网络和目标物理网络之间的虚拟网络标识符 (VNI) 设置为 1001，以便在传输期间跟踪数据包。当数据包到达目标物理网络时，隧道将 VNI 从数据包中删除，并将数据包传递给目标物理网络。\n\n### 安全性\n\nGeneve 隧道协议本身并没有提供任何安全机制，因此在 Geneve 隧道中传输的数据包可能会受到威胁，例如数据包被篡改、截获、重放等。\n\n为了保障 Geneve 隧道中传输的数据包的安全性，可以使用一些安全协议。以下是一些常见的安全协议：\n\n1. IPsec（Internet Protocol Security）：IPsec 是一种网络层安全协议，可以对 Geneve 隧道中的数据包进行加密、认证和完整性保护。使用 IPsec 可以提供端到端的安全性。\n2. TLS（Transport Layer Security）：TLS 是一种基于传输层的加密协议，可以对 Geneve 隧道中的数据包进行加密和认证。使用 TLS 可以提供端到端的安全性。\n3. MACSec（Media Access Control Security）：MACSec 是一种数据链路层的安全协议，可以对 Geneve 隧道中的数据包进行加密和认证。使用 MACSec 可以提供链路层的安全性。\n\n需要注意的是，以上安全协议都需要进行相应的配置和部署，且可能会对性能产生一定的影响。在选择合适的安全协议时，需要考虑安全性、性能、可管理性等方面的因素。\n\n### 为什么选择 Geneve？\n\n下表对比了 VXLAN 与 Geneve 在多个方面的特点。\n\n| 特性 | VXLAN | Geneve |\n| --- | --- | --- |\n| 头部格式 | 固定格式 | 可扩展格式 |\n| 可扩展性 | 更多地专注于 L2 扩展 | 更好地支持新兴网络服务 |\n| 可操作性 | 较难管理和扩展 | 更容易管理和扩展 |\n| 性能 | 头部较短，性能较高 | 头部较长，性能略低 |\n\n使用 Geneve 协议的主要原因是将目前网络虚拟化封装技术（例如 VXLAN、NVGRE 和 STT）中的优点合并到一个协议中。我们通过多年的网络虚拟化开发经验得知，其中一个重要的需求是可扩展性。Geneve 协议使用可扩展的 TLV 结构对元数据进行编码，因此可以独立地发展软件和硬件端点的功能，以满足不断增长的需求。\n\n## Istio Ambient Mesh 如何应用 Geneve 隧道\n\n在[之前的博客](https:\/\/jimmysong.io\/blog\/ambient-mesh-l4-traffic-path\/)中，我讲解了 Istio Ambient Mesh 如何使用 Ztunnel 实现 L4 代理的，图 2 展示使用 iptables 和 Geneve 隧道的 L4 透明流量劫持路径。\n\n![图 2：使用 iptables 和 Geneve 隧道的 L4 透明流量劫持路径示意图](geneve-tunnel.svg)\n\n从图中我们可以看到：\n\n- Istio CNI 在节点上创建 \u0060istioout\u0060 网卡和 iptables 规则，将节点中的出站流量透明劫持到 \u0060pistioout\u0060 虚拟网卡；\n- Istio CNI 在节点上创建 \u0060istioin\u0060 网卡和 iptables 规则，将节点中的入站流量透明劫持到 \u0060pistioin\u0060 虚拟网卡；\n- Istio CNI 在 ztunnel 中创建 \u0060pistioin\u0060 和 \u0060pistioout\u0060 网卡，用于接收 Geneve 隧道中的发来的数据包；\n\n\u0060pistioin\u0060 和 \u0060pistioout\u0060 这两个网卡是由 ztunnel 中的 init 容器或 Istio CNI（见 [\u0060CreateRulesWithinNodeProxyNS\u0060](https:\/\/github.com\/istio\/istio\/blob\/master\/cni\/pkg\/ambient\/net_linux.go#L910) 函数）创建的，其 IP 地址和端口也是固定的。应用容器发出的数据包需要经过 \u0060istioout\u0060 网卡并使用 Geneve 隧道封装后转发给 ztunnel 容器。\n\n## 使用 eBPF 进行透明流量劫持\n\neBPF（extended Berkeley Packet Filter）是一个功能强大的技术，它可以在 Linux 内核中运行安全的用户态程序。eBPF 最初是一种用于过滤网络数据包的技术，但现在已经扩展到其他领域，如跟踪系统调用、性能分析和安全监控等。eBPF 的优势在于其轻量级、高效、安全和可编程性。它可以被用于实时监控、网络安全、应用程序调试和优化、容器网络等多个领域。\n\n在 Istio 1.18 之前，Ambient 模式中使用 iptables 和 Geneve 隧道将应用程序流量透明劫持到 ztunnel 中。在 Istio 1.18 中，增加了 eBPF 选项，你可以选择使用 iptables 或 eBPF 来做流量劫持。如图 3 所示，eBPF 程序直接运行在宿主机内核，将应用程序的流量转发到 ztunnel 中。\n\n![图 3：使用 eBPF 劫持应用程序的流量](ebpf.svg)\n\n图 3：使用 eBPF 劫持应用程序的流量\n\n| 对比项 | eBPF 方式 | 使用 iptables 和 Geneve 隧道 |\n| --- | --- | --- |\n| 效率 | 更高 | 略低 |\n| 兼容性 | 需要较高的 Linux 内核版本 | 更好 |\n| 实现难度 | 较高 | 较低 |\n| 扩展性 | 较好 | 较差 |\n\n根据 [Istio 官方博客](https:\/\/istio.io\/latest\/blog\/2023\/ambient-ebpf-redirection\/)介绍，使用 eBPF 方式避免了部分 iptables 规则和隧道封装，相比使用 iptables 和 Geneve 隧道更加高效。然而，eBPF 对 Linux 内核版本的要求更高（至少 4.20），而 iptables 方式则具有更好的兼容性。此外，eBPF 方式的实现难度较高，但扩展性较好。\n\n要想使用 eBPF 模式运行 Ambient Mesh，只需要在安装 Istio 时设置 \u0060values.cni.ambient.redirectMode\u0060 参数即可，如下：\n\n\u0060\u0060\u0060bash\nistioctl install --set profile=ambient --set values.cni.ambient.redirectMode=\u0022ebpf\u0022\n\u0060\u0060\u0060\n\n## 总结\n\n本文介绍了 Geneve 隧道协议的工作原理、安全性和与 VXLAN 的比较。此外，还介绍了 Istio Ambient Mesh 如何使用 Geneve 隧道实现流量拦截，并讨论了使用 eBPF 进行透明流量劫持的优缺点。Geneve 隧道协议是一种通用的隧道协议，可以在虚拟网络中传输数据包，具有更多的优势，因此在选择隧道协议时，用户可以考虑使用 Geneve 隧道。在 Istio 1.18 中新推出了 Ambient Mesh 的的 eBPF 模式，可以提供网络效率，但对 Linux 内核版本有更高要求，用户可以根据自己的实际情况选用。\n\n## 参考\n\n- [RFC 7348 Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks](https:\/\/tools.ietf.org\/html\/rfc7348)\n- [RFC 8926 Geneve: Generic Network Virtualization Encapsulation](https:\/\/www.rfc-editor.org\/rfc\/rfc8926#name-geneve-packet-format-over-i)\n- [Istio Ambient Mesh](https:\/\/istio.io\/latest\/docs\/ops\/deployment\/architecture\/#istio-ambient-mesh)\n- [Open vSwitch Geneve(8) man page](https:\/\/www.mankier.com\/8\/ovs-vswitchd.conf.db(5))\n', '\/blog\/traffic-interception-with-geneve-tunnel-with-istio-ambient-mesh\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文介绍了什么是 Geneve 隧道，与 VXLAN 的区别，以及它在 Istio Ambient Mesh 中的应用，最后谈及使用 eBPF 优化流量拦截。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/introducing-wazero-from-tetrate/">[译] Tetrate 开源项目 Wazero 简介</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/20</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%bc%80%e6%ba%90"> 
             开源
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://tetrate.io/blog/introducing-wazero-from-tetrate/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Tetrate 开源项目 Wazero 简介', '这篇文章介绍了 wazero，一个由 Tetrate 开发的用 Go 语言编写的 WebAssembly 运行时。wazero 可以让开发者用不同的编程语言编写代码，并在安全的沙箱环境中运行。', '\n\u003e 译者注：本文译自 [Tetrate 博客](https:\/\/tetrate.io\/blog\/introducing-wazero-from-tetrate\/)。这篇文章介绍了 wazero，一个由 Tetrate 开发的用 Go 语言编写的 WebAssembly 运行时。wazero 可以让开发者用不同的编程语言编写代码，并在安全的沙箱环境中运行。wazero 有以下几个特点：\n\u003e\n\u003e - 纯 Go，无依赖，支持跨平台和跨架构\n\u003e - 遵循 WebAssembly 核心规范 1.0 和 2.0\n\u003e - 支持 Go 的特性，如并发安全和上下文传递\n\u003e - 提供了丰富的编程接口和命令行工具\n\u003e - 性能优异，超过了其他同类运行时\n\nWebAssembly，也称为 Wasm，是一种编译用一种编程语言（例如 C 或 Rust）编写的代码并在不同的运行时（例如 Web 浏览器或微服务）上运行它的方法。这使得它成为编写插件、扩展以及在安全沙箱环境中运行任意用户定义代码的绝佳选择。\n\nWebAssembly 经常被误认为是一种仅限浏览器的技术，而实际上 Wasm 是一种跨平台的二进制文件，可以由任何 WebAssembly 运行时执行。从历史上看，Go 程序员没有太多好的选择，但这种情况已经改变。\n\n本文介绍了 [wazero](https:\/\/wazero.io\/)，它在用 Go 编程语言编写的基础设施中很重要，并涵盖了其最引人注目的功能。\n\n## 在 Go 中运行 WebAssembly 的简史\n\n最初，大多数 WebAssembly 运行时是用 C\/C\u002b\u002b 和 Rust 编程语言编写的。许多云原生项目，包括 Docker、Istio 和 Kubernetes 都是用 Go 编写的。不是用 Go 编写的运行时可通过称为 CGO 的机制获得。然而，CGO 不是 Go，通过选择 CGO，您就放弃了 Go 运行时的许多杀手级功能，例如对广泛平台交叉编译的一流支持。围绕 CGO 的复杂性，尤其是隐含的本机库，是将 wasm 扩展到 Kubernetes 调度程序的请求被拒绝的原因。总之，Go 缺乏原生运行时延迟或限制了将 WebAssembly 引入核心基础设施。\n\n## wazero 是为 Go 开发人员编写的\n\n[wazero](https:\/\/wazero.io\/) 是唯一用 Go 编写的**零依赖 WebAssembly 运行时**。这个开源项目最初是由 **Takeshi Yoneda** 作为爱好开始的。2021 年底，Tetrate 认识到其战略价值并投入了几名全职员工，以期有朝一日发布 1.0 版。\n\n在过去的几个月里，该团队孜孜不倦地工作以支持多种平台、架构和编程接口。我们很高兴地宣布 wazero 1.0 发布！\n\nWazero 是一个功能齐全、符合标准、丰富且经过实战检验的 WebAssembly 运行时，它与 Go 运行时的最佳特性无缝集成，例如安全并发和上下文传播。它包括一个面向 Go 开发人员的编程接口和一个面向那些只想运行 Wasm 的人的 CLI。\n\n## Wazero 有什么不同之处？\n\n你可能想知道 wazero 的优势在哪里，考虑到 Go 与其他语言具有良好的互操作性。这允许您通过 CGO 选择多个不是用 Go 编写的运行时。以下是考虑 Wazero 的五个理由：\n\n1. **最佳 Go 支持**。Wazero 是纯 Go 语言，不引入任何依赖，但支持更进一步。Wazero 包括惯用的 Go 函数，例如上下文集成。这允许您重用传入的截止日期，例如来自 gRPC 请求以限制在 wasm 函数中花费的时间。运行时是专门为 Go 设计的，因此在 Go 开发人员关注的问题（例如 goroutine security \/wazero）方面[记录很好](https:\/\/pkg.go.dev\/github.com\/tetratelabs)。比如很多库可以同时使用 wazero 而不互相冲突，这些都是在 Go 中测试过的。\n2. **API 兼容性**。WebAssembly 运行时嵌入在项目的底层位置，因此兼容性的变化可能会导致版本锁定，尤其是在中间件中。Wazero 是唯一已知的提供语义版本控制的运行时。函数可以制作成 1.1 版本，它们不会破坏 1.0 用户。Wazero 承诺保持零依赖并与 Go 的前两个版本一起工作。总之，wazero 的兼容性方法是模仿 Go 本身，为其用户引入最少的维护问题。\n3. **平台兼容性**。wazero 完全支持 amd64、arm64、FreeBSD、Linux、macOS 和 Windows 在最新三个版本的 Go 上的任意组合。它还通过其“解释器运行时”将对 Go 的支持扩展到其他平台，它的执行速度比本机“编译器运行时”慢。wazero 在 Windows 上非常棒，因为它不仅是一流的平台，而且我们还在发布时生成签名的 MSI 安装程序。\n4. **坚如磐石的测试方法**。Wazero 通过多项规范测试来测试平台支持，包括 WebAssembly 核心规范的 1.0 和 2.0 草案版本以及用于测试 I\/O 功能的 WASI 测试套件。我们还运行由 Zig 和 TinyGo 编写的标准库测试。最后，我们运行基准测试并对每个更改进行“模糊测试”。所有这些都使得 wazero 的错误易于识别和修复。\n5. **活跃的终端用户社区。** wazero 的社区包括许多公司的极强的开发人员。我们涉及一些与 Go 支持 WebAssembly 有关的方面，并为 Go 和 TinyGo 编译器做出贡献。请查看我们的[社区](https:\/\/wazero.io\/community\/)和[用户](https:\/\/wazero.io\/community\/users\/)页面，了解更多关于我们以及您如何融入其中的信息！\n\n## 将 wazero 嵌入您的项目中\n\nWazero 显然也是一个 Go 库，其主要目标是让您与运行时环境无缝集成，并使用 WebAssembly 扩展您的 Go 应用程序。例如，假设您想运行[经典的 Unix 程序 cowsay](https:\/\/en.wikipedia.org\/wiki\/Cowsay)（最初是用 Perl 编写的）。那么您可以输入：\n\n\u0060\u0060\u0060\n\/\/ Download the executable from:\n\/\/ https:\/\/github.com\/evacchi\/cowsay\/releases\/download\/0.1.0\/cowsay.wasm\n\/\/go:embed \u0022cowsay.wasm\u0022\nvar cowsay []byte\n\nfunc main() {\n\tctx := context.Background()\n\tr := wazero.NewRuntime(ctx)\n\twasi_snapshot_preview1.MustInstantiate(ctx, r)\n\tr.InstantiateWithConfig(ctx, cowsay,\n\t\twazero.NewModuleConfig().\n\t\t\tWithArgs(\u0022cowsay\u0022, \/\/ first arg is usually the executable name\n\t\t\t\t\u0022wazero is awesome!\u0022).\n\t\t\tWithStdout(os.Stdout))\n}\n\u0060\u0060\u0060\n\n运行它会显示：\n\n\u0060\u0060\u0060\n ____________________\n\u003c wazero is awesome! \u003e\n --------------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\\/\\\n               ||----w |\n                ||     ||\n\u0060\u0060\u0060\n\n## 使用 wazero CLI 入门\n\n该项目现在包括一个 CLI，用于运行 WebAssembly 二进制文件。我们发现许多用户无论使用哪种编程语言都选择它，因此我们决定使用这个例子。\n\n现在，您可以使用一个简单的命令下载和安装 wazero CLI：\n\n\u0060\u0060\u0060\n$ curl https:\/\/wazero.io\/install.sh | sh\n\u0060\u0060\u0060\n\n或者在 Windows 上，您可以[下载有 MSI 签名的](https:\/\/github.com\/tetratelabs\/wazero\/releases\/download\/v1.0.0-rc.2\/wazero_1.0.0-rc.2_windows_amd64.msi)。\n\n然后您可以使用以下命令运行您的 WebAssembly 二进制文件：\n\n\u0060\u0060\u0060\n$ .\/bin\/wazero run someApp.wasm\n\u0060\u0060\u0060\n\n例如，假设您想在 CLI 上运行 cowsay，那么只需键入\n\n\u0060\u0060\u0060\n$ curl -LO https:\/\/github.com\/evacchi\/cowsay\/releases\/download\/0.1.0\/cowsay.wasm\n$ wazero run cowsay.wasm wazero is awesome!\n ____________________\n\u003c wazero is awesome! \u003e\n --------------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\\/\\\n               ||----w |\n                ||     ||\n\u0060\u0060\u0060\n\n或者，也许你更想玩 1977 年的 Infocom 文本冒险游戏 Zork。\n\n你可以从 https:\/\/github.com\/evacchi\/zork-1\/releases\/tag\/v0.0.1 获取一个 Wasm 二进制文件，然后使用以下命令调用：\n\n\u0060\u0060\u0060\n$ curl -L https:\/\/github.com\/evacchi\/zork-1\/releases\/download\/v0.0.1\/zork-wasm-wasi.tgz | tar xzf -\n$ wazero run -mount=.:\/ zork.wasm\nWelcome to Dungeon.\t\t\tThis version created 11-MAR-91.\nYou are in an open field west of a big white house with a boarded\nfront door.\nThere is a small mailbox here.\n\u003eopen mailbox\nOpening the mailbox reveals:\n  A leaflet.\n\u003eread leaflet\nTaken.\n\t\t    Welcome to Dungeon!\n\n   Dungeon is a game of adventure, danger, and low cunning.  In it\nyou will explore some of the most amazing territory ever seen by mortal\nman.  Hardened adventurers have run screaming from the terrors contained\nwithin.\n\n   In Dungeon, the intrepid explorer delves into the forgotten secrets\nof a lost labyrinth deep in the bowels of the earth, searching for\nvast treasures long hidden from prying eyes, treasures guarded by\nfearsome monsters and diabolical traps!\n\n   No DECsystem should be without one!\n\u0060\u0060\u0060\n\n尽情玩吧！\n\n## 最后的话\n\n这是我们的第一个重大发布，但我们才刚刚开始！**有许多值得期待的事情**。\n\nWebAssembly 规范正在不断更新，我们将密切关注它：例如，[tail call proposal](https:\/\/github.com\/WebAssembly\/tail-call\/blob\/main\/README.md) 刚刚进入第 4 阶段，[GC proposal](https:\/\/github.com\/WebAssembly\/gc\/blob\/master\/proposals\/gc\/Overview.md) 则是许多编程语言（如 Java）的支持者，最近进入了第 3 阶段。Wazero 将继续通过所有测试，随着 WebAssembly 的发展而发展。\n\n我们还希望作为您 WebAssembly 运行时的战略性选择。您可以期待持续致力于性能，可观测性和可扩展性。一个例子是我们即将推出的低级文件系统插件。它支持比 Go 的 fs.FS 更多的功能，现在就可以使用，例如创建目录和文件。该设计支持自定义审计和访问控制，并可用于第三方主机函数。\n\n最后，如果您在 3 月 23 日和 24 日参加巴塞罗那的 Wasm I\/O 活动，就有机会认识我们团队的一部分！\n\n如果您在会议结束后留在那里，或者您只是在那个晚上在城市里，**在 3 月 24 日星期五**，我们也很高兴[邀请您参加 wazero 1.0 自己的官方发布派对](https:\/\/www.eventbrite.com\/e\/wazero-10-launch-party-tickets-585204150367)。我们将提供小吃，饮料和许多社区贡献者，他们将展示他们如何使用我们所钟爱的 WebAssembly 运行时！一位幸运的参会者将有机会按下 1.0 的发布按钮！\n\n我们很兴奋地看到您将如何使用 Wazero 构建项目。[加入我们不断增长的社区用户列表](https:\/\/wazero.io\/community\/users\/)，并让我们知道您正在创造什么！\n', '\/trans\/introducing-wazero-from-tetrate\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇文章介绍了 wazero，一个由 Tetrate 开发的用 Go 语言编写的 WebAssembly 运行时。wazero 可以让开发者用不同的编程语言编写代码，并在安全的沙箱环境中运行。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/ai-tools-collection/">AIGC 工具推荐：利用 AI 提高工作效率的利器</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/15</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/ai"> 
             AI
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('AIGC 工具推荐：利用 AI 提高工作效率的利器', '本篇博客旨在为大家推荐几款实用且易于上手的 AI 工具，希望能够帮助大家提高工作效率，更好地应用 AI 技术。', '\n更新时间：2023 年 04 月 16 日\n\n人工智能（AI）正在改变我们的生活，使我们的工作更加高效和智能化。在这个快速发展的领域中，有许多 AI 实用工具可以帮助我们更好地完成工作。在未来熟练使用各种 AI 工具优化你的工作流并提高工作效率将是每个人的必备技能，是时候收集一些便宜好用的实用 AI 工具了。下面是笔者推荐的一些值得收藏的实用 AIGC 工具，你可以直接上手使用这些工具，不需要额外的编程知识。这些工具大多可以免费使用，或者提供免费使用额度，或者使用成本很低。\n\n注意：本列表暂时只关注文本工具，不涉及以下内容：\n\n- 图像、声音、视频等多媒体内容生成和编辑，因为编辑那些内容需要更多专业知识，一般供专业人士使用；\n- 必须付费才能使用的工具或者笔者认为收费过高的工具；\n\n{{\u003ccallout note \u0022什么是 AIGC 工具？\u0022\u003e}}\n\nAIGC（AI-Generated Content）可以自动生成各种文本内容，如文章、新闻、产品描述、广告语等，它使用人工智能技术，通过对大量文本数据的学习和分析来生成通顺、连贯、语法正确的文本内容。对于需要大量重复性内容的场景（如电商平台的商品描述、新闻媒体的稿件生成等），它能大幅提高内容创作效率。AIGC 工具的实现方式有很多种，如基于语言模型的自动生成文本、基于模板的文本生成、基于知识图谱的自动生成文本等。随着技术的不断进步，AIGC 工具在自动生成文本方面的能力也在不断提升，能够生成更加贴近人类写作风格的文本内容。\n\n{{\u003c\/callout\u003e}}\n\n## 1. ChatGPT\n\n![ChatGPT 网站界面](chatgpt.jpg)\n\n[ChatGPT](https:\/\/chat.chatgpt.com\/) 是一个基于 GPT 技术的智能聊天机器人，可以与用户进行自然语言交互。它使用深度学习技术和大规模训练的语言模型来理解用户的问题并提供有用的答案。\n\nChatGPT 可以回答各种问题，用户可以直接在网站上输入问题或话题，并获得快速和准确的答案。需要注意的是，ChatGPT 是一个在线聊天机器人，它的回答可能不是 100% 准确。此外，ChatGPT 模型训练的数据截止到 2021 年，它还处于早期开发阶段，仍在不断改进和优化中。\n\n**推荐理由**\n\nChatGPT 的回答速度超快，几秒就能得到答案，特别适合需要快速回复的场合。还可以用 OpenAI 的 API 做自己的工具。但是 ChatGPT 的免费版响应速度有时会慢，而且在追问时经常需要刷新页面，问题和答案的字数也有限制。\n\n比较常用的功能包括：\n\n- 编写代码\n- 翻译\n- 文章润色\n- 总结某一篇文章（你可以输出一个 URL）\n- 学习一个你不了解的知识领域\n\n另外推荐一款 [ChatGPT 桌面应用](https:\/\/github.com\/lencx\/ChatGPT) 以及 [ChatGPT 提示项目](https:\/\/github.com\/f\/awesome-chatgpt-prompts)。\n\n### ChatGPT Plus\n\n[ChatGPT Plus](https:\/\/chat.chatgpt.com\/plus) 是 ChatGPT 的增强版，它使用 GPT-3 技术，提供了更加强大和智能的自然语言处理功能。它可以帮助用户完成各种任务，如自动生成文章、翻译、问答、语音转换和聊天机器人等。\n\nChatGPT Plus 的界面简洁美观，使用起来非常直观和友好。用户可以使用多种方式输入文本，如键盘输入、语音输入和图像输入等。ChatGPT Plus 还提供了多种语言和风格选择，可以帮助用户轻松生成高质量的文本和语音。\n\n## 2. Smodin\n\n![Smodin 界面](smodin.jpg)\n\n[Smodin.io](https:\/\/smodin.io\/) 是一个基于人工智能和自然语言处理技术的在线工具，可以帮助用户自动生成文章、新闻稿、博客和社交媒体帖子等内容。该网站使用深度学习技术和语言模型来自动化生成高质量的文本，并提供了多种语言和风格选择。\n\n[Smodin.io](https:\/\/smodin.io) 的使用非常简单，只需要输入您需要生成的主题、关键词和所需的语言和风格，然后点击“生成”按钮即可获得一篇高质量的文章。您还可以根据需要进行微调和编辑，以满足您的具体需求。\n\n除了自动生成文本外，[Smodin.io](https:\/\/smodin.io) 还提供了其他有用的功能，如语法和拼写检查、SEO 优化建议和实时翻译等。该网站的使用非常灵活和方便，适合需要高质量文本的个人和企业用户，如营销人员、编辑、作家和博主等。\n\n需要注意的是，虽然 [Smodin.io](https:\/\/smodin.io) 可以为您节省大量时间和精力，但由于是自动生成的文本，可能会存在一定的语法或逻辑错误，因此在使用时需要进行适当的审查和编辑。\n\n**推荐理由**\n\n该网站支持 40 多种语言，**对于中文的改写功能比较强悍**，限制一次性输入 1000 字，可以迅速的返回改写结果，免费用户有调用次数限制，付费用户可无限制。付费分为两个档次，价格比较便宜。\n\n## 3. Bing\n\n![新必应聊天界面](bing.jpg)\n\n[Bing](https:\/\/bing.com) 是微软公司开发的搜索引擎，集成了人工智能技术，可以提供更加智能化的搜索结果。最近，微软宣布向 Bing 中添加了一项新功能，即“聊天”，用户可以在聊天框中输入问题，Bing 会自动回答问题，就像一个智能聊天机器人一样。Bing 还提供多种对话样式可供选择。\n\n需要注意的是，聊天功能目前还处于测试阶段，可能存在一些问题和限制。此外，Bing 在一些国家和地区的可用性可能会受到限制。但是，它仍然是一款非常有用的搜索引擎，可以帮助用户快速找到所需的信息。\n\n**推荐理由**\n\n新必应集成的聊天功能比较稳定，因为它可以联网和实时爬取因特网中的数据，你可以把它作为搜索引擎的辅助工具，或者询问它一些实时的信息。\n\n关于新必应与 ChatGPT 的区别请见我的[前一篇博客](\/blog\/new-bing-chat)。\n\n## 4. GitHub Copilot\n\n![GitHub Copilot 界面](copilot.jpg)\n\n[GitHub Copilot](https:\/\/copilot.github.com\/) 是一款由 OpenAI 和 GitHub 共同开发的 AI 代码助手，可以帮助开发人员更快、更准确地编写代码。它使用了自然语言处理和机器学习等技术，可以自动为用户生成高质量的代码，提高了开发效率和代码质量。\n\nGitHub Copilot 可以与多种开发工具和编程语言集成，如 VS Code、Visual Studio、Python、JavaScript 等。用户只需要在编辑器中输入少量的自然语言描述，Copilot 就可以自动为用户生成高质量的代码。例如，当用户输入“Create a function that takes two arrays as arguments and returns their dot product.”时，Copilot 可以自动为用户生成如下代码：\n\n\u0060\u0060\u0060go\nfunction dotProduct (arr1, arr2) {\n  return arr1.map ((n, i) =\u003e n * arr2 [i]).reduce ((a, b) =\u003e a \u002b b);\n}\n\u0060\u0060\u0060\n\n需要注意的是，GitHub Copilot 目前还处于 beta 版本，仍在不断优化和改进中。此外，GitHub Copilot 的代码生成质量和准确性可能会受到一些因素的影响，如输入的描述、编程语言、编码规范等。\n\n**推荐理由**\n\nGitHub Copilot 的代码生成速度非常快，可以帮助开发人员节省大量的时间和精力。此外，GitHub Copilot 还可以从用户的代码库中学习，提高了代码生成的质量和准确性。\n\n## 5. Notion\n\n![Notion 界面](notion.jpg)\n\n[Notion](https:\/\/www.notion.so\/) 是一款集笔记、待办事项、项目管理、知识库和团队协作等功能于一体的综合性工具。它提供了强大的编辑和组织功能，可以帮助用户轻松创建各种类型的文档，包括文本、图片、视频、表格和数据库等。\n\nNotion 的界面简洁美观，使用起来非常直观和友好。用户可以使用多种方式组织和查找自己的文档，如标签、目录和搜索等。此外，Notion 还提供了丰富的协作和分享功能，可以帮助用户轻松与团队成员协作和共享文档。\n\n对于 AI 开发人员来说，Notion 是一个非常好用的工具，可以帮助他们轻松管理项目、记录实验数据、分享笔记、翻译和文档等。Notion 还提供了丰富的第三方应用程序和 API，可以轻松集成其他工具和服务。\n\n需要注意的是，Notion 的免费版本有一些限制，如文件上传大小限制和 API 调用次数限制等。但是，付费版本提供了更多的功能和服务，如无限制的文件上传、API 调用和团队成员数等，适合团队和企业用户使用。\n\n**推荐理由**\n\nNotion 提供了丰富的模板和插件，可以帮助用户快速创建各种类型的文档和项目，如产品路线图、项目计划和工作日志等。此外，Notion 的 API 和 Webhook 功能也非常强大，用户可以利用这些功能轻松集成其他工具和服务。免费用户可以创建无限多的文档，但是只有 20 次调用 Notion AI 的权限。超过该次数需要付费 $10 \/ 月 订阅（注意：Notion AI 功能需要单独订阅）。\n\nNotion 是我最喜欢的 AI 文本编辑器，它对中文支持很好。而且，它支持 Markdown 格式，方便导出。它可以代替 Smodin 的部分功能，但是对于文本改写的效果还有待验证。\n\n## 6. Grammarly\n\n![Grammarly 界面](grammarly.jpg)\n\n[Grammarly](https:\/\/app.grammarly.com\/) 是一款使用人工智能帮助用户提高写作能力的写作助手。它可以识别和纠正语法错误、拼写错误和标点符号错误，还可以提供改善写作清晰度和风格的建议。Grammarly 可以作为浏览器扩展、桌面应用程序和移动应用程序使用，可用于各种写作任务，如电子邮件、社交媒体帖子和学术论文。Grammarly 有免费版本和高级版本，具有其他功能。\n\nGrammarly 的使用非常简单，只需在浏览器中安装其扩展程序或在电脑或移动设备上下载其应用程序，然后在需要的文本框中开始输入即可。Grammarly 会自动检查文本，并在需要时提供建议和纠正错误。用户还可以选择不同的写作风格和语言设置，以适应他们的写作需求。\n\n除了基本的拼写和语法检查外，Grammarly 还提供了一些高级功能，如词汇增强、句子结构调整、文本简化和风格建议等。这些功能可以帮助用户改善写作技巧，提高写作质量。此外，Grammarly 还提供了一些其他有用的工具，如写作目标设定、批注和评论等，可以帮助用户更好地组织和管理自己的写作任务。\n\n需要注意的是，尽管 Grammarly 可以提供有用的建议和纠正错误，但它并不能完全代替人类编辑或审查。在使用 Grammarly 时，用户仍应该进行适当的审查和编辑，以确保写作质量和准确性。\n\n**推荐理由**\n\nGrammarly 的语法检查和纠错功能非常准确和实用，可以帮助用户快速纠正拼写错误和语法错误。此外，Grammarly 还提供了一些高级功能，如句子结构调整和文本简化，可以帮助用户改善写作风格和质量。对于需要频繁写作的人来说，Grammarly 是一个非常有用的工具，可以提高写作效率和质量。\n\n**注意：Grammarly 不支持中文。**\n\n## 7. Quillbot\n\n![Quillbot 界面](quillbot.jpg)\n\nQuillbot 是一款使用人工智能技术帮助用户改写和翻译文本的工具。它可以帮助用户将现有文本转化为更加简洁、清晰和易于理解的版本，以满足不同的写作需求。\n\nQuillbot 的使用非常简单，只需将需要改写或翻译的文本粘贴到指定的文本框中，然后选择所需的改写或翻译选项，即可获得高质量的改写或翻译结果。Quillbot 还提供了多种语言和风格的选择，以满足不同用户的需求。\n\n除了改写和翻译文本外，Quillbot 还提供了其他有用的功能，如语法检查、拼写检查、同义词替换和学术论文检查等。这些功能可以帮助用户提高写作质量和效率，节省时间和精力。\n\n需要注意的是，尽管 Quillbot 可以为用户节省大量时间和精力，但改写和翻译文本需要一定的技巧和经验，因此在使用时需要进行适当的审查和编辑。\n\n**推荐理由**\n\nQuillbot 的改写和翻译功能非常强大和实用，可以帮助用户快速转化现有文本为更加简洁、清晰和易于理解的版本。此外，Quillbot 还提供了其他有用的功能，如语法检查、拼写检查和同义词替换等，可以帮助用户提高写作质量和效率。Quillbot 提供多款插件，可以轻松集成到浏览器和其他应用程序中使用。\n\n**注意：Quillbot 不支持中文。**\n\n## 8. ChatPDF\n\n![ChatPDF 界面](chatpdf.jpg)\n\nChatPDF 是一个可以让你和任何 PDF 文件进行交流的工具，就像和一个人聊天一样。它的原理是通过分析 PDF 文件来创建语义索引，然后根据你的问题，把相关的段落发送给一个文本生成的 AI，让它给你解释。\n\nChatPDF 是由德国开发者 Mathis Lichtenberger 开发的，他之前还开发过其他数据处理工具 firefoo。ChatPDF 目前是免费使用的，但是有一个 120 页的限制。\n\n你可以用它来快速地从大型 PDF 文件中提取信息，比如手册、论文、合同、书籍等。它支持中文和英文，并且可以自动翻译。\n\nChatPDF 还有一个 App 版本，可以在 iPhone, iPad, iPod touch 或 Mac OS X 13.0 或更高版本上使用。\n\n**推荐理由**\n\n你可以用它快速获取 PDF 中的关键信息，对于 200 页以内的 PDF 格式书籍已经足够使用。文档处理速度较快，如果要处理超过 120 需要升级账号到  Plus 级别。\n\n下表展示了免费账户和 Plus 账号的区别。\n\n| 类别     | 免费       | Plus         |\n| -------- | ---------- | ------------ |\n| 页数限制 | 120 页     | 2000 页      |\n| 大小限制 | 10MB       | 32MB         |\n| 次数限制 | 3 PDF \/ 天   | 50 PDF \/ 天    |\n| 问题限制 | 50 问题 \/ 天 | 1000 问题 \/ 天 |\n\n## 9. ChatDoc\n\n![ChatDoc 界面](chatdoc.jpg)\n\n[chatdoc.com](https:\/\/chatdoc.com) 与 ChatPDF 类似，该网站是一个基于 ChatGPT 技术的文件阅读助手，可以让用户像与人类交互一样与 PDF 文档进行交互。用户可以上传研究论文、书籍、手册等文件，然后用自然语言提问，获取简洁易懂的回答。回答还会附上直接引用的文件来源，方便用户核实信息的准确性¹⁴。这个网站支持中英文，并且能够识别理解文档中的表格数据。\n\n**推荐理由**\n\n可以直接选择 PDF 中的文字来提问，并且答案中给出了引用的段落标记。\n\n免费用户限制：\n\n- 200 页\/PDF\n- 36MB\/文件\n- 5 文件\/24 小时\n\n除了文档处理速度比 ChatPDF 稍慢以外，在用户体验上比 ChatPDF 更好。另外该网站暂未推出付费计划。\n\n## 10. Claude\n\n![在 Slack 中使用 Claude](claude.jpg)\n\n[Anthropic](https:\/\/www.anthropic.com\/index\/introducing-claude) 的 Claude 是一个基于人工智能的编程自动化工具，它能够自动化处理编程任务，并生成优化的代码。Claude 使用了深度学习和其他人工智能技术来分析程序逻辑和数据结构，并根据用户提供的目标和约束生成代码。Claude 支持多种编程语言，包括 Python、Java 和 JavaScript。\n\nClaude 的使用非常简单，只需提供一个输入数据集和目标输出，然后让 Claude 自动化处理剩下的任务。Claude 还支持自定义模型和算法，以满足不同的编程需求。此外，Claude 还提供了一些其他有用的功能，如代码优化、文档生成和测试等，可以帮助用户提高编程效率和质量。Claude 还提供了一些教程和示例代码，以帮助用户了解如何使用它来解决各种编程问题。\n\n需要注意的是，尽管 Claude 可以为用户节省大量时间和精力，但编写高质量的代码仍需要一定的技巧和经验，因此在使用 Claude 时需要进行适当的审查和编辑。\n\n**推荐理由**\n\nClaude 的自动化编程功能非常强大和实用，可以帮助用户快速生成高质量的代码。此外，Claude 还提供了一些其他有用的功能，如代码优化、文档生成和测试等，可以帮助用户提高编程效率和质量。对于需要频繁编写代码的人来说，Claude 是一个非常有用的工具，可以提高编程效率和质量。\n\n你可以直接[在 Slack 中安装](https:\/\/www.anthropic.com\/index\/claude-now-in-slack) Claude App 免费使用，无任何限制。响应迅速，服务稳定。\n\n## 结论\n\n这些 AI 实用工具都具有高效、易用、可扩展的特点，可以帮助人们更好地完成各种任务。如果您正在寻找一款优秀的 AI 工具，那么这些工具都是值得考虑的。如果你有更多好用的实用 AI 工具，欢迎在评论区补充。本推荐列表将持续更新，敬请期待。\n', '\/blog\/ai-tools-collection\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本篇博客旨在为大家推荐几款实用且易于上手的 AI 工具，希望能够帮助大家提高工作效率，更好地应用 AI 技术。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/introducing-service-weaver-framework-for-writing-distributed-applications/">[译] Google 开源 Service Weaver——构建和部署分布式应用程序框架</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/06</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%bc%80%e6%ba%90"> 
             开源
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://opensource.googleblog.com/2023/03/introducing-service-weaver-framework-for-writing-distributed-applications.html" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Google 开源 Service Weaver——构建和部署分布式应用程序框架', '编者按：近日 Google 开源了一个名为 Service Weaver 的开源框架，它可以帮助开发者构建和部署分布式应用程序。Service Weaver 的特点是，它允许开发者以模块化单体的方式编写应用程序，然后使用自定义部署器将其部署为一组微服务。这样，开发者可以在不改变代码的情况下，灵活地调整应用程序的架构和性能。', '\n\u003e 编者按：近日 Google 开源了一个名为 Service Weaver 的开源框架，它可以帮助开发者构建和部署分布式应用程序。Service Weaver 的特点是，它允许开发者以模块化单体的方式编写应用程序，然后使用自定义部署器将其部署为一组微服务。这样，开发者可以在不改变代码的情况下，灵活地调整应用程序的架构和性能。[Google 开源博客](https:\/\/opensource.googleblog.com\/2023\/03\/introducing-service-weaver-framework-for-writing-distributed-applications.html)介绍了该项目，并给出了开源地址：https:\/\/github.com\/ServiceWeaver\/weaver\n\n**Service Weaver 是一个用于构建和部署分布式应用程序的开源框架**。Service Weaver 允许您将应用程序编写为**模块化单体**，并将其部署为一组微服务。\n\n更具体地说，Service Weaver 由两个核心部分组成：\n\n1. 一组编程库，可让您将应用程序编写为单个**模块化**二进制文件，仅使用本机数据结构和方法调用，以及\n2. 一组部署器，可让您配置应用程序的运行时拓扑并将其部署为一组微服务，可以在本地或在您选择的云上部署。\n\n![Service Weaver 编程库从开发到执行的流程图，将标记为 A 到 D 的四个模块从跨微服务级别的应用程序移动到标记为 Desktop、Google Cloud 和其他云的部署程序](1.png) \n\n通过将应用程序编写过程与运行时考虑因素（例如应用程序如何拆分为微服务、使用何种数据序列化格式以及如何发现服务）分离，Service Weaver 旨在提高分布式应用程序开发速度和性能。\n\n### 构建 Service Weaver 的动机\n\n在编写基于微服务的应用程序时，我们发现维护多个不同的微服务二进制文件（具有它们自己的配置文件、网络端点和可序列化数据格式）的开销大大降低了我们的开发速度。\n\n更重要的是，**微服务严重影响我们进行跨二进制更改的能力**。使得我们不得不做一些事情，比如在每个二进制文件中标记新功能，仔细地改进我们的数据格式，并深入了解我们的上线过程。最后，拥有预定数量的特定微服务会有效地冻结我们的 API；它们变得如此难以更改，以至于将我们所有的更改都压缩到现有的 API 中而不是改进它们。\n\n因此，我们希望我们有一个单一的整体二进制文件来使用。单体二进制文件易于编写：它们仅使用语言原生类型和方法调用。它们也很容易更新：只需编辑源代码并重新部署。它们很容易在本地或虚拟机中运行：只需执行二进制文件即可。\n\n**Service Weaver 是一个提供两全其美的框架：单体应用程序的开发速度，以及微服务的可扩展性、安全性和容错性。**\n\n## 服务编织器概述\n\nService Weaver 的核心思想是它的**模块化单体**模型。您编写单个二进制文件，仅使用语言的原生数据结构和方法调用。您将二进制文件组织成一组称为组件的模块，它们是您的编程语言中的原生类型。例如，这是一个使用 Service Weaver 用 Go 语言编写的简单应用程序。它由一个 main() 函数和一个 Adder 组件组成：\n\n\u0060\u0060\u0060go\ntype Adder interface { \n    Add(context.Context, int, int) (int, error)\n} \ntype adder struct{ \n    weaver.Implements[Adder]\n}\nfunc (adder) Add(_ context.Context, x, y int) (int, error) {\n  return x \u002b y, nil\n}\n\nfunc main() {\n  ctx := context.Background()\n  root := weaver.Init(ctx)\n  adder, err := weaver.Get[Adder](root)\n  sum, err := adder.Add(ctx, 1, 2)\n}\n\u0060\u0060\u0060\n\n运行上述应用程序时，您可以进行简单的配置选择，即是将 Adder 组件放置在 main() 函数中还是单独放置。当 Adder 组件分离时，Service Weaver 框架自动将 Add 调用翻译成跨机 RPC；否则，Add 调用仍然是本地方法调用。\n\n要更改上述应用程序，例如向 Add 方法添加无限数量的参数，您所要做的就是更改 Add 的签名，更改其调用站点，然后重新部署您的应用程序。Service Weaver 确保新版本的 main() 只与新版本的 Adder 通信，无论它们是否位于同一位置。这种行为与使用语言原生数据结构和方法调用相结合，使您可以专注于编写应用程序逻辑，而不必担心部署拓扑和服务间通信（例如，代码中没有原型、存根或 RPC 通道）。\n\n当需要运行您的应用程序时，Service Weaver 允许您在任何地方运行它——在您的本地桌面环境或本地机器机架上，或在云中——而无需对您的应用程序代码进行任何更改。这种级别的可移植性是通过将关注点明确分离到 Service Weaver 框架中来实现的。一方面，我们有应用程序开发的编程框架。另一方面，我们有各种 **deployer** 实现，每个部署环境一个。\n\n![描述一次迭代中跨三个独立平台的 Service Weaver Libraries 部署程序实施的流程图](2.png) \n\n这种关注点分离允许您通过 go run 在单个进程中本地运行您的应用程序。或者通过 weaver gke deploy 在谷歌云上运行它；或者在其他平台上启用并运行它。在所有这些情况下，您无需修改或重新编译您的应用程序即可获得相同的应用程序行为。\n\n## Service Weaver v0.1 中有什么？\n\nService Weaver 的 v0.1 版本包括：\n\n- 用于编写应用程序的 核心[Go 库](https:\/\/github.com\/ServiceWeaver\/weaver)\n- 许多用于在[本地](https:\/\/github.com\/ServiceWeaver\/weaver\/tree\/main\/cmd\/weaver)或[GKE 上](https:\/\/github.com\/ServiceWeaver\/weaver-gke)运行您的应用程序的部署程序\n- [一组 API](https:\/\/github.com\/ServiceWeaver\/weaver\/tree\/main\/runtime)，允许您为任何其他平台编写自己的部署程序\n\n所有库都是在 Apache 2.0 许可下发布的。请注意，在发布 v1.0 版之前， **我们可能会引入重大更改**。', '\/trans\/introducing-service-weaver-framework-for-writing-distributed-applications\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">编者按：近日 Google 开源了一个名为 Service Weaver 的开源框架，它可以帮助开发者构建和部署分布式应用程序。Service Weaver 的特点是，它允许开发者以模块化单体的方式编写应用程序，然后使用自定义部署器将其部署为一组微服务。这样，开发者可以在不改变代码的情况下，灵活地调整应用程序的架构和性能。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/new-bing-chat/">体验新必应——聊天式的搜索引擎辅助工具</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/01</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/ai"> 
             AI
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('体验新必应——聊天式的搜索引擎辅助工具', '昨天我的新必应体验申请通过了，立马去体验了下，本文记录下我对新必应的最初印象。', '\n更新时间：2023 年 04 月 20 日 17:16:22\n\n昨天我的新必应体验申请通过了，立马去体验了下，本文记录下我对新必应的最初印象。\n\n## 如何体验新必应 {#how-to-experience-new-bing}\n\n访问必应国际站（[bing.com](https:\/\/bing.com)）并下载 Bing App（非中国版），申请加入 waitlist，我是在 waitlist 推出第一天就申请了，直到昨天才正式获批。\n\n新必应推荐（强制）你使用微软 Edge 浏览器和使用 bing.com 进行搜索，如果你在中国大陆使用 Chrome、Safari、火狐或其他浏览器访问的话，无论搜索什么网页都不会给你返回任何结果，你将看到白屏，这令人很无语。\n\n## 使用 Chrome 访问新必应 {#chrome}\n\n如果你身处中国大陆，习惯使用了 Chrome 浏览器，不想为了体验新必应而安装一个 Edge 浏览器，可以使用下面的方法在 Chrome 中使用新必应：\n\n### 方式一：修改 HTTP Header\n\n首先在 Chrome 应用商店中安装 [ModHeader](https:\/\/chrome.google.com\/webstore\/detail\/modheader-modify-http-hea\/idgpnmonknjnojddfkpgkljpfnnfcklj)，方便我们修改  HTTP 请求中的 Header，模仿 Edge 浏览器。\n\n然后配置 ModeHeader，添加规则如下：\n\n在 Request headers 处添加：\n\n- 模拟 Edge 浏览器：\u0060user-agent\u0060 =  \u0060Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/110.0.0.0 Safari\/537.36 Edg\/110.0.1587.41\u0060\n- 模拟香港 IP：\u0060X-Forwarded-For\u0060 =  \u00601.36.x.y\u0060\n\n在 FILTER 处选择「(Request) URL filter」，填入 \u0060.*:\/\/www.bing.com\/.*\u0060\n\n**注意：这种方式在 2023 年 4 月 20 日发现失效。**\n\n### 方式二：安装专用浏览器插件\n\n安装 [Bing chat for all browsers](https:\/\/github.com\/anaclumos\/bing-chat-for-all-browsers) 浏览器插件。推荐这种方式，安装好后你不需要任何配置。\n\n现在访问 [bing.com](https:\/\/bing.com) 你就可以看到顶部的【聊天】选项，可以顺利的使用新必应了。\n\n## 新必应初体验 {#first-experience}\n\n在新必应推出前，我已经使用过几个月的 ChatGPT 了，因此下面主要将新必应的聊天与 ChatGPT 做对比。通过同一个问题两者给出的不同答案，以小见大。\n\n问题：北京的亮马河发源于哪里？\n\nChatGPT 和新必应给出了截然不同的回答，如图 1 所示。ChatGPT 的答案究竟来自哪里我们无从知晓，如果你对北京的地面一无所知的话也许会觉得它的回答有模有样，貌似很合理，但实际上稍有了解的人都会觉得它是【一本正经的胡说八道】。而新必应的回答则明确了出处，是来自维基百科和百度百科等渠道。\n\n![图 1：ChatGPT 与新必应给出的不同回答](chatgpt-vs-bing.jpg)\n\n从上面的回答及我一天的使用体会：\n\n1. ChatGPT 并非直接引用网络上的内容，因为在网上找不到同样的回答，所以我们无法直接验证答案的准确性，需要与它进一步对话来纠正它的错误；\n2. 新必应对于问答是问题，很多答案都引用自知乎；\n3. 新必应的每条回答都会给出引用来源，这一点方便我们去验证，这就像是搜索引擎的辅助工具，如果你直接搜索也可以很方便找到答案；\n4. 新必应会根据你的问题推荐一些相关的问题，类似搜索引擎中的推荐功能；\n5. 因为新必应是联网的，如果问一些近期的问题，也可以找到答案，而 ChatGPT 只有 2021 年以前的数据；\n6. 新必应聊天功能更稳定，在我试用一天的时间内没有遇到需要刷新重连的情况，而 ChatGPT 免费用户会经常遇到刷新问题；\n7. 新必应的上下文联想能力比较差，更像是一个聊天式的搜索工具，它可以将一些搜索到的网页主题进行归纳输出，然后给出引用地址；\n\n\u003e 结论：聊天是新必应的搜索引擎辅助工具，如果 Google 推出同样的服务，比如 Bart，我可能还会继续使用 Google 搜索。\n\n## 网友看法 {#comments}\n\n我昨天在朋友圈里分享了这张图片，看看大家对这两种回答的看法。收到了很多网友的朋友，我精选了以下几条给大家品味一下：\n\n1. ChatGPT 有自己的人格，他就像一个中年油腻男，一本正经的胡说八道的样子，确实很强大。比那些老老实实实的回答的 AI 强多了；\n2. ChatGPT 是数学白痴，只要语义自洽逻辑合理，它可以无中生有一本正经胡扯。而且数据陈旧只有 2021 年之前的数据；\n3. ChatGPT 目前不太适合客观问题的解答，说白了它的核心就是“生成\/编造”，但是非常适合一些基于已有事实的创作，比如润色\/翻译文章之类的，新必应更像是传统 NLP \u002b 搜索引擎，其实对于搜索这个场景我觉得反而更靠谱一点；\n4. 新必应更好，ChatGPT 没联网而且有时候会捏造答案。新必应用了 ReAct prompt 会自动 search \u002b reason；\n5. ChatGPT 是一个发散思路的工具，然后具体的实施和工作，还会根据相关的关键词，交叉验证一下。但是新必应不能把一个功能详细合理的写出来，内容也有限制。现在还是使用 ChatGPT 进行辅助工作。\n\n关于 ChatGPT 和新必应大家有什么看法，欢迎在评论区回复。\n\n## 参考 {#reference}\n\n- [无需梯子！新 Bing ChatGPT 申请教程 by LiXin - ilx.notion.site](https:\/\/ilx.notion.site\/Bing-ChatGPT-by-LiXin-58dbdab242ed479780adab09a371c260)\n\n', '\/blog\/new-bing-chat\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">昨天我的新必应体验申请通过了，立马去体验了下，本文记录下我对新必应的最初印象。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/tsb-tips/">关于 TSB 你应该知道的事情</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/02/22</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('关于 TSB 你应该知道的事情', '如果你对服务网格（Service Mesh）和 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中很多疑惑。', '\n本文假设你熟悉服务网格和 Istio，对 Tetrate 出品的商业化服务网格管理工具 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中的一些困惑。\n\n本文中包含了：\n\n- 关于 TSB 的一些 FAQ\n- TSB 的一些基本资源对象\n- TSB 实现的一些细节\n\n## TSB FAQ\n\n笔者将罗列一些关于 TSB 的知识点，主要是关于它与 Istio 之间的不同点：\n\n1. TSB 全称 Tetrate Service Bridge，是 Tetrate 公司的旗舰产品，首发于 2018 年，目前版本是 1.7，这是一款商业化产品，你需要购买才能使用，如果想要了解更多或请求试用请在[这里](https:\/\/tetrate.io\/tetrate-service-bridge\/)登记；\n2. TSB 可以私有化部署也可以在 GKE、AWS、Azure、OpenShift、EKS Anywhere 等平台中单独或跨平台部署；\n3. TSB 并不是对 Istio 的改进版，它是在 Istio 之上建立的管理平面，它可以与 Istio 完全兼容，并适配最新版的 Istio；\n4. TSB 并不是 Kubernetes 管理平台，它不能用于管理 Kubernetes 中的资源；\n5. TSB 是基于 Istio、Envoy 和 Apache SkyWalking 构建；\n6. TSB 通过定义 Tenant、Workspace 等资源对象为 Istio 增加了多租户和多集群管理功能；\n7. 为了实现多集群服务网格的管理，TSB 中定义了一系列 Group 资源，如 Traffic、Security、Gateway 等，这些 CRD 最终将转化为 Istio 中的 CRD 应用到服务网格；\n8. TSB 定义了 Tier1Gateway CRD 实现了跨集群的二层网关；\n9. TSB 部署和管理比较复杂，Tetrate 即将推出轻量级的 Tetrate Service Express（TSE）简化服务网格管理；\n\n## TSB 中的资源对象 {#tsb-resources}\n\n图 1 展示了 TSB 的基本资源对象，其中只要分为五大类：\n\n- 为了实现多租户和多集群管理的资源对象，如 Tenant、Organization、Workspace 等；\n- 主要功能对象配置组，如 Traffic、Security、Gateway 等；\n- Istio 原生 CRD；\n- 角色和权限管理；\n- 其他扩展；\n\n![图 1：Tetrate Service Bridge 中的资源对象](tsb-crd.svg)\n\nTSB 是建立在 Istio 之上的，下表中列出了 TSB 中的可以通过 tctl 命令获取的资源对象，其中部分名称与 Kubernetes 中原生资源对象重复，但它们并不相同：\n\n| **名称**                    | **说明**                                                     |\n| --------------------------- | ------------------------------------------------------------ |\n| ApplicationAccessBindings   | 配置应用程序用户访问权限。                                   |\n| AccessBindings              | 为 TSB 中任何资源的用户分配访问角色的配置。                  |\n| AuthorizationPolicy         | 同 Istio 中的授权策略。                                      |\n| APIAccessBindings           | 配置 API 用户访问权限。                                      |\n| Application                 | 应用程序的配置，应用程序表示一组相互关联的服务逻辑分组，并公开一组实现完整业务逻辑的 API。 |\n| Cluster                     | Kubernetes 集群。要想将 Kubernetes 集群纳入 TSB 管理，首先需要声明 Cluster 添加，然后是部署 TSB Agent 和控制平面（包括 Istio、XCP、GitOps、OAP 等组件）。 |\n| DestinationRule             | Istio 原生 CRD，主要用来划分可路由的集群及负载均衡规则。     |\n| EnvoyFilter                 | Istio 原生 CRD，主要用来扩展 Envoy 的功能。                  |\n| EgressGateway               | 配置工作负载作为出口网关。                                   |\n| GatewayAccessBindings       | 配置网关组用户访问权限。                                     |\n| GatewayGroup                | 网关组。                                                     |\n| Gateway                     | 管理 TSB 中设置的网关，而非 Istio 中的原生 Gateway CRD。     |\n| IstioInternalAccessBindings | 为 Istio 内部组的用户分配访问角色的配置。                    |\n| IngressGateway              | 配置负载作为入口网关，类似于 Istio 中的原生 Gateway。        |\n| IstioInternalGroup          | 配置 Istio 内部的 TSB 资源。                                 |\n| OrganizationAccessBindings  | 配置组织用户访问权限。                                       |\n| Organization                | 组织。                                                       |\n| OrganizationSetting         | 组织的默认配置，如区域 Failover、安全、流量、网络配置等。    |\n| Metric                      | 运行时获取的服务度量。                                       |\n| Source                      | Sources 服务公开了管理来自资源的遥测源。                     |\n| PeerAuthentication          | Istio 原生 CRD，配置对等认证（配置 mTLS）。                  |\n| RequestAuthentication       | Istio 原生 CRD，配置请求认证（JWT 规则配置）。               |\n| ServiceAccount              | 不同于 Kubernetes 中的原生资源对象，TSB 自定义的服务账号配置。 |\n| SecurityAccessBindings      | 配置安全组用户访问权限。                                     |\n| Sidecar                     | 配置预安装的 Istio Sidecar。                                 |\n| ServiceEntry                | Istio 原生 CRD，添加服务对象。                               |\n| SecurityGroup               | 安全配置组。                                                 |\n| ServiceRoute                | 配置服务路由。                                               |\n| SecuritySetting             | 安全设置将配置应用于 SecurityGroup 或 Workspace 中的一组代理工作负载。当应用于 SecurityGroup 时，缺失的字段将从 Workspace 范围设置继承值 (如果有的话)。 |\n| ServiceSecuritySetting      | 安全组配置。                                                 |\n| Service                     | 注册中心中的服务，表示所有这些单独服务的聚合和逻辑视图，并提供聚合指标等高级功能。 |\n| Tier1Gateway                | TSB 一级网关配置，指定网关负载。                             |\n| TrafficAccessBindings       | 流量访问角色配置。                                           |\n| TrafficGroup                | 流量管理组。                                                 |\n| TenantAccessBindings        | 租户角色配置。                                               |\n| TenantSetting               | 租户配置。                                                   |\n| TrafficSetting              | 流量配置。                                                   |\n| VirtualService              | Istio 原生 CRD，配置流量路由。                               |\n| WorkspaceAccessBindings     | Workspace 角色配置。                                         |\n| WasmExtension               | 配置管理 Wasm 扩展。                                         |\n| WasmPlugin                  | Istio 原生 CRD，配置 Wasm 插件。                             |\n| Workspace                   | 划定工作空间。                                               |\n| WorkspaceSetting            | 配置工作空间。                                               |\n\n你可以使用 tctl 命令行工具来管理 TSB，它的使用方法与 kubectl 类似，上面的列表是使用 \u0060tctl get\u0060 命令可以列出的资源对象。实际上 TSB 中的资源对象不止这些，关于 TSB 中 API 资源的详细说明请参考 [TSB 文档](https:\/\/docs.tetrate.io\/service-bridge\/1.6.x\/en-us\/reference)。\n\n## TSB 架构 {#tsb-arch}\n\n我在上文中提到，TSB 是在 Istio 之上构建的管理平面，为 Istio 增加了多租户和多集群管理功能，TSB 的组件架构及其功能如图 2 所示。\n\n![图 2：TSB 组件架构图](tsb-arch.svg)\n\nTSB 的全局控制平面可以和管理平面部署在同一个 Kubernetes 集群中，也可以单独部署。\n\nTSB 管理平面的架构如图 3 所示。\n\n![图 3：TSB 管理平面架构图](tsb-management-plane.svg)\n\n管理平面与各个 Kubernetes 集群中的 Istio 联系，管理多集群环境下的服务网格。\n\nTSB 控制平面的架构如图 4 所示。\n\n![图 4：TSB 控制平面架构](tsb-control-plane.svg)\n\n为了实现跨集群的多租户管理，TSB 定义了一系列逻辑对象，如图 5 所示。\n\n![图 5：TSB 中的多租户管理层级](tsb-resource-hierarchy.svg)\n\n## 更多 {#more}\n\n如果您不熟悉服务网格和 Kubernetes 安全性，我们在 [Tetrate Academy](https:\/\/tetr8.io\/academy) 提供了一系列免费在线课程，可以让您快速了解 Istio 和 Envoy。\n\n如果您正在寻找一种快速将 Istio 投入生产的方法，请查看 [Tetrate Istio Distribution (TID)](https:\/\/tetr8.io\/tid)。TID 是 Tetrate 的强化、完全上游的 Istio 发行版，具有经过 FIPS 验证的构建和支持。这是开始使用 Istio 的好方法，因为您知道您有一个值得信赖的发行版，有一个支持您的专家团队，并且如果需要，还可以选择快速获得 FIPS 合规性。\n\n一旦启动并运行 Istio，您可能需要更简单的方法来管理和保护您的服务，而不仅仅是 Istio 中可用的方法，这就是 Tetrate Service Bridge 的用武之地。您可以[在这里](https:\/\/tetr8.io\/tsb)详细了解 Tetrate Service Bridge 如何使服务网格更安全、更易于管理和弹性，或[联系我们进行快速演示](https:\/\/tetr8.io\/contact)。 \n\n## 参考 {#refrence}\n\n- [TSB 简介 - tetrate.io](https:\/\/tetrate.io\/tetrate-service-bridge\/)\n- [TSB 文档 - docs.tetrate.io](https:\/\/docs.tetrate.io\/service-bridge\/)\n- [TSB API 参考 - docs.tetrate.io](https:\/\/docs.tetrate.io\/service-bridge\/1.6.x\/en-us\/reference)\n', '\/blog\/tsb-tips\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">如果你对服务网格（Service Mesh）和 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中很多疑惑。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/ocsp-stapling-for-istio-gateways/">Istio Gateway 中对证书撤销的支持</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/02/06</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio Gateway 中对证书撤销的支持', '这篇博客将向你介绍证书撤销的方式和 Istio 的解决方案。', '\n最近 Istio 社区正在处理 [Issue 17763](https:\/\/github.com\/istio\/istio\/issues\/17763)，以增加 Istio 对证书撤销的支持，目前该功能正在开发工程中，见 [PR #42859 - OSCP Stapling](https:\/\/github.com\/istio\/istio\/pull\/42859) 和 [OCSP Stapling for Istio Gateways](https:\/\/docs.google.com\/document\/d\/15wwYyVyOluubL2KIM89b2X8NFwyhMVxq2_I1MESrZdI\/edit#)。这篇博客将向你介绍证书撤销的方式和 Istio 的解决方案进展。\n\nIstio 使用 Envoy SDS 分发证书，一共有两种情形：\n\n- 分发内部证书，用于 mTLS，这种情况需要分别验证客户端和服务端的证书是否被撤销\n- 分发外部服务的证书给集群内的服务，用于向集群外的通信加密，此时集群内的服务相当于客户端，仅需验证服务端证书是否被撤销\n\n本文探讨的是第二种情形，即 Istio Gateway 的证书撤销，如下图所示：\n\n![Istio Gateway 的证书撤销示意图](cert-revoke.svg)\n\nCA 通过设置 TTL 控制证书的寿命，如果要提前结束证书可以将证书撤销，有两种方式撤销证书：\n\n1. 配置证书撤销列表（CRL）\n2. 在线证书状态协议（OCSP）\n\n## CRL（证书撤销列表）\n\nCRL（证书吊销列表）是一种用于管理和验证证书有效性的机制。它包含一个已被撤销的证书列表，颁发机构（CA）定期更新该列表。当验证证书的客户端（如浏览器）收到证书时，它会检查该证书是否在 CRL 中被列为已撤销，如果是，则该证书被视为无效。\n\nCRL 通常存储在颁发机构（CA）的服务器上，并可以通过互联网公开访问。验证证书的客户端（例如，浏览器）可以下载并检查 CRL 以确定证书是否有效。CRL 可以以多种格式（如 DER 或 PEM）存储，并通过 HTTP，LDAP 或其他协议发布，以便进行验证。\n\nCRL 文件通常是以二进制形式存储的，不是直接可读的文本文件。但是，可以使用工具（例如 OpenSSL）转换为其他格式，例如 PEM，以方便阅读。下面是一个名为 \u0060crl.pem\u0060 的 CRL 示例文件，以 PEM 格式表示：\n\n\u0060\u0060\u0060dockerfile\n-----BEGIN X509 CRL-----\nMIIBtjCBqwIBATANBgkqhkiG9w0BAQUFADBBMQswCQYDVQQGEwJVUzERMA8GA1UE\nCBMITmV3IFlvcmsxETAPBgNVBAcTCE5ldyBZb3JrMREwDwYDVQQKEwhNeSBDQTEQ\nMA4GA1UECxMHQ2VydGlmaWNhdGUxGDAWBgNVBAMTD01ZIEJ1c2luZXNzIENBMB4X\nDTA5MDUwMzE1MTQwMFoXDTEwMDUwMjE1MTQwMFqgLzAtMB8GA1UdIwQYMBaAFJ4f\n6Nz7Vuw\/NcZXG0U8O6OZ9XB0MAsGA1UdDwQEAwIFoDAdBgNVHQ4EFgQUU6G9fjRK\nop\u002bJU6vQPnnhxBxHtzUwDQYJKoZIhvcNAQEFBQADgYEAbYoLz7MnJ4ltIS\u002bnCquG\nN\/v\u002b8rE00\/N0pGzN\/dCv\/8t0W0tGTGr2zGRb0mv67MPOmWmHcZZq3sOxgEIp8T\u002bO\nOJxDCD\/xJN6hB0NgN\/Z0\u002bfX9hU6bL\/6zhwUy\/l51xddmSd5KKhJ7FmOh2Py5m9Au\n4fJh7w\u002bOLyjKV7rz55WKjvY=\n-----END X509 CRL-----\n\u0060\u0060\u0060\n\n使用 OpenSSL 将其转换为可读格式：\n\n\u0060\u0060\u0060bash\nopenssl crl -inform PEM -in crl.pem -noout -text\n\u0060\u0060\u0060\n\n输出结果为：\n\n\u0060\u0060\u0060\nCertificate Revocation List (CRL):\n        Version 2 (0x1)\n    Signature Algorithm: sha256WithRSAEncryption\n        Issuer: \/C=US\/ST=New York\/L=New York\/O=My CA\/OU=Certificate\/CN=My Business CA\n        Last Update: May 3 11:40:00 2009 GMT\n        Next Update: May 2 11:40:00 2010 GMT\n    Revoked Certificates:\n        Serial Number: 1 (0x1)\n            Revocation Date: May 3 11:40:00 2009 GMT\n\u0060\u0060\u0060\n\n**注意**：该 CRL 文件的列表中只保存了一个撤销证书。\n\nCRL 虽被广泛使用，但使用 CRL 文件来撤销证书存在以下几个缺点：\n\n1. **时效性**：CRL 文件必须定期更新，否则将无法识别近期撤销的证书；\n2. **可用性**：如果无法访问 CRL 服务器，则无法验证证书是否已被撤销；\n3. **效率**：CRL 文件随着证书数量的增加而变得越来越大，因此验证证书的过程可能会变慢；\n4. **安全性**：CRL 文件本身也需要安全保护，否则攻击者可能会篡改 CRL 以逃避撤销证书的限制；\n\n因此，现在有更高效和安全的证书撤销机制，例如 OCSP（Online Certificate Status Protocol），它可以实时验证证书的状态，并且不需要存储所有已撤销证书的列表。\n\n## OCSP Stapling\n\nOCSP Stapling（正式名称为 TLS 证书状态查询扩展）是一种 TLS（Transport Layer Security）扩展，用于证明证书的状态是有效的。它允许服务器预先检索证书状态信息，并将该信息“钉”到 TLS 证书中，以减少对证书颁发机构的依赖，并提高证书状态验证的效率。可代替 OCSP 来查询 X.509 证书的状态。服务器在 TLS 握手时发送事先缓存的 OCSP 响应，用户只需验证该响应的有效性而不用再向数字证书认证机构（CA）发送请求。详见[维基百科](https:\/\/en.wikipedia.org\/wiki\/OCSP_stapling)。\n\nOCSP 只适用于单个证书，而不是列表。客户端在收到证书后，与 CA 通信以检查撤销状态。响应可以是 \u0022good\u0022、\u0022revoked\u0022 或 \u0022unknown\u0022 之一。\n\n使用 OSCP Stapling 虽然省去了维护 CRL 的负担，但是它依然有以下几个缺点：\n\n1. **额外的资源开销**：CA 服务器需要不断地响应 OCSP 质询以确保证书的有效性，这将对服务器的 CPU 和网络带宽造成额外的开销；\n2. **可用性问题**：如果 OCSP 服务器不可用，则客户端将无法获得证书的有效性信息；\n3. **安全问题**：如果 OCSP 响应被篡改或服务器不安全，则证书的有效性信息可能被篡改，从而影响安全；\n4. **兼容性问题**：OCSP Stapling 不是所有浏览器都支持的功能，因此可能需要在旧浏览器上实现额外的兼容性。\n\nOCSP 的挑战是，它给 CA 带来了很大的负担，因为每个客户端都需要独立地获得证书的验证。总体而言，OCSP Stapling 可以提高证书验证的效率和安全性，但是也存在一些需要考虑的问题。因此，在采用该技术时需要综合考虑多方面的因素。\n\n## Istio 对 OSCP Stapling 支持\n\n很多 Web 服务器都支持 OSCP Stapling，云原生边缘代理 Envoy 也支持该功能，需要对 Envoy 进行以下配置：\n\n- 配置 [\u0060DownstreamTlsContext\u0060](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/api-v3\/extensions\/transport_sockets\/tls\/v3\/tls.proto#envoy-v3-api-msg-extensions-transport-sockets-tls-v3-downstreamtlscontext) 中的 \u0060oscp_staple_policy\u0060：\n  - \u0060LENIENT_STAPLING\u0060：OCSP 响应是可选的，此为默认值\n  - \u0060STRICT_STAPLING\u0060：OCSP 响应是可选的，但如果存在并且有效，就会使用。\n  - \u0060MUST_STAPLE\u0060: OCSP 响应是必需的\n- 配置 [\u0060TlsCertificate\u0060](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/api-v3\/extensions\/transport_sockets\/tls\/v3\/common.proto#envoy-v3-api-msg-extensions-transport-sockets-tls-v3-tlscertificate) 中的 \u0060oscp_staple\u0060，响应必须是 DER 编码的，只能通过文件名或 \u0060inline_bytes\u0060 提供。响应可能只与一个证书有关。\n\n目前 Envoy 已支持 OSCP Stapling，其作为 Istio 的数据平面和 Istio Gateway 中的代理，理论上 Istio 也可以支持该功能。不过 Istio 的 OSCP Stapling 证书撤销功能支持仍在进行中，详见 [PR #42859 - OSCP Stapling](https:\/\/github.com\/istio\/istio\/pull\/42859)。该功能的新进展将在本文中更新，请保持关注。\n', '\/blog\/ocsp-stapling-for-istio-gateways\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇博客将向你介绍证书撤销的方式和 Istio 的解决方案。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/">[译] 服务网格安全性优化最佳实践</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/02/01</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://tetrate.io/blog/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('服务网格安全性优化最佳实践', '本文推荐了服务网格安全性优化的一些最佳实践。', '\n这是 [服务网格最佳实践系列文章](https:\/\/tetrate.io\/blog\/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely\/) 中的第三篇，摘自 Tetrate 创始工程师 Zack Butcher 即将出版的新书 Istio in Production。\n\nIstio 就像一组乐高积木：它具有许多功能，可以按照你想要的任何方式进行组装。出现的结构取决于你如何组装零件。在 [上一篇中](..\/service-mesh-deployment-best-practices-for-security-and-high-availability\/)，我们描述了一种运行时拓扑结构，用于构建健壮、有弹性且可靠的基础架构。在本文中，我们将描述一组网格配置，以帮助在运行时实现稳健性、弹性、可靠性和安全性。\n\nIstio 在其所谓的 [根命名空间](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-root_namespace) 中支持全局默认配置 —— 默认在 \u0060istio-system\u0060。在根命名空间中发布的配置默认适用于所有服务，但在本地命名空间中发布的任何配置都会覆盖它。因此，一些配置应该在根命名空间中发布，并且不允许在其他任何地方发布（例如用于在传输中强制加密的 PeerAuthentication 策略）。其他配置应该在每个服务自己的命名空间中编写（例如 VirtualService 控制它的弹性设置）。\n\n我们看到的最成功的网格采用将网格本身隐藏在另一个界面后面：例如 Helm 模板、Terraform 或更高级的解决方案，例如 [Tetrate Service Bridge (TSB)](https:\/\/tetrate.io\/tetrate-service-bridge\/)。核心思想是只公开应用程序开发人员应该配置的一小部分网格功能，最好是使用他们理解的语言（例如，TSB 可以使用 [带注释的 OpenAPI 规范](https:\/\/docs.tetrate.io\/service-bridge\/1.6.x\/en-us\/quickstart\/apps) 进行配置）。首先，我们通常只向应用程序开发人员公开流量设置和授权。身份验证和遥测由各自的团队或代表他们的平台团队集中控制。[NIST SP800-204 系列](https:\/\/tetrate.io\/blog\/nist-standards-for-zero-trust-the-sp-800-204-series\/)，尤其是 [SP 800-204A](https:\/\/csrc.nist.gov\/publications\/detail\/sp\/800-204a\/final) 和 [SP 800-204B](https:\/\/csrc.nist.gov\/publications\/detail\/sp\/800-204b\/final)。Istio 项目站点也有一组 [最佳实践](https:\/\/istio.io\/latest\/docs\/ops\/best-practices\/)，也值得收藏。\n\n## 服务网格命名约定\n\n**建议**：为 Istio 资源开发和维护一致的命名方案，最好基于它们配置的服务或主机。\n\n**建议**：为跨集群的团队保持一致的名称。命名空间应该由一个团队拥有。\n\nIstio 资源应该根据它们配置的服务或主机来命名：\u0060ServiceEntry\u0060 添加 \u0060api.example.com\u0060 到网格的应该命名为 \u0060external-api-example-com\u0060；服务的 \u0060DestinationRule\u0060、\u0060VirtualService\u0060、\u0060PeerAuthentication\u0060 和 \u0060Authorization\u0060 策略也都应该有相同的名称。PCI 命名空间中的内部服务 Payments（应用程序代码中的 hostname \u0060payments.pci\u0060）应该被命名为 \u0060payment-pci\u0060，其所有的网格配置名称也应该匹配。这些命名方案并不是硬性规定，但你应该在你的组织内建立并坚持一个一致的惯例。\n\n这些资源应该全部发布在它们配置的服务的命名空间中，或者发布在 \u0060istio-system\u0060 命名空间中以进行网格范围的配置。外部服务通常发布到 \u0060istio-system\u0060 中并由中心团队（平台或安全团队）管理。\n\n我们建议跨集群的团队使用一致的名称：无论集群租户模型如何，命名空间都应由单个团队拥有（请参阅下一节）。\n\n## 服务网格全局设置\n\n**配置可见性**。Istio 有一个配置可见性的想法：配置可以默认应用于整个集群，或者它可以只应用于本地命名空间，甚至可以只应用于单个服务（选择对整个集群可见，或者只是特定的命名空间）。为了性能和安全，你应该将该字段默认为 \u0060exportTo\u0060 本地名称空间（“.”）。你应该在安装时为 [*Services*](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-default_service_export_to)、[*VirtualServices*](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-default_virtual_service_export_to) 和 [*DestinationRules*](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-default_destination_rule_export_to) 设置这个默认值。查看 Istio 的 [全局配置](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-default_service_export_to) 来配置这些默认值：\n\n\u0060\u0060\u0060yaml\napiVersion: install.istio.io\/v1alpha1\nkind: IstioOperator\nmetadata:\n name: controlplane\n namespace: istio-system\nspec:\n # profile: default\n # ...\n meshConfig:\n   defaultServiceExportTo:\n   - \u0022.\u0022# only the namespace the resource is published in\n   defaultVirtualServiceExportTo:\n   - \u0022.\u0022\n   # equivalent, just different YAML syntax\n   defaultDestinationRuleExportTo: [\u0022.\u0022]\n\u0060\u0060\u0060\n\n示例 1：默认全局设置\n\n**每个命名空间的 Sidecar 资源配置**。Istio 的 \u0060Sidecar\u0060 （API）资源控制 Istio 将哪些配置发送到每个命名空间中的 Sidecar。为了获得最佳性能和最低开销，你应该为每个命名空间管理一个配置，并管理 egress 部分以仅包括服务必须与之通信的主机。这将导致 Istio 向该命名空间中的 Envoy 实例发送更少的配置，从而减少它们的内存和 CPU 消耗。结合仅注册表出站流量策略（见下一条），Sidecar 资源还可以帮助限制攻击者通过 Envoy 的表面区域，因为不在 Sidecar 的 egress 部分的主机将是该 Envoy 实例的 \u0022出站流量\u0022。这本身并不是一个足够的安全策略（见下面的安全部分），而是增加了一个攻击者必须穿越的额外防御层。\n\n**编写明确的出站（egress）流量策略**。Istio 提供了一些选项来配置它如何处理网格中的服务，该服务试图与 Istio 未知的端点进行通信：[Outbound Traffic Policy](https:\/\/istio.io\/latest\/docs\/reference\/config\/istio.mesh.v1alpha1\/#MeshConfig-OutboundTrafficPolicy-Mode)。Istio 可以允许所有流量，也可以将流量限制在网格已知的服务上。你应该在安装时配置 Istio，只允许连接到注册表中的服务。此外，你应该将所有需要与之通信的外部服务建模为 Mesh 中的 ServiceEntries（例如，SaaS 服务的 DNS 解析等），使用 DestinationRules 来配置与它们通信的 TLS。这些外部服务应该由安全团队集中管理，或者由平台团队代表他们管理。\n\n## 运行时流量管理配置\n\n**为服务使用一致的全局名称，并使用 Istio 将它们映射到本地实例**。你应该使用一致的全局名称来访问服务。你可以使用 Istio 将这些全局名称映射到本地实例。例如，\u0060payments.tetrate.internal\u0060 可以被所有内部应用程序使用，而 Istio 可以用来将该名称映射到服务实例，例如“在 \u0060us-east-2\u0060 Kubernetes 集群中的 \u0060payments.default.svc.cluster.local\u0060 服务”。这种全局命名方案使开发人员可以像 SaaS 一样考虑所有服务，而无需仔细考虑运行时拓扑的细节，并且可以轻松地执行故障转移、金丝雀和跨集群路由等操作，作为你的网格使用成熟或组织需求演变。\n\n**在根配置中定义粗略的默认弹性设置**。你应该为网格中的所有服务定义粗略的超时、重试、熔断和异常值检测设置。你可以在根配置命名空间中使用 \u0060VirtualService\u0060 来实现此目的。各个团队应在其本地命名空间中指定自己的名称以覆盖默认值。\n\n**为应用程序团队提供简化的“低 \/ 中 \/ 高”弹性设置**。将网格的底层 API 隐藏在更高级别接口后面的系统中，为配置默认断路和异常值检测设置的应用程序开发人员提供简化的“低 \/ 中 \/ 高”旋钮很有价值，因为很多领域容易配置错误，导致该应用程序性能不佳。\n\n## 运行时安全配置\n\n以下安全建议来自我们为微服务应用程序建立美国安全标准的工作，该标准由美国国家标准与技术研究院（NIST）在 [SP 800-204 系列](https:\/\/tetrate.io\/blog\/nist-standards-for-zero-trust-the-sp-800-204-series\/) 中发布。[你可以在我们的综合指南](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/) 中阅读 NIST 针对微服务应用程序的所有安全建议。\n\n**最小控制**。运行时的零信任至少需要以下五个控制：\n\n1. **加密传输中的所有内容**：提供消息真实性和窃听保护（[SP 800-204，§MS-SS-4](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n2. **验证服务到服务的通信**：每个应用程序都应验证与之通信的应用程序的身份（[SP 800-204A，§SM-DR16；SP 800-204B，§APE-SR-3](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n3. **授权服务到服务访问**：每个应用程序都应使用其运行时身份授权与之通信的应用程序（[SP 800-204B，§SAUZ-SR-1](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n4. **验证最终用户身份**：每个请求都必须在服务调用图中的每个跃点进行身份验证（[SP 800-204B，§EAUN-SR-1，§EUAZ-SR-3](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n5. **授权最终用户访问资源**：对每种资源的每次访问都应获得授权，而不仅仅是在前门访问一次（[SP 800-204B，§EAUZ-SR-3](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n\nIstio 提供传输中的加密（我们在上面讨论了全局启用），以及可验证的服务身份 ([SPIFFE](https:\/\/tetrate.io\/blog\/why-would-you-need-spire-for-authentication-with-istio\/) ) 和服务到服务的访问控制 (Istio \u0060AuthorizationPolicy\u0060)。此外，它可以配置为代表应用程序（JWT、OIDC 令牌）验证某些形式的最终用户身份，最后 Istio 支持可插拔授权系统（Envoy 的 \u0060ext_authz\u0060）以强制最终用户访问资源。\n\n**安装限制性默认授权策略**。根据 [Istio 最佳实践](https:\/\/istio.io\/latest\/docs\/ops\/best-practices\/security\/#use-default-deny-patterns)，你应该安装一个不允许流量的默认授权策略，为每个服务发布对象创建 \u0060AuthorizationPolicy\u0060 对象以管理允许它们与之通信的对象（[SP 800-204B，SAUZ-SR-1](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。有助于实现这一目标的两个授权策略：\n\n\u0060\u0060\u0060yaml\napiVersion: security.istio.io\/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: deny-all-audit\n  namespace: istio-system\nspec:\n  action: AUDIT\n\u0060\u0060\u0060\n\n示例 2：\u0060IstioAuthorizationPolicy\u0060会拒绝所有流量，并审计记录它。你可能会运行这样的策略几周，以了解在启用强制执行之前你需要的策略。\n\n\u0060\u0060\u0060yaml\napiVersion: security.istio.io\/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: deny-all\n  namespace: istio-system\nspec:\n  {} # or action: ALLOW\n\u0060\u0060\u0060\n\n示例 3：拒绝所有流量的 Istio AuthorizationPolicy。或者，你可以创建一个允许但具有空规则集的策略，这与空主体相同。\n\n**默认情况下需要 mTLS 进行服务到服务通信**。通过在由安全或平台团队管理的根命名空间中配置 \u0060PeerAuthentication\u0060 资源，应将传输中的加密设置为严格（即 [需要 mTLS 才能与服务通信](https:\/\/tetrate.io\/blog\/how-istios-mtls-traffic-encryption-works-as-part-of-a-zero-trust-security-posture\/)）。网格外部的服务调用网格中的应用程序应该通过应用程序入口网关进行通信，它可以向外部服务提供简单的 TLS（甚至明文），因为它不太可能有证书来对网格执行 mTLS。网格内部的服务呼出应配置为使用简单的 TLS 或明文，并带有用于外部服务的 DestinationRule 的明文 ([NIST SP 800-204A, §SM-DR8](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/) )。\n\n**TLS 配置默认值**。Istio 开箱即用，具有良好的 TLS 设置（[TLS 最低版本 1.2，具有一组有限的密码套件](https:\/\/istio.io\/latest\/docs\/concepts\/security\/#mutual-tls-authentication)），但你可能需要根据你的环境对其进行调整（例如，在 [FedRAMP](https:\/\/www.fedramp.gov\/) 环境中遵守 [FIPS 140-3](https:\/\/csrc.nist.gov\/publications\/detail\/fips\/140\/3\/final) ）：\n\n- Envoy 支持通过配置 [网关](https:\/\/istio.io\/latest\/docs\/reference\/config\/networking\/gateway\/#ServerTLSSettings-cipher_suites) 为每个服务配置最低 TLS 版本和一组受支持的密码套件。\n- 如果可能，我们建议将 **TLS 1.3 作为最低版本** 执行（如果你只执行 mTLS Envoy-to-Envoy），并为需要较旧或安全性较低的 TLS 配置的外部流量使用网关。\n\n**为每个服务分配一个唯一的运行时身份，以促进表达性强、细粒度的授权策略并限制暴露于攻击**。为你正在部署的每个服务分配一个唯一的运行时标识。在 Kubernetes 中，不要在每个命名空间中使用默认的 Kubernetes 服务帐户，而是为每个命名空间中的每个服务分配一个唯一的服务帐户。授权策略只能在身份的粒度上轻松管理。当多个运行时组件共享相同的身份时，很难管理一个访问控制策略来表达你的预期访问权限，同时不允许使用共享身份的某些组件进行过于广泛的访问。这导致更大的表面积暴露给可能危及系统的一个组件的攻击者（[NIST SP 800-204A §SM-DR11，§SM-DR18](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n\n**将服务到服务的通信限制在本地命名空间**。默认情况下，服务间通信应限制在本地名称空间内。不幸的是，这不能写为根配置命名空间中的单个 AuthorizationPolicy。相反，可以将仅允许在本地命名空间中访问的默认 AuthorizationPolicy 模板化为默认值，并且应允许应用程序团队编写他们自己的更专业（受限）的策略（[NIST SP800-204B，§SAUZ-SR-1](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)）。\n\n## 下一步\n\n我们希望从我们多年帮助客户构建成功的服务网格实践的经验中获得的这些最佳实践将有助于促进你的部署。如果你还没有，请查看服务网格最佳实践系列中的其他帖子： \n\n- [第 1 部分：如何将服务网格作为安全模型的一部分，以分层形式将微服务安全与传统安全结合起来](\/trans\/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely\/)\n- [第 2 部分：服务网格安全性和高可用性部署最佳实践](\/trans\/service-mesh-deployment-best-practices-for-security-and-high-availability\/)\n\n如需全面了解 NIST 微服务安全标准，请 [下载我们的免费指南](https:\/\/tetrate.io\/tetrates-guide-to-federal-security-requirements-for-microservices\/)。\n\n### 接下来：多租户的服务网格最佳实践\n\n在我们关于服务网格最佳实践系列的下一篇文章中，我们将讨论我们看到客户正在努力解决的常见租赁决策点，并重点关注网格如何帮助促进这些决策。我们将涵盖的主题包括 Kubernetes 集群所有权、命名空间所有权、配置所有权，以及如何使用服务网格应用程序网关来缓解中断。\n', '\/trans\/optimize-traffic-management-and-security-with-these-service-mesh-best-practices\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文推荐了服务网格安全性优化的一些最佳实践。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/service-mesh-deployment-best-practices-for-security-and-high-availability/">[译] 服务网格安全性和高可用性部署最佳实践</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/01/30</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://tetrate.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('服务网格安全性和高可用性部署最佳实践', '本文强调的是控制平面应该如何部署在应用程序附近，入口应该如何部署以促进安全性和敏捷性，如何使用 Envoy 促进跨集群负载均衡，以及网格内部如何使用证书。', '\n这是 [服务网格最佳实践系列文章](https:\/\/tetrate.io\/blog\/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely\/) 中的第二篇，摘自 Tetrate 创始工程师 Zack Butcher 即将出版的书籍 Istio in Production。\n\n当涉及到在多集群的基础设施中部署服务网格时，有一些可移动的部分。这里主要想强调的是控制平面应该如何部署在应用程序附近，入口应该如何部署以促进安全性和敏捷性，如何使用 Envoy 促进跨集群负载均衡，以及网格内部如何使用证书。\n\n## 使服务网格控制平面与故障域保持一致\n\n**建议：围绕故障域部署松散耦合的控制平面以实现高可用性。**\n\n构建高可用性系统可能具有挑战性，而且通常成本很高。我们知道的一种经过验证的技术是围绕故障域构建。故障域是当关键系统发生故障时受影响的基础架构部分。我们构建可靠系统的基本方法是将系统跨越的故障域分组为多个独立的孤岛。最终系统的整体可靠性取决于我们可以使孤岛的独立程度。实际上，总是存在一些相互依赖性，将其最小化总是成本与可用性的权衡。\n\n在没有耦合故障域的情况下创建隔离孤岛的最简单方法是在每个孤岛中运行关键服务的独立副本。我们可以说这些副本是筒仓的本地副本 —— 它们共享相同的故障域。在云原生架构中，Kubernetes 集群形成了最自然的筒仓边界。Istio 是一项关键服务，因此我们在每个应用程序集群中运行一个 Istio 控制平面实例。换句话说，我们部署 Istio 使其故障域与你的应用程序的故障域保持一致。\n\n此外，我们确保 Istio 控制平面实例是松散耦合的，不需要直接与其他集群通信，从而最大限度地减少其与孤岛外部的通信。有关如何实现此目的的详细信息，请参阅下面的多集群部分。\n\n## 使用应用程序入口网关隔离每个应用程序的流量\n\n**建议：从每个应用程序或应用程序团队的网关（应用程序入口网关）开始，以帮助缓解共享中断。随着时间的推移你操作经验的增加，将应用程序入口合并到共享网关以优化成本。**\n\n虽然 Istio 默认附带共享 \u0060istio-ingressgateway\u0060，但我们不建议使用共享网关。大多数采用网格的团队都需要时间来构建实施共享网关模型所需的审查实践和操作，而没有共享中断的风险。特别是在 Istio 实施的早期，我们建议每个团队部署一个 Envoy 网关。我们称这些为应用程序入口网关。随着你获得操作经验，你可以开始将应用程序合并到共享网关上以优化成本。\n\n使用共享网关模型实现每个团队隔离的捷径是为每个团队分配一个单独的主机名。按主机名隔离的团队可以更安全地配置共享网关实例。然而，其他共同命运的中断风险仍然存在，例如入口代理部署的错误配置、嘈杂的邻居消耗资源和增加所有应用程序的延迟等。根据我们的经验，每个团队一个网关的方法会产生最快的影响，并且失败的机会最少，并且总体成本相对较低。\n\n我们期望成熟部署的最终状态是 80-20 的比例：大多数应用程序将通过共享网关接收流量，而一小部分高度关键或敏感的应用程序将保留专用网关。\n\n## 使用应用程序边缘网关在多个集群之间分配入口流量\n\n**建议：使用应用程序边缘网关为客户端提供单一地址，以供客户端使用并将流量分配到跨多个集群的应用程序入口网关。**\n\n![图 1：基于 Envoy 的应用程序边缘网关。](f1.png)\n\n我们经常看到客户需要跨多个集群分配入口流量。例如，他们可能希望启用蓝 \/ 绿基础设施升级，以促进跨区域故障转移，或者通过使用 Envoy 的 L7 功能将流量从单体迁移到微服务来实现扼杀模式。我们称这些为应用程序边缘网关。\n\n为了实现这个用例，我们将部署 Envoy—— 在专用的 Kubernetes 集群中或作为一组虚拟机 —— 来接收外部流量。这些 Envoy 实例将通过其 Kubernetes 入口或 VM VIP 将流量转发到你的应用程序。这与 ingress-per-team 方法协同工作：多集群网关为客户端提供一个单一地址以供使用，根据你的基础设施需要提供尽可能多的应用程序网关和集群。\n\n虽然此网关确实存在共享故障域，但其配置远比每个应用程序一个入口网关的配置简单。因此，作为共享基础架构运行起来更容易，也更安全。每个集群都有一个应用程序入口网关的共享应用程序边缘网关是一种强大而灵活的模型，用于在网格上部署和操作应用程序，还可以更轻松地操作底层基础设施。\n\n## 证书和公钥基础设施 (PKI) 的建议\n\n**建议：从你现有的企业根目录为网格 mTLS 创建一个中间签名证书。**\n\nIstio 使用常规 X.509 证书进行身份验证并在网格中启用传输加密。我们建议为现有企业根目录中的所有网格 mTLS 创建一个网格中间签名证书。如果每个环境都有一个根，请为每个环境创建一个网格中间签名证书。使用该网格中间颁发证书为每个 Istio 安装创建一个签名证书。我们建议创建一个网格中间签名证书，以便在任何特定环境中网格的整个 PKI 是一棵树，如果需要可以一起失效。成本是一些额外的证书管理，与控制平面签名证书相比，在管理网格中间签名证书的生命周期时需要更加小心。\n\n![图 2. Tetrate 推荐的将网格与现有 PKI 集成的方法：在环境（如 prod）中为 Istio 生成中间签名证书，使用它向该环境中的每个 Istio 控制平面实例颁发签名证书，并让 Istio 像往常一样向每个集群中的所有 pod 颁发工作负载（叶）证书。](f2.png)\n\nIstio 监视文件系统，并在检测到文件更改时重新加载其签名证书。因此，只要你有一个批准的机制来将秘密加载到 *istiod* pod 的文件系统中 —— 比如 *cert-manager*、Vault 的 *init-agent* 或 sidecar，或者只是存储在加密 *etcd* 中的普通旧 Kubernetes Secret—— 集成 Istio 进入你的 PKI 应该很容易。控制平面签名证书的轮换应由你的 PKI 自动执行。\n\nIstio 使用众所周知的密码学库：Istio 的内部 CA 使用 Golang 的密码学套件，Envoy（sidecar 和 ingress）使用 BoringSSL 进行证书验证和传输中的加密。通过 Tetrate 的开源 Istio 发行版 [Tetrate Istio Distro](https:\/\/tetr8.io\/tid) ，经过 FIPS 验证的控制平面和数据平面构建也作为 [Tetrate Istio 订阅](https:\/\/tetr8.io\/tis) 的一部分提供，因此你可能期望的所有 X.509 约束（基本约束，如 CA 和深度，开箱即用地支持和强制执行命名约束、策略约束等）。\n\n### 使用极短寿命的工作负载证书以轻松吊销\n\n**建议：使用 Istio 来自动化证书管理，以便设置极短的工作负载证书 TTL 变得切实可行，从而使 [证书撤销列表（CRL）](https:\/\/csrc.nist.gov\/glossary\/term\/certificate_revocation_list) 保持简短且易于管理。**\n\n在证书颁发和轮换（Istio 为你自动执行）之后，PKI 中最大的挑战是证书吊销。证书吊销是通过证书吊销列表实现的，通常 CRL 具有 24 小时的强制执行 SLA：添加到列表中的证书在吊销后最多 24 小时内可能会被基础设施视为有效。此外，由于吊销的证书必须在其整个生命周期 (TTL) 内保留在列表中，因此吊销列表会变得庞大而笨拙。\n\nIstio 提供的一个更好的解决方案是自动化证书管理，以便设置极短的工作负载证书 TTL 是切实可行的。默认情况下，Istio 附带 24 小时的工作负载证书 TTL。这足够短，大多数安全组织可以选择让受损的证书过期，而不是明确地撤销它们。而且，当你向 CRL 添加证书时，它只需要在那里停留很短的时间（因为我们不需要在 CRL 上保留过期的证书）。通过这种方式，网格有助于解决大多数组织面临的最痛苦的 PKI 问题：它颁发和吊销短期证书，这意味着吊销列表可以在需要时保持简短且易于管理。\n\n**注意**：由于网格使用 mTLS 证书作为身份，Istio 将 Envoy 配置为自动丢弃已建立的连接，以强制客户端和服务器在任何一方轮换证书时重新验证彼此。这是 Istio 实现中的设计决策，通常通过 Istio 的弹性功能对应用程序隐藏：对应用程序透明的自动重试重新建立连接。在网格中设置较短的证书 TTL 会强制这些重新连接更频繁地发生。值得注意的是，这种行为偶尔会中断一些期望长期 TCP 连接的应用程序。\n\n### 进一步的证书推荐\n\n你应该与你的安全团队协调，为你的网格颁发的证书建立适当的约束。我们推荐的一些常见约束如下。\n\n**证书生命周期 (TTL)**。请注意，只要证书是从同一个根颁发的，Istio 就支持控制平面签名证书和工作负载证书的零停机轮换。我们建议每个级别的证书生命周期如下：\n\n- 网格中间签名证书 1-3 年\n- 控制平面签名证书 3 个月\n- 工作负载证书需要 12-24 小时\n\nIstio 自动处理工作负载证书的轮换。这些证书上的短 TTL（少于 24 小时）有助于限制可能被盗的凭据进行时间限制攻击，还可以减少对 CRL 的需求。控制平面证书应按一个月的偏移轮换以确保平稳过渡 —— 换句话说，在 3 个月的 TTL 到期前 1 个月轮换控制平面签名证书。类似地，当网格中间签名证书还剩一半到三分之一的生命周期时轮换（一年 TTL 提前 3-4 个月，三年 TTL 提前 6-8 个月）。\n\n**基础（CA 和深度）**。控制平面签名证书应该只能颁发叶证书：用于工作负载识别的非签名证书。因此，应配置深度限制以防止控制平面签名证书颁发任何其他签名证书。\n\n网格中间签名证书需要创建控制平面签名证书，因此它应该配置一个深度，以便能够**在它下面创建一个级别的签名证书，而不是更多**。\n\n**名称约束**。Istio 颁发的工作负载证书不会填充 X.509 主体名称 (SN) 字段；网格身份验证依赖于作为主体备用名称 (SAN) 字段携带的 SPIFFE 身份。阅读 [SPIFFE 规范以获取有关验证和身份验证工作的信息](https:\/\/github.com\/spiffe\/spiffe\/blob\/main\/standards\/X509-SVID.md#4-constraints-and-usage)，以及 Istio 的 [文档](https:\/\/istio.io\/latest\/docs\/concepts\/security\/#istio-identity) 以了解 Istio 如何根据 SPIFFE 对身份进行编码。在为网格中间和控制平面签名证书编写名称约束时，请记住这一点。\n\n**密钥用法**。 \u0060keyCertSign\u0060 必须为网格中间签名证书和控制平面签名证书设置，但应为工作负载证书禁用。换句话说，网格中间和控制平面证书是签名证书，而工作负载证书不是。\n\n根据 SPIFFE 的建议，不应将签名证书用于传输中的加密，并且应配置密钥使用以防止它（通过加密约束）。\n\n**扩展密钥用法**。虽然此处没有具体要求，但 SPIFFE X.509 SVID 规范说明 \u0060id-kp-serverAuth\u0060 和 \u0060id-kp-clientAuth\u0060 应针对叶（工作负载）证书进行配置。\n\nSPIFFE 规范还推荐了 [各种证书约束](https:\/\/github.com\/spiffe\/spiffe\/blob\/main\/standards\/X509-SVID.md#4-constraints-and-usage)，尽管其中大部分上面已经约束了。\n\n## 下一步\n\n我们希望从多年帮助我们的客户充分利用服务网格的经验中收集的这些最佳实践将有助于促进你的部署。如果你还没有，请查看 [如何将服务网格作为安全模型的一部分，以分层形式将微服务安全与传统安全结合起来](\/trans\/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely\/) 这篇文章。\n\n接下来：服务网格运行时配置建议。在我们的下一篇文章中，我们将谈论：\n\n- 命名约定\n- 全局设置\n- 流量管理\n- 安全\n- 遥测\n\n敬请关注。\n', '\/trans\/service-mesh-deployment-best-practices-for-security-and-high-availability\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文强调的是控制平面应该如何部署在应用程序附近，入口应该如何部署以促进安全性和敏捷性，如何使用 Envoy 促进跨集群负载均衡，以及网格内部如何使用证书。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/why-you-should-learn-wasm/">为什么要学习 WebAssembly？</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/01/13</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e9%9a%8f%e7%ac%94"> 
             随笔
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('为什么要学习 WebAssembly？', '2023 年我决定学习一门新技术——WebAssembly。', '\n2023 年你有什么学习计划？我计划要学习一门新技术——WebAssembly！\n\n## 为什么要学习 WebAssembly？{#why}\n\n2019 年，Docker 创始人 Solomon Hykes 发布了一条推特在业界引起了轩然大波（见下面的推文），他说如果 2008 年 WebAssembly 和 WASI 就存在的话，他就没必要创建 Docker。一时间，关于 WebAssembly 取代 Docker 的讨论此起彼伏。也是从那时起，WebAssembly 正式进入我的视线。\n\n\u003cblockquote class=\u0022twitter-tweet\u0022\u003e\u003cp lang=\u0022en\u0022 dir=\u0022ltr\u0022\u003eIf WASM\u002bWASI existed in 2008, we wouldn\u0026#39;t have needed to created Docker. That\u0026#39;s how important it is. Webassembly on the server is the future of computing. A standardized system interface was the missing link. Let\u0026#39;s hope WASI is up to the task! \u003ca href=\u0022https:\/\/t.co\/wnXQg4kwa4\u0022\u003ehttps:\/\/t.co\/wnXQg4kwa4\u003c\/a\u003e\u003c\/p\u003e\u0026mdash; Solomon Hykes \/ @shykes@hachyderm.io (@solomonstre) \u003ca href=\u0022https:\/\/twitter.com\/solomonstre\/status\/1111004913222324225?ref_src=twsrc%5Etfw\u0022\u003eMarch 27, 2019\u003c\/a\u003e\u003c\/blockquote\u003e \u003cscript async src=\u0022https:\/\/platform.twitter.com\/widgets.js\u0022 charset=\u0022utf-8\u0022\u003e\u003c\/script\u003e\n\n到了 2021 年，网上突然多了很多关于 WebAssembly 的炒作文章，包括我长期关注的 Istio 也在当年发布的 1.12 版本开始支持 WebAssembly（见 [Istio 1.12 引入 Wasm 插件配置 API 用于扩展 Istio 生态](https:\/\/cloudnative.to\/blog\/istio-wasm-extensions-and-ecosystem\/)），通过引入 [WasmPlugin](https:\/\/istio.io\/latest\/docs\/reference\/config\/proxy_extensions\/wasm-plugin\/) API，使开发人员更方便扩展服务网格和网关。\n\n最近我看到一篇介绍 WebAssembly 在 2023 年有哪些新趋势的[文章](https:\/\/cloudnative.to\/blog\/webassembly-5-predictions-for-2023\/)，文章的作者 Matt Butcher 颇有来头，他是 WebAssembly Cloud 公司 Fermyon 的联合创始人和 CEO，也是 Helm、Brigade、CNAB、OAM、Glide 和 Krustlet 的原始创建者之一。通过他的介绍让我笃定，WebAssembly 是一门颇有前景的技术，是时候学习它了。\n\n## WebAssembly 的市场前景 {#prospect}\n\n更何况 WebAssembly 的应用领域越来越广，像 [WasmEdge](https:\/\/wasmedge.org\/) 这样的公司正在使用 Tensorflow 来突破可以使用 Wasm 运行的边界。[Fermyon](https:\/\/www.fermyon.com\/) 正在构建用于微服务的 WebAssembly 工具，而 [Vercel](https:\/\/vercel.com\/docs\/concepts\/functions\/edge-functions\/wasm)、[Fastly](https:\/\/docs.fastly.com\/products\/compute-at-edge)、[Shopify](https:\/\/shopify.engineering\/shopify-webassembly) 和 [Cloudflare](https:\/\/developers.cloudflare.com\/workers\/platform\/languages\/) 使用 WebAssembly 在边缘运行代码。[Figma](https:\/\/www.figma.com\/blog\/webassembly-cut-figmas-load-time-by-3x\/)（2022 年以 200 亿美元被 Adobe 公司收购）正在使用 WebAssembly 为其应用程序在浏览器中提供更高的性能，而他们的新母公司 [Adobe](https:\/\/web.dev\/ps-on-the-web\/) 正在使用 WebAssembly 将他们的桌面应用程序带到 Web。\n\n## 如何学习 WebAssembly？{#how-to-learn-wasm}\n\n为了学习 WebAssembly，我制定了以下学习目标：\n\n1. 了解 WebAssembly 的基本概念，包括它是什么、为什么要使用它、如何在浏览器中运行它；\n\n2. 学习 WebAssembly 的语言，这是一种类似于汇编语言的低级语言，可以编译成二进制文件；\n\n3. 使用工具将代码编译成 WebAssembly 格式；\n\n4. 在 JavaScript 中调用 WebAssembly 模块；\n\n5. 学习 WebAssembly 的其他特性，如内存管理、多线程和 WebAssembly System Interface（WASI）；\n\n6. 了解 WebAssembly 如何增强安全防护；\n\n7. 学习 WebAssembly 的最佳实践，如代码优化和调试；\n\n8. 在 Istio 中开发 WebAssembly 插件；\n\n9. 学习使用 WebAssembly 开发的开源项目；\n\n## WebAssembly 参考资料 {#materials}\n\n下面列出了一些有助于学习 WebAssembly 的参考资料，包括网站和图书：\n\n- [WebAssembly 官网](https:\/\/webassembly.org\/)\n- [WebAssembly 教程](https:\/\/developer.mozilla.org\/zh-CN\/docs\/WebAssembly)\n- WebAssembly 在线编译器\n- [WebAssembly 学习资源](https:\/\/webassembly.org\/getting-started\/developers-guide\/)\n- [《WebAssembly：权威指南：安全、快速和可移植的代码，第 1 版，2022 年 1 月》](https:\/\/www.amazon.com\/WebAssembly-Definitive-Guide-Safe-Portable\/dp\/1492089842\/)\n- [wazero: the zero dependency WebAssembly runtime for Go developers](https:\/\/wazero.io\/)\n\n## 总结 {#summary}\n\nWebAssembly 不仅是用于浏览器端有效弥补 JavaScript 缺陷的一门技术，凭借它的小巧、高效和可移植性在后端也会有很广泛的应用。2023 年，让我们一起来学习 WebAssembly 吧！我也会适时得在云原生社区中创建 Wasm 学习小组，欢迎大家[加入云原生社区](https:\/\/cloudnative.to\/community\/join\/)共同交流学习。\n\n## 参考 {#reference}\n\n- [Istio 1.12 引入 Wasm 插件配置 API 用于扩展 Istio 生态 - cloudnative.to](https:\/\/cloudnative.to\/blog\/istio-wasm-extensions-and-ecosystem\/)\n- [在 Istio 中引入 Wasm 意味着什么？- cloudnative.to](https:\/\/cloudnative.to\/blog\/importance-of-wasm-in-istio\/)\n- [2023 年 WebAssembly 技术五大趋势预测 - cloudnative.to](https:\/\/cloudnative.to\/blog\/webassembly-5-predictions-for-2023\/)\n', '\/blog\/why-you-should-learn-wasm\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">2023 年我决定学习一门新技术——WebAssembly。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/">
         ««
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a href="/blog/page/13/" class="page-link">
         «
       </a>
     </li>
     
     
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/12/" class="page-link">
             12
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/13/" class="page-link">
             13
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item page-item active ">
           <a href="/blog/page/14/" class="page-link">
             14
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/15/" class="page-link">
             15
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/16/" class="page-link">
             16
           </a>
         </li>
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
     
     
     <li class="page-item">
       <a href="/blog/page/15/" class="page-link">
         »
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/page/29/">
         »»
       </a>
     </li>
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      专栏
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(80)</span>
        </a>
      
        <a href="/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(42)</span>
        </a>
      
        <a href="/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(25)</span>
        </a>
      
        <a href="/categories/%e9%9a%8f%e7%ac%94" class="sidebar-item">
            <span>随笔</span>
            <span>(22)</span>
        </a>
      
        <a href="/categories/%e5%85%b6%e4%bb%96" class="sidebar-item">
            <span>其他</span>
            <span>(19)</span>
        </a>
      
        <a href="/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e4%b8%9a%e6%80%81" class="sidebar-item">
            <span>业态</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e4%ba%91%e5%8e%9f%e7%94%9f" class="sidebar-item">
            <span>云原生</span>
            <span>(14)</span>
        </a>
      
        <a href="/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%ae%89%e5%85%a8" class="sidebar-item">
            <span>安全</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%bc%80%e6%ba%90" class="sidebar-item">
            <span>开源</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e6%97%85%e8%a1%8c" class="sidebar-item">
            <span>旅行</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e5%b7%a5%e5%85%b7" class="sidebar-item">
            <span>工具</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7" class="sidebar-item">
            <span>可观测性</span>
            <span>(5)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      资料
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/%e5%87%ba%e7%89%88%e7%89%a9" class="sidebar-item">
            <span>出版物</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e7%94%b5%e5%ad%90%e4%b9%a6" class="sidebar-item">
            <span>翻译电子书</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e6%96%87%e6%a1%a3" class="sidebar-item">
            <span>翻译文档</span>
            <span>(7)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>翻译图书</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8e%9f%e5%88%9b%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>原创图书</span>
            <span>(2)</span>
        </a>
      
        <a href="/categories/%e6%95%99%e7%a8%8b%e6%89%8b%e5%86%8c" class="sidebar-item">
            <span>教程手册</span>
            <span>(2)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">联系</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">微信公众号</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">博客</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/building-private-ai-knowledge-base-anythingllm/">探索 AnythingLLM：借助开源 AI 打造私有化智能知识库</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/migrate-to-istio-telemetry-api/">从 MeshConfig 迁移到 Istio Telemetry API：提升网格观测性和灵活性</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/south-korea-trip/">韩国旅行回忆：首尔、釜山与仁川的真实体验</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">链接</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio 服务网格
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate 公司
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  云原生学院|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  云原生开源项目大全
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  云原生社区（中国）
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">教程</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes 基础教程
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/envoy-made-simple/" >
                  简明 Envoy 教程
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">通知</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/nist-sp-800-233-service-mesh-proxy-models/">资料分享：云原生应用服务网格代理模型的威胁分析指南</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/kubecon-china-2024-panel/">KubeCon China 2024（香港）</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/website-revamp-notice/">网站改版通知</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2024 Jimmy Song 保留所有权利</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />





<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
