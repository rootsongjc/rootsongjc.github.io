<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>博客 - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="专注开源技术、云原生与生活随笔的分享与思考。">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.129.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.595949bd12db88434115e2a1e70965cf2928cc646e73acc6437c4cbbc323f585.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/blog/" />
  <meta property="og:title" content="博客 | Jimmy Song" />
  <meta property="twitter:title" content="博客 | Jimmy Song" />

  
  <meta property="og:description" content="专注开源技术、云原生与生活随笔的分享与思考。" />
  <meta property="twitter:description" content="专注开源技术、云原生与生活随笔的分享与思考。" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">博客</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/book">资料</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">标签</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">公告</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">联系</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">关于</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">社区</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">视频 <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    <a class="nav-link" href="/en/blog/">English</a>
                    
                  
                
              
              
              
                
                  
                    
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>搜索</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>站内搜索</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="关闭"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="请输入搜索词" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="请输入搜索词">
        
        <div class="mt-4">
          <span>搜索类型: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">所有</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">原创</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">译文</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">资料</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">公告</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    博客
                </p>
                <p class="page-description">
                    专注开源技术、云原生与生活随笔的分享与思考。
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/securing-cloud-natives-most-important-use-cases/">[译] 云原生软件的关键用例安全保障之道</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/10</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e4%b8%9a%e6%80%81"> 
             业态
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.chainguard.dev/unchained/securing-cloud-natives-most-important-use-cases" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('云原生软件的关键用例安全保障之道', '云原生软件开发意味着为公有云和私有云的特性优化应用和环境。Chainguard 旨在提供不影响开发者体验的软件供应链安全工具，通过提供最小化、强化的容器镜像，让用户能够准确地扫描漏洞并消除 CVE 警报。本文介绍了 Chainguard Images 为 Istio 和 Cilium 这两个云原生基础技术提供的安全增强方案。', '\n摘要：云原生软件开发意味着为公有云和私有云的特性优化应用和环境。Chainguard 旨在提供不影响开发者体验的软件供应链安全工具，通过提供最小化、强化的容器镜像，让用户能够准确地扫描漏洞并消除 CVE 警报。本文介绍了 Chainguard Images 为 Istio 和 Cilium 这两个云原生基础技术提供的安全增强方案。\n\n---\n\n从根本上说，构建云原生软件意味着构建针对公共和私有云特性进行优化的应用程序和环境。开发云原生软件意味着管理一定程度的混乱，这不是所有类型的软件都需要的。\n\n这在新的一年尤其重要，我们可以预期产品将趋向于优先考虑开发者体验，并且平台工程的崛起。良好的工程和工具使开发者可以专注于构建和创新。已经构建的所有内部开发者平台和即将推出的平台都需要尽量将基础设施管理从开发者那里抽象出来。\n\n这正是 Chainguard 想要解决的问题领域，特别是在安全性和漏洞管理方面。我们致力于提供不妨碍开发者体验的工具，以确保软件供应链的安全。我们通过提供最小化、加固的容器镜像来实现这一目标，这使我们的用户可以获得准确的扫描结果，并将 CVE 收件箱警报降至零。\n\n### 推出新的 Chainguard Images 捆绑包，适用于 Cilium 和 Istio\n\n为了实现这一目标，我们密切关注最受欢迎的开源项目，但也关注那些如果经过加固，将为整个开源生态系统提供重要的安全改进的项目。为了在整个生态系统中产生最大的影响，我们应该帮助加固那些作为云原生软件基石的技术。Istio 和 Cilium 正是这样的明显示例，它们是云原生软件生态系统的基础构建模块之一。通过提供新的 Chainguard Images Istio 和 Cilium 捆绑包，我们为这些项目的用户提供了一个安全地将它们引入其构建流程的简便方法。\n\n在任何给定的供应链中，有些原材料比其他原材料更为基础。如果这些原材料得到了妥善保护，那么这将对后续工作产生连锁效应（或者如果你愿意的话，可以说是对整个堆栈产生上下游影响）。\n\nCilium 和 Istio 技术都涵盖了对 Kubernetes 环境具有基础作用的各种用例。Cilium 和 Istio 是两个流行的工具，通过提供流量路由、负载平衡、服务发现等功能来帮助解决这些挑战。这些功能对于确保 Kubernetes 和其他云原生软件部署的顺利、高效和安全运行至关重要。最终，构建云原生软件意味着创建专为云设计的应用程序，而 Cilium 和 Istio 在帮助开发者实现这一目标方面发挥了关键作用。\n\n### Istio 和 Cilium 在云计算中不可或缺的作用\n\n根据 2022 年的 [CNCF 年度调查](https:\/\/www.cncf.io\/reports\/cncf-annual-survey-2022\/)，Istio 是受访者中使用最广泛的服务网格，73% 的受访公司使用它。这种广泛的采用证明了 Istio 在解决各种服务管理挑战方面的有效性，使其成为现代企业寻求构建强大、安全和可扩展的微服务架构的重要工具。Istio 在 GitHub 上拥有超过 34,000 颗星星，使其成为 CNCF 中最受欢迎的项目之一。\n\n从同一份 CNCF 调查中，有 47% 的受访者将 Cilium 作为他们容器编排平台（如 Kubernetes）的首选网络插件。它也受欢迎于网络安全领域，有 43% 的受访者将其用于此目的。eBPF 的未来和力量是不可思议的，所有人都同意这一点。\n\n最近，我们推出了我们的新的 [Chainguard Images 目录](https:\/\/images.chainguard.dev\/)，这是一个公开可用的网站，用户可以在其中浏览我们库存中的所有镜像。在每个 Chainguard\n\n Image 列表中，你将找到有关安装、基础设施、签名和 SBOM 的源数据的相关信息，以及更多其他相关信息。Chainguard Images 目录还包括一个新的[安全通报](https:\/\/images.chainguard.dev\/security)页面，显示用户已知的 CVE，修复的状态等信息。\n\n如果你正在寻找更多关于如何在本地环境中启动 Chainguard Images Cilium 或 Istio 捆绑包的技术指导，请查看 Chainguard 工程师[Nghia Tran](https:\/\/www.linkedin.com\/in\/tcnghia\/)在 Chainguard Academy 上提供的这些方便入门的指南。非常感谢我们的朋友[Isovalent](https:\/\/www.linkedin.com\/in\/feroz-salam-372a4113\/)的 Feroz Salam 在 Cilium Images 方面给了我们帮助，以及多年来帮助我们的 Istio 的[John Howard](https:\/\/www.linkedin.com\/in\/-johnhoward\/)！以下是指南：\n\n- [开始使用 Istio](https:\/\/edu.chainguard.dev\/chainguard\/chainguard-images\/getting-started\/getting-started-istio\/)\n- [开始使用 Cilium](https:\/\/edu.chainguard.dev\/chainguard\/chainguard-images\/getting-started\/getting-started-cilium\/)\n\nChainguard Developer Images 提供了带有 \u0060:latest\u0060 和 \u0060:latest-dev\u0060 标签的免费镜像，供你在开发和测试环境中使用。在新的目录中，每个镜像页面还包括重要的特定于镜像的详细信息，例如版本标签和其他变体，如 FIPS 和长期支持（LTS），这些都适用于购买了这些解决方案的 Chainguard Images 客户。如果你想了解有关我们的 Production Images 中面向企业的功能的更多信息，请[联系我们的团队](https:\/\/www.chainguard.dev\/contact)。\n', '\/trans\/securing-cloud-natives-most-important-use-cases\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">云原生软件开发意味着为公有云和私有云的特性优化应用和环境。Chainguard 旨在提供不影响开发者体验的软件供应链安全工具，通过提供最小化、强化的容器镜像，让用户能够准确地扫描漏洞并消除 CVE 警报。本文介绍了 Chainguard Images 为 Istio 和 Cilium 这两个云原生基础技术提供的安全增强方案。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits/">[译] 如何使用 Calico 构建和管理 Kubernetes Cluster Mesh</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/09</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/kubernetes"> 
             Kubernetes
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.tigera.io/blog/deep-dive/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('如何使用 Calico 构建和管理 Kubernetes Cluster Mesh', '这篇文章介绍了集群网格的概念和优势，以及如何使用 Calico Open Source 的多种方法，实现跨集群的服务间通信和负载均衡。', '\nKubernetes 是构建灵活可扩展基础设施以运行动态工作负载的优秀解决方案。然而，随着我们的集群扩展，我们可能会面临同时扩展和管理多个集群的不可避免情况。这个概念可能会给我们的日常工作负载维护带来很多复杂性，并增加在所有环境中保持所有策略和服务的最新性的难度。在这种情况下，[集群网格](https:\/\/www.tigera.io\/blog\/using-calico-to-create-a-kubernetes-cluster-mesh-for-multi-cluster-environments\/) 可以在这些集群之间建立无缝的连接，并将工作负载集成到统一的网络环境中。\n\n集群网格是连接独立 Kubernetes 集群并在不同集群中的资源之间提供连接性的绝佳方式，以提供超出单个集群情况下可能的容错性和高可用性。\n\n在本博客文章中，我们将引导你完成构建多集群环境并建立集群网格所需的步骤，利用 Calico Open Source 的多功能能力。我们将探讨不同的方法，如顶级机架 (TOR) 和 overlay，以建立集群网格，解决不同环境提出的独特网络挑战。这是可能的，因为 Calico 提供了建立多集群环境的多种方法，灵活适应你的网络基础设施和特定要求。此外，我们还将介绍如何加入 DNS 连通性以增强集群间通信。\n\n随着你的集群网格环境扩展，我们将讨论涉及[联邦](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-federation\/)和使用 Calico Enterprise 进行多集群管理的下一步，以及涉及联邦集群。我们将展示 Calico 如何提供多集群管理平面，允许在集群间无缝实施安全性和可观测性。\n\n最后，我们将涉及到 Calico Enterprise 联邦身份如何在[多集群](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-networking\/kubernetes-multi-cluster\/)环境中弥合差距，提供一种统一的方式来定制网络策略，可以引用来自不同集群的资源并构建跨集群边界负载平衡请求的服务。\n\n## 什么是集群网格？\n\n集群网格连接了两个或多个独立集群内部资源。通常，每个 Kubernetes 集群将为内部资源分配私有 IP 地址，除非将**节点端口**或**负载均衡器**服务与它们关联，否则这些资源对任何外部实体都不可见。然而，将资源暴露给所有人可能会带来安全风险，并破坏你应该保持的[零信任安全](https:\/\/www.tigera.io\/learn\/guides\/zero-trust\/zero-trust-security\/)姿态，以保护你的环境。此外，它可以通过允许恶意用户利用漏洞并在关键服务中占据立足点来危及整个环境。\n\n在多集群环境中建立集群网格提供了一种安全机制，用于促进集群之间的直接通信。这种通信可以通过指定的集群服务或私有 IP 地址进行，确保强大而受控制的交互，同时减轻了将内部资源暴露给更广泛网络的风险。\n\n### 如何构建多集群环境并建立集群网格\n\n以下图片说明了 Calico 如何在你的集群之间建立集群网格连接。\n\n![](1.png)\n\nCalico 提供了不同的方式，你可以使用这些方式来构建多集群环境，从而提供了与你的网络基础设施和需求相匹配的灵活性。Calico 最好的部分是，在将两个集群连接在一起后，它将自动提供集群网格，你可以通过使用它们的内部集群服务和 IP 地址开始在不同的集群中使用资源。\n\n### 在扁平网络环境中的集群网格\n\n集群网格的配置可以根据底层基础设施的不同而变化，但其基本目的保持不变，实质上是用于建立独立集群之间的连接。\n\n例如，在我们的集群的参与节点通过广播域直接连接的环境中，我们可以通过传播内部路由到外部实体的路由协议来快速建立一个网格。这将允许我们广告内部路由，而无需通过**节点端口**服务将它们暴露给我们的目标服务。\n\n以下图片说明了扁平网络的常见设计：\n\n![](2.png)\n\n考虑观看我们的视频，[使用 Calico 开源进行 Kubernetes 的 BGP](https:\/\/www.youtube.com\/watch?v=PefluN8YM9o\u0026ab_channel=ProjectCalico)，以了解使用全网格方法部署集群网格的全面教程。\n\n### 在企业或云网络环境中的集群网格\n\n在复杂的网络环境中，例如云或企业网络，形成集群的基础设施资源通常分为单独的广播域。这是因为这些域中的每个实体都被要求通过网关来到达其目的地。但是，默认情况下，这个额外的跳跃（网关）需要了解我们在 Kubernetes 集群中创建的内部集群资源。因此，网关会丢弃前往这些内部资源的数据包，使简单的路由方法无法满足要求。\n\n以下图片说明了复杂网络环境的常见设计：\n\n![](3.png)\n\n既然我们知道了问题，让我们看看如何利用 Calico 来解决这个问题。\n\n为了在这样的环境中建立集群网格，我们可以使用两种方法：\n\n- 顶层机架（TOR）\n- overlay\n\n#### TOR 方法（推荐）\n\n在企业或云环境中，资源通常通过中间网关互连。通常，我们建议我们的客户使用 TOR，因为通过与云提供商自动建立路由传播机制来使你的集群了解你监管下的所有云资源，从而使你的集群具备高可用性。这也在云提供商的底层网络基础设施上发挥了作用，从而使你的集群在网络基础设施的支持下具备高可用性。\n\n假设你可以配置云网关并将其与像 Calico 这样的强大的[容器网络接口（CNI）](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-networking\/kubernetes-cni\/)配对，那么你可以利用 BGP 路由来建立集群网格。Calico BGP 集成提供了动态路由，允许你将内部 Pod 和集群 IP 路由传播到网络基础设施中的其他资源。\n\n以下图片说明了支持 BGP 的云环境的常见设计：\n\n![](4.png)\n\n在许多情况下，TOR（顶层机架）提高了高可用性和容错性。这种方法优化了网络流量分布，减轻了单点故障，并进一步增强了你的基础设施的可靠性和弹性。\n\n注意：要了解使用 TOR 方法部署集群网格的详细指南，请查看[此处](https:\/\/docs.tigera.io\/calico\/latest\/networking\/configuring\/bgp#top-of-rack-tor)的教程。\n\n#### IPIP overlay\n\n在某些情况下，你可能无法访问网关以修改其设置，或者它可能不支持 BGP 对等连接。在这种情况下，你可以使用 IPIP overlay 来封装流向目标集群的流量。overlay 网络允许网络设备在底层网络（称为底层）上相互通信，而底层网络不需要了解连接到 overlay 网络的设备。\n\n注意：如果你想了解更多关于 overlay 网络的信息，请单击[此处](https:\/\/docs.tigera.io\/calico\/latest\/about\/kubernetes-training\/about-networking#overlay-networks)。\n\n#### VXLAN overlay (Calico Enterprise)\n\n即将发布的 Calico Enterprise（3.18\u002b）版本将在多集群环境下启用 VXLAN 网络。这种方法的一个显著优势之一是能够使用身份感知策略来保护跨集群的流量（你将在接下来的联邦部分了解有关此功能的信息）。通过其多集群网络功能，Calico Enterprise 自动扩展 overlay 网络，以在集群之间建立 Pod IP 路由。\n\n在使用 VXLAN 的 Calico Enterprise 集群网格设置中，每个集群都充当本地集群和远程集群，本地集群配置为从远程集群的加密通道中检索端点和路由数据。VXLAN 集群网格提供了一种安全、可扩展和高效的解决方案，用于管理多集群网络，实现了跨集群的无缝通信和身份感知策略强制执行。\n\n注意：如果你想了解有关 VXLAN overlay 的更多信息，请单击[此处](https:\/\/www.tigera.io\/news\/tigera-introduces-powerful-enhancements-to-calico-open-source-and-calico-cloud-to-elevate-security-scalability-and-performance\/)。\n\n以下图片说明了没有 BGP 能力的云环境的常见设计：\n\n![](5.png)\n\n注意：要了解使用 TOR 方法部署集群网格的全面指南，请查看[此教程](https:\/\/youtu.be\/rv-DnExi6SM?t=2287)。\n\n### DNS 连接\n\n在建立多集群之后，各个集群可以在 IP 级别进行通信。然而，根据你的网络规模以及 Kubernetes IP 地址的性质，这些地址可以随时动态更改，因此你需要实现一种更容易建立这些集群之间连接的方式。域名解析可以成为你的集群网格的重要补充，允许更容易进行集群间通信。\n\n在大多数 Kubernetes 部署中，CoreDNS 作为负责解析集群域名的主要工作负载。要将 DNS 与集群网格无缝集成，只需对 CoreDNS 配置映射进行简单的修改即可。具体来说，你需要将其他集群的 CoreDNS 内部服务 IP 添加为转发器到你的配置中。\n\n这个简单的调整使你的集群能够通过向其他集群发送查询来解析名称，并检索所需资源的相应 IP 地址。这种集成大大简化了集群网格内的通信，增强了整体连通性，并提高了管理效率。\n\n注意：考虑观看[此视频](https:\/\/youtu.be\/rv-DnExi6SM?t=2574)以了解有关 DNS 连接的全面教程。\n\n## 联邦和多集群管理（下一步）\n\n随着你的环境扩展，你可能会遇到多个团队必须同时在所有集群上工作的情况。多集群管理（MCM）通常解决的一个常见问题是以集中的方式处理来自不同集群的对象，包括网络策略、Pod、[合规性](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-compliance\/)报告、可观测性和安全日志。\n\n虽然从技术上讲，可以通过 kubectl 为每个集群手动创建策略、网络集和其他资源，但这种方法会在你的日常维护任务中引入相当复杂性，并可能为意外的凭据泄漏开辟一条途径。此外，与我们在前一节中探讨的类似，它反映了没有良好结构的多集群环境所面临的挑战，特别是在集群管理、网络、故障排除和可观测性方面。\n\n### 使用 Calico Enterprise 进行多集群管理\n\nCalico Enterprise 提供了一个 MCM 平面，通过在这些集群之间建立安全连接，实现了多集群的安全和可观测性。该架构还支持跨集群联邦[网络策略](https:\/\/www.tigera.io\/learn\/guides\/kubernetes-security\/kubernetes-network-policy\/)资源，并为真正的集中式管理、可观测性和集群维护奠定了基础。\n\n以下图像是列出所有已连接集群的 MCM 页面的示例。\n\n![](6.png)\n\nMCM 的安全功能不仅限于集群的网络方面。由于 MCM 完全集成了 Kubernetes 基于角色的访问控制（RBAC），你可以制定授权，允许用户仅查看他们需要查看的信息。\n\n注意：使用[这个](https:\/\/www.tigera.io\/tutorials\/?_sft_tutorial_product=calico-enterprise)实际操作的工作坊来了解更多关于多集群管理的信息。\n\n### 利用 Calico Enterprise 的联邦身份和统一策略执行\n\nCalico Enterprise 联邦将工作负载和服务端点与在集群之间共享的唯一身份关联起来。\n\n联邦身份可以与网络安全策略关联，以创建引用位于不同集群中的端点的唯一资源，从而实现对集群间安全的无缝控制。\n\n此外，通过联邦服务，你可以发现并与位于不同集群中的远程 Pod 互动。这两个关键功能使得可以创建精确、细粒度的安全控制，加强了跨多个集群的整体安全姿态。\n\n![](7.png)\n\n通过实施联邦层和策略，你可以灵活地定义网络安全策略，这些策略可以普遍适用于所有集群，也可以专门针对一组定义的集群。这种方法提供了一种有效的手段，以在扩展部署以包括多个集群的同时扩展安全措施。通过将这些安全控制扩展到现有和新的集群，你有效地减少了策略的重复和简化了从创建到维护的整个过程。\n\n## 结论\n\n总结一下，集群网格连接不同 Kubernetes 集群中的内部资源。Calico 的灵活集群网格设置为在任何环境中连接到多个集群提供了构建块。\n\nCalico Enterprise MCM、联邦和联邦策略强制执行成为多集群架构的缺失环节，允许无缝通信，同时优先考虑安全性。Calico 在这个领域的能力使你能够无缝提供多集群管理、可观测性、联邦服务和身份，从而使你的组织能够自信而高效地应对现代网络的复杂性。随着组织的继续扩展和扩大规模，整合这些策略将在塑造多集群环境的未来中发挥关键作用。\n', '\/trans\/what-is-a-kubernetes-cluster-mesh-and-what-are-the-benefits\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇文章介绍了集群网格的概念和优势，以及如何使用 Calico Open Source 的多种方法，实现跨集群的服务间通信和负载均衡。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/cilium-gateway-api/">[译] 使用 Cilium 实现 Gateway API 指南</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/04</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%85%b6%e4%bb%96"> 
             其他
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://blog.ogenki.io/post/cilium-gateway-api/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('使用 Cilium 实现 Gateway API 指南', '这篇文章介绍了如何使用 Cilium 部署和配置 Gateway API，一个新的服务网格 API，用于管理 Kubernetes 中的服务间通信。文章详细说明了 Gateway API 的概念和组件，以及如何使用 Cilium 的特性和工具，实现高效和灵活的路由策略。', '\n在 Kubernetes 上部署应用程序后，通常的下一步是让用户可以访问它。我们通常使用[**Ingress 控制器**](https:\/\/kubernetes.io\/docs\/concepts\/services-networking\/ingress-controllers\/)，例如 Nginx、Haproxy、Traefik 或来自云提供商的控制器，来引导传入的流量到应用程序，管理负载平衡、TLS 终止等等。\n\n然后，我们必须从众多[可用的选项](https:\/\/kubernetes.io\/docs\/concepts\/services-networking\/ingress-controllers\/) 中进行选择。Cilium 是其中一个相对较新的选项，旨在处理所有这些网络方面的问题。\n\n[**Cilium**](https:\/\/cilium.io\/) 是一个基于 eBPF 的开源网络和安全解决方案，其采用速度增长迅猛。它可能是提供最多功能的网络插件之一。我们不会涵盖所有功能，但其中一个功能涉及使用[**Gateway API**](https:\/\/gateway-api.sigs.k8s.io\/) (\u0060GAPI\u0060) 管理传入流量。\n\n## 我们的目标\n\n- 准确了解 **Gateway API** 是什么，以及它如何代表从 \u0060Ingress\u0060 API 进化而来。\n- 演示以 GitOps 方式部署的真实场景。\n- 当前的限制和即将推出的新功能。\n\n{{\u003ccallout note 提示\u003e}}\n\n本文中执行的所有步骤都来自这个[**git 存储库**](https:\/\/github.com\/Smana\/cilium-gateway-api)。\n\n我鼓励你探索它，因为它远远超出了本文的范围：\n\n- 使用启用了 kube-proxy 替代并具有专用 Daemonset 用于 \u0060Envoy\u0060 的 \u0060Cilium\u0060 配置的 **EKS** 集群的安装。\n- 提出了具有依赖关系管理和我认为非常高效的 DRY 代码的 \u0060Flux\u0060 结构。\n- 简化了用于平台组件的 IAM 权限管理的 \u0060Crossplane\u0060 和 [IRSA](https:\/\/docs.aws.amazon.com\/eks\/latest\/userguide\/iam-roles-for-service-accounts.html) 组合。\n- 使用 \u0060External-DNS\u0060 和 \u0060Let\u0027s Encrypt\u0060 自动管理域名和证书。\n\n这个想法是只需几分钟内设置好一切，只需一个命令行。\n\n{{\u003c\/callout\u003e}}\n\n## 介绍 Gateway API\n\n正如前面提到的，有许多**Ingress 控制器**选项，每个都有其特定性和特殊功能，有时会使它们的使用变得复杂。此外，Kubernetes 中传统的 \u0060Ingress\u0060 API 具有非常有限的参数。一些解决方案甚至创建了自己的[CRDs](https:\/\/kubernetes.io\/docs\/concepts\/extend-kubernetes\/api-extension\/custom-resources\/)（Kubernetes 自定义资源），而其他解决方案则使用 \u0060annotations\u0060 来克服这些限制。\n\n这就是**Gateway API**的用武之地！实际上，这是一种**标准**，允许声明高级网络功能，而无需对底层控制器进行特定扩展。而且，由于所有控制器都使用相同的 API，因此可以在不改变配置的情况下从一个解决方案切换到另一个解决方案（Kubernetes 清单描述了如何路由传入流量）。\n\n在我们将要探讨的概念中，GAPI 引入了一个精细的授权模型，定义了具有不同权限的**显式角色**（有关 GAPI 安全模型的更多信息，请参阅[这里](https:\/\/gateway-api.sigs.k8s.io\/concepts\/security-model\/#roles-and-personas)）。\n\n值得注意的是，该项目由[sig-network-kubernetes](https:\/\/github.com\/kubernetes\/community\/tree\/master\/sig-network)工作组推动，还有一个 Slack [频道](https:\/\/kubernetes.slack.com\/archives\/CR0H13KGA)，你可以在需要时联系他们。\n\n让我们看看在实践中如何使用 GAPI 与 Cilium！\n\n## 先决条件\n\n在本文的其余部分，我们假设已部署了一个 EKS 集群。如果你没有使用[演示存储库中建议的方法](https:\/\/github.com\/Smana\/cilium-gateway-api\/tree\/main\/terraform\/eks)作为本文的基础，那么有一些**要检查的要点**，以便使用 GAPI。\n\n此处描述的安装方法基于 \u0060Helm\u0060，所有的 \u0060values\u0060 可以在[这里](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/terraform\/eks\/helm_values\/cilium.yaml)查看。\n\n- 在[Gateway API](https:\/\/github.com\/kubernetes-sigs\/gateway-api\/tree\/main\/config\/crd)存储库中**安装**可用的 \u0060CRDs\u0060。\n\n  {{\u003ccallout note 注意\u003e}}\n\n  如果 Cilium 设置为支持 \u0060GAPI\u0060（见下文），并且缺少 CRDs，则它将无法启动。在[演示存储库](https:\/\/github.com\/Smana\/cilium-gateway-api)中，**GAPI CRDs**在集群创建期间安装一次，以便 Cilium 可以启动，然后由 Flux 管理。\n\n  {{\u003c\/callout\u003e}}\n\n- 使用 Cilium 和 \u0060eBPF\u0060 的网络转发功能**替换** \u0060kube-proxy\u0060。\n\n  \u0060\u0060\u0060yaml\n  kubeProxyReplacement: true\n  \u0060\u0060\u0060\n\n- **启用** Gateway API 支持。\n\n  \u0060\u0060\u0060yaml\n  gatewayAPI:\n    enabled: true\n  \u0060\u0060\u0060\n\n- **检查**安装。为此，你需要安装名为 \u0060cilium\u0060 的命令行工具。我个人使用 [asdf](https:\/\/blog.ogenki.io\/post\/asdf\/asdf\/)：\n\n  \u0060\u0060\u0060console\n  asdf plugin-add cilium-cli\n  asdf install cilium-cli 0.15.7\n  asdf global cilium 0.15.7\n  \u0060\u0060\u0060\n\n  以下命令允许确保所有组件都正常运行：\n\n  \u0060\u0060\u0060console\n  cilium status --wait\n     \/¯¯\\\n  \/¯¯\\__\/¯¯\\    Cilium:             OK\n  \\__\/¯¯\\__\/    Operator:           OK\n  \/¯¯\\__\/¯¯\\    Envoy DaemonSet:    OK\n  \\__\/¯¯\\__\/    Hubble Relay:       disabled\n     \\__\/       ClusterMesh:        disabled\n  \n  Deployment             cilium-operator    Desired: 2, Ready: 2\/2, Available: 2\/2\n  DaemonSet              cilium             Desired: 2, Ready: 2\/2, Available: 2\/2\n  DaemonSet              cilium-envoy       Desired: 2, Ready: 2\/2, Available: 2\/2\n  Containers:            cilium             Running: 2\n                        cilium-operator    Running: 2\n                        cilium-envoy       Running: 2\n  Cluster Pods:          33\/33 managed by Cilium\n  Helm chart version:    1.14.2\n  Image versions         cilium             quay.io\/cilium\/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2\n                        cilium-operator    quay.io\/cilium\/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2\n                        cilium-envoy       quay.io\/cilium\/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2\n  \u0060\u0060\u0060\n\n  最后，你可以通过运行以下命令来检查是否启用了 Gateway API 支持：\n\n  \u0060\u0060\u0060console\n  cilium config view | grep -w \u0022enable-gateway-api\u0022\n  enable-gateway-api                                true\n  enable-gateway-api-secrets-sync                   true\n  \u0060\u0060\u0060\n\n  你还可以运行以下端到端测试：\n\n  \u0060\u0060\u0060console\n  cilium connectivity test\n  \u0060\u0060\u0060\n\n  但是，此命令（\u0060connectivity test\u0060）当前在启用 Envoy 作为 DaemonSet 时会抛出错误。([Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/28057))。\n\n{{\u003ccallout note 提示\u003e}}\n  **Envoy 作为 DaemonSet**\n\n  默认情况下，Cilium 代理还在同一 Pod 中运行 \u0060Envoy\u0060，并委托给它级别 7 的网络操作。从版本 \u0060v1.14\u0060 开始，可以将 Envoy 单独部署，这带来了一些好处：\n\n  - 如果修改\/重新启动一个组件（无论是 Cilium 还是 Envoy），都不会影响另一个组件。\n  - 更好地分配资源给每个组件以优化性能。\n  - 在某个 Pod 被攻击的情况下限制攻击面。\n  - Envoy 日志和 Cilium 代理日志不会混合在一起。\n\n  你可以使用以下命令来检查此功能是否已启用：\n\n  \u0060\u0060\u0060console\n  cilium status\n      \/¯¯\\\n   \/¯¯\\__\/¯¯\\    Cilium:             OK\n   \\__\/¯¯\\__\/    Operator:           OK\n   \/¯¯\\__\/¯¯\\    Envoy DaemonSet:    OK\n   \\__\/¯¯\\__\/    Hubble Relay:       disabled\n      \\__\/       ClusterMesh:        disabled\n  \u0060\u0060\u0060\n\n  [更多信息](https:\/\/isovalent.com\/blog\/post\/cilium-release-114\/#h-envoy-daemonset)。\n{{\u003c\/callout\u003e}}\n\n## 入口点：GatewayClass 和 Gateway\n\n![网关](gateway.jpg)\n\n一旦满足先决条件，我们就可以访问多个元素。我们可以利用 Gateway API CRDs 定义的自定义资源。而且，在安装 Cilium 后，一个 \u0060GatewayClass\u0060 立即可用。\n\n\u0060\u0060\u0060console\nkubectl get gatewayclasses.gateway.networking.k8s.io\nNAME     CONTROLLER                     ACCEPTED   AGE\ncilium   io.cilium\/gateway-controller   True       7m59s\n\u0060\u0060\u0060\n\n在 Kubernetes 集群上，你可以配置多个 \u0060GatewayClasses\u0060，从而能够使用不同的实现。例如，我们可以通过在 \u0060Gateway\u0060 配置中引用 GatewayClass 来使用 \u0060Linkerd\u0060。\n\n\u0060Gateway\u0060 是允许触发在云提供商中创建负载均衡组件的资源。\n\n这是一个简单的示例：[apps\/base\/echo\/gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/gateway.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: Gateway\nmetadata:\n  name: echo-gateway\n  namespace: echo\nspec:\n  gatewayClassName: cilium\n  listeners:\n    - protocol: HTTP\n      port: 80\n      name: echo-1-echo-server\n      allowedRoutes:\n        namespaces:\n          from: Same\n\u0060\u0060\u0060\n\n在 AWS（EKS）上，配置 \u0060Gateway\u0060 时，Cilium 会创建一个类型为 \u0060LoadBalancer\u0060 的 \u0060Service\u0060。然后，另一个控制器（[AWS Load Balancer Controller](https:\/\/kubernetes-sigs.github.io\/aws-load-balancer-controller)）处理云负载均衡器（[NLB](https:\/\/docs.aws.amazon.com\/elasticloadbalancing\/latest\/network\/introduction.html)）的创建。\n\n\u0060\u0060\u0060console\nkubectl get svc -n echo cilium-gateway-echo\nNAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE\ncilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395\/TCP   2m58s\n\u0060\u0060\u0060\n\n值得注意的是，负载均衡器地址也与 \u0060Gateway\u0060 相关联。\n\n\u0060\u0060\u0060console\nkubectl get gateway -n echo echo\nNAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE\necho   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m\n\u0060\u0060\u0060\n\n## 路由规则：HTTPRoute\n\n### 基本规则\n\n![HTTPRoute](httproute.jpg)\n\n简而言之，上面的图表可总结为几句话：\u0060HTTPRoute\u0060 允许通过引用 Gateway 并定义所需的路由参数来配置到服务的路由。\n\n{{\u003ccallout note 提示\u003e}}\n**Kyverno**\n\n截止目前，无法配置由 \u0060Gateways\u0060 生成的服务的注释（[Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/25357)）。已提出一种解决方法，即在创建 \u0060Gateway\u0060 后立即修改由 \u0060Gateway\u0060 创建的服务。\n\nKyverno 是一种确保配置符合最佳实践和安全要求的工具。我们在这里仅仅使用它来轻松描述[突变](https:\/\/kyverno.io\/docs\/writing-policies\/mutate\/)规则。\n\n[security\/mycluster-0\/echo-gw-clusterpolicy.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/security\/mycluster-0\/echo-gw-clusterpolicy.yaml)\n\n\u0060\u0060\u0060yaml\nspec:\n  rules:\n    - name: mutate-svc-annotations\n      match:\n        any:\n          - resources:\n              kinds:\n                - Service\n              namespaces:\n                - echo\n              name: cilium-gateway-echo\n      mutate:\n        patchStrategicMerge:\n          metadata:\n            annotations:\n              external-dns.alpha.kubernetes.io\/hostname: echo.${domain_name}\n              service.beta.kubernetes.io\/aws-load-balancer-scheme: \u0022internet-facing\u0022\n              service.beta.kubernetes.io\/aws-load-balancer-backend-protocol: tcp\n          spec:\n            loadBalancerClass: service.k8s.aws\/nlb\n\u0060\u0060\u0060\n\n因此，服务 \u0060cilium-gateway-echo\u0060 将添加 AWS 控制器的注释，以及一个允许自动 DNS 记录配置的注释。\n{{\u003c\/callout\u003e}}\n\n[apps\/base\/echo\/httproute.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/httproute.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n  parentRefs:\n    - name: echo\n      namespace: echo\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n\u0060\u0060\u0060\n\n上面使用的示例非常简单：所有请求都会转发到 \u0060echo-1-echo-server\u0060 服务。\n\n\u0060parentRefs\u0060 指示使用哪个 \u0060Gateway\u0060，然后在 \u0060rules\u0060 部分定义了路由规则。\n\n路由规则还可以基于 \u0060path\u0060。\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  hostnames:\n  - foo.bar.com\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \/login\n\u0060\u0060\u0060\n\n或者基于 HTTP 标头\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  rules:\n  - matches:\n      headers:\n      - name: \u0022version\u0022\n        value: \u00222\u0022\n...\n\u0060\u0060\u0060\n\n让我们检查服务是否可访问。\n\n\u0060\u0060\u0060console\ncurl -s http:\/\/echo.cloud.ogenki.io | jq -rc \u0027.environment.HOSTNAME\u0027\necho-1-echo-server-fd88497d-w6sgn\n\u0060\u0060\u0060\n\n正如你所看到的，该服务以 HTTP 方式暴露，没有证书。让我们尝试解决这个问题。\n\n### 配置 TLS 证书\n\n有多种方法可以使用 GAPI 配置 TLS。在这里，我们将使用最常见的情况：HTTPS 协议和在 Gateway 上终止 TLS。\n\n假设我们想要配置之前使用的域名 \u0060echo.cloud.ogenki.io\u0060。配置主要通过配置 \u0060Gateway\u0060 来完成。\n\n[apps\/base\/echo\/tls-gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/tls-gateway.yaml)\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: Gateway\nmetadata:\n  name: echo\n  namespace: echo\n  annotations:\n    cert-manager.io\/cluster-issuer: letsencrypt-prod\nspec:\n  gatewayClassName: cilium\n  listeners:\n    - name: http\n      hostname: \u0022echo.${domain_name}\u0022\n      port: 443\n      protocol: HTTPS\n      allowedRoutes:\n        namespaces:\n          from: Same\n      tls:\n        mode: Terminate\n        certificateRefs:\n          - name: echo-tls\n\u0060\u0060\u0060\n\n这里的关键点是引用一个包含名称为 \u0060echo-tls\u0060 的证书的密钥。这个证书可以手动创建，但是为了本文，我选择使用 **Let\u0027s Encrypt** 和 \u0060cert-manager\u0060 来自动化这个过程。\n\n{{\u003ccallout note 提示\u003e}}}\n**cert-manager**\n\n使用 \u0060cert-manager\u0060，自动创建和更新由 \u0060Gateway\u0060 暴露的证书非常简单。为此，你需要允许控制器访问 [route53](https:\/\/aws.amazon.com\/route53\/)，以解决 DNS01 挑战（这是一种确保客户端只能为自己拥有的域请求证书的机制）。\n\n[ClusterIssuer](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/security\/base\/cert-manager\/cluster-issuer-staging.yaml) 资源描述了使用 cert-manager 生成证书所需的配置。\n\n接下来，我们只需要添加一个注释 \u0060cert-manager.io\/cluster-issuer\u0060 并设置存储证书的 Kubernetes 密钥。\n\n[更多信息](https:\/\/cert-manager.io\/docs\/usage\/gateway\/)\n\n在演示存储库中，权限是使用 \u0060Crossplane\u0060 分配的，它负责在 AWS 中配置这些 IAM 权限。\n{{\u003c\/callout\u003e}}\n\n为了使路由正常工作，你还需要将 \u0060HTTPRoute\u0060 附加到正确的 \u0060Gateway\u0060 并指定域名。\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n  parentRefs:\n    - name: echo\n      namespace: echo\n  hostnames:\n    - \u0022echo.${domain_name}\u0022\n...\n\u0060\u0060\u0060\n\n几秒钟后，证书将被创建。\n\n\u0060\u0060\u0060console\nkubectl get cert -n echo\nNAME       READY   SECRET     AGE\necho-tls   True    echo-tls   43m\n\u0060\u0060\u0060\n\n最后，我们可以检查证书确实来自 Let\u0027s Encrypt，如下所示：\n\n\u0060\u0060\u0060console\ncurl https:\/\/echo.cloud.ogenki.io -v 2\u003e\u00261 | grep -A 6 \u0027Server certificate\u0027\n* Server certificate:\n*  subject: CN=echo.cloud.ogenki.io\n*  start date: Sep 15 14:43:00 2023 GMT\n*  expire date: Dec 14 14:42:59 2023 GMT\n*  subjectAltName: host \u0022echo.cloud.ogenki.io\u0022 matched cert\u0027s \u0022echo.cloud.ogenki.io\u0022\n*  issuer: C=US; O=Let\u0027s Encrypt; CN=R3\n*  SSL certificate verify ok.\n\u0060\u0060\u0060\n\n{{\u003ccallout note 提示\u003e}}\nGAPI 还允许你配置 **端到端的 TLS**，一直到容器。这是通过配置 \u0060Gateway\u0060 为 \u0060Passthrough\u0060 模式并使用 \u0060TLSRoute\u0060 资源来完成的。证书也必须由执行 TLS 终止的 pod 携带。\n{{\u003c\/callout\u003e}}\n\n### 在多个命名空间中共享 Gateway\n\n![共享网关](shared-gateway.jpg)\n\n使用 \u0060GAPI\u0060，你可以在 \u0060命名空间\u0060 之间路由流量。这得益于每个功能的不同资源：一个 \u0060Gateway\u0060 允许配置基础设施，以及 \u0060*Routes\u0060。这些路由可以附加到位于另一个命名空间中的 Gateway。因此，不同的团队\/项目可以共享相同的基础设施组件。\n\n但是，这需要指定哪个路由允许引用该 Gateway。在这里，我们假设我们有一个专门用于内部工具的 Gateway，名为 \u0060platform\u0060。通过使用 \u0060allowedRoutes\u0060 参数，我们明确指定了哪些命名空间允许附加到此 Gateway。\n\n[infrastructure\/base\/gapi\/platform-gateway.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/infrastructure\/base\/gapi\/platform-gateway.yaml)\n\n\u0060\u0060\u0060yaml\n...\n      allowedRoutes:\n        namespaces:\n          from: Selector\n          selector:\n            matchExpressions:\n              - key: kubernetes.io\/metadata.name\n                operator: In\n                values:\n                  - observability\n                  - flux-system\n      tls:\n        mode: Terminate\n        certificateRefs:\n          - name: platform-tls\n\u0060\u0060\u0060\n\n在命名空间 \u0060observability\u0060 和 \u0060flux-system\u0060 中配置的 \u0060HTTPRoutes\u0060 附加到此唯一的 \u0060Gateway\u0060。\n\n\u0060\u0060\u0060yaml\n...\nspec:\n  parentRefs:\n    - name: platform\n      namespace: infrastructure\n\u0060\u0060\u0060\n\n因此，使用来自云提供商的相同负载均衡器。\n\n\u0060\u0060\u0060console\nNLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})\n\ndig \u002bshort ${NLB_DOMAIN}\n13.36.89.108\n\ndig \u002bshort grafana-mycluster-0.cloud.ogenki.io\n13.36.89.108\n\ndig \u002bshort gitops-mycluster-0.cloud.ogenki.io\n13.36.89.108\n\u0060\u0060\u0060\n\n{{\u003ccallout note 注意\u003e}}\n这些内部工具不应该暴露在互联网上，但是你知道：这只是一个演示。例如，我们可以使用内部 Gateway（私有 IP）通过调整注释并使用私有连接系统（VPN、隧道等）来实现。\n{{\u003c\/callout\u003e}}\n\n### 流量分流\n\n![分流](split.jpg)\n\n由服务网格常常提供的一个功能是在有新版本可用时（A\/B 测试或金丝雀部署）对部分流量测试应用程序的能力。\u0060GAPI\u0060通过使用权重来实现这一点，使其变得非常简单。\n\n以下是一个将 5% 的流量转发到服务 \u0060echo-2-echo-server\u0060 的示例：\n\n[apps\/base\/echo\/httproute-split.yaml](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/apps\/base\/echo\/httproute-split.yaml)\n\n\u0060\u0060\u0060yaml\n...\n  hostnames:\n    - \u0022split-echo.${domain_name}\u0022\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n          weight: 95\n        - name: echo-2-echo-server\n          port: 80\n          weight: 5\n\u0060\u0060\u0060\n\n让我们检查分发是否按预期进行：\n\n[scripts\/check-split.sh](https:\/\/github.com\/Smana\/cilium-gateway-api\/blob\/main\/scripts\/check-split.sh)\n\n\u0060\u0060\u0060console\n.\/scripts\/check-split.sh https:\/\/split-echo.cloud.ogenki.io\necho-1 的请求次数：95\necho-2 的请求次数：5\n\u0060\u0060\u0060\n\n### 修改标头\n\n还可以更改 HTTP **标头**：添加、修改或删除它们。这些修改可以通过在 \u0060HTTPRoute\u0060 清单中使用 [filters](https:\/\/gateway-api.sigs.k8s.io\/api-types\/httproute#filters-optional) 应用于请求标头或响应标头。\n\n例如，我们将在 **请求** 中添加一个标头。\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1beta1\nkind: HTTPRoute\nmetadata:\n  name: echo-1\n  namespace: echo\nspec:\n...\n  rules:\n    - matches:\n        - path:\n            type: PathPrefix\n            value: \/req-header-add\n      filters:\n        - type: RequestHeaderModifier\n          requestHeaderModifier:\n            add:\n              - name: foo\n                value: bar\n      backendRefs:\n        - name: echo-1-echo-server\n          port: 80\n...\n\u0060\u0060\u0060\n\n此命令允许查看标头是否确实已添加：\n\n\u0060\u0060\u0060console\ncurl -s https:\/\/echo.cloud.ogenki.io\/req-header-add | jq \u0027.request.headers\u0027\n{\n  \u0022host\u0022: \u0022echo.cloud.ogenki.io\u0022,\n  \u0022user-agent\u0022: \u0022curl\/8.2.1\u0022,\n  \u0022accept\u0022: \u0022*\/*\u0022,\n  \u0022x-forwarded-for\u0022: \u002281.220.234.254\u0022,\n  \u0022x-forwarded-proto\u0022: \u0022https\u0022,\n  \u0022x-envoy-external-address\u0022: \u002281.220.234.254\u0022,\n  \u0022x-request-id\u0022: \u0022320ba4d2-3bd6-4c2f-8a97-74296a9f3f26\u0022,\n  \u0022foo\u0022: \u0022bar\u0022\n}\n\u0060\u0060\u0060\n\n## 分配适当的权限\n\n\u0060GAPI\u0060 提供了一种清晰的权限共享模型，用于管理流量路由基础设施（由集群管理员管理）和应用程序（由开发人员管理）之间的关系。\n\n多个自定义资源的可用性允许使用 Kubernetes 的 **RBAC** 配置以声明性方式分配权限。我已经添加了一些示例，这些示例在我的演示集群中没有效果，但可能会给你一个想法。\n\n下面的配置授予 \u0060developers\u0060 组的成员在 echo 命名空间内管理 \u0060HTTPRoutes\u0060 的能力，同时仅提供对 \u0060Gateways\u0060 的读取权限。\n\n\u0060\u0060\u0060yaml\n---\napiVersion: rbac.authorization.k8s.io\/v1\nkind: Role\nmetadata:\n  namespace: echo\n  name: gapi-developer\nrules:\n  - apiGroups: [\u0022gateway.networking.k8s.io\u0022]\n    resources: [\u0022httproutes\u0022]\n    verbs: [\u0022*\u0022]\n  - apiGroups: [\u0022gateway.networking.k8s.io\u0022]\n    resources: [\u0022gateways\u0022]\n    verbs: [\u0022get\u0022, \u0022list\u0022]\n---\napiVersion: rbac.authorization.k8s.io\/v1\nkind: RoleBinding\nmetadata:\n  name: gapi-developer\n  namespace: echo\nsubjects:\n  - kind: Group\n    name: \u0022developers\u0022\n    apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: Role\n  name: gapi-developer\n  apiGroup: rbac.authorization.k8s.io\n\u0060\u0060\u0060\n\n## 乍一看有点模糊\n\n人们可能会对通常称为 \u0060API 网关\u0060 的东西感到困惑。已经创建了 [FAQ](https:\/\/gateway-api.sigs.k8s.io\/faq\/) 的一个部分，以澄清它与 \u0060Gateway API\u0060 的不同之处。尽管 GAPI 提供了通常在 API 网关中找到的功能，但它主要是 Kubernetes 的一个特定实现。然而，选择这个名称确实可能引起 **混淆**。\n\n此外，请注意，本文仅关注入站流量，通常由 *Ingress Controllers* 管理，称为 [南北](https:\/\/gateway-api.sigs.k8s.io\/concepts\/glossary\/#northsouth-traffic)，这实际上是 GAPI 的初始范围。最近的一个名为 [**GAMMA**](https:\/\/gateway-api.sigs.k8s.io\/concepts\/gamma\/) 的倡议旨在处理 [东西流量](https:\/\/gateway-api.sigs.k8s.io\/concepts\/glossary\/#eastwest-traffic) 路由，这将在将来标准化某些常见的功能，通常由 \u0060Service Meshes\u0060 解决方案提供。（有关更多详细信息，请参阅 [此文章](https:\/\/kubernetes.io\/blog\/2023\/08\/29\/gateway-api-v0-8\/)）。\n\n## 最后的想法\n\n老实说，我已经知道 **Gateway API** 有一段时间了。尽管我读了一些文章，但我并没有真正深入研究过。我会想：“为什么要麻烦呢？我的 *Ingress Controller* 可以工作，而且这需要学习曲线。”\n\nGAPI 正在崭露头角，即将发布 GA 版本。多个 [项目](https:\/\/gateway-api.sigs.k8s.io\/implementations\/) 已经拥抱它，这个用于管理 Kubernetes 内流量的 API 将迅速成为标准。\n\n我必须说，配置 GAPI 感觉直观而明确。它的安全模型取得了平衡，赋予开发人员权力而不会损害安全性。而且无缝的基础设施管理？你可以在不触及 \u0060*Routes\u0060 的情况下在不同的实现之间切换。\n\n现在就用 \u0060Cilium\u0060 交换我的 Ingress Controller 吗？**还没有，但它即将到来**。\n\n值得强调的是，Cilium 的功能非常广泛：在 Kubernetes 周围有大量的工具，Cilium 脱颖而出，承诺提供指标、跟踪、服务网格、安全性，以及 *Ingress Controller* 与 GAPI。\n\n然而，需要注意一些挑战：\n\n- [TCP 和 UDP 支持](https:\/\/github.com\/cilium\/cilium\/issues\/21929)\n- [GRPC 支持](https:\/\/github.com\/cilium\/cilium\/issues\/21928)\n- 需要使用变异规则来配置云组件（[Github Issue](https:\/\/github.com\/cilium\/cilium\/issues\/25357)）。\n- 本文讨论的许多功能仍处于实验阶段。例如，最新版本（我写作时的 \u0060v1.14.2\u0060）支持的 [扩展功能](https:\/\/github.com\/cilium\/cilium\/pull\/27472)。我尝试设置一个简单的 HTTP\u003eHTTPS 重定向，但遇到了 [这个问题](https:\/\/github.com\/kubernetes-sigs\/gateway-api\/issues\/1185)。因此，我预计 API 将来会有一些修改。\n\n虽然我只是涉及了 Cilium 的 GAPI 能够提供的一小部分内容（老实说，这篇文章已经相当长了），但我希望我们可以很快在生产中使用它。但考虑到前面提到的几点，我建议等待一段时间。不过，如果你想为未来做准备，那么现在是时候了！\n\n## 参考资料\n\n- https:\/\/gateway-api.sigs.k8s.io\/\n- https:\/\/docs.cilium.io\/en\/latest\/network\/servicemesh\/gateway-api\/gateway-api\/#gs-gateway-api\n- https:\/\/isovalent.com\/blog\/post\/cilium-gateway-api\/\n- https:\/\/isovalent.com\/blog\/post\/tutorial-getting-started-with-the-cilium-gateway-api\/\n- Isovalent 的 [labs](https:\/\/isovalent.com\/resource-library\/labs\/) 是开始使用 Gateway API 并且你将获得新的徽章以添加到你的收藏中的好方法\n', '\/trans\/cilium-gateway-api\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇文章介绍了如何使用 Cilium 部署和配置 Gateway API，一个新的服务网格 API，用于管理 Kubernetes 中的服务间通信。文章详细说明了 Gateway API 的概念和组件，以及如何使用 Cilium 的特性和工具，实现高效和灵活的路由策略。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide/">使用 TIS 增强 Istio：安装与监控指南</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/03</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('使用 TIS 增强 Istio：安装与监控指南', '在这篇博客中我将指导你如何安装 TIS 并启用监控插件。', '\n在这篇博客中我将指导你如何安装 TIS 并启用监控插件。\n\n## 什么是 TIS？\n\nTetrate Istio Subscription（TIS）是由 Tetrate 提供的企业级、全面支持的产品，提供了经过全面测试且适用于所有主要云平台的 Istio 版本。TIS 基于开源的 Tetrate Istio Distro 项目，增加了对这些构建版本的全面高级支持，并可选提供 FIPS 验证的加密模块。此外，TIS 包含一系列经过测试和支持的 Add-Ons 和 Integrations，使得 Istio 的功能扩展和与常用基础设施工具的集成变得简单安全。\n\n## 为什么使用 TIS？\n\nTIS 不是 Istio 的一个分支，而是提供针对特定环境进行测试的上游发行版。我们对 Istio 所做的任何增强都会应用于上游。TIS 与普通的 Istio 相比有以下关键优势：\n\n1. **长期支持**：TIS 提供 14 个月的安全更新支持，确保稳定性和安全性。\n2. **商业支持**：TIS 有商业支持选项，适用于企业用例，包括合规性需求。\n3. **易于管理**：TIS 提供简化的安装和管理过程，减少了操作复杂性。\n4. **多环境适配**：TIS 支持不同云环境，满足各种部署需求。\n5. **FIPS 验证**：提供 FIPS 验证版本，适用于高安全性要求的场景。\n\n想要了解 TIS 的更多信息请访问：\u003chttps:\/\/docs.tetrate.io\/istio-subscription\/\u003e\n\n## 准备条件\n\n在安装 TIS 及其插件前，你需要准备：\n\n- 安装 [Terraform](https:\/\/www.terraform.io\/)：用于导入 Dashboard 到 Grafana\n- 向 Tetrate 请求安装 TIS 所需的 credentials\n\n## 安装 Istio 及 Monitoring addons\n\n首先使用下面的命令查看 TIS 支持的 Istio 版本：\n\n\u0060\u0060\u0060bash\nhelm search repo tetratelabs\/base --versions\nNAME            \tCHART VERSION  \tAPP VERSION    \tDESCRIPTION\ntetratelabs\/base\t1.20.1\u002btetrate0\t1.20.1-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.20.0\u002btetrate0\t1.20.0-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.5\u002btetrate0\t1.19.5-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.4\u002btetrate0\t1.19.4-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.19.3\u002btetrate0\t1.19.3-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.6\u002btetrate0\t1.18.6-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.5\u002btetrate0\t1.18.5-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.18.3\u002btetrate0\t1.18.3-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.17.8\u002btetrate0\t1.17.8-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.17.6\u002btetrate0\t1.17.6-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.16.7\u002btetrate0\t1.16.7-tetrate0\tHelm chart for deploying Istio cluster resource...\ntetratelabs\/base\t1.16.6\u002btetrate0\t1.16.6-tetrate0\tHelm chart for deploying Istio cluster resource...\n\u0060\u0060\u0060\n\n我们将安装当前最新的 Istio 1.20.1 版本。\n\n\u0060\u0060\u0060bash\nexport TIS_USER=\u003ctis_username\u003e\nexport TIS_PASS=\u003ctis-password\u003e\n# Helm chart version\nexport VERSION=1.20.1\u002btetrate0\n# Image tag\nexport TAG=1.20.1-tetrate0\nkubectl create namespace istio-system\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-system\n\n# Install Istio\nhelm install istio-base tetratelabs\/base -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION}\n\nhelm install istiod tetratelabs\/istiod -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# install ingress Gateway\nkubectl create namespace istio-ingress\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-ingress\n\nhelm install istio-ingress tetratelabs\/istio-ingress -n istio-ingress \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# Install TIS addon\nhelm install istio-monitoring-demo tis-addons\/istio-monitoring-demo --namespace tis --create-namespace\n\u0060\u0060\u0060\n\n端口转发 Grafana 服务，然后在本地浏览器中打开 Grafana：http:\/\/localhost:3000\n\n\u0060\u0060\u0060bash\nkubectl port-forward --namespace tis svc\/grafana 3000:3000\n\u0060\u0060\u0060\n\n注意：请保持该命令持续运行，因为我们在向 Grafana 导入 dashboard 时还需要访问该端口。\n\n## 安装 Istio Monitoring Addons\n\n使用默认的用户名密码 \u0060admin\/admin\u0060 登录后，在左侧导航栏中选择 Administration - Service accounts，参考 Grafana 文档上的说明创建一个 admin 权限的 Service account。\n\n![在 Grafana 中创建一个 Service account](grafana-service-account.jpg)\n\n记下这个 Token，我们将在下面的操作中用到。\n\n使用 Terraform 向 Grafana 中导入 dashboard：\n\n\u0060\u0060\u0060bash\ncat\u003e~\/.terraformrc\u003c\u003cEOF\ncredentials \u0022terraform.cloudsmith.io\u0022 {\n  token = \u0022tetrate\/tis-containers\/kuhb8CPZhaOiR3v6\u0022\n}\nEOF\n\n# Create a terraform module file\ncat\u003eistio-monitoring-grafana.tf\u003c\u003cEOF\nmodule \u0022istio_monitoring_grafana\u0022 {\n  source = \u0022terraform.cloudsmith.io\/tis-containers\/istio-monitoring-grafana\/tetrate\u0022\n  version = \u0022v0.2.0\u0022\n  gf_url  = \u0022\u003chttp:\/\/localhost:3000\u003e\u0022\n  gf_auth = \u0022\u003cgrafana_token\u003e\u0022\n}\nEOF\n\n# Run the commands\nterraform init\nterraform plan\nterraform apply -auto-approve\n\u0060\u0060\u0060\n\n恭喜你现在已经成功的向 Grafana 中导入了以下四个 dashboard：\n\n- TIS Workload Dashboard\n- TIS Service Dashboard\n- TIS Wasm Extension Dashboard\n- TIS Control Plan Dashboard\n\n但是现在有些 dashboard 还没有数据，我们需要在网格中制造一些流量。\n\n## 测试监控\n\n部署 Bookinfo 应用和入口网关：\n\n\u0060\u0060\u0060bash\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n default\nkubectl label namespace default istio-injection=enabled\nkubectl apply -f samples\/bookinfo\/platform\/kube\/bookinfo.yaml -n default\nkubectl apply -f samples\/bookinfo\/networking\/bookinfo-gateway.yaml -n default\n\u0060\u0060\u0060\n\n获取入口网关的 IP 并发送一些流量：\n\n\u0060\u0060\u0060bash\nexport GATEWAY_IP=$(kubectl -n istio-ingress get service istio-ingressgateway -o jsonpath=\u0027{.status.loadBalancer.ingress[0].ip}\u0027)\nfor i in $(seq 1 100);do curl http:\/\/$GATEWAY_IP\/productpage ; sleep 3;done\n\u0060\u0060\u0060\n\n现在访问 Grafana dashboard，你可以看到监控数据了。\n\n![TIS Workload Dashboard](istio-workload-dashboard.jpg)\n\n除此之外，在导入了这些 dashboard 的同时，我们还导入了以下警报规则：\n\n![导入的警报规则](alerting-rules.jpg)\n\n你也可以在 Grafana 中定义警报规则，比如[整合 Telegram](https:\/\/grafana.com\/blog\/2023\/12\/28\/how-to-integrate-grafana-alerting-and-telegram\/) 或 Slack 来发送通知。\n\n## 清理\n\n运行下面的命令清理 Bookinfo 应用和 TIS：\n\n\u0060\u0060\u0060bash\nkubectl delete -f samples\/bookinfo\/platform\/kube\/bookinfo.yaml -n default\nkubectl delete -f samples\/bookinfo\/networking\/bookinfo-gateway.yaml -n default\nhelm uninstall istio-ingress -n istio-ingress\nhelm uninstall istio-monitoring-demo -n tis\nhelm uninstall istiod -n istio-system\nhelm uninstall istio-base -n istio-system\nkubectl delete namespace tis\nkubectl delete namespace istio-ingress\nkubectl delete namespace istio-system\n\u0060\u0060\u0060\n\n## 总结\n\n通过执行这些步骤，您已经使用 TIS 成功地在 Istio 中设置和测试了监视。在 Istio 环境中享受增强监控的见解和优势！\n', '\/blog\/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">在这篇博客中我将指导你如何安装 TIS 并启用监控插件。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/scaling-and-sizing-the-sidecar/">[译] Istio Sidecar 的资源和性能管理：从监控到自动扩缩容的最佳实践</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/03</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://karlstoney.com/scaling-and-sizing-the-sidecar/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio Sidecar 的资源和性能管理：从监控到自动扩缩容的最佳实践', '这篇博客介绍了作者在使用 Istio Sidecar 时，如何通过可视化和分析 Sidecar 的数据，以及使用 HPA 和 VPA 来自动调整 Sidecar 的大小，提高应用程序的效率和稳定性', '\n本文讨论我们如何在工作负载中扩展 Istio Sidecar，以及如何考虑 Sidecar 资源与应用程序紧密耦合的关系。\n\n目前有很多关于 Istio 新的 [Ambient Mesh](https:\/\/istio.io\/v1.15\/blog\/2022\/introducing-ambient-mesh\/) 的讨论。这种部署服务网格的新方法放弃了 Sidecar，而采用了两个新组件，\u0060ztunnel\u0060，一个用于处理核心 L4 网络问题的每节点组件，以及（如果需要）\u0060waypoint proxy\u0060 来处理 L7 问题。\n\n![](image.jpg)\n\n来源：\u003chttps:\/\/istio.io\/v1.15\/blog\/2022\/introducing-ambient-mesh\u003e\n\n我听到的远离 Sidecar 的一个主要原因是，扩展 Sidecar 很复杂。如果只使用 L4 功能，我同意这一观点。然而，作为 L7 功能的重度用户，对我来说，似乎我们只是在管理 Waypoint 代理的规模，而不是 Sidecar。对我个人而言，也许有点自私，它感觉像是一个横向（充其量）的步骤，而不是前进。\n\n此外，我并不觉得管理 Sidecar 资源很痛苦，所以我很难产生共鸣。这部分是因为我从早期就开始使用 Istio，并建立了有助于这一过程的工具和流程。我意识到我从未真正分享过关于我们如何管理这一过程的信息，所以在这里分享一下。\n\n### 一些背景\n\n背景很重要，你如何思考监控和伸缩将取决于你如何构建你的 Kubernetes 设置，以及你的组织结构。也没有一种大小适合所有情况，这只是对我们有效的方法。因此我相信 Ambient 模式将减少某些 Operator 的复杂性，但可能会增加其他 Operator 的复杂性（我承认，这可能是少数情况）。\n\n我们运行大约 700 个个别服务（“工作负载”）。每个服务都有：\n\n- 在自己的 \u0060Namespace\u0060 中运行\n- 使用自己的 \u0060Service Account\u0060\n- 拥有自己的 \u0060Service\u0060\n- 由自己的隔离 CI\/CD 流水线部署\n- 从 Istio 和网络策略的角度来看，都在默认拒绝的设置中运行\n\n![](workload.png)\n\n对于我们来说，命名空间是工作负载的边界，这是一种一对一的关系，而且是一条坚决的规则。因此，我相信我们也会为每个命名空间创建一个 waypoint 代理。我们不会在多个工作负载之间共享 waypoint 代理，因为这会导致耦合（风险\/冲击范围）。因此，我们将得到类似于这样的结果：\n\n![](waypoint.png)\n\n与其扩展 \u0060Sidecar\u0060，我们将扩展 \u0060Waypoint\u0060 - 这就是我所说的对于我们来说，是横向的。我们仍然需要考虑某种规模的问题。\n\n### 可观测性：只是另一个容器\n\n这基本上总结了我对 Sidecar 的看法。它只是你的工作负载中的另一个容器。为了[有效管理](https:\/\/karlstoney.com\/managing-your-costs-on-kubernetes\/)成本（\u0022合适大小\u0022），你应该已经在监控你的工作负载时监控关键指标，这些指标自然扩展到涵盖 \u0060istio-proxy\u0060。对我来说，这些指标包括：\n\n- CPU 和内存 **请求**（例如 \u0060kube_pod_container_resource_requests\u0060）\n- CPU 和内存 **使用**（例如 \u0060container_memory_working_set_bytes\u0060）\n- CPU 和内存 **计算利用率**（Usage \/ Requests）。\n\n暂时忽略 Istio，如果你没有做上述操作，那么你应该开始做。为了帮助你，这是我用于 CPU 计算利用率的指标：\n\n\u0060\u0060\u0060yaml\n - record: \u0022container_cpu_usage_against_request:pod:rate1m\u0022\n   expr: |\n    (   \n      count(kube_pod_container_resource_requests{resource=\u0022cpu\u0022, container!=\u0022\u0022}) by (container, pod, namespace)\n      *   \n      avg(\n        irate(\n          container_cpu_usage_seconds_total{container!=\u0022\u0022}[1m]\n        )   \n      ) by (container, pod, namespace)\n    )   \n    \/   \n    avg(\n      avg_over_time(\n        kube_pod_container_resource_requests{resource=\u0022cpu\u0022, container!=\u0022\u0022}[1m]\n      )   \n    ) by (container, pod, namespace) * 100 \n    *   \n    on(pod) group_left(workload) (\n      avg by (pod, workload) (\n        label_replace(kube_pod_info{created_by_kind=~\u0022ReplicaSet|Job\u0022}, \u0022workload\u0022, \u0022$1\u0022, \u0022created_by_name\u0022, \u0022^(.*)-([^-]\u002b)$\u0022)\n        or  \n        label_replace(kube_pod_info{created_by_kind=~\u0022DaemonSet|StatefulSet\u0022}, \u0022workload\u0022, \u0022$1\u0022, \u0022created_by_name\u0022, \u0022(.*)\u0022)\n        or  \n        label_replace(kube_pod_info{created_by_kind=\u0022Node\u0022}, \u0022workload\u0022, \u0022node\u0022, \u0022\u0022, \u0022\u0022) \n        or  \n        label_replace(kube_pod_info{created_by_kind=\u0022\u0022}, \u0022workload\u0022, \u0022none\u0022, \u0022\u0022, \u0022\u0022) \n      )   \n    )\n\u0060\u0060\u0060\n\n你会注意到在这个指标中，我还与 \u0060kube_pod_info\u0060 进行了关联，这为我的指标提供了一些额外的维度，特别是 \u0060workload\u0060。这仅在我们有一个部署与一个命名空间相对应，等于一个工作负载的关系时才有效。这是可选的，只是帮助我在各个级别查看这个指标，包括 \u0060container\u0060、\u0060pod\u0060、\u0060node\u0060 或 \u0060workload\u0060。这样做将自然地为你的所有容器提供数据，当然也包括你的 Sidecar：\n\n![](Screenshot-2023-10-03-at-08.33.17.jpg)\n\n### Sidecar 与工作负载一起扩展\n\n对于 HTTP 工作负载，我们观察到 Sidecar 的扩展方式与底层应用程序非常相似。你可以在上面的截图中看到 \u0060istio-proxy\u0060 容器的 \u0022计算利用率\u0022 如何紧密跟随 \u0060master\u0060 容器。\n\n这就是我真正喜欢 Sidecar 模式的地方。你的 Sidecar 利用率与你的工作负载利用率紧密耦合，而工作负载利用率与工作负载的副本数量紧密耦合。在上面的示例中，如果我们需要水平扩展工作负载，利用率将保持大致相同。例如，你可以看到 \u0060master\u0060 容器的利用率峰值为 75%，而 \u0060istio-proxy\u0060 的利用率为 60%，如果我们将副本数量加倍，这两个值会松散减半，但保持大致一致。我们只是水平扩展一个 \u0060Deployment\u0060 对象，而不是两个。我们认为这更容易理解。\n\n我们向应用程序所有者提供的指导是，我们希望利用率在峰值时保持在 75% 左右。在这里，人们自然会问为什么我们不使用自动扩展。自动扩展依赖于底层云提供商提供的计算资源。我们曾经遇到过多次影响客户的事件，因为我们无法按需扩展，原因是底层云提供商的容量存在问题。此外，自动扩展会带来延迟，很难对突然的负载急剧增加做出响应，因此它只对具有明显逐渐季节性的工作负载有效，就像上面的工作负载一样。我们认为与自动扩展相关的成本节省不值得与不能对需求做出反应的风险相匹配，因此我们会略微过度配置我们的工作负载（因此是 75%）。\n\n但是，如果你对自动扩展感到满意，你可以在自动扩展配置中设置目标 CPU，然后就可以了。你有一个工作负载，以及一个与之紧密相关的 Sidecar，它们一起扩展。\n\n这就是我对 Waypoint 的看法。因为在我们的设置中，我们每个工作负载都有一个 waypoint 代理，我们将创建两个需要以不同方式但同步扩展的独立部署，这将解耦了我们自身有意关联的东西。\n\n### 设置正确的 CPU 和内存值\n\n在上面的示例中，你可以看到我们有一个相对健康的工作负载。\u0060istio-proxy\u0060 容器被分配了适合工作负载配置文件的 \u0060CPU\u0060 量，允许其利用率紧密跟踪底层应用程序的利用率。经验告诉我，一旦你将这两者对齐，它们就不会松散对齐。它们会漂移的唯一时间是如果任一容器的性能配置发生了显著变化（例如，如果开发人员将应用程序性能提高了 2 倍，则 \u0060master\u0060 的利用率会下降）。\n\n在 AutoTrader，我们的平台团队负责构建“交付平台”，开发人员将应用程序部署到其中，但应用程序开发人员负责确定其工作负载的大小（CPU 和 RAM）。平台团队构建了帮助他们做出明智决策的工具，涉及这些值。\n\n这意味着简单的抽象。我们不让开发人员编写 100 个 Kubernetes 清单来部署工作负载。他们不需要关心 Istio \u0060VirtualServices\u0060、\u0060Sidecars\u0060、Kubernetes \u0060Deployments\u0060 或记住在哪里放置注释以正确设置 Sidecar 的规模。相反，我们要求在他们的存储库中提供一个 yaml 文件，其内容如下：\n\n\u0060\u0060\u0060yaml\ndeployment:\n  istio:\n    resources:\n      cpu: 500m\n      memory: 80Mi\n  container:\n    replicas: 6\n    resources:\n      cpu: 1000m\n      memory: 956Mi\n\u0060\u0060\u0060\n\n因此，你可以看到，服务的所有者负责设置其 \u0060master\u0060 容器和其 \u0060istio-proxy\u0060 的资源。我们的责任是构建工具，帮助他们在选择这些值时做出明智决策。\n\n你已经看到了我们如何在上面的 Grafana 仪表板中使用 \u0022Utilisation\u0022 等指标来做到这一点，但我们还做了一些称为 \u0022建议\u0022 的事情。这些是我们向应用程序所有者提供的有关优化配置其服务的提示：\n\n![](Screenshot-2023-10-03-at-09.19.52.jpg)\n\n因此，你可以在这里看到我们有一个名为 \u0060ProxyMasterImbalance\u0060 的建议。如果我们检测到给定工作负载内的 \u0060master\u0060 和 \u0060istio-proxy\u0060 容器之间的漂移超过 30%，则此建议将处于活动状态。以下是此建议触发的示例：\n\n![](Screenshot-2023-10-03-at-09.44.09.png)\n\n### 总结\n\n希望你可以看到在大小调整 Sidecar 方面，它如何可以轻松地融入到你现有的用于大小调整工作负载的业务流程中。无论如何，你都应该这样做，以保持你的基础架构的健康利用率。\n\n我们已经建立了一种文化，小组关心并拥有他们的软件在生产环境中运行，其中包括关键的 CFR（成本），他们知道通过掌握这些事物，他们正在为更大的目标做出贡献，总体而言，他们做到了。至关重要的是，他们已经关心他们的 \u0060master\u0060 容器利用率，因此 \u0060istio-proxy\u0060 只是他们需要设置 2 个值（CPU\/内存）的另一个容器，我们提供了使其尽可能容易的数据，而在绝大多数情况下 - 这只是你需要调整一次的事情。\n\n我还想指出，这篇文章专门思考了规模的问题。将代理与应用程序分离出来还存在其他潜在优势（例如隔离升级）。不过再次强调，我个人认为这有利有弊（就像技术中的大多数决策一样），但这是另一天的博客文章。\n', '\/trans\/scaling-and-sizing-the-sidecar\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇博客介绍了作者在使用 Istio Sidecar 时，如何通过可视化和分析 Sidecar 的数据，以及使用 HPA 和 VPA 来自动调整 Sidecar 的大小，提高应用程序的效率和稳定性</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/opentelemetry-and-observability-looking-forward/">[译] OpenTelemetry 与可观测性：展望未来</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/02</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7"> 
             可观测性
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thenewstack.io/opentelemetry-and-observability-looking-forward/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('OpenTelemetry 与可观测性：展望未来', '本文展望 2024 年可观测性的发展。', '\n让我们探讨一些令人兴奋的趋势，考虑到我们期待 2024 年会有什么样的可观测性发展。\n\n随着年底的临近，现在是一个停下来思考的好时机。2023 年对于 OpenTelemetry 来说是一个里程碑，因为其三个基本信号，跟踪、度量和日志，都达到了稳定版本。这一成就标志着[OpenTelemetry](https:\/\/thenewstack.io\/opentelemetry-gaining-traction-from-companies-and-vendors\/)最初愿景的实现，即提供一个基于标准的框架，用于仪器化和收集可观测性数据。\n\n让我们抓住这个机会，探讨一下我们所见证的一些令人兴奋的趋势，深入研究创新的产品和用例，并在期待 2024 年的到来时深思熟虑地考虑可观测性的不断演变。\n\n## 度量标准的崭露头角\n\n尽管 OpenTelemetry 关于度量的规范在 2022 年 5 月被宣布为稳定版本，但今年看到了其被广泛采用。以下是一些从业者的文章：\n\n- 由 VMware 的 Matthew Kocher 和 Carson Long 撰写的文章，标题为“[体验报告：在 Cloud Foundry 中采用 OpenTelemetry 进行度量](https:\/\/opentelemetry.io\/blog\/2023\/cloud-foundry\/)”。\n- 我们自己的 Matheus Nogueira 撰写的文章，标题为“[在你的 Go 应用程序中添加 OpenTelemetry 度量](https:\/\/tracetest.io\/blog\/adding-opentelemetry-metrics-in-your-go-app)”。\n\n展望 2024 年，可以预期会看到类似的日志运动和采用。\n\n## 关注在负载测试中使用分布式跟踪\n\n2023 年，两个领先的负载测试工具，[Grafana k6](https:\/\/k6.io\/)和[Artillery.io](https:\/\/artillery.io\/)，都添加了对 OpenTelemetry 的支持。\n\n- Grafana k6 [引入了跟踪](https:\/\/github.com\/grafana\/xk6-distributed-tracing)功能，使性能工程师能够在[负载测试](https:\/\/thenewstack.io\/trace-based-testing-the-next-step-in-observability\/)期间识别系统瓶颈或故障。\n- Artillery.io 随后也[添加了度量和分布式跟踪](https:\/\/www.artillery.io\/blog\/introducing-opentelemetry-support)，提供了对系统性能更详细的分析。\n\nTracetest 利用了 k6 测试中暴露的功能，以[启用基于跟踪的负载测试](https:\/\/docs.tracetest.io\/tools-and-integrations\/k6)，在运行测试时进行深入的断言。我们已经看到许多客户广泛使用了这个功能，比如[Sigma Software](https:\/\/tracetest.io\/case-studies\/how-sigma-software-built-load-testing-for-their-microservices-with-k6-tracetest)。在 2024 年，Tracetest 团队将考虑将这一能力添加到[Artillery.io](http:\/\/artillery.io\/)和其他负载测试工具中。\n\n## OpenTelemetry 的支持和用例扩展\n\n越来越多的供应商正在采用 OpenTelemetry 标准，以支持典型但非常重要的遥测数据分析之外的行动。\n\n- 一些公司，比如[Tyk 正在仪器化其 API 网关，以原生支持 OpenTelemetry](https:\/\/opentelemetry.io\/blog\/2023\/tyk-api-gateway\/)。\n- 终端用户正在发现 OpenTelemetry 的新用例，比如[使用分布式跟踪来观察你的 CI\/CD 流水线](https:\/\/thenewstack.io\/how-to-observe-your-ci-cd-pipelines-with-opentelemetry\/)。\n- [Tracetest](https:\/\/tracetest.io\/)利用分布式跟踪数据进行集成和端到端测试。\n\n## 强调 OpenTelemetry 收集器\n\n[OpenTelemetry 收集器](https:\/\/thenewstack.io\/how-adobe-uses-opentelemetry-collector\/)位于 OpenTelemetry 世界的中心，接收来自应用程序的信号，处理和转换这些信号，然后将它们导出到任意数量的后端系统。随着对 OpenTelemetry 的集成和供应商支持的扩展，对这个集中式收集器的需求和要求也在增加。\n\n2023 年引入了 OpenTelemetry Transformation Language (OTTL)，增强了 OpenTelemetry 收集器处理和转换传入信号的能力。\n\n在 Tracetest 中，我们能够利用[在过滤器处理器中使用 OTTL](https:\/\/github.com\/open-telemetry\/opentelemetry-collector-contrib\/blob\/main\/processor\/filterprocessor\/README.md)的能力，改进了我们从输出大量遥测数据的生产环境中收集跟踪数据的方式。这一变化对[OpenTelemetry 收集器的过滤器处理器](https:\/\/tracetest.io\/blog\/opentelemetry-collectors-new-filter-processor)使 Tracetest 适用于在高负载环境中运行测试，包括生产环境。\n\n## 无处不在的可观测性\n\n在最近的讨论中，我们发现了一种客户中不断增长的趋势，即“无处不在的可观测性”方法。这些公司不仅限于由网站可靠性工程师和 DevOps 传统使用，还包括了每个人，包括开发人员和测试人员，参与到可观测性中。这种转变重新定义\n\n了可观测性，使其从生产问题的一种反应性工具变成了在开发和测试中都有益的一种主动工具。\n\n[Honeycomb](https:\/\/www.honeycomb.io\/)强调了[在开发过程中使用可观测性](https:\/\/www.honeycomb.io\/blog\/observability-driven-development)，而像[Digma.ai](http:\/\/digma.ai\/)和 Tracetest 这样的工具正在推动这一前进。\n\n## 浏览器\n\nOpenTelemetry 的主要作用一直局限于仪器化后端系统，而基于开放标准的浏览器仪器化仍然是实验性的，进展缓慢。正在努力改进和标准化这种仪器化。\n\n- [Uzufly](https:\/\/tracetest.io\/case-studies\/how-uzufly-built-end-to-end-testing-serverless-web-app-with-distributed-traces)在这方面脱颖而出。它使用现有的客户端仪器化来构建测试。展望未来，它的雄心是扩展基于跟踪的测试，以覆盖浏览器内部发起的前端操作所进行的测试。\n\n这将实现前端和后端的全面端到端测试。请关注 2024 年更多关于这个主题的信息！\n\n## 2023 已经过去\n\n告别 2023，我们怀着热情期待 2024 年的到来。OpenTelemetry 具有势头，得到了标准和广泛采用的支持，推动了其增长。新的一年承诺带来令人兴奋的发展，围绕 OpenTelemetry 出现了创新的产品和用例。我迫不及待地想看到 2024 年将揭示的进步和创新。愿 OpenTelemetry 长存！\n', '\/trans\/opentelemetry-and-observability-looking-forward\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文展望 2024 年可观测性的发展。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/what-will-be-the-api-management-trends-for-2024/">[译] 2024 年 API 管理趋势预测</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/01/01</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e4%b8%9a%e6%80%81"> 
             业态
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thenewstack.io/what-will-be-the-api-management-trends-for-2024/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('2024 年 API 管理趋势预测', '本文预测了 2024 年 API 管理的六大趋势，包括多源 API、多种 API 标准和格式、API 技术的解耦、API 的自动化和智能化、API 的无服务器化和边缘化、以及 API 的 GitOps 化。', '\n我们已经审视了 2023 年的发展，并确定了几个可能在明年主导 API 管理领域的关键趋势。\n\n根据一个想法：API 完全控制了数字世界，预测到本十年结束时，API 管理市场将增长六倍。\n\n随着越来越多的公司转向 API 为先的架构，API 管理的需求变得至关重要。一家组织可能会管理数百甚至数千个微服务，它们需要工具来有效地编排和监控这些 API。\n\n因此，随着这种增长的开始，API 管理在未来会带来什么？我们已经审视了 2023 年的发展，并确定了几个可能在 2024 年主导 API 管理领域的关键趋势。\n\n## 是时候实行零信任了（这并不是坏事！）\n\n随着 API 的不断增加，安全漏洞、黑客和 API 问题的风险也在增加。将零信任安全概念与你的 API 战略结合起来，倡导一种安全模型，其中不管交互发生在网络边界内还是外部，都不会假定信任。\n\n这种方法要求对每个试图访问网络内资源的个人和设备进行严格的身份验证，有效地消除了传统的受信任的内部网络概念。在数据泄露和恶意行为者变得越来越复杂的时代，采用零信任框架对于全面的安全至关重要，包括 API、云服务和网络基础设施在内的所有技术方面。\n\n在 API 管理领域，API 网关在实施零信任架构中起着关键作用。作为第一道防线，这些网关对每个 API 请求执行严格的身份验证和授权策略。它们负责验证凭据，管理访问令牌，并确保每个请求，无论来自组织内部还是外部，都要经过相同严格的安全检查。\n\n在这个框架中，API 网关不仅仅是流量管理器；它们是安全姿态的一部分，将零信任原则嵌入到 API 交互的核心。它们帮助构建适应持续风险评估、基于上下文的访问控制和深度监控 API 使用模式的动态安全策略。\n\n在零信任模型中，API 网关演变为安全执行者，对流经 API 的数据的完整性和机密性至关重要。这种演变强调了高级 API 管理工具在维护零信任原则和确保安全和弹性基础设施方面的重要性。\n\n## “多体验架构”将成为常态\n\n随着 2024 年 Gartner 的“多体验架构”概念变得越来越普遍，API 管理的复杂性将升级。组织不再只处理一种类型的 API；他们在同一应用生态系统中处理多种协议和架构。这种情况是现代应用多样性的结果，这些应用不仅包括基于 Web 的门户和本机移动应用，还包括扩展，如手表应用、实时对话界面和人工智能集成。\n\n每个组件都需要特定的 API 方法。通常情况下，REST API 在外部通信中因其简单性和通用性而受欢迎，而 gRPC 由于其效率和速度而可能被选择用于内部服务通信。与此同时，GraphQL 因其创建联合图和子图的能力而越来越多地用于高度灵活和高效的数据检索，这对于复杂的客户端应用程序是必不可少的。此外，消息代理对于实现需要立即数据更新和交互的应用程序的实时通信至关重要。\n\n在这种环境下，API 管理的挑战是多方面的。它涉及编排不同类型的 API 并确保在这些不同的架构中实现无缝集成、一致的安全执行和有效的性能监控。解决方案在于高级 API 管理工具和网关，它们能够处理这种多样性。这些工具必须提供复杂的功能，如协议转换、统一的安全策略和可以适应每种 API 类型的独特需求的分析。\n\n因此，2024 年的 API 管理将涉及到拥抱和管理这种复杂性，提供一个有凝聚力和高效率的框架，支持多体验架构的各种需求。\n\n## API 管理正在变成组织管理\n\n有一个著名的故事，来自前亚马逊和谷歌工程师 Steve Yegge，讲述了 Jeff Bezos 在 2002 年在亚马逊网络服务（AWS）制定的一项核心任务：\n\n1. 所有团队将通过服务接口公开其数据和功能。\n2. 团队必须通过这些接口相互通信。\n3. 不允许其他形式的进程间通信：不允许直接链接，不允许直接读取另一个团队的数据存储，不允许共享内存模型，也不允许任何后门。唯一允许的通信是通过网络上的服务接口调用。\n\n4. 无论他们使用什么技术。HTTP、Corba、Pubsub、自定义协议——都无所谓。贝佐斯不关心。\n5. 所有服务接口，没有例外，必须从头开始设计，以便能够将接口暴露给外部世界的开发人员。不允许例外。\n6. 不这样做的人将被解雇。\n\n贝佐斯正在为亚马逊的面向服务的体系结构打下基础。二十二年后，这一框架在技术领域普及。这意味着 API 管理实际上是团队在组织内部进行通信和操作的方式。\n\nAPI 已经成为组织过程的生命线，代表了从孤立的功能到集成系统的转变。这种转变将 API 管理从技术任务转变为组织领导的核心方面。这带来了几个具体的变化：\n\n- **战略对齐**。API 管理与业务战略密切对齐。它涉及理解 API 如何能够实现业务目标，如进入新市场、提升客户体验或简化运营。这种战略对齐要求 API 倡议与组织的方向和目标同步。\n- **跨职能合作**。API 不再仅仅是 IT 部门的责任。它们需要跨各种功能领域的合作，包括营销、销售、客户服务和业务发展。这种合作确保 API 以支持多样化的组织需求和机会的方式开发和管理。\n- **将 API 作为产品的思维方式**。API 越来越被视为产品，有专门的团队负责它们的生命周期，从构思到淘汰。这种方法涉及定期更新、用户反馈集成和持续改进，就像公司提供的任何其他产品或服务一样。\n- **性能指标和分析**。API 的成功不仅通过技术性能来衡量，还通过其对业务结果的影响来衡量。诸如 API 使用趋势、用户参与度和对收入增长的贡献等指标成为 API 有效性的重要指标。\n\n因此，API 的管理不再仅仅关于技术规范或协议，而是关于管理信息分享和服务交付的方式，跨整个组织。这种方法促进了敏捷性、可扩展性和创新，这在今天不断发展的技术领域中是必不可少的。\n\n## GitOps 已经在 API 中使用\n\n将 GitOps 集成到 API 管理中标志着 API 是如何更高效、透明和可靠地开发、部署和维护的一种显著转变。GitOps 是一种将 git 的版本控制原则应用于操作工作流程的方法，对于以更高效、透明和可靠的方式管理 API 的生命周期至关重要。\n\n在这个框架中，API 的每个方面，从其设计文档和配置到代码和部署清单，都存储在 git 存储库中。这种方法确保了整个 API 生命周期都受到版本控制，允许详细跟踪更改，以及在出现问题时轻松回滚，增强了团队成员之间的协作。\n\n自动化部署流程是使用 GitOps 管理 API 的一个关键优势。通过利用 git 作为唯一的真相来源，可以设置自动化流水线，以在提交更改时部署 API。这种自动化不仅限于简单的部署，还包括配置和策略的更新，确保 API 的所有方面都得到一致和可靠的更新。团队可以创建与 GitOps 工作流程直接集成的分散的声明性工作流，用于复杂的自定义配置。\n\nGitOps 还为 API 管理带来了更高级别的安全性。关于更改的拉取请求鼓励同行审查和批准，为引入修改提供了更健壮的流程。此外，git 存储库的不可变性增加了额外的安全性层，因为每个更改都是被跟踪和可审计的。\n\nGitOps 有望通过引入版本控制、自动化、安全和协作原则来改变 API 管理，从而使 API 开发和管理更加与现代敏捷实践相符，提高了效率和可靠性。\n\n## 开发者体验将成为标配\n\n在 2024 年，提供卓越的开发者体验（DevX）将不再是奢侈；它将成为一项必需。未将 DevX 置于优先位置的 API 管理系统越来越有被淘汰的风险，因为以开发者为中心的模式正在成为标准。\n\n这一变革的基石在于认识到开发者需要与其工作流程相一致并增强生产力的工具和系统。这其中的一个关键方面是采用[基础设施即代码](https:\/\/thenewstack.io\/why-use-infrastructure-as-code\/)（IaC）实践。IaC 允许开发者通过代码而不是手动流程来管理和配置基础设施。\n\n另一个关键因素是 API 管理系统支持各种部署环境的能力。随着部署模型的多样化，从本地部署到[云原生](https:\/\/www.getambassador.io\/kubernetes-glossary\/cloud-native)等，一个灵活的 API 管理解决方案，能够适应不同的环境至关重要。\n\nAPI 管理系统必须不断发展，以满足现代软件开发实践的需求。未能提供以开发者为中心的体验的系统，其特点包括 IaC、与标准工具的集成、易用性、灵活性和强大的分析功能，将在开发者体验至关重要的环境中难以保持相关性。\n\n## 捆绑随后的解绑\n\nAPI 管理工具的演变正在见证回归到捆绑解决方案，这是与最近的点对点解决方案的趋势相反。与旧的企业捆绑解决方案不同，这些新一代捆绑解决方案适用于更广泛的组织范围，提供了综合的、集成的解决方案。\n\nAPI 生态系统的不断复杂和规模的增加推动了这一转变。现代 API 管理需要一种全面的方法，包括强大的身份验证机制、严格的安全协议和自助开发者工具。通过将这些功能整合到[单一的、连贯的包中](https:\/\/www.getambassador.io\/products\/edge-stack\/api-gateway)，捆绑解决方案提供了一种更简化和高效的 API 管理方式。\n\n在这些捆绑解决方案中包括网关对于流量管理至关重要，提供了速率限制、请求路由和协议转换等功能。身份验证是另一个关键组成部分，确保通过 OAuth 和 JSON Web Tokens（JWT）等机制安全访问 API。这些捆绑解决方案中的安全功能不仅限于身份验证，还提供了全面的保护，防止 SQL 注入、DDoS 攻击和数据泄露等威胁。\n\n[自助开发者工具](https:\/\/www.getambassador.io\/products\/telepresence)是这些捆绑解决方案的重要组成部分。它们赋予开发者独立创建、测试和部署 API 的能力，减少了对 IT 团队的依赖，加速了开发。这些工具必须包括用户友好的界面、详细的文档和自动化的测试功能。\n\nAPI 管理中捆绑解决方案的再次出现代表着对现代 API 景观需求的适应。通过在一个统一的包中提供网关、身份验证、安全和开发者工具，这些捆绑解决方案提供了适用于各种组织需求的多功能和高效的解决方案。\n\n## 未知的人工智能\n\n人工智能正在颠覆数十个行业的规则，并以意想不到的方式重塑它们。\n\n“意想不到”是描述人工智能\/机器学习技术将如何扰乱 API 管理生态系统的好方式。KubeCon North America 2023 与 OpenAI Dev Day 同时举行，但两者似乎天差地别。在 KubeCon 上，AI 只轻微[提及](https:\/\/danielbryantuk.medium.com\/kubecon-chicago-key-takeaways-3de5ca13b375)，似乎 DevOps 和 API 管理行业对人工智能没有太多（尚未！）言论。\n\n但是，将 AI 排除在外将严重低估 AI 发展的范围和速度。去年这个时候，ChatGPT 才两周大。那时没有人知道它将如何彻底改变技术的各个方面。\n\n因此，AI\/机器学习与 API 战略的融合是不可避免的，可能会彻底改变 API 的开发、管理和优化方式。\n\n- AI 驱动的分析可以提供对 API 使用模式的更深入洞察，从而实现更有效的资源管理和优化。\n- AI 可以自动化和增强安全协议，比传统方法更有效地检测异常和潜在威胁。\n- AI 可以显着简化 API 开发过程。通过使用机器学习算法，API 可以变得更加自适应和智能，能够以更高的准确性和效率处理复杂请求。这种集成可能导致自我优化的 API，根据实时反馈调整其行为。\n\nAI 与 API 管理的交汇是即将到来的现实。随着 AI 继续渗透各个领域，其融入 API 生态系统将提供前所未有的效率、安全性和适应性水平，宣告了 API 管理和使用方式的新时代。\n\n## 未知的未知\n\n还有什么在未来？随着技术进步的极速和 API 已经吞噬了整个世界的方式，预测 API 管理的未来就像试图绘制未知领域一样困难。\n\n这个领域正在迅速发展，受新兴技术和 Paradigm 转变的推动，这使得难以预见未来的变化的全部范围。就像 API 已经改变了数字基础设施一样，未来的创新和方法将进一步重新定义我们今天对 API 管理的理解。\n\n请告诉我们你认为 2024 年将为 API 管理带来什么，以及你认为明年我们将使用什么令人兴奋的技术。\n', '\/trans\/what-will-be-the-api-management-trends-for-2024\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文预测了 2024 年 API 管理的六大趋势，包括多源 API、多种 API 标准和格式、API 技术的解耦、API 的自动化和智能化、API 的无服务器化和边缘化、以及 API 的 GitOps 化。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/grafana-dashboards-in-2023-memorable-use-cases-of-the-year/">[译] 令人惊叹的 Grafana 仪表盘用途：2023 年最有创意和有趣的用例分享</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/12/29</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7"> 
             可观测性
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://grafana.com/blog/2023/12/27/grafana-dashboards-in-2023-memorable-use-cases-of-the-year/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('令人惊叹的 Grafana 仪表盘用途：2023 年最有创意和有趣的用例分享', '这篇文章回顾了 2023 年社区中一些令人印象深刻的 Grafana 仪表盘的用例，它们展示了 Grafana 的多样性和创造力，以及如何用可视化的方式监控和分析各种数据和场景。', '\n## 编者按\n\n本文译自：[Grafana dashboards in 2023: Memorable use cases of the year](https:\/\/grafana.com\/blog\/2023\/12\/27\/grafana-dashboards-in-2023-memorable-use-cases-of-the-year\/)。\n\n摘要：这篇文章回顾了 2023 年社区中一些令人印象深刻的 Grafana 仪表盘的用例，它们展示了 Grafana 的多样性和创造力，以及如何用可视化的方式监控和分析各种数据和场景。\n\n## 正文\n\n随着每年使用 [Grafana](https:\/\/grafana.com\/oss\/grafana?pg=blog\u0026plcmt=body-txt) 的用户人数增加，人们使用 [Grafana 仪表板](https:\/\/grafana.com\/grafana\/dashboards\/?pg=blog\u0026plcmt=body-txt) 的原因也日益多样化。在 2023 年，我们社区内外的成员分享了一些令人难以置信的专业和个人项目，包括 Grafana 如何帮助他们成功发射火箭，减少碳排放，甚至帮助平衡国家电网。让我们回顾一下今年看到的一些最令人难忘的仪表板：\n\n## 获奖者\n\nGrafana 在六月份迎来了 10 岁的生日，为了庆祝这一时刻，我们首次推出了 [Golden Grot 奖项](https:\/\/grafana.com\/about\/events\/grafanacon\/2023\/golden-grot-awards\/?pg=blog\u0026plcmt=body-txt)，这些奖项帮助突出显示了我们社区创建的令人惊叹的 Grafana 仪表板。但今年并不是唯一一个与仪表板相关的胜利：今年三月，加州大学洛杉矶分校的火箭工程团队使用 Grafana 作为测试和发射过程中的可视化工具，在一次业余火箭竞赛中赢得了冠军，并打破了世界纪录。\n\n### [监控能源基础设施](https:\/\/grafana.com\/blog\/2023\/06\/15\/meet-our-golden-grot-awards-grand-prize-winners\/?pg=blog\u0026plcmt=body-txt)\n\nGolden Grot 奖项有两位大奖得主，在个人仪表板类别中，奖项授予了荷兰 Erasmus 经济学院的研究生 Nicky Sonnemans。他用仪表板监控 [欧洲能源基础设施的当前状态](https:\/\/grafana.sonnem.nl\/d\/uCV3CiPVz\/european-energy-infastructure-golden-grot?orgId=2) — 具体包括有关天然气储存、天然气在欧洲的实际流动、电力生成和能源价格的当前和历史信息。Sonnemans 创建这个仪表板的灵感来自于他想要将能源数据可视化到一个集中的地方，以便他可以轻松地实时发现任何异常情况并收到任何必要的警报。他补充说：“我的主要动机是展示 Grafana 可以用作商业智能工具，而不仅仅是用于技术监控和服务器监控。”\n\n![Nicky Sonnemans 的 Golden Grot 奖获奖仪表板](f1.jpg)\n\n### [解决工作中的可观测性问题](https:\/\/grafana.com\/blog\/2023\/06\/15\/meet-our-golden-grot-awards-grand-prize-winners\/?pg=blog\u0026plcmt=body-txt)\n\n在今年的 Golden Grot 奖项的专业仪表板类别中，获奖者是南非约翰内斯堡的 IT 专业人员 Raymond Sowden。他是 RadixTrie PTY LTD 的 CNC 团队负责人，专注于 Oracle 的 JD Edwards EnterpriseOne ERP (JDE)。他创建了获奖的 Grafana 仪表板来解决工作中的一个重大可观测性问题：“我们没有一个单一的监控视图来监控 JDE，所以我们的仪表板为我们提供了对 JDE 的整体健康和性能的无与伦比的见解。”他说，一个重要时刻是当他们能够看到后端和前端发生了什么时：“那时我们知道我们有了特别的东西。”\n\nRaymond 的仪表板提供了对系统健康状况的高级概述，但各种小部件链接到了更多技术数据的详细仪表板。它被他公司的 JDE 技术人员使用，以及他们客户的技术人员，一直到执行层级。他说：“我们通过提供实时见解和指标来减少了日常检查、日常报告等人工工作的工作量。”\n\n![Raymond Sowden 的 Golden Grot 奖获奖仪表板](f2.jpg)\n\n### [在火箭发射过程中提供数据可见性](https:\/\/grafana.com\/blog\/2023\/04\/21\/how-grafana-helped-a-rocket-engineering-team-break-a-world-record\/?pg=blog\u0026plcmt=body-txt)\n\n在一篇关于赢得 [Dollar Per Foot 挑战](https:\/\/friendsofamateurrocketry.org\/dpf-challenge\/) 并创下液体火箭最高高度的大学生和软件工程师 Philip Do 的博客文章中，他和来自 [UCLA 火箭项目](http:\/\/rocketproject.seas.ucla.edu\/) 的队友解释了他们是如何依赖 [Grafana](https:\/\/grafana.com\/oss\/grafana?pg=blog\u0026plcmt=body-txt) 来进行工作的。“通过我们的仪表板，我们可以快速可视化数据，并在测试和发射的关键阶段监控潜在的硬件问题，”他说。\n\n![Rocket Project 的发射仪表板中的传感器和阀门数据](f3.jpg)\n\n## 家居\n\nGrafana Labs 坚定地相信工作与生活的平衡，但当你对 Grafana 仪表板的吸引力和信息丰富性如此熟悉时，难以抵挡创建一个用于监视家庭事物的诱惑。我们在 2023 年展示的 Grafanista 制作的项目包括一个[可视化家用炉子的运行时间](https:\/\/grafana.com\/blog\/2023\/05\/19\/monitoring-a-furnace-with-home-assistant-prometheus-and-grafana\/?pg=blog\u0026plcmt=body-txt)、一个[监控空气质量](https:\/\/grafana.com\/blog\/2023\/02\/15\/breathing-easy-with-grafana-dashboards-and-3d-printing\/?pg=blog\u0026plcmt=body-txt)的项目，同时使用 3D 打印机，以及一个[跟踪温度和湿度](https:\/\/grafana.com\/blog\/2023\/10\/23\/monitor-temperature-and-humidity-with-grafana-and-raspberry-pi\/?pg=blog\u0026plcmt=body-txt)的项目，用于监控滨海家庭。还有一个旨在监控 [Plex 媒体服务器](https:\/\/www.plex.tv\/your-media\/) 的项目，是 [内部 homelab Slack 频道的三位 Grafanista 在一次黑客马拉松期间创建的](https:\/\/grafana.com\/blog\/2023\/04\/28\/plexporters-energize-how-we-monitor-plex-with-grafana\/?pg=blog\u0026plcmt=body-txt)。\n\n另一个值得注意的家庭项目来自公司外部：[GrafanaCON 2023](https:\/\/grafana.com\/about\/events\/grafanacon\/2023\/) 上，Toyota Racing Development 的高级 DevOps 工程师 Kyle Shelton 提供了一个演示，他介绍了如何将他在工作中使用的 [Grafana Cloud](https:\/\/grafana.com\/products\/cloud\/?pg=blog\u0026plcmt=body-txt) 经验，用于在家中使用 Grafana Cloud Free [监控个人三项铁人训练](https:\/\/grafana.com\/about\/events\/grafanacon\/2023\/session\/triathlon-training-with-prometheus-python-grafana-cloud\/?pg=blog\u0026plcmt=body-txt)。\n\n### 从任何地方监测游泳池水位\n\n高级解决方案工程师 Brian LeBlanc 创建了一个 Grafana 仪表板，以便他可以监测自家游泳池的水位。这使他可以安心地进行了一次为期 10 天的旅行，而不会过度担心游泳池水泵可能遭受的潜在损害（更换费用：1000 美元）。在[一篇博客文章](https:\/\/grafana.com\/blog\/2023\/08\/14\/how-to-monitor-pool-water-levels-from-anywhere-with-grafana\/?pg=blog\u0026plcmt=body-txt)中，他解释了他如何建立一个系统，其中包括一个名为 [Pool Sentry](https:\/\/www.rola-chem.com\/m-3000-pool-sentry\/) 的机械设备，一个 [LinkTap G2S](https:\/\/www.link-tap.com\/)（一个连接到花园水管的物联网智能水控制器），以及一个 [Tempest 天气站](https:\/\/weatherflow.com\/tempest-home-weather-system\/)。他使用 Docker 运行了一个在 GitHub 上找到的 [exporter](https:\/\/github.com\/nalbury\/tempest-exporter)，并将数据导出到 [Prometheus](https:\/\/grafana.com\/oss\/prometheus\/?pg=blog\u0026plcmt=body-txt)，然后远程将指标数据写入了由 Grafana Mimir 提供支持的 [Grafana Cloud Metrics](https:\/\/grafana.com\/products\/cloud\/metrics\/)。他解释说：“Tempest exporter 从 Tempest Cloud 中获取数据。然后，我的本地 Prometheus 实例会抓取这些数据并将其发布到 Grafana Cloud Metrics 中，以便我可以在 Grafana Cloud 中可视化它。”结果，他说：“我可以将两个物联网设备的数据汇总到一个窗口中，以评估水的消耗、降雨量和环境温度。”\n\n这个项目在多个方面都取得了成功：“作为一名新的 Grafanista，它为我提供了一些实际的用例，让我有机会亲自学习我们的产品，”他说。“在我和家人度假期间，它也一直运行得非常顺利。”\n\n![一个 Grafana 仪表板的截图，涵盖了大范围的时间，包括水的使用数据、降水和温度。](f4.jpg)\n\n## 环境、气候和能源消耗\n\n今年的许多杰出仪表板是作为环保使命的一部分创建的。Grafana Labs 的一个客户转向 Grafana，帮助减少对环境的影响。在另一个用例中，我们了解到 Grafana Cloud 在一次能源危机期间发挥了关键作用。我们还发现，Grafana Labs 的一名工程师曾经将 Grafana 作为可持续农业系统的一部分使用。\n\n### 减少数据中心的碳排放\n\n[Sentry Software](https:\/\/www.sentrysoftware.com\/) 是 Hardware Sentry 的制造商，它是一款 IT 监控软件，其业务的很大一部分依赖于在其数据中心中维持最佳的温度条件，这一操作对公司的整体碳足迹有所贡献。\n\n最近，Sentry Software 开始采取措施，在位于巴黎的主要数据中心中降低电力消耗，以减少其碳排放。通过实施开放标准和 Grafana Labs 技术，他们开发了一个[使用 Grafana 仪表板监控电力使用情况](https:\/\/grafana.com\/grafana\/dashboards\/17229-hardware-sentry-site\/?pg=blog\u0026plcmt=body-txt)的监控系统，以更高效地监测电力使用情况。最终结果是数据中心的空调能源使用减少了 19%，年度二氧化碳排放量减少了 7%。\n\n最好的部分是，由于整个监控系统是建立在开源解决方案和开放标准之上的，任何人都可以复制该公司的成功经验。Sentry Software CEO Bertrand Martin 在[GrafanaCON 2023 演讲](https:\/\/grafana.com\/about\/events\/grafanacon\/2023\/session\/grafana-opentelemetry-to-reduce-electricity-usage-at-sentry-software\/?pg=blog\u0026plcmt=body-txt)中表示：“这个故事可以成为你的故事，你不需要复杂的企业解决方案。”\n\n![Sentry Software 的 Grafana 仪表板为更有效地跟踪其数据中心的碳足迹提供了有关能源消耗、成本和排放的实时和累积数据。](f5.jpg)\n\n### 在法国平衡电网\n\n去年冬天，Flexcity —— 电动灵活性市场的市场领导者 —— 面临了前所未有的挑战：帮助法国电网运营商 [RTE](https:\/\/www.rte-france.com\/en\/home) 在欧洲普遍的能源危机阴云笼罩下稳定法国国家电网。随着公司因其努力而上了新闻头条，Flexcity 的技术团队将 [Grafana Cloud](https:\/\/grafana.com\/products\/cloud\/?pg=blog\u0026plcmt=body-txt) 归功于帮助法国渡过了那个特别艰难的时期。利用 Grafana 仪表板，Flexcity 团队可以实时跟踪客户的能源消耗数据，从而在电网最需要的关键时刻节省了数千千瓦时电力。\n\nFlexcity 的 CTO Mathias Deshayes 表示：“当我们收到电网运营商的请求时，我们使用 Grafana 仪表板实时查看客户基础的能源和功率消耗和产量水平。我们在客户现场安装了小型设备，每隔四秒，我们的平台就会将他们的消耗发送到我们的平台，并在 Grafana 中显示出来。因此，我们在 Grafana 中有了我们组合的总和，我们可以在激活期间跟踪消耗，即当电网运营商要求设备上下调整功率以帮助平衡电网时。”\n\n![Flexcity 比利时组合的 Grafana Cloud 仪表板，显示了公司客户和服务 KPI 的全球消耗。](f6.jpg)\n\n### 监管小农场\n\n在加入 Grafana Labs 之前，高级解决方案工程师 Chris Wilkes 经营了一个鱼塘农场 —— 严格来说是一个水耕农场。 （水耕农业结合了养鱼业和水培，即在液体培养基中种植蔬菜。）Wilkes 是一名初学者农民，坦言在开始时遇到了很多问题。例如，有一次，他的所有鱼在晚上一台空气泵发生故障后死亡。\n\n在深入研究物联网领域之后，他说：“农场上的每一台机器都有一个微控制器。”随着时间的推移，农场上发展出了一个控制和监控系统，他使用 PubNub 查询了所有板，并将数据转储到运行在中央服务器上（一台旧的笔记本电脑放在集装箱中）的 PostgreSQL 数据库中。当他偶然发现 Grafana 时，他说：“就像走出黑暗洞穴进入光明。”\n\nWilkes 经营了这个农场约五年。他说：“Grafana 的监控能力在我管理和改进农业技术方面发挥了重要作用。”他补充说，他计划有一天回到农业领域，将更加高级的 Grafana 技能与他对可持续性的热情结合起来。他说：“我们需要改变种植食物的方式，特别是在食物稀缺和不确定的地方。”\n\n![2016 年左右的 Grafana 仪表板，跟踪了农场的物联网数据。](f7.jpg)\n\n## 户外\n\n我们经常看到 Grafana 仪表板突然出现，但今年有两个特别引人注目。\n\n### The Ocean Race\n\n参赛者在这个全球帆船比赛中环绕世界比赛，这意味着他们需要全天候监测包括 GPS 位置、风速以及空气和水温在内的数据。代表德国的 [Team Malizia](https:\/\/www.theoceanrace.com\/en\/teams\/team-malizia)分享了[帮助他们在艰难的六个月冒险中跟踪进展的 Grafana 仪表板](https:\/\/exocet.cloud\/grafana\/d\/bsbc_7MGx\/malizia-public-dashboard-the-ocean-race?orgId=15)。The Ocean Race 总部还展示了一些令人印象深刻的 Grafana 仪表板，以监测整个比赛。\n\n### Call of Duty\n\nGrafana 仪表板的现实世界示例并不新鲜，但它们也在虚拟世界中使用。下面的图像来自视频游戏 Call of Duty: Modern Warfare 2。\n\nGrafana Labs 的首席执行官兼联合创始人 Raj Dutt 在[GrafanaCON 2023 主题演讲](https:\/\/grafana.com\/about\/events\/grafanacon\/2023\/session\/keynote-grafana-10\/?pg=blog\u0026plcmt=body-txt)中说：“对于那些了解 Grafana 的人来说，这显然非常像 Grafana，从指针的样式、颜色方案以及一切都清晰可见。”“所以无论是谁在 Activision 是 Grafana 的粉丝并且负责这个，谢谢你！我们所有人都表示由衷的敬意。”\n\n![Call of Duty 视频游戏中的 Grafana 仪表板截图](f8.jpg)\n\n我们期待在 2024 年看到更多令人惊叹的仪表板！\n\n想要与社区分享您的 Grafana 故事和仪表板吗？给我们发送邮件：[stories@grafana.com](mailto:stories@grafana.com)。\n', '\/trans\/grafana-dashboards-in-2023-memorable-use-cases-of-the-year\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇文章回顾了 2023 年社区中一些令人印象深刻的 Grafana 仪表盘的用例，它们展示了 Grafana 的多样性和创造力，以及如何用可视化的方式监控和分析各种数据和场景。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/primary-remote-istio-ingress-gateway-mtls/">Istio 多集群身份验证与 mTLS 连接解析</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/12/27</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio 多集群身份验证与 mTLS 连接解析', '这篇博客为你深度解析 Istio 主 - 远程部署模式下的远程网关的初始身份验证及 mTLS 连接流程。', '\n## 前言\n\n我经常在 [Istio 的 GitHub Discussions](https:\/\/github.com\/istio\/istio\/discussions) 上回答网友的问题，最近我遇到了一个关于 Istio 主 - 远程部署的[讨论](https:\/\/github.com\/istio\/istio\/discussions\/48343)，问题是关于远程集群中网关如何最初验证到外部 Istiod 实例的。这个问题触及到服务网格在多集群配置中的核心安全机制，我认为这值得在社区中进行更深入的分享。\n\n## 正文\n\n在 Istio 官方的[不同网络上安装 Primary-Remote](https:\/\/istio.io\/latest\/docs\/setup\/install\/multicluster\/primary-remote_multi-network\/)文档中，有一个步骤是[将 cluster2 作为 cluster1 的远程集群进行附加](https:\/\/istio.io\/latest\/docs\/setup\/install\/multicluster\/primary-remote_multi-network\/#attach-cluster2-as-a-remote-cluster-of-cluster1)。这个过程中会创建一个包含 kubeconfig 配置的 Secret，这个配置文件中含有访问远程集群（cluster2）所需的证书和令牌。\n\n\u0060\u0060\u0060yaml\n# 这个文件是自动生成的，请不要编辑。\napiVersion: v1\nkind: Secret\nmetadata:\n  annotations:\n    networking.istio.io\/cluster: cluster2\n  creationTimestamp: null\n  labels:\n    istio\/multiCluster: \u0022true\u0022\n  name: istio-remote-secret-cluster2\n  namespace: istio-system\nstringData:\n  cluster2: |\n    apiVersion: v1\n    clusters:\n    - cluster:\n        certificate-authority-data: {CERTIFICATE}\n        server: {CLUSTER2-APISERVER-ADDRESS}\n      name: cluster2\n    contexts:\n    - context:\n        cluster: cluster2\n        user: cluster2\n      name: cluster2\n    current-context: cluster2\n    kind: Config\n    preferences: {}\n    users:\n    - name: cluster2\n      user:\n        token: {TOKEN}\n\u0060\u0060\u0060\n\n这个 Secret 的关键作用是让主集群（cluster1）中的 Istio 能够访问远程集群的 API 服务器，从而获得服务信息。此外，远程集群（cluster2）中的 Istiod 服务，通过端点指向主集群中 Istiod 服务的 LoadBalancer IP（端口 15012 和 15017），使得 cluster2 能够通过 Istiod 与主集群进行通信。\n\n因为这两个集群共用一个 CA（由主集群提供），并且远程集群能够访问自己的 API 服务器，所以主集群中的 Istiod 可以验证来自远程集群（cluster2）的请求。下面的序列图清晰地展示了这一过程：\n\n\u0060\u0060\u0060mermaid \u0022Istio 多集群身份验证与 mTLS 连接过程时序图\u0022\nsequenceDiagram\n    participant IG as Ingress Gateway（远程集群）\n    participant K8s as Kubernetes API（远程集群）\n    participant SA as Service Account（远程集群）\n    participant Istiod as Istiod（主集群）\n\n    Note over IG: 启动\n    IG-\u003e\u003eK8s: 请求Service Account令牌\n    K8s-\u003e\u003eSA: 创建\/检索令牌\n    SA--\u003e\u003eIG: 返回令牌\n    Note over IG: 令牌挂载在Pod中\n\n    IG-\u003e\u003eIstiod: 使用令牌进行身份验证\n    Note over Istiod: 验证令牌\n    Istiod-\u003e\u003eIstiod: 生成mTLS证书\n    Istiod--\u003e\u003eIG: 发送mTLS证书\n\n    Note over IG: 使用mTLS证书进行Mesh内的安全通信\n\u0060\u0060\u0060\n\n![Istio 多集群身份验证与 mTLS 连接过程时序图](7183c70e686f598e80f374d029080ea6.svg)\n\n\n\n这一过程是 Istio 多集群配置中的关键一环，确保了服务网格中跨集群通信的安全性。正如我们在这次讨论中看到的，无论是远程网关还是服务都依赖于主集群的 CA 来进行初始的 mTLS 认证，这为整个服务网格的安全通信提供了坚实的基础。\n\n## 总结\n\n在本篇博客中，我们探讨了在 Istio 主 - 远程部署中，远程集群的网关如何进行初始验证以连接到外部的 Istiod。我们解释了如何通过创建一个含有 kubeconfig 的 Secret 来允许主集群的 Istio 访问远程集群的 API，以及如何通过共享的 CA 和服务账户令牌来确保 mTLS 认证的安全性。这一过程确保了服务网格中的跨集群通信的安全，为理解和实施 Istio 的多集群配置提供了重要的见解。\n', '\/blog\/primary-remote-istio-ingress-gateway-mtls\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇博客为你深度解析 Istio 主 - 远程部署模式下的远程网关的初始身份验证及 mTLS 连接流程。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/7-best-practices-for-developers-getting-started-with-genai/">[译] 给初学生成式 AI（GenAI）的开发人员的 7 条最佳实践</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/12/20</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/ai"> 
             AI
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://thenewstack.io/7-best-practices-for-developers-getting-started-with-genai/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('给初学生成式 AI（GenAI）的开发人员的 7 条最佳实践', '这篇文章分享了七个步骤，帮助开发者掌握生成式 AI 的基本概念和技能。', '## 编者按\n\n编辑评论：这是一篇非常有价值的文章，向开发者展示了生成式 AI 的潜力和应用。生成式 AI 是一种利用大型语言模型来生成和转换文本的技术，它可以帮助开发者解决一些复杂的问题，如代码生成，文档编写，内容创作等。生成式 AI 也是一种云原生的技术，它需要大量的计算资源和数据，以及高效的部署和管理方式。文章提供了一些实用的工具和平台，如 GitHub Copilot，Bard，ChatGPT 等，让开发者可以轻松地尝试和使用生成式 AI。文章还给出了一些注意事项和建议，如保护数据隐私，验证输出质量，避免滥用等，让开发者可以负责任地使用生成式 AI。我认为这篇文章是一个很好的入门指南，让开发者可以了解和利用生成式 AI 来打造创新的云原生应用。\n\n---\n\n## 正文\n\n通过一点经验，你可以使用 GenAI 解决一些相当困难的问题，就像学习任何新技术一样，最好的方法就是动手实践。\n\n随着可访问的生成式人工智能进入主流，以及由此产生的通过简单语言转化整个人类知识的能力，每个企业都在竭力将人工智能整合到其技术体系中。对于开发人员来说，压力很大，但也有着令人兴奋的无限可能性。\n\n如果你有一些经验，你可以使用 GenAI 解决一些相当困难的问题，就像学习自 HTML 诞生以来的每一项新技术一样。让我们看看你可以采取的七个步骤，以开始建立 GenAI 的基础，并最终逐步发展成一个完全运作、可扩展的应用程序。\n\n## 1. 玩转现有的 GenAI 工具\n\n入门 GenAI 的最佳方法是实践，而且门槛非常低。市场上现在有许多免费选项，比如 Bard、ChatGPT、Bing 和 Anthropic，有很多可以学习的选择。\n\n尝试使用 GenAI 工具和代码生成解决方案进行实验（并鼓励你的团队进行实验），例如[GitHub Copilot](https:\/\/github.com\/features\/copilot)，它集成到每个流行的 IDE 中，充当一对程序员。Copilot 提供程序员建议，帮助解决代码问题，并生成整个函数，使学习和适应GenAI变得更快更容易。\n\n当你首次使用这些现成的工具时，要小心使用专有或敏感的公司数据，即使只是提供给工具一个提示也要小心。Gen AI 供应商可能会存储并使用你的数据用于将来的训练运行，这是公司数据政策和信息安全协议的重大违规行为。确保你及时直接地向你的团队传达这一黄金规则。\n\n## 2. 了解从 GenAI 中可以获得什么\n\n一旦你开始尝试 GenAI，你将很快了解到不同提示会产生什么类型的输出。大多数 GenAI 工具可以生成各种格式的文本，包括：\n\n- **生成**新的故事、想法、文章或任意长度的文本。\n- **转换**现有文本为不同格式，如 JSON、Markdown 或 CSV。\n- **翻译**文本成不同语言。\n- 以聊天的方式**对话**来回。\n- **审查**文本以展示特定元素。\n- 将长篇内容**汇总**以获取洞察。\n- **分析**文本的情感。\n\n任何人都可以生成这些类型的生成文本结果，无需编程技能。只需键入提示，文本就会产生。然而，大型语言模型（LLM）经过的培训越多，即它摄取的语言碎片越多，随着时间的推移，它在生成、更改和分析文本方面就会变得更加准确。\n\n## 3. 学习提示工程\n\n部署 GenAI 的良好方法之一是掌握编写提示的技巧，这既是一门艺术又是一门科学。虽然提示工程师是一个实际的职位描述，但它也是任何希望提高他们使用 AI 的人的好绰号。优秀的提示工程师知道如何开发、完善和优化文本提示，以获得最佳结果并提高整个 AI 系统的性能。\n\n提示工程不需要特定的学位或背景，但从事这项工作的人需要擅长清晰解释事物。这是重要的，因为所有可用的 LLM 都是无状态的，这意味着没有长期记忆，每次交互只存在于小会话中。\n\n在提示工程中，以下三个因素变得重要：\n\n1. **上下文**：你提出的问题、聊天历史记录和你设置的参数。\n2. **知识**：LLM 已经接受的培训内容以及你通过提示提供的新信息的结合。\n3. **形式**：你期望以何种方式生成信息的语气。\n\n上下文、知识和形式的结合塑造了 GenAI 的大量知识存储成为你希望获得的响应类型。\n\n## 4. 探索其他 GenAI 提示方法\n\n到目前为止，我们一直在谈论零-shot 提示，这基本上意味着提出一个带有一些上下文的问题。如果你从这种方法中没有得到期望的结果，还有四种提示 GenAI 的方法。\n\n1. **单次提示**：提供你正在寻找的输出类型的示例。如果你想要特定类型的格式，例如[标题]和[4 个要点]，这将特别有用。\n2. **少量提示**：这类似于单次提示，但你会提供三到五个示例而不仅仅是一个。\n3. **“让我们一步一步地思考”**：这种技巧对 LLM 和对人都同样有效。如果你有一个包含多个部分的复杂问题，请在末尾输入此短语，等待 LLM 分解问题。\n4. **思路链提示**：对于涉及复杂算术或其他推理任务的问题，思路链提示会指示工具“展示其工作方式”并解释其如何得出答案。以下是可能的示例：\n\n![](f1.png)\n\n## 5. 查看其他 GenAI 工作示例\n\n一旦你熟悉了 GenAI 工具并了解如何编写出色的提示，[请查看 OpenAI 发布的一些示例](https:\/\/github.com\/openai\/openai-cookbook\/tree\/main\/examples)，了解其他人正在做什么以及可能的其他可能性。随着你的实验，你将更加熟悉聊天界面，并学会如何对其进行微调，以便熟练地缩小响应范围，甚至将响应转换为 CSV 文件或其他类型的表格。\n\n考虑如何将你的 GenAI 知识应用于你的业务，以简化困难或重复性任务，生成创意并使信息易于让更广泛的受众访问。你可以想象出哪些新的用例？以前不可能的东西现在成为可能了吗？\n\n## 6. 集成第三方 GenAI 工具和 API\n\n考虑使用 ChatGPT、Bard 和 Claude 2 等 API 通过 API 使用 LLMs 的角色。这些工具都提供了强大的 API，并有支持文档，因此入门门槛很低。大多数这些 API 是基于使用量的，因此更容易玩弄。\n\n通常情况下，通过语义搜索和由向量数据库支持的嵌入来将自定义或私有数据集成到 LLM 提示中，你还可以集成自定义或私有数据。通常称为 RAG（检索增强生成）。\n\n分解这两个术语：\n\n- **语义搜索**：使用词嵌入比较查询的含义与其索引中文档的含义，即使没有完全匹配的单词也能获得更相关的结果。\n- **嵌入**：将对象（如单词、句子或整个文档）的数值表示转化为多维空间。这使得评估不同实体之间的关系成为可能。\n\n以下是这可能看起来的一个示例：\n\n![](f2.png)\n\n这幅图展示了“猫”和“狗”的概念比它们与“人”或“蜘蛛”的概念更接近，“车辆汽车”则是最远的，是概念中最不相关的。（[这里有更多关于如何使用语义搜索和嵌入的信息](https:\/\/www.confluent.io\/blog\/chatgpt-and-streaming-data-for-real-time-generative-ai\/#connecting-knowledge-base-to-gpt)。）\n\n## 7. 从头开始训练自己的模型\n\n这最后的建议实际上不太像建议，更像是一个“可选的下一步”。训练自己的 GenAI 模型并不适合每个人，但如果你：\n\n- 拥有独特而有价值的知识库。\n- 想要执行商业 LLM 无法完成的某些任务。\n- 发现商业 LLM 的推理成本在商业上没有意义。\n- 有特定的安全要求，需要托管自己的 LLM 数据，并且不愿通过第三方 API 传递数据。\n\n训练自己的模型的一种方法是使用开源模型，例如 Llama 2、Mosaic MPT-7B、Falcon 或 Vicuna，其中许多还提供了商业使用许可证。这些通常根据它们具有的参数数量进行标记：7B、13B、40B 等。 “B”代表模型的参数数目，以及它可以处理和存储的信息量。数字越高，模型就越复杂和复杂，但训练和运行成本也越高。如果你的用例不复杂，并且如果你计划在性能相当强大的现代笔记本电脑上运行模型，那么具有较低参数的模型是开始的最佳且最经济的方法。\n\n中大型组织可能会选择从头开始构建和训练一个 LLM 模型。这是一条非常昂贵、资源密集且耗时的 AI 之路。你需要难以招聘的技术人才，并具备长时间迭代的机会，因此对大多数组织来说，这条路线不现实。\n\n### 微调 LLM\n\n一些组织选择中间路径：微调基本开源 LLM 以实现模型预训练能力之外的特定功能。如果你希望以你品牌独特的声音创建虚拟助手或基于真实客户购买构建的推荐系统，那么这是一个很好的选择。这些模型会随着你纳入排名靠前的用户交互而不断地训练自己。事实上，[Open AI 报告](https:\/\/voicebot.ai\/2023\/08\/23\/openai-brings-fine-tuning-to-gpt-3-5-turbo-and-gpt-4\/)，使用此模型，可以将提示长度缩短多达 90%，同时保持性能不变。此外，Open AI 的商业 API 的最新增强功能使其与驱动 ChatGPT 和 Bing AI 的模型一样强大和易于访问。\n', '\/trans\/7-best-practices-for-developers-getting-started-with-genai\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">这篇文章分享了七个步骤，帮助开发者掌握生成式 AI 的基本概念和技能。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/">
         ««
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a href="/blog/page/6/" class="page-link">
         «
       </a>
     </li>
     
     
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/5/" class="page-link">
             5
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/6/" class="page-link">
             6
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item page-item active ">
           <a href="/blog/page/7/" class="page-link">
             7
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/8/" class="page-link">
             8
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/blog/page/9/" class="page-link">
             9
           </a>
         </li>
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
     
     
     <li class="page-item">
       <a href="/blog/page/8/" class="page-link">
         »
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a class="page-link" href="/blog/page/26/">
         »»
       </a>
     </li>
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      专栏
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(70)</span>
        </a>
      
        <a href="/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(41)</span>
        </a>
      
        <a href="/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(24)</span>
        </a>
      
        <a href="/categories/%e9%9a%8f%e7%ac%94" class="sidebar-item">
            <span>随笔</span>
            <span>(21)</span>
        </a>
      
        <a href="/categories/%e4%b8%9a%e6%80%81" class="sidebar-item">
            <span>业态</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e5%85%b6%e4%bb%96" class="sidebar-item">
            <span>其他</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(16)</span>
        </a>
      
        <a href="/categories/%e4%ba%91%e5%8e%9f%e7%94%9f" class="sidebar-item">
            <span>云原生</span>
            <span>(14)</span>
        </a>
      
        <a href="/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%ae%89%e5%85%a8" class="sidebar-item">
            <span>安全</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%bc%80%e6%ba%90" class="sidebar-item">
            <span>开源</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7" class="sidebar-item">
            <span>可观测性</span>
            <span>(5)</span>
        </a>
      
        <a href="/categories/%e6%97%85%e8%a1%8c" class="sidebar-item">
            <span>旅行</span>
            <span>(5)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      资料
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/%e5%87%ba%e7%89%88%e7%89%a9" class="sidebar-item">
            <span>出版物</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e7%94%b5%e5%ad%90%e4%b9%a6" class="sidebar-item">
            <span>翻译电子书</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e6%96%87%e6%a1%a3" class="sidebar-item">
            <span>翻译文档</span>
            <span>(7)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>翻译图书</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8e%9f%e5%88%9b%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>原创图书</span>
            <span>(2)</span>
        </a>
      
        <a href="/categories/%e6%95%99%e7%a8%8b%e6%89%8b%e5%86%8c" class="sidebar-item">
            <span>教程手册</span>
            <span>(1)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">联系</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">微信公众号</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">博客</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/service-mesh-data-plane-deployment-modes/">深入解析服务网格的四种数据平面部署模式：性能、安全性与成本分析</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/service-mesh-sidecar-vs-sidecarless-debate/">服务网格架构：Sidecar vs. Sidecarless，谁才是未来？</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/hong-kong-trip/">香港——内地的一面的镜子</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">链接</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio 服务网格
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate 公司
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  云原生学院|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  云原生开源项目大全
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  云原生社区（中国）
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">教程</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes 基础教程
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">通知</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/nist-sp-800-233-service-mesh-proxy-models/">资料分享：云原生应用服务网格代理模型的威胁分析指南</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/kubecon-china-2024-panel/">KubeCon China 2024（香港）</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/website-revamp-notice/">网站改版通知</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2024 Jimmy Song 保留所有权利</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>




<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
