<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  
  <title>KCD - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="Jimmy Song&#39;s Blog">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.145.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/en/tags/kcd/" />
  <meta property="og:title" content="KCD | Jimmy Song" />
  <meta property="twitter:title" content="KCD | Jimmy Song" />

  
  <meta property="og:description" content="Jimmy Song&#39;s Blog" />
  <meta property="twitter:description" content="Jimmy Song&#39;s Blog" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/en">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/blog">Blog</a>
              
            </li>
            
            
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
                aria-expanded="false">
                Resources
              </a>
              <div class="dropdown-menu">
                
                <a class="dropdown-item" href="/en/book">Books</a>
                
                <a class="dropdown-item" href="/en/slide">Slides</a>
                
              </div>
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/tags">Tags</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/notice">Notice</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/contact">Contact</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/about">About</a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    
                  
                
              
              
              
                
                  
                    
                    <a class="nav-link" href="/tags/kcd/">中文</a>
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>Search</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>Search</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="Close"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="Input the keyword" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="Input the keyword">
        
        <div class="mt-4">
          <span>Search type: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">All</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">Blog</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">Book</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">Notice</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    KCD
                </p>
                <p class="page-description">
                    
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/beyond-sidecar/">Beyond Sidecar: A Deep Dive into Istio Ambient Mode Traffic Mechanism and Cost Efficiency</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Mar 22, 2025</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Beyond Sidecar: A Deep Dive into Istio Ambient Mode Traffic Mechanism and Cost Efficiency', 'This post introduces the background, core components, traffic flow mechanisms, and comparisons between Ambient Mode and the traditional Sidecar model in Istio—helping you evaluate and get started with this new feature quickly.', '\nWelcome to my blog post — **\u0022Beyond Sidecar: A Deep Dive into Istio Ambient Mode Traffic Mechanism and Cost Efficiency.\u0022** \n\nThis post is based on my talk at KCD Beijing and focuses on Istio’s newly introduced data plane model — **Ambient Mode**. Its core idea is to remove the Sidecar proxy to reduce resource overhead and operational complexity.\n\nIn this article, I’ll explain Ambient Mode\u0027s background, core components, traffic routing mechanisms, and a comparison with the existing Sidecar model. The goal is to help you evaluate this new feature and confidently adopt it.\n\n[Click here to view the slides](\/en\/slide\/beyond-sidecar\/).\n\n## Why Care About Ambient Mode?\n\nLet’s start with a question: why should we care about—or even consider adopting—this new mode? Sidecar proxies have been working well in service meshes for years, so why remove them now?\n\nTo answer that, let’s look at some of the challenges service meshes currently face.\n\n### Challenges with Service Mesh\n\n- **Resource overhead** and **operational complexity** introduced by sidecar proxies \n- **Upgrading** or **restarting** Envoy often requires restarting all Pods \n- Growing demand for **high performance** and **lower costs**\n\n\u003e **Thought exercise**: Is there a way to retain the core capabilities of a service mesh—security, observability, traffic control—while reducing the per-Pod intrusion and extra resource consumption?\n\n### Common Service Mesh Deployment Models\n\n![Proxy Locations](proxy-location.svg)\n\nThe architecture of service meshes has long been exploring different proxy deployment strategies, such as:\n\n- **Sidecar**: Runs an Envoy proxy inside each Pod\n- **Ambient**: Moves the proxy out of Pods to the node level (which this post focuses on)\n- **Cilium Mesh**: Uses eBPF in the kernel space for L4, combined with Envoy for L7 capabilities\n- **gRPC**: Embeds mesh functionality directly into application SDKs\n\nEach of these models has trade-offs in terms of functionality, security, performance, and operational complexity. **Istio Ambient Mode** is a new attempt to address the Sidecar model’s overhead and operational burdens.\n\n### The Birth of Ambient Mode\n\n- A next-generation Istio architecture that **removes the Sidecar**, using **ztunnel \u002b Waypoint Proxy** to simplify the data plane\n- Saves resources and reduces operational complexity\n- Still supports **mTLS** and **policy enforcement**, with **Waypoint Proxy** optionally providing L7 capabilities\n\n![Deployment Model Quadrants](istio-data-plane-deployment-modes.svg)\n\nThe following table provides a quick comparison of some common service mesh deployment models:\n\n| **Mode**         | **Security**                         | **Efficiency**        | **Manageability**            | **Performance**                          |\n| ---------------- | ------------------------------------ | --------------------- | ---------------------------- | ---------------------------------------- |\n| **Sidecar**       | High isolation via per-Pod proxy     | High resource usage   | Centralized but complex      | Adds some latency                        |\n| **Ambient**       | Security via ztunnel (still evolving) | More efficient, shared | Easier to manage, still maturing | Good; cross-AZ traffic may add overhead |\n| **Cilium mesh**   | Moderate, kernel-based with eBPF     | Kernel-level efficiency | Complex to configure         | Depends on use case                      |\n| **gRPC**          | App-integrated, depends on the app   | Efficient              | Complex upgrade management    | Low latency, ideal for real-time use     |\n\n## Core Concepts of Istio Ambient Mode\n\nLet’s now move into the second part of our discussion, where we’ll explore the core components of Ambient Mode, including **ztunnel**, **Waypoint Proxy**, and the role of **Istio CNI**.\n\n### Key Components of Ambient Mode\n\n1. **ztunnel (L4)**\n   - Runs as a node-level proxy\n   - Responsible for **transparent traffic interception** and **mTLS encryption**\n   - Handles most traffic that only requires L4 forwarding\n\n2. **Waypoint Proxy (L7)**\n   - Optionally deployed (configurable by namespace, service, or pod granularity)\n   - Handles advanced functionality like **HTTP\/gRPC authentication, routing, and observability**\n\n3. **Istio CNI**\n   - Replaces the \u0060istio-init\u0060 container and handles traffic redirection\n   - Supports both **Sidecar** and **Ambient** modes\n   - Enables traffic redirection in **unprivileged mode** for enhanced security\n\n### Overview of Ambient Mode Architecture\n\n![Istio Ambient Mode Architecture](istio-ambient-layers.svg)\n\nIn Ambient Mode, the Istio data plane is split into two layers:\n\n1. **Security Layer (ztunnel)**: A lightweight L4 proxy is deployed on each node\n2. **Optional L7 Layer (Waypoint Proxy)**: Deployed only when HTTP\/gRPC proxying is needed\n\nThe **control plane** is still managed by **Istiod**, which distributes configurations and certificates to both ztunnel and Waypoint proxies.\n\n### Deployment Strategies for Waypoint Proxy\n\n- **Namespace-level** (default): Applies to all workloads in the namespace\n- **Service-level**: For services that require L7 processing only\n- **Pod-level**: Offers fine-grained control\n- **Cross-namespace**: Enables sharing via Gateway resources\n\n### Istio CNI\n\n- **Traffic Interception**: Replaces the \u0060istio-init\u0060 container, simplifying the installation process\n- **Dual-mode Support**: Compatible with both **Sidecar** and **Ambient** modes\n- **Unprivileged Mode Compatibility**: Enables traffic redirection for Pods running without elevated privileges\n- **CNI Chaining**: Adds Istio CNI as an additional plugin in the existing CNI configuration\n- **In-Pod Traffic Redirection (Ambient Mode)**:\n  - Uses \u0060iptables REDIRECT\u0060 rules inside the Pod’s network namespace\n  - Creates a local socket within the Pod to intercept and proxy traffic\n\nThe following diagram illustrates how Istio CNI integrates with Kubernetes network plugins like Calico or Cilium. Istio CNI modifies the node’s CNI configuration by appending itself to the CNI chain. After Kubernetes assigns a Pod IP, Istio CNI executes its interception logic and injects traffic redirection rules into the Pod’s network namespace.\n\nIt applies different \u0060iptables\u0060 rules depending on whether the Pod runs in Sidecar or Ambient mode, forming a chained CNI workflow that complements—rather than conflicts with—the existing network policies.\n\n![How Istio CNI Works](istio-cni.svg)\n\n### How the Istio CNI Plugin Works\n\nThe following diagram illustrates in detail what the Istio CNI does when a Pod starts:\n\n![How the Istio CNI Plugin Works](istio-cni-diagram.svg)\n\n1. It enters the Pod’s network namespace and creates a set of iptables rules to redirect traffic to the socket where **ztunnel** is listening.\n2. There’s no longer a need to inject an init container into each Pod, nor are elevated privileges required. This results in a cleaner and more secure deployment.\n3. **ztunnel** creates a socket inside each Pod’s network namespace, and does so for every Pod on the node.\n\n## Traffic Flow and Core Mechanisms\n\nAfter understanding the components, let’s dive into the heart of Ambient Mode: **the traffic path**. How do zTunnel and Waypoint intercept and forward traffic? We\u0027ll examine this through the lens of transparent traffic interception and the HBONE protocol.\n\n### Transparent Traffic Interception\n\nIn Ambient Mode, **Istio CNI** injects iptables rules into each Pod\u0027s network namespace to **transparently intercept outbound traffic** and redirect it to the local **ztunnel** process on the node. zTunnel then decides whether to forward traffic at L4 or send it to the **Waypoint Proxy** for L7 processing.\n\nAs shown in the diagram, when Kubelet starts a Pod on the node, this event is observed by the Istio CNI Agent. The agent enters the Pod’s network namespace, sets up iptables rules to redirect traffic to a local socket, and passes the Pod’s **file descriptor (FD)** to zTunnel. Once zTunnel receives the FD, it creates a socket within the Pod’s namespace.\n\nWhen the Pod sends traffic, it normally would go directly to the destination address. But because of the iptables rules, the traffic is intercepted and redirected to the local zTunnel process. zTunnel then determines whether the traffic needs L7 processing via Waypoint:\n\n- If not, it encrypts and forwards the traffic at **L4** directly to the destination Pod.\n- If **L7** functionality is needed (e.g., for authentication), it tunnels the traffic to the **Waypoint Proxy**.\n\n![Transparent Traffic Interception](transparent-traffic-interception.svg)\n\n### Packet Lifecycle Overview\n\n1. **Pod → ztunnel**: Traffic from the Pod is intercepted by the CNI and redirected to the local ztunnel on the same node.\n2. **ztunnel**: Resolves the destination address and applies mTLS encryption.\n3. **(If L7 policy is needed) ztunnel → Waypoint Proxy**: Handles HTTP authentication, routing, etc.\n4. **Waypoint Proxy**: After L7 processing, traffic is sent back to ztunnel.\n5. **ztunnel**: Decapsulates or forwards the traffic to the destination node’s ztunnel.\n6. **To the target Pod**: The destination ztunnel finally delivers the traffic to the target Pod.\n\n### The HBONE Protocol\n\nIn Ambient Mode, ztunnel and Waypoint Proxy use the **HBONE (HTTP\/2 \u002b CONNECT)** protocol to establish a secure tunnel. This enables **mTLS encryption** and multiplexing, reducing connection overhead and simplifying proxy forwarding logic.\n\n![HBONE Protocol](hbone-packet.svg)\n\nBelow is a simplified example of an HBONE CONNECT request, which uses headers like \u0060x-envoy-original-dst-host\u0060 and \u0060x-istio-auth-userinfo\u0060 to pass routing and authentication context:\n\n\u0060\u0060\u0060text\n:method: CONNECT\n:scheme: https\n:authority: Pod_B_IP:9080\n:path: \/api\/v1\/users?id=123\nx-envoy-original-dst-host: Pod_B_IP:9080\nx-forwarded-proto: hbone\nx-istio-attributes: ...\n...\n\u0060\u0060\u0060\n\nIn this example, assume ztunnel A is sending traffic to node B. The outer TCP connection is actually from \u0060ztunnel_A_IP:52368\u0060 to \u0060Node_B_IP:15008\u0060, where port 15008 is the HBONE listener on the destination node.\n\nAt the HTTP\/2 layer, a CONNECT request is initiated. The \u0060:authority\u0060 field shows \u0060Pod_B_IP:9080\u0060, indicating the actual destination port of Pod B. The \u0060x-envoy-original-dst-host\u0060 header carries the same target.\n\nYou’ll also notice custom headers like \u0060x-forwarded-proto\u0060 and \u0060x-istio-attributes\u0060, which carry routing context and security metadata for the receiving ztunnel or downstream proxy.\n\nThink of this as an “inner tunnel” built on top of HTTP\/2 CONNECT: the application-layer request (e.g., \u0060\/api\/v1\/users?id=123\u0060) is encapsulated inside, then unpacked by ztunnel B and forwarded to Pod B.\n\nThis entire process is transparent to the application. But by inspecting the CONNECT headers, we gain insight into how Ambient Mode performs traffic routing and identity verification at the HTTP\/2 layer. This flexibility makes HBONE a more adaptable alternative to traditional Sidecar-to-Sidecar communication, especially for implementing mTLS and L7 extensions.\n\n### Encrypted Traffic on the Same Node\n\nIf the source Pod and destination Pod happen to be on the same node, traffic goes through the ztunnel\u0027s L4 encryption path.\n\nAs shown here, ztunnel is deployed as a DaemonSet on each node and runs in the host network, sharing the host’s network namespace. Istio CNI intercepts the Pod\u0027s outbound traffic and redirects it to ztunnel’s port 15001. When both the source and destination Pods are on the same node, ztunnel performs encryption and decryption internally and directly forwards the traffic to the destination Pod.\n\nIf L7 traffic handling is required (e.g., authentication), ztunnel establishes an HBONE tunnel with the Waypoint proxy, and traffic is routed through the Waypoint before reaching the destination Pod.\n\n![Encrypted Traffic on the Same Node](ambient-traffic-on-the-same-node.svg)\n\n### Encrypted Traffic Across Nodes (L4)\n\nThis is the cross-node scenario, which is also the most common case:\n\nThe source node’s ztunnel encrypts the traffic via an HBONE tunnel and sends it to the destination node’s ztunnel. The destination ztunnel decapsulates the traffic and forwards it as plaintext to the destination Pod. As long as the traffic remains purely L4 and does not require L7 features, it avoids additional hops through a Waypoint proxy—reducing the proxy chain and improving efficiency.\n\n![Encrypted Traffic Across Nodes (L4)](ambient-traffic-on-the-same-node-l4.svg)\n\n### Encrypted Traffic Across Nodes (L7)\n\nWhen L7 processing is required, the traffic passes through an additional Waypoint proxy, following this flow:\n\n- The source ztunnel tunnels the traffic to the Waypoint proxy.\n- The Waypoint handles L7 logic like authentication and routing.\n- The Waypoint re-tunnels the traffic using HBONE to the destination ztunnel.\n- The destination ztunnel decapsulates the traffic and delivers it to the destination Pod.\n\n![Encrypted Traffic Across Nodes (L7)](ambient-traffic-on-the-same-node-l7.svg)\n\nThis process adds one extra proxy hop compared to L4-only traffic, but the benefit is that only traffic requiring L7 handling goes through this additional step—reducing unnecessary overhead.\n\n### Catch-All Traffic (Preventing Traffic Escape)\n\nFor traffic originating outside the Istio mesh that tries to access a Pod directly via its IP and port, Istio still needs to ensure such traffic is intercepted and managed by ztunnel to prevent it from bypassing the mesh.\n\nIf the traffic targets an application port, ztunnel checks whether the packet includes the \u00600x539\u0060 mark. If not, it redirects the traffic to port \u006015006\u0060, a plaintext port monitored by ztunnel. After processing, ztunnel adds the \u00600x539\u0060 mark and forwards it to the application port.\n\nIf the destination port is \u006015008\u0060, the packet is treated as HBONE traffic and directly handled by ztunnel.\n\n![Non-Mesh Traffic Routed into the Mesh](non-istio-mesh-pod-taffic-go-into-the-mesh.svg)\n\n### Differences Between L4 and L7 Traffic\n\n| Traffic Type | Processing Location             | Example Scenarios                                            |\n| ------------ | ------------------------------- | ------------------------------------------------------------ |\n| **L4**       | ztunnel (transparent forwarding) | TCP-level traffic that does not require application-layer policies |\n| **L7**       | ztunnel → Waypoint Proxy         | HTTP\/gRPC traffic requiring advanced features like auth, routing, observability, etc. |\n\nFor most traffic that only needs encryption and forwarding at the TCP layer, Ambient Mode relies solely on \u0060ztunnel\u0060. Only when HTTP-layer policies are required does the traffic get routed through the Waypoint proxy.\n\n## Ambient Mode vs. Sidecar Mode\n\nNow that we understand Ambient Mode, it\u0027s important to compare it with the traditional Sidecar model to evaluate which scenarios best fit each and what gaps remain.\n\n### Limitations of Ambient Mode\n\nCompared to the traditional Sidecar model, Ambient Mode still has some limitations:\n\n- When **mixing** Ambient and Sidecar modes, it’s difficult to apply fine-grained proxy configurations (e.g., \u0060EnvoyFilter\u0060) to individual Pods.\n- Support for **multi-cluster**, **multi-network**, and **VM** workloads is not yet mature and requires caution in production environments.\n- Some advanced customizations, such as **WASM plugins**, cannot be applied directly on a per-Pod basis in Ambient Mode.\n\n### Feature and Behavior Comparison\n\n| Criteria            | **Sidecar Mode**                                                   | **Ambient Mode**                                                  |\n| ------------------- | ------------------------------------------------------------------ | ----------------------------------------------------------------- |\n| **Proxy Location**  | Each Pod runs its own Envoy sidecar                                | Node-level **ztunnel** \u002b optional **Waypoint Proxy**              |\n| **Resource Overhead** | Higher CPU\/memory usage, especially in large-scale environments     | Lower overhead; proxies are shared at the node\/namespace level    |\n| **Operational Complexity** | Sidecar upgrades require rolling restarts of all affected Pods     | Upgrades are centralized to a few components (ztunnel\/Waypoint)   |\n| **Performance**     | Strong per-Pod isolation but added proxy cost per Pod              | Better L4 performance; L7 adds one more forwarding hop via Waypoint |\n| **Feature Completeness** | Mature and stable; supports multi-cluster, VMs, and hybrid networks  | Still evolving; multi-network, and VM support are under development |\n| **Typical Scenarios** | Scenarios requiring strict isolation or custom \u0060EnvoyFilter\u0060\/WASM   | Large-scale clusters, lightweight management, mostly L4 traffic   |\n\n### Recommendations\n\n1. If you\u0027re already using the **Sidecar** model and rely heavily on mature features, you can continue with Sidecar for now.\n2. If your priority is **resource savings** and **operational simplicity**, and most of your traffic is L4, try **Ambient Mode**.\n3. For hybrid needs, consider **mixed deployment**, but make sure to plan clearly around boundaries and policies for Sidecar vs. Ambient workloads.\n\n## Conclusion\n\nLet’s wrap up with a summary of Ambient Mode’s pros, cons, and where it fits best.\n\n### Key Takeaways\n\n1. **Ambient Mode** reduces per-Pod proxy overhead by removing the Sidecar, significantly lowering resource and operational costs.\n2. **ztunnel \u002b Waypoint architecture**: L7 functionality is only activated when necessary; all other traffic is forwarded efficiently at L4.\n3. Although Ambient Mode has reached **GA**, features like **multi-cluster \/ VM \/ multi-network** support still need further testing and validation.\n4. Recommended for: **large-scale clusters**, **primarily L4 traffic**, and teams with high demands on resource efficiency and centralized management.\n\nYou can find more cloud-native articles and practical insights on my blog at [jimmysong.io](https:\/\/jimmysong.io). If you have any questions about this post or Istio in general, feel free to leave a comment or join the community discussion. Thank you!', '\/en\/blog\/beyond-sidecar\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">This post introduces the background, core components, traffic flow mechanisms, and comparisons between Ambient Mode and the traditional Sidecar model in Istio—helping you evaluate and get started with this new feature quickly.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      Columns
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/en/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(54)</span>
        </a>
      
        <a href="/en/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(12)</span>
        </a>
      
        <a href="/en/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(7)</span>
        </a>
      
        <a href="/en/categories/cloud-native" class="sidebar-item">
            <span>Cloud Native</span>
            <span>(5)</span>
        </a>
      
        <a href="/en/categories/essays" class="sidebar-item">
            <span>Essays</span>
            <span>(5)</span>
        </a>
      
        <a href="/en/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(2)</span>
        </a>
      
        <a href="/en/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(2)</span>
        </a>
      
        <a href="/en/categories/open-source" class="sidebar-item">
            <span>Open Source</span>
            <span>(2)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      Book
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/en/categories/translation" class="sidebar-item">
            <span>Translation</span>
            <span>(6)</span>
        </a>
      
        <a href="/en/categories/original" class="sidebar-item">
            <span>Original</span>
            <span>(2)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">Contact</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">Jimmy&rsquo;s LinkedIn</li>
            
            
            <li class="mb-4"><img src="/images/jimmysong-linkedin.png" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Blog</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/blog/beyond-sidecar/">Beyond Sidecar: A Deep Dive into Istio Ambient Mode Traffic Mechanism and Cost Efficiency</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/istio-ambient-l7-flow-analysis/">Understanding L7 Traffic Management in Istio Ambient Mode: From ztunnel to Waypoint Proxy</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/envoy-ext-proc-guide/">Advanced Request and Response Processing in Microservice Architecture with Envoy&#39;s External Processing Filter</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">links</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" >
                  Awesome Cloud Native
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://gateway.envoyproxy.io" target="_blank" rel="noopener noreferrer">
                  Envoy Gateway
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io" target="_blank" rel="noopener noreferrer">
                  Istio
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate - Service Mesh Company
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://docs.tetrate.io/istio-subscription/" target="_blank" rel="noopener noreferrer">
                  Tetrate Istio Subscription
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Courses</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals" target="_blank" rel="noopener noreferrer">
                  Envoy Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals" target="_blank" rel="noopener noreferrer">
                  Istio Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">new notice</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-china-2024-panel/">KubeCon China 2024 panel Preview: Istio and Modern API Gateways – Leading the Future of Service Mesh</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/website-revamp-notice/">Website Revamp Notice</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-eu-2024/">See you in KubeCon Paris!</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2025 Jimmy Song All Right Reserved</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/en/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/en/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />










<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>






  





<script src="/js/wowchemy-search.min.ce03c611044441cf6e84f9e4bef20818.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
