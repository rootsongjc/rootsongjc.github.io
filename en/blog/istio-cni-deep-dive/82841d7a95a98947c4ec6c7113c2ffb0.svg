<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="max-width:508.551px;background-color:#fff" id="my-svg" width="100%" aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 508.551 1215.477"><style>#my-svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;fill:#000}#my-svg .edge-thickness-normal{stroke-width:2px}#my-svg .edge-pattern-solid{stroke-dasharray:0}#my-svg .marker{fill:#0b0b0b;stroke:#0b0b0b}#my-svg .marker.cross{stroke:#0b0b0b}#my-svg .label,#my-svg svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif}#my-svg svg{font-size:16px}#my-svg .label{color:#fff}#my-svg .cluster span,#my-svg .cluster-label span{color:#000}#my-svg span{fill:#fff;color:#fff}#my-svg .node circle,#my-svg .node path,#my-svg .node polygon,#my-svg .node rect{fill:#0a55a7;stroke:transparent;stroke-width:1px}#my-svg .node .label{text-align:center}#my-svg .flowchart-link{stroke:#0b0b0b;fill:none}#my-svg .edgeLabel{background-color:gray;text-align:center}#my-svg .edgeLabel rect{opacity:.5;background-color:gray;fill:gray}#my-svg .cluster rect{fill:#fafafa;stroke:#714d27;stroke-width:1px}#my-svg :root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif}</style><g><marker id="my-svg_flowchart-pointEnd" class="marker flowchart" markerHeight="12" markerUnits="userSpaceOnUse" markerWidth="12" orient="auto" refX="6" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath"/></marker><marker id="my-svg_flowchart-pointStart" class="marker flowchart" markerHeight="12" markerUnits="userSpaceOnUse" markerWidth="12" orient="auto" refX="4.5" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath"/></marker><marker id="my-svg_flowchart-circleEnd" class="marker flowchart" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="11" refY="5" viewBox="0 0 10 10"><circle style="stroke-width:1;stroke-dasharray:1,0" cx="5" cy="5" r="5" class="arrowMarkerPath"/></marker><marker id="my-svg_flowchart-circleStart" class="marker flowchart" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="-1" refY="5" viewBox="0 0 10 10"><circle style="stroke-width:1;stroke-dasharray:1,0" cx="5" cy="5" r="5" class="arrowMarkerPath"/></marker><marker id="my-svg_flowchart-crossEnd" class="marker cross flowchart" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="12" refY="5.2" viewBox="0 0 11 11"><path style="stroke-width:2;stroke-dasharray:1,0" d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath"/></marker><marker id="my-svg_flowchart-crossStart" class="marker cross flowchart" markerHeight="11" markerUnits="userSpaceOnUse" markerWidth="11" orient="auto" refX="-1" refY="5.2" viewBox="0 0 11 11"><path style="stroke-width:2;stroke-dasharray:1,0" d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath"/></marker><g class="root"><g class="clusters"><g id="subGraph0" class="cluster default flowchart-label"><rect width="492.551" height="915" x="0" y="0" rx="0" ry="0"/><g class="cluster-label" transform="translate(178.302734375, 0)"><foreignObject width="135.945" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Kubernetes Cluster</span></div></foreignObject></g></g></g><g class="edgePaths"><path style="fill:none" id="L-A-B-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,58.5L251.012,64.208C251.012,69.917,251.012,81.333,251.012,91.867C251.012,102.4,251.012,112.05,251.012,116.875L251.012,121.7" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B"/><path style="fill:none" id="L-B-C-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,160.5L251.012,164.667C251.012,168.833,251.012,177.167,251.078,184.7C251.144,192.234,251.276,198.967,251.342,202.334L251.408,205.701" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C"/><path style="fill:none" id="L-C-D-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M220.857,303.345L210.023,314.079C199.188,324.813,177.52,346.282,166.686,361.841C155.852,377.4,155.852,387.05,155.852,391.875L155.852,396.7" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D"/><path style="fill:none" id="L-C-E-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M282.167,303.345L292.834,314.079C303.502,324.813,324.837,346.282,335.504,361.841C346.172,377.4,346.172,387.05,346.172,391.875L346.172,396.7" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-E"/><path style="fill:none" id="L-D-F-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M155.852,435.5L155.852,439.667C155.852,443.833,155.852,452.167,164.54,460.145C173.228,468.124,190.604,475.747,199.292,479.559L207.98,483.371" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F"/><path style="fill:none" id="L-E-F-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M346.172,435.5L346.172,439.667C346.172,443.833,346.172,452.167,337.484,460.145C328.796,468.124,311.419,475.747,302.731,479.559L294.043,483.371" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F"/><path style="fill:none" id="L-F-G-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,519L251.012,524.708C251.012,530.417,251.012,541.833,251.012,552.367C251.012,562.9,251.012,572.55,251.012,577.375L251.012,582.2" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G"/><path style="fill:none" id="L-G-H-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,621L251.012,625.167C251.012,629.333,251.012,637.667,251.012,645.117C251.012,652.567,251.012,659.133,251.012,662.417L251.012,665.7" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H"/><path style="fill:none" id="L-H-I-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,704.5L251.012,710.208C251.012,715.917,251.012,727.333,251.012,737.867C251.012,748.4,251.012,758.05,251.012,762.875L251.012,767.7" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I"/><path style="fill:none" id="L-I-J-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,806.5L251.012,810.667C251.012,814.833,251.012,823.167,251.012,830.617C251.012,838.067,251.012,844.633,251.012,847.917L251.012,851.2" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J"/><path style="fill:none" id="L-J-K-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M251.012,890L251.012,894.167C251.012,898.333,251.012,906.667,251.012,915C251.012,923.333,251.012,931.667,251.078,939.2C251.144,946.734,251.276,953.467,251.342,956.834L251.408,960.201" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-J LE-K"/><path style="fill:none" id="L-K-L-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M213.912,1060.377L198.106,1072.268C182.301,1084.16,150.689,1107.943,134.884,1124.66C119.078,1141.377,119.078,1151.027,119.078,1155.852L119.078,1160.677" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L"/><path style="fill:none" id="L-K-M-0" marker-end="url(#my-svg_flowchart-pointEnd)" d="M289.112,1060.377L304.751,1072.268C320.39,1084.16,351.667,1107.943,367.306,1124.66C382.945,1141.377,382.945,1151.027,382.945,1155.852L382.945,1160.677" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-M"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(251.01171875, 92.75) translate(-32.7578125, -9.25)"><foreignObject width="65.516" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Detected</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(155.8515625, 367.75) translate(-50.4609375, -9.25)"><foreignObject width="100.922" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Newly Started</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(346.171875, 367.75) translate(-57.7734375, -9.25)"><foreignObject width="115.547" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Already Running</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(251.01171875, 553.25) translate(-117.6875, -9.25)"><foreignObject width="235.375" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Enters Pod&apos;s Network Namespace</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(251.01171875, 738.75) translate(-162.87890625, -9.25)"><foreignObject width="325.758" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Creates Listening Sockets in Pod&apos;s Namespace</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(119.078125, 1131.7265625) translate(-19.18359375, -9.25)"><foreignObject width="38.367" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">mTLS</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(382.9453125, 1131.7265625) translate(-32.390625, -9.25)"><foreignObject width="64.781" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Plaintext</span></div></foreignObject></g></g></g><g class="nodes"><g id="flowchart-B-1" class="node default flowchart-label" data-id="B" data-node="true" transform="translate(251.01171875, 143.75)"><rect width="157.492" height="33.5" x="-78.746" y="-16.75" class="basic label-container" rx="5" ry="5"/><g class="label" transform="translate(-71.24609375, -9.25)"><rect/><foreignObject width="142.492" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">istio-cni node agent</span></div></foreignObject></g></g><g id="flowchart-A-0" class="node default flowchart-label" data-id="A" data-node="true" transform="translate(251.01171875, 41.75)"><rect width="324.141" height="33.5" x="-162.07" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-154.5703125, -9.25)"><rect/><foreignObject width="309.141" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Pod with istio.io/dataplane-mode=ambient</span></div></foreignObject></g></g><g id="flowchart-C-3" class="node default flowchart-label" data-id="C" data-node="true" transform="translate(251.01171875, 272)"><polygon points="61.5 0 123 -61.5 61.5 -123 0 -61.5" class="label-container" transform="translate(-61.5,61.5)"/><g class="label" transform="translate(-37.25, -9.25)"><rect/><foreignObject width="74.5" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Pod Status</span></div></foreignObject></g></g><g id="flowchart-D-5" class="node default flowchart-label" data-id="D" data-node="true" transform="translate(155.8515625, 418.75)"><rect width="159.266" height="33.5" x="-79.633" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-72.1328125, -9.25)"><rect/><foreignObject width="144.266" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">CNI Plugin Triggered</span></div></foreignObject></g></g><g id="flowchart-E-7" class="node default flowchart-label" data-id="E" data-node="true" transform="translate(346.171875, 418.75)"><rect width="121.375" height="33.5" x="-60.688" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-53.1875, -9.25)"><rect/><foreignObject width="106.375" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">New Pod Event</span></div></foreignObject></g></g><g id="flowchart-F-10" class="node default flowchart-label" data-id="F" data-node="true" transform="translate(251.01171875, 502.25)"><rect width="170.883" height="33.5" x="-85.441" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-77.94140625, -9.25)"><rect/><foreignObject width="155.883" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Configure Redirection</span></div></foreignObject></g></g><g id="flowchart-G-12" class="node default flowchart-label" data-id="G" data-node="true" transform="translate(251.01171875, 604.25)"><rect width="229.883" height="33.5" x="-114.941" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-107.44140625, -9.25)"><rect/><foreignObject width="214.883" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Establish Network Redirection</span></div></foreignObject></g></g><g id="flowchart-H-14" class="node default flowchart-label" data-id="H" data-node="true" transform="translate(251.01171875, 687.75)"><rect width="159.406" height="33.5" x="-79.703" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-72.203125, -9.25)"><rect/><foreignObject width="144.406" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Notify Node Ztunnel</span></div></foreignObject></g></g><g id="flowchart-I-16" class="node default flowchart-label" data-id="I" data-node="true" transform="translate(251.01171875, 789.75)"><rect width="259.641" height="33.5" x="-129.82" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-122.3203125, -9.25)"><rect/><foreignObject width="244.641" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Node-local Ztunnel Proxy Instance</span></div></foreignObject></g></g><g id="flowchart-J-18" class="node default flowchart-label" data-id="J" data-node="true" transform="translate(251.01171875, 873.25)"><rect width="233.93" height="33.5" x="-116.965" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-109.46484375, -9.25)"><rect/><foreignObject width="218.93" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Traffic Redirection Established</span></div></foreignObject></g></g><g id="flowchart-K-20" class="node default flowchart-label" data-id="K" data-node="true" transform="translate(251.01171875, 1031.23828125)"><polygon points="66.238 0 132.477 -66.238 66.238 -132.477 0 -66.238" class="label-container" transform="translate(-66.23828125,66.23828125)"/><g class="label" transform="translate(-41.98828125, -9.25)"><rect/><foreignObject width="83.977" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Traffic Type</span></div></foreignObject></g></g><g id="flowchart-L-22" class="node default flowchart-label" data-id="L" data-node="true" transform="translate(119.078125, 1182.7265625)"><rect width="229.547" height="33.5" x="-114.773" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-107.2734375, -9.25)"><rect/><foreignObject width="214.547" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Encrypted Traffic Within Mesh</span></div></foreignObject></g></g><g id="flowchart-M-24" class="node default flowchart-label" data-id="M" data-node="true" transform="translate(382.9453125, 1182.7265625)"><rect width="198.188" height="33.5" x="-99.094" y="-16.75" class="basic label-container" rx="0" ry="0"/><g class="label" transform="translate(-91.59375, -9.25)"><rect/><foreignObject width="183.188" height="18.5"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="nodeLabel">Handling Plaintext Traffic</span></div></foreignObject></g></g></g></g></g></svg>