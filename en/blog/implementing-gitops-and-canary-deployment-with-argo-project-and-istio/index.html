<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  
  <title>Implementing GitOps and Canary Deployment with Argo Project and Istio · Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="This article discusses how to use Deployment, ArgoCD, and Istio to implement GitOps and canary deployment. ">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.129.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.10cc29dc94114b03907db3131a2a0b871735964d59cce9d69637f50ea22698ae.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.10cc29dc94114b03907db3131a2a0b871735964d59cce9d69637f50ea22698ae.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/" />
  <meta property="og:title" content="Implementing GitOps and Canary Deployment with Argo Project and Istio | Jimmy Song" />
  <meta property="twitter:title" content="Implementing GitOps and Canary Deployment with Argo Project and Istio | Jimmy Song" />

  
  <meta property="og:description" content="This article discusses how to use Deployment, ArgoCD, and Istio to implement GitOps and canary deployment. " />
  <meta property="twitter:description" content="This article discusses how to use Deployment, ArgoCD, and Istio to implement GitOps and canary deployment. " />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/argo-sk-istio.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/argo-sk-istio.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/en">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/blog">Blog</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/book">Library</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/tags">Tags</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/notice">Notice</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/contact">Contact</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/about">About</a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    
                  
                
              
              
              
                
                  
                    
                    <a class="nav-link" href="/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/">中文</a>
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>Search</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>Search</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="Close"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="Input the keyword" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="Input the keyword">
        
        <div class="mt-4">
          <span>Search type: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">All</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">Blog</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">Book</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">Notice</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    Implementing GitOps and Canary Deployment with Argo Project and Istio
                </p>
                <p class="page-description">
                    This article discusses how to use Deployment, ArgoCD, and Istio to implement GitOps and canary deployment.
                </p>
                
                <div class="page-metadata">
                  <ul class="list-inline d-flex">
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-calendar"></i>
                        </span>Aug 31, 2023</li>
                    
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-folder-open"></i>
                        </span><a
                        href="/en/categories/istio"> 
                        Istio</a> </li>
                    
                    
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-clock"></i>
                        </span>13 Minute</li>
                    <li class="list-inline-item mr-2 mb-md-0 d-sm-block d-none"><span><i class="fa-regular fa-file-word"></i>
                        </span>2834 words</li>
                    
                    
                  </ul>
                </div>
                
            </div>
        </div>
    </div>
</section>

        


  <div class="container-xl blog mb-4">
    <div class="row">
      <div class="col-xl-8">
        <div class="row">
          
          <div class="col-12 content py-md-3">
            
            <details class="mobile-toc d-sm-none d-block mb-0">
  <summary>Click to show the outline</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#deployment-strategy">Deployment strategy</a></li>
    <li><a href="#release-strategy-of-kubernetes-deployment">Release strategy of Kubernetes Deployment</a></li>
    <li><a href="#implementing-gitops-with-argocd">Implementing GitOps with ArgoCD</a></li>
    <li><a href="#using-istio-to-achieve-fine-grained-traffic-routing">Using Istio to achieve fine-grained traffic routing</a></li>
    <li><a href="#demo">Demo</a>
      <ul>
        <li><a href="#deploy-argocd-and-argo-rollouts">Deploy ArgoCD and Argo Rollouts</a></li>
        <li><a href="#deploy-bookinfo-application">Deploy Bookinfo Application</a></li>
      </ul>
    </li>
    <li><a href="#implementing-fine-grained-traffic-management-with-istio">Implementing Fine-grained Traffic Management with Istio</a>
      <ul>
        <li><a href="#converting-deployment-to-rollout">Converting Deployment to Rollout</a></li>
      </ul>
    </li>
    <li><a href="#cleaning-up">Cleaning Up</a></li>
    <li><a href="#principles-of-argo-rollouts">Principles of Argo Rollouts</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
</details>

            
            <p>The development of cloud-native applications has led to a shift in development to the left and a higher frequency of application iteration, which has given rise to the need for GitOps. This article will introduce how to use the Argo project, including ArgoCD and Argo Rollouts, to achieve GitOps and canary deployment with Istio. There is also a demonstration in the article that shows how to achieve GitOps based on the Istio environment provided by Tetrate Service Express (also applicable to Tetrate Service Bridge).</p>
<p>The deployment architecture diagram of the demo in this article is shown in Figure 1. If you are already familiar with the deployment strategies and Argo projects introduced in this article, you can skip directly to the demo section.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f1.svg" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f1.svg" alt="image" data-caption="Figure 1: Architecture diagram of using Istio and Argo projects in TSE/TSB to achieve GitOps and canary release">
        
      
    
  
  
  <figcaption>Figure 1: Architecture diagram of using Istio and Argo projects in TSE/TSB to achieve GitOps and canary release</figcaption>
  
</figure>
<h2 id="deployment-strategy">Deployment strategy</h2>
<p>First of all, I want to briefly introduce the two deployment strategies supported by Argo Rollouts, which can achieve zero-downtime deployment.</p>
<p>The steps of blue-green deployment and canary deployment are shown in Figure 2.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f2.svg" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f2.svg" alt="image" data-caption="Figure 2: Steps of blue-green deployment and canary deployment">
        
      
    
  
  
  <figcaption>Figure 2: Steps of blue-green deployment and canary deployment</figcaption>
  
</figure>
<ul>
<li>Blue-green deployment is a strategy that deploys the new version of the application in a separate environment in parallel without affecting the current production environment. In blue-green deployment, the current production environment is called the &ldquo;blue environment,&rdquo; and the environment where the new version of the application is deployed is called the &ldquo;green environment.&rdquo; Once the green environment is considered stable and has passed the test, the traffic will gradually switch from the blue environment to the green environment, allowing users to gradually access the new version. If problems occur during the switching process, it can be quickly rolled back to the blue environment to minimize the impact on users. The advantage of blue-green deployment is that it can provide high availability and zero-downtime deployment.</li>
<li>Canary deployment is a strategy for gradually introducing new versions or features into the production environment. In canary deployment, the new version or feature is first deployed to a small number of users in the production environment, called &ldquo;canary users.&rdquo; By monitoring the feedback and performance indicators of canary users, the development team can evaluate the stability and reliability of the new version or feature. If there are no problems, more users can be gradually included in the canary deployment until all users use the new version. If a problem is found, it can be quickly rolled back or fixed to avoid negative effects on the entire user group. The advantage of canary deployment is that it can quickly identify problems and make adjustments in a small impact area.</li>
</ul>
<p>The main difference between blue-green deployment and canary deployment is the deployment method and the scale of the changes. Blue-green deployment deploys the entire application in a new environment and then switches, which is suitable for large-scale changes, such as major upgrades of the entire application. Canary deployment gradually introduces new versions or features, which is suitable for small-scale changes, such as adding or modifying a single feature.</p>
<p>In terms of application scenarios, blue-green deployment is suitable for systems with higher requirements for high availability and zero-downtime deployment. When deploying large-scale changes, blue-green deployment can ensure stability and reliability and can quickly roll back to cope with unexpected situations. Canary deployment is suitable for systems that need to quickly verify new features or versions. By gradually introducing changes, problems can be discovered early and adjustments can be made to minimize the impact on users.</p>
<h2 id="release-strategy-of-kubernetes-deployment">Release strategy of Kubernetes Deployment</h2>
<p>In Kubernetes, the Deployment resource object is one of the main tools for managing the deployment and updating of applications. Deployment provides a declarative way to define the expected state of an application and implements the release strategy through the controller&rsquo;s functionality. The architecture of Deployment is shown in Figure 3, where the colored squares represent pods of different versions.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f3.svg" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f3.svg" alt="image" data-caption="Figure 3: Architecture diagram of Kubernetes Deployment">
        
      
    
  
  
  <figcaption>Figure 3: Architecture diagram of Kubernetes Deployment</figcaption>
  
</figure>
<p>The release strategy can be configured in the spec field of Deployment. Here are some common release policy options:</p>
<ol>
<li><strong>Management of ReplicaSet</strong>: Deployment uses ReplicaSet to create and manage replicas of an application. The desired number of replicas can be specified by setting the <code>spec.replicas</code> field. During the release process, the Kubernetes controller ensures that the number of replicas of the new version&rsquo;s ReplicaSet gradually increases when created, and the number of replicas of the old version&rsquo;s ReplicaSet gradually decreases when deleted to achieve a smooth switch.</li>
<li><strong>Rolling update policy</strong>: Deployment supports multiple rolling update policies, which can be selected by setting the <code>spec.strategy.type</code> field. Common policies include:
<ul>
<li><strong>RollingUpdate</strong>: The default policy updates replicas gradually at a certain time interval. The number of replicas that are not available at the same time and the number of additional available replicas can be controlled by setting the <code>spec.strategy.rollingUpdate.maxUnavailable</code> and <code>spec.strategy.rollingUpdate.maxSurge</code> fields.</li>
<li><strong>Recreate</strong>: This policy first deletes all replicas of the old version during the update process and then creates replicas of the new version. This policy will cause the application to be temporarily unavailable during the update.</li>
</ul>
</li>
<li><strong>Version control</strong>: Deployment sets labels for each version&rsquo;s ReplicaSet through the <code>spec.template.metadata.labels</code> field so that the controller can track and manage them accurately. This way, multiple versions of ReplicaSet can coexist, and the number of replicas of each version can be accurately controlled.</li>
</ol>
<p>By using these configuration options, Deployment can achieve different release strategies. Updating the spec field of the Deployment object can trigger the release of a new version. The Kubernetes controller will automatically handle the creation, update, and deletion of replicas according to the specified policy to achieve smooth application updates and deployment strategies.</p>
<h2 id="implementing-gitops-with-argocd">Implementing GitOps with ArgoCD</h2>
<p>You can use Deployment to manually manage release strategies, but to achieve automation, we also need to use GitOps tools such as ArgoCD.</p>
<p>ArgoCD is a GitOps-based continuous delivery tool used to automate and manage the deployment of Kubernetes applications. It provides some key help to improve the efficiency and reliability of application deployment.</p>
<p>Here are some of the help ArgoCD provides for Kubernetes application deployment:</p>
<ol>
<li><strong>Declarative configuration</strong>: ArgoCD uses a declarative way to define the expected state of an application and stores the application configuration in a Git repository. By versioning and continuous integration/continuous delivery (CI/CD) processes, it is easy to track and manage application configuration changes.</li>
<li><strong>Continuous deployment</strong>: ArgoCD can monitor configuration changes in the Git repository and automatically deploy the application to the Kubernetes environment. It provides customizable synchronization policies that can automatically trigger application deployment and updates, achieving continuous deployment.</li>
<li><strong>State comparison and automatic repair</strong>: ArgoCD periodically checks the current state of the application and compares it with the expected state. If inconsistencies are found, it will automatically try to repair and restore the application to the desired state to ensure consistency between the expected and actual states.</li>
<li><strong>Multi-environment management</strong>: ArgoCD supports managing multiple Kubernetes environments, such as development, testing, and production environments. It is easy to deploy and synchronize application configurations between different environments, ensuring consistency and controllability.</li>
</ol>
<p>Compared to Deployment resource objects, ArgoCD provides more advanced features and workflows that complement the capabilities of native Kubernetes resource objects:</p>
<p><strong>GitOps-based configuration management</strong>: ArgoCD stores application configuration in a Git repository, enabling GitOps-based configuration management. This approach ensures that configuration changes are traceable, auditable, and can be integrated with existing CI/CD pipelines.</p>
<p><strong>Automated deployment and continuous delivery</strong>: ArgoCD can automatically detect configuration changes in the Git repository and deploy applications to Kubernetes environments, enabling automated deployment and continuous delivery.</p>
<p><strong>State management and automatic recovery</strong>: ArgoCD continuously monitors the state of applications and compares it to the expected state. If inconsistencies are detected, it automatically recovers and ensures that the application state remains consistent with the expected state.</p>
<h2 id="using-istio-to-achieve-fine-grained-traffic-routing">Using Istio to achieve fine-grained traffic routing</h2>
<p>Although ArgoCD can implement GitOps, it essentially operates on Kubernetes Deployment and controls traffic routing through replica numbers. To achieve fine-grained traffic routing, services meshes like Istio are used.</p>
<p>Istio achieves finer-grained traffic routing and application release through the following methods:</p>
<p><strong>VirtualService</strong>: Istio uses VirtualService to define traffic routing rules. By configuring VirtualService, traffic can be routed and distributed based on request attributes such as request headers, paths, weights, etc., directing requests to different service instances or versions.</p>
<p><strong>DestinationRule</strong>: Istio&rsquo;s DestinationRule is used to define service version policies and load balancing settings. By specifying different traffic weights between service instances of different versions, advanced application release policies such as canary release or blue-green deployment can be implemented.</p>
<p><strong>Traffic control and policies</strong>: Istio provides rich traffic control and policy capabilities such as traffic limiting, fault injection, timeout settings, retry mechanisms, etc. These features help applications achieve higher-level load balancing, fault tolerance, and reliability requirements.</p>
<p>Compared to ArgoCD and Kubernetes Deployment objects, Istio provides the following advantages in application deployment:</p>
<p><strong>Fine-grained traffic routing control</strong>: Istio provides richer traffic routing capabilities, enabling flexible routing and distribution based on a variety of request attributes, allowing for finer-grained traffic control and management.</p>
<p><strong>Advanced release policy support</strong>: Istio&rsquo;s DestinationRule can specify traffic weights between different versions of service instances, supporting advanced application release policies such as canary release and blue-green deployment. This makes version management and release of applications more flexible and controllable.</p>
<p><strong>Powerful traffic control and policy capabilities</strong>: Istio provides rich traffic control and policy capabilities such as traffic limiting, fault injection, timeout settings, retry mechanisms, etc. These features help applications achieve higher-level load balancing, fault tolerance, and reliability requirements.</p>
<p>Combining Istio with Argo Rollouts can fully leverage the advantages of Istio&rsquo;s fine-grained traffic routing. Let&rsquo;s now have a demo together. In our demo, we will use the Kubernetes and Istio environments provided by TSE, implement GitOps using ArgoCD, and implement canary release using Argo Rollouts.</p>
<h2 id="demo">Demo</h2>
<p>The software versions used in our demo are:</p>
<ul>
<li>Kubernetes v1.24.14</li>
<li>Istio v1.15.7</li>
<li>ArgoCD v2.7.4</li>
<li>Argo Rollouts v1.5.1</li>
<li>TSE Preview2</li>
</ul>
<p>We will use Istio&rsquo;s VirtualService and DestinationRule to implement traffic grouping routing based on Subset, and use ArgoCD Rollouts for progressive release.</p>
<h3 id="deploy-argocd-and-argo-rollouts">Deploy ArgoCD and Argo Rollouts</h3>
<p>I have created a Kubernetes cluster and added it to TSE in advance, and TSE will automatically install Istio control plane for the cluster. We also need to install ArgoCD and Argo Rollouts:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Install ArgoCD</span>
</span></span><span class="line"><span class="cl">kubectl create namespace argocd
</span></span><span class="line"><span class="cl">kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install ArgoCD CLI on macOS</span>
</span></span><span class="line"><span class="cl">brew install argocd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Change the service type of argocd-server to LoadBalancer</span>
</span></span><span class="line"><span class="cl">kubectl patch svc argocd-server -n argocd -p <span class="s1">&#39;{&#34;spec&#34;: {&#34;type&#34;: &#34;LoadBalancer&#34;}}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get the ArgoCD UI address</span>
</span></span><span class="line"><span class="cl"><span class="nv">ARGOCD_ADDR</span><span class="o">=</span><span class="k">$(</span>kubectl get svc argocd-server -n argocd -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Login using ArgoCD CLI, see https://argo-cd.readthedocs.io/en/stable/getting_started/#4-login-using-the-cli to get password</span>
</span></span><span class="line"><span class="cl">argocd login <span class="nv">$ARGOCD_ADDR</span> --skip-test-tls --grpc-web --insecure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install Argo Rollouts</span>
</span></span><span class="line"><span class="cl">kubectl create namespace argo-rollouts
</span></span><span class="line"><span class="cl">kubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/download/latest/install.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install rollouts plugin on macOS</span>
</span></span><span class="line"><span class="cl">curl -LO https://github.com/argoproj/argo-rollouts/releases/download/v1.5.0/kubectl-argo-rollouts-darwin-amd64
</span></span><span class="line"><span class="cl">chmod +x ./kubectl-argo-rollouts-darwin-amd64
</span></span><span class="line"><span class="cl">sudo mv ./kubectl-argo-rollouts-darwin-amd64 /usr/local/bin/kubectl-argo-rollouts
</span></span></code></pre></div><p>This feature is not applicable to TSE Bridge Mode, so we will use TSE Direct Mode to achieve progressive release.</p>



<div class="alert alert-note-container">
  
  <div class="alert-note-title px-2 py-2">
    💡 What is Bridge Mode and Direct Mode?
  </div>
  
  <div class="alert-note px-2">
    Direct Mode and Bridge Mode are two modes in TSE for control plane to issue configuration. They are suitable for flow, security, and gateway group configuration modes. BRIDGED mode is a minimalist mode that allows users to quickly configure the most commonly used features in the service mesh using Tetrate-specific APIs, while DIRECT mode provides greater flexibility for advanced users, allowing them to configure using Istio APIs directly.
  </div>
</div>

<p>Next, deploy Rollouts Dashboard:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/argoproj/argo-rollouts.git
</span></span><span class="line"><span class="cl">kustomize build manifests/dashboard-install<span class="p">|</span>kubectl apply -n argo-rollouts -f -
</span></span><span class="line"><span class="cl">kubectl port-forward svc/argo-rollouts-dashboard -n argo-rollouts 3100:3100
</span></span></code></pre></div><p>You can now access the Rollouts Dashboard at <a href="https://localhost:3100/rollouts/" title="https://localhost:3100/rollouts/" target="_blank" rel="noopener">https://localhost:3100/rollouts/</a>.</p>
<h3 id="deploy-bookinfo-application">Deploy Bookinfo Application</h3>
<p>We have prepared the configuration file for the Bookinfo application (saved in the <a href="https://github.com/tetrateio/tse-gitops-demo/" title="tse-gitops-demo" target="_blank" rel="noopener">tse-gitops-demo</a> repository), and you can also fork it to your own account and replace it with your own repository. Run the following command to deploy the Bookinfo application:</p>
<pre tabindex="0"><code>argocd app create bookinfo-app --repo https://github.com/tetrateio/tse-gitops-demo.git --path application --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated
</code></pre><p>Note: We set <code>replicas</code> to <code>0</code> in the <a href="https://github.com/tetrateio/tse-gitops-demo/blob/main/application/bookinfo.yaml#L151" title="&lt;code&gt;reviews&lt;/code&gt; Deployment" target="_blank" rel="noopener"><code>reviews</code> Deployment</a> because we will create Argo Rollouts to manipulate the number of instances of the <code>reviews</code> service. If you set it to a non-zero positive integer here, we will not be able to achieve canary deployment.</p>
<p>Now you can open the ArgoCD UI in your browser, as shown in Figure 4.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          
          <picture>
           <source srcset="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4_hu2adde1e204b15f6e0c3ec1d5cd693523_379147_3836x1928_resize_q75_h2_lanczos_3.webp" type="image/webp">
           <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4.png" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f4.png" data-width="3836" data-height="1928" alt="image" data-caption="Figure 4: ArgoCD UI">
          </picture>
        
      
    
  
  
  <figcaption>Figure 4: ArgoCD UI</figcaption>
  
</figure>
<p>If you find that the application status is not in sync, you can run the following command or click the SYNC button in the UI.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">argocd app sync bookinfo-app
</span></span></code></pre></div><h2 id="implementing-fine-grained-traffic-management-with-istio">Implementing Fine-grained Traffic Management with Istio</h2>
<p>First, let&rsquo;s use Argo CD to create Istio-related resource objects:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">argocd app create bookinfo-tse-conf --repo https://github.com/tetrateio/tse-gitops-demo.git --path argo/tse --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated --self-heal
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check the creation status</span>
</span></span><span class="line"><span class="cl">argocd app get bookinfo-tse-conf
</span></span></code></pre></div><h3 id="converting-deployment-to-rollout">Converting Deployment to Rollout</h3>
<p>Suppose we want to release a new version of the <code>reviews</code> service. To achieve zero downtime updates, we will use canary deployment, with the following steps:</p>
<ol>
<li>Reduce the <code>replicas</code> of the <code>reviews</code> Deployment to 0;</li>
<li>Create a Rollout that references the <code>reviews</code> Deployment previously deployed in the Bookinfo application;</li>
<li>Send traffic to the <code>reviews</code> service to achieve automatic canary deployment progress.</li>
</ol>
<p>You can view the Rollout and AnalysisTemplate configurations used in this demo on <a href="https://github.com/tetrateio/tse-gitops-demo/tree/main/argo/rollout" title="GitHub" target="_blank" rel="noopener">GitHub</a>. Run the following command to deploy <code>reivews-rollout</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">argocd app create reviews-rollout --repo https://github.com/tetrateio/tse-gitops-demo.git --path argo/rollout --dest-server https://kubernetes.default.svc --dest-namespace bookinfo --sync-policy automated
</span></span></code></pre></div><p>Note: We can use the <code>argocd</code> command to deploy or use <code>kubectl apply</code>. It is recommended to use <code>argocd</code> because you can view the deployment status in ArgoCD UI and Argo Rollouts Dashboard at the same time and manage the deployment using the <code>argocd</code> command.</p>
<p>View the status of the <code>reviews</code> rollouts in the <a href="https://localhost:3001/rollouts/bookinfo" title="Argo Rollouts Dashboard" target="_blank" rel="noopener">Argo Rollouts Dashboard</a>, and use the following command to send traffic to the <code>reviews</code> service for a period of time:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">GATEWAY_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl -n bookinfo get service tsb-gateway-bookinfo -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> 1<span class="p">;</span><span class="k">do</span> curl -H <span class="s2">&#34;Host: bookinfo.tetrate.com&#34;</span> http://<span class="nv">$GATEWAY_HOSTNAME</span>/api/v1/products/1/reviews<span class="p">;</span>sleep 3<span class="p">;</span><span class="k">done</span>
</span></span></code></pre></div><p>You will see responses from pods with different rollouts-pod-template-hash labels in the output, which proves that canary deployment is effective. After about 10 minutes, the Argo Rollouts Dashboard you see will be as shown in Figure 5.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          
          <picture>
           <source srcset="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5_hu11170ce2820faa5c8b7ec39c7019924c_276397_3584x2240_resize_q75_h2_lanczos_3.webp" type="image/webp">
           <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5.png" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f5.png" data-width="3584" data-height="2240" alt="image" data-caption="Figure 5: Argo Rollout Dashboard">
          </picture>
        
      
    
  
  
  <figcaption>Figure 5: Argo Rollout Dashboard</figcaption>
  
</figure>
<p>From Figure 5, we can see that canary deployment is progressing smoothly and has reached the third step. This is because the <code>apdex</code> (Application Performance Index) indicator of the <code>reviews</code> service is normal. You can use <a href="https://tetrate.io/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/" title="Postman to submit GraphQL queries to SkyWalking" target="_blank" rel="noopener">Postman to submit GraphQL queries to SkyWalking</a> to verify this, as shown in Figure 6.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          
          <picture>
           <source srcset="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6_hu5685ceb7be9c9e3d2b3ef1f9496adc1b_381735_3584x2040_resize_q75_h2_lanczos_3.webp" type="image/webp">
           <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6.png" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f6.png" data-width="3584" data-height="2040" alt="image" data-caption="Figure 6: Submitting GraphQL queries to SkyWalking using Postman">
          </picture>
        
      
    
  
  
  <figcaption>Figure 6: Submitting GraphQL queries to SkyWalking using Postman</figcaption>
  
</figure>
<p>The GraphQL query statement we built is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-graphql" data-lang="graphql"><span class="line"><span class="cl"><span class="kd">query</span><span class="w"> </span><span class="nc">ReadMetricsValues</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">readMetricsValues</span><span class="p">(</span><span class="py">condition</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;service_apdex&#34;</span><span class="p">,</span><span class="w"> </span><span class="nc">entity</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nc">scope</span><span class="p">:</span><span class="w"> </span><span class="nc">Service</span><span class="p">,</span><span class="w"> </span><span class="py">serviceName</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;canary|reviews|bookinfo|cluster-1|-&#34;</span><span class="p">,</span><span class="w"> </span><span class="nc">normal</span><span class="p">:</span><span class="w"> </span><span class="nc">true</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="py">duration</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">start</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;2023-07-13 0812&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">end</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;2023-07-13 0813&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">step</span><span class="p">:</span><span class="w"> </span><span class="nc">MINUTE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="py">label</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="py">values</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="py">values</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="py">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="py">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>This statement queries the <code>apdex</code> indicator of the <code>canary|reviews|bookinfo|cluster-1|-</code> service from UTC <code>2023-07-13 8:12</code> to <code>2023 8:13</code> for two minutes and obtains the following results:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;readMetricsValues&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;label&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;values&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;values&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;service_apdex_202307130812_Y2FuYXJ5fHJldmlld3N8Ym9va2luZm98Y2x1c3Rlci0xfC0=.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="mi">10000</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;service_apdex_202307130813_Y2FuYXJ5fHJldmlld3N8Ym9va2luZm98Y2x1c3Rlci0xfC0=.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="mi">10000</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The value of the <code>apdex</code> indicator is greater than 9900 (the threshold configured in the <code>successCondition</code> of AnalysisTemplate), so Rollouts will progress smoothly. You can also click Promote manually on the Argo Rollouts Dashboard to promote it, or run the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl argo rollouts promote reviews-rollout -n bookinf
</span></span></code></pre></div><h2 id="cleaning-up">Cleaning Up</h2>
<p>Delete the deployed ArgoCD Apps and Rollouts:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">argocd app delete -y reviews-rollout
</span></span><span class="line"><span class="cl">argocd app delete -y bookinfo-tse-conf
</span></span><span class="line"><span class="cl">argocd app delete -y bookinfo-app
</span></span></code></pre></div><h2 id="principles-of-argo-rollouts">Principles of Argo Rollouts</h2>
<p>When integrating with Istio, Argo Rollouts supports traffic splitting based on VirtualService and Subset, as shown in Figure 7.</p>
<figure class="mx-auto text-center">
  
  
  
    
      
        
          <img src="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f7.svg" data-img="/en/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/f7.svg" alt="image" data-caption="Figure 7: Argo Rollouts uses Istio for traffic splitting">
        
      
    
  
  
  <figcaption>Figure 7: Argo Rollouts uses Istio for traffic splitting</figcaption>
  
</figure>
<p>The table below provides a detailed comparison of these two traffic segmentation methods.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Applicable Scenario</th>
<th>Resource Object</th>
<th>Principle</th>
</tr>
</thead>
<tbody>
<tr>
<td>Host-level Traffic Split</td>
<td>Applicable for accessing different versions of services based on hostname;</td>
<td>2 Services, 1 VirtualService, 1 Rollout;</td>
<td>Rollout injects the rollouts-pod-template-hash label into the ReplicaSet and selects pods with these labels by updating the selector in the Service;</td>
</tr>
<tr>
<td>Subset-level Traffic Split</td>
<td>Applicable for accessing different services based on labels;</td>
<td>1 Service, 1 VirtualService, 1 DestinationRule, and 1 Rollout;</td>
<td>Rollout injects the rollouts-pod-template-hash label into the ReplicaSet and selects pods with these labels by updating the selector in the DestinationRule;</td>
</tr>
</tbody>
</table>
<p>Subset-based traffic splitting is used in this demo, and Argo Rollouts continuously:</p>
<ul>
<li>modify the VirtualService <code>spec.http[].route[].weight</code> to match the current desired canary weight</li>
<li>modify the DestinationRule <code>spec.subsets[].labels</code> to contain the <code>rollouts-pod-template-hash</code> label of the canary and stable ReplicaSets</li>
</ul>
<p>Visit <a href="https://argo-rollouts.readthedocs.io/en/stable/features/traffic-management/istio/" title="Argo Rollouts documentation" target="_blank" rel="noopener">Argo Rollouts documentation</a> for details on using Istio for traffic management.</p>
<h2 id="summary">Summary</h2>
<p>This article introduces how to use the Argo project and Istio to achieve GitOps and canary deployment. First, we use ArgoCD to achieve GitOps, and then use Argo Rollout and SkyWalking to achieve automated canary release. From the demo, we can see that the Istio deployed by TSE is fully compatible with the open-source version. There are many features of TSE worth exploring, visit the <a href="https://tetrate.io/tetrate-service-express/" title="Tetrate website" target="_blank" rel="noopener">Tetrate website</a> for more information.</p>
<hr>
<p><em>This blog was originally published at <a href="https://tetrate.io/blog/implementing-gitops-and-canary-deployment-with-argo-project-and-istio/" title="tetrate.io" target="_blank" rel="noopener">tetrate.io</a>.</em></p>

            <div class="border-bottom mb-2"></div>
          </div>

          <div class="col-12">
            <p>Last updated on Jul 26, 2024</p>
            


            


          </div>
          
          <div class="col-12">
              <div class="list-inline-item text-light">
              
              <a href="/en/tags/istio" class="badge"> 
                  Istio</a> 
              <a href="/en/tags/argo" class="badge">  
                  Argo</a> 
              <a href="/en/tags/argo-cd" class="badge">  
                  Argo Cd</a> 
              <a href="/en/tags/skywalking" class="badge">  
                  Skywalking</a> </div>
          </div>

          
          <div class="col-12">
            




    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    






    



    



<div class="pager blog-pager d-flex justify-content-between">
    
    <div class="previous mr-4">
        <a href="https://jimmysong.io/en/blog/ica-review/" class="d-flex flex-column align-items-start">
            <span class="nav mb-2 text-color-dark">&larr; Previous Post</span>
            <span class="text-align-left">A Month in Review: The Impact of Istio Certified Associate (ICA) Certification with Tetrate&#39;s Contribution</span>
        </a>
    </div>
    

    
    <div class="next">
        <a href="https://jimmysong.io/en/blog/how-to-use-graphql-to-query-observability-data-from-skywalking-with-postman/" class="d-flex flex-column align-items-end">
            <span class="nav mb-2 text-color-dark">Next Post &rarr;</span>
            <span class="text-align-right">How to Use GraphQL to Query Observability Data from SkyWalking with Postman</span>
        </a>
    </div>
     
</div>

          </div>

          
          
          <div class="col-12">
            <script src="https://giscus.app/client.js"
        data-repo="rootsongjc/rootsongjc.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzMTQ1MzczNA=="
        data-category="Announcements"
        data-category-id="DIC_kwDOAd_yJs4CPNtR"
        data-mapping="pathname"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        
        data-lang="en"
        
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
          </div>
          
        </div>
      </div>
      <!-- sidebar -->
      <aside class="px-2 col-xl-4 py-md-3 d-none d-xl-block">
          <div class="sidebar">
          <!-- recommend -->
          











<div>
  <p class="related-sidebar-title">
  Related article
  </p>
  <!-- related-blog-item -->
    <ul class="related-list">
    
      <li>
          <a href="/en/blog/the-future-of-istio/">
            The Future of Istio: the Path to Zero Trust Security
          </a>
      </li>
    
      <li>
          <a href="/en/blog/how-to-build-istio/">
            How to Build Istio?
          </a>
      </li>
    
      <li>
          <a href="/en/blog/sidecar-injection-iptables-and-traffic-routing/">
            Understanding the Sidecar Injection, Traffic Intercepting &amp; Routing Process in Istio
          </a>
      </li>
    
      <li>
          <a href="/en/blog/istio-pod-process-lifecycle/">
            Istio Data Plane Pod Startup Process Explained
          </a>
      </li>
    
      <li>
          <a href="/en/blog/istio-components-and-ports/">
            Istio Component Ports and Functions in Details
          </a>
      </li>
    
    </ul>
</div>


          <!-- /recommend -->
          <!-- toc -->
          
  <div class="bg-white sticky-top aside-toc">
    <p class="toc-sidebar-title">
      Table of content
    </p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#deployment-strategy">Deployment strategy</a></li>
    <li><a href="#release-strategy-of-kubernetes-deployment">Release strategy of Kubernetes Deployment</a></li>
    <li><a href="#implementing-gitops-with-argocd">Implementing GitOps with ArgoCD</a></li>
    <li><a href="#using-istio-to-achieve-fine-grained-traffic-routing">Using Istio to achieve fine-grained traffic routing</a></li>
    <li><a href="#demo">Demo</a>
      <ul>
        <li><a href="#deploy-argocd-and-argo-rollouts">Deploy ArgoCD and Argo Rollouts</a></li>
        <li><a href="#deploy-bookinfo-application">Deploy Bookinfo Application</a></li>
      </ul>
    </li>
    <li><a href="#implementing-fine-grained-traffic-management-with-istio">Implementing Fine-grained Traffic Management with Istio</a>
      <ul>
        <li><a href="#converting-deployment-to-rollout">Converting Deployment to Rollout</a></li>
      </ul>
    </li>
    <li><a href="#cleaning-up">Cleaning Up</a></li>
    <li><a href="#principles-of-argo-rollouts">Principles of Argo Rollouts</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>



          <!-- /toc -->
          <!-- ad-->
          

          <!-- /ad -->
          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">Contact</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">Jimmy&rsquo;s LinkedIn</li>
            
            
            <li class="mb-4"><img src="/images/jimmysong-linkedin.png" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Blog</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/blog/seamless-cross-cluster-access-istio/">A Definitive Guide to Cross-Cluster Seamless Access in Multicluster Istio Service Mesh</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/how-to-integrate-third-party-registry-with-istio/">How to Integrating Third-Party Service Registries with Istio?</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/envoy-gateway-oidc/">How to Implement Single Sign-On (SSO) with OIDC in API Gateway using Envoy Gateway?</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">links</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" >
                  Awesome Cloud Native
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://gateway.envoyproxy.io" target="_blank" rel="noopener noreferrer">
                  Envoy Gateway
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io" target="_blank" rel="noopener noreferrer">
                  Istio
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate - Service Mesh Company
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://docs.tetrate.io/istio-subscription/" target="_blank" rel="noopener noreferrer">
                  Tetrate Istio Subscription
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Courses</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals" target="_blank" rel="noopener noreferrer">
                  Envoy Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals" target="_blank" rel="noopener noreferrer">
                  Istio Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">new notice</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-china-2024-panel/">KubeCon China 2024 panel Preview: Istio and Modern API Gateways – Leading the Future of Service Mesh</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/website-revamp-notice/">Website Revamp Notice</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-eu-2024/">See you in KubeCon Paris!</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2024 Jimmy Song All Right Reserved</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>




<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>






  





<script src="/js/wowchemy-search.min.ce03c611044441cf6e84f9e4bef20818.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
