<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  
  <title>Blog - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="Jimmy Song&#39;s Blog Posts">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.136.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/en/blog/" />
  <meta property="og:title" content="Blog | Jimmy Song" />
  <meta property="twitter:title" content="Blog | Jimmy Song" />

  
  <meta property="og:description" content="Jimmy Song&#39;s Blog Posts" />
  <meta property="twitter:description" content="Jimmy Song&#39;s Blog Posts" />

  
  <meta property="og:image" content="https://jimmysong.io/images/banner/default.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/default.jpg" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/en">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/blog">Blog</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/tags">Tags</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/notice">Notice</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/contact">Contact</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/about">About</a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    
                  
                
              
              
              
                
                  
                    
                    <a class="nav-link" href="/trans/">中文</a>
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>Search</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>Search</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="Close"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="Input the keyword" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="Input the keyword">
        
        <div class="mt-4">
          <span>Search type: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">All</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">Blog</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">Book</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">Notice</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    Blog
                </p>
                <p class="page-description">
                    Jimmy Song&rsquo;s Blog Posts
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/istio-ambient-mode-limitations/">Analysis of the Limitations of Istio Ambient Mode</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               May 16, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Analysis of the Limitations of Istio Ambient Mode', 'In-depth discussion on the Ambient mode in Istio 1.22, comparison with the traditional Sidecar mode, and its limitations.', '\n[Istio 1.22](https:\/\/istio.io\/latest\/news\/releases\/1.22.x\/announcing-1.22\/) marks the official beta release of Ambient mode, accompanied by a blog titled [Say goodbye to your sidecars: Istio\u0027s ambient mode reaches Beta in v1.22](https:\/\/istio.io\/latest\/blog\/2024\/ambient-reaches-beta\/), claiming that Layer 4 and Layer 7 features are now production-ready. This milestone was actually announced by the community at KubeCon EU a month earlier. Such exciting promotion seems to suggest that we can completely abandon the Sidecar mode, but is this really the case?\n\n### Why Not Hurry to Say Goodbye to Sidecar Mode?\n\nWhile I am open to new technologies, it may be premature to completely abandon the Sidecar mode. Each mode has its specific application scenarios, advantages, and disadvantages. Below, I will share in detail some of the limitations of the Ambient mode compared to the Sidecar mode, to help everyone better understand the differences between the two.\n\n### Key Differences Between Ambient Mode and Sidecar Mode\n\n#### Traffic Management\n\nThe L7 traffic management support in Ambient mode is not yet mature and production-ready. In contrast, Sidecar mode is more stable and reliable in this regard.\n\n#### Security\n\nIn Ambient mode, mTLS is enforced at the namespace level, whereas Sidecar mode gives users more flexibility to choose whether to enable mTLS. This flexibility is particularly important for certain application scenarios.\n\n#### Observability\n\nFor L7 layer telemetry data, it remains questionable whether Ambient mode can provide precise monitoring and tracing for each pod as effectively as Sidecar mode. Sidecar mode has been widely validated in terms of observability and is more mature.\n\n#### Operations\n\nIn terms of deployment, Ambient mode recommends using Helm and only supports the Kubernetes platform, while Sidecar mode also supports VMs and hybrid cloud environments. Additionally, Ambient mode has not yet received official support from major cloud vendors. During upgrades, Ambient mode has a larger blast radius and currently does not support canary releases, recommending blue-green deployments instead. There is still a lack of best practices for migrating from Sidecar mode to Ambient mode or coexisting with both.\n\n#### Extensibility\n\nCurrently, support for Wasm plugins in Ambient mode is still unclear, whereas Sidecar mode already has relatively complete support in this area.\n\n#### Other Functional Features\n\nWhile Dual Stack mode is still experimental in Sidecar mode, it has at least some implementation, whereas it remains unclear whether Ambient mode supports this feature.\n\n### Conclusion\n\nAlthough Istio 1.22 brings the exciting Ambient mode, we need to carefully consider these limitations and differences before completely saying goodbye to Sidecar mode. Each mode has its unique advantages and applicable scenarios, and users should make informed choices based on their own needs. I will continue to test and track Ambient mode, so stay tuned to this blog for more in-depth analysis.', '\/en\/blog\/istio-ambient-mode-limitations\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">In-depth discussion on the Ambient mode in Istio 1.22, comparison with the traditional Sidecar mode, and its limitations.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/kubecon-eu-2024-transparency-report/">KubeCon EU 2024 Transparency Report Interpretation</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               May 7, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/essays"> 
             Essays
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('KubeCon EU 2024 Transparency Report Interpretation', 'A detailed interpretation of the key data and highlights from KubeCon Europe 2024.', '\nRecently, the CNCF released the [KubeCon EU 2024 Transparency Report](https:\/\/www.cncf.io\/reports\/kubecon-cloudnativecon-europe-2024\/). The KubeCon \u002b CloudNativeCon Europe 2024 held in Paris was the largest event in its history, and I had the fortune to attend in person. The beauty of Paris and the atmosphere of the conference were unforgettable.\n\n![KubeCon \u002b CloudNativeCon EU 2024 Transparency Report Cover](report-cover.jpg)\n\nWe witnessed the power of the open-source and cloud-native communities and how they drive the next major technological shift — artificial intelligence. At this conference, CNCF announced the establishment of an AI working group and launched the first edition of the [Cloud Native AI Whitepaper](\/blog\/cloud-native-ai-whitepaper\/), followed by the creation of the [Cloud Native AI Landscape](https:\/\/rx-m.github.io\/cnai-landscape\/?group=cnai).\n\n\u003ciframe src=\u0022https:\/\/rx-m.github.io\/cnai-landscape\/embed\/embed.html?key=cnai\u0026headers=true\u0026category-header=true\u0026category-in-subcategory=false\u0026item-name=false\u0026title-uppercase=false\u0026title-alignment=left\u0026title-font-family=sans-serif\u0026title-font-size=13\u0026style=shadowed\u0026size=xs\u0026items-alignment=left\u0026bg-color=%23016bcc\u0026fg-color=%23ffffff\u0026base-path=%2Fcnai-landscape\u0022 style=\u0022width:100%;height:500px;display:block;border:none;\u0022\u003e\u003c\/iframe\u003e\n\n## Growth and Diversity\n\nThe event welcomed over 12,000 participants, with the majority (78%) coming from Europe and 52% attending for the first time. Participants from different regions showed enthusiasm for cloud-native technologies. The diverse functional backgrounds of the participants, including business operations, developers, and architects, highlighted the wide application of cloud-native technology across fields.\n\nThe following table shows the top 10 countries by attendee numbers:\n\n| Country     | Number of Attendees |\n| ----------- | ------------------- |\n| France      | 1,956               |\n| Germany     | 1,879               |\n| USA         | 1,733               |\n| United Kingdom | 816              |\n| Netherlands | 797                 |\n| Switzerland | 368                 |\n| Spain       | 355                 |\n| Israel      | 312                 |\n| Poland      | 303                 |\n| Denmark     | 293                 |\n\n## Innovation and Communication\n\nDuring the event, there were 331 sessions and 19 keynote speeches covering hot topics such as artificial intelligence, application development, and platform engineering. This edition of KubeCon also hosted poster sessions and project tours for researchers, helping attendees better understand various projects.\n\n## Community and Inclusivity\n\nKubeCon is committed to supporting diversity, equity, and inclusion. Activities such as diversity lunches and Peer Group Mentoring provided platforms for participants to connect and support each other. (PS. The catering at the venue was not to my liking, especially the taste of the tea and the hard bread.)\n\n## Environmental and Sustainability\n\nIn terms of environmental and sustainability efforts, the organizers chose venues with an environmental consciousness and implemented measures to reduce food waste and recycle waste, demonstrating CNCF\u0027s commitment to environmental protection.\n\n## Looking Forward\n\nLooking forward, we hope to bring the magic of KubeCon to more regions globally. Whether it\u0027s the upcoming KubeCon \u002b CloudNativeCon China 2024 or other regional events, I am very much looking forward to meeting you. I have also submitted a panel session for KubeCon China, and if selected, we will meet in Hong Kong this August.\n\n## Conclusion\n\nKubeCon \u002b CloudNativeCon Europe 2024 was not just a technical gathering, but a display of community strength. If you would like to know more details, please check out my previous recap of [KubeCon \u002b CloudNativeCon Europe](\/en\/blog\/kubecon-eu-paris-recap\/).\n\nI hope this transparency report helps you better understand the impact of the event and inspires you to participate in future KubeCon events.\n', '\/en\/blog\/kubecon-eu-2024-transparency-report\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">A detailed interpretation of the key data and highlights from KubeCon Europe 2024.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/cloud-native-ai-whitepaper/">In-depth Analysis of CNCF&#39;s Cloud Native AI Whitepaper</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Apr 16, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/cloud-native"> 
             Cloud Native
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('In-depth Analysis of CNCF\u0027s Cloud Native AI Whitepaper', 'During KubeCon EU 2024, CNCF released its first Cloud Native Artificial Intelligence (CNAI) whitepaper. This article provides an in-depth analysis of the content of this whitepaper.', '\nIn March 2024, during KubeCon EU, the Cloud Native Computing Foundation (CNCF) released its first detailed [whitepaper](https:\/\/www.cncf.io\/reports\/cloud-native-artificial-intelligence-whitepaper\/) on Cloud Native Artificial Intelligence (CNAI). This report thoroughly explores the current state, challenges, and future directions of integrating Cloud Native technologies with artificial intelligence. This article delves into the core content of this whitepaper.\n\n## What is Cloud Native AI?\n\nCloud Native AI refers to the approach of building and deploying artificial intelligence applications and workloads using Cloud Native technology principles. This includes leveraging microservices, containerization, declarative APIs, and continuous integration\/continuous deployment (CI\/CD) to enhance the scalability, reusability, and operability of AI applications.\n\nThe diagram below illustrates the architecture of Cloud Native AI, redrawn based on the whitepaper.\n\n![Cloud Native AI Architecture](cloud-native-ai.svg)\n\n## Relationship Between Cloud Native AI and Cloud Native Technologies\n\nCloud Native technologies provide a flexible, scalable platform that makes the development and operation of AI applications more efficient. Through containerization and microservices architecture, developers can iterate and deploy AI models rapidly while ensuring high availability and scalability of systems. Kubernetes and other Cloud Native tools provide essential support such as resource scheduling, automatic scaling, and service discovery.\n\nThe whitepaper provides two examples illustrating the relationship between Cloud Native AI and Cloud Native technologies, namely running AI on Cloud Native infrastructure:\n\n- [Hugging Face Collaborates with Microsoft to launch Hugging Face Model Catalog on Azure](https:\/\/huggingface.co\/blog\/hugging-face-endpoints-on-azure)\n- [OpenAI Scaling Kubernetes to 7,500 nodes](https:\/\/openai.com\/research\/scaling-kubernetes-to-7500-nodes)\n\n## Challenges of Cloud Native AI\n\nDespite providing a solid foundation for AI applications, Cloud Native technologies still face challenges when integrating AI workloads with Cloud Native platforms. These challenges include the complexity of data preparation, resource requirements for model training, and maintaining the security and isolation of models in multi-tenant environments. Additionally, resource management and scheduling in Cloud Native environments are crucial, especially for large-scale AI applications, and further optimization is needed to support efficient model training and inference.\n\n## Development Path of Cloud Native AI\n\nThe whitepaper proposes several development paths for Cloud Native AI, including improving resource scheduling algorithms to better support AI workloads, developing new service mesh technologies to enhance the performance and security of AI applications, and driving innovation and standardization of Cloud Native AI technology through open-source projects and community collaboration.\n\n## Cloud Native AI Technology Landscape\n\nCloud Native AI involves a variety of technologies, from containers and microservices to service meshes and serverless computing. Kubernetes is a key platform for deploying and managing AI applications, while service mesh technologies like Istio and Envoy provide powerful traffic management and security features. Additionally, monitoring tools like Prometheus and Grafana are essential for maintaining the performance and reliability of AI applications.\n\nBelow is the Cloud Native AI landscape provided in the whitepaper.\n\n### General Orchestration\n\n- Kubernetes\n- Volcano\n- Armada\n- Kuberay\n- Nvidia NeMo\n- Yunikorn\n- Kueue\n- Flame\n\n### Distributed Training\n\n- Kubeflow Training Operator\n- Pytorch DDP\n- TensorFlow Distributed\n- Open MPI\n- DeepSpeed\n- Megatron\n- Horovod\n- Apla\n- ...\n\n### ML Serving\n- Kserve\n- Seldon\n- VLLM\n- TGT\n- Skypilot\n- ...\n\n### CI\/CD - Delivery\n- Kubeflow Pipelines\n- Mlflow\n- TFX\n- BentoML\n- MLRun\n- ...\n\n### Data Science\n- Jupyter\n- Kubeflow Notebooks\n- PyTorch\n- TensorFlow\n- Apache Zeppelin\n- ...\n\n### Workload Observability\n- Prometheus\n- Influxdb\n- Grafana\n- Weights and Biases (wandb)\n- OpenTelemetry\n- ...\n\n### AutoML\n- Hyperopt\n- Optuna\n- Kubeflow Katib\n- NNI\n- ...\n\n### Governance \u0026 Policy\n- Kyverno\n- Kyverno-JSON\n- OPA\/Gatekeeper\n- StackRox Minder\n- ...\n\n### Data Architecture\n- ClickHouse\n- Apache Pinot\n- Apache Druid\n- Cassandra\n- ScyllaDB\n- Hadoop HDFS\n- Apache HBase\n- Presto\n- Trino\n- Apache Spark\n- Apache Flink\n- Kafka\n- Pulsar\n- Fluid\n- Memcached\n- Redis\n- Alluxio\n- Apache Superset\n- ...\n\n### Vector Databases\n- Milvus\n- Chroma\n- Weaviate\n- Quadrant\n- Pinecone\n- Extensions\n  - Redis\n  - Postgres SQL\n  - ElasticSearch\n- ...\n\n### Model\/LLM Observability\n- Trulens\n- Langfuse\n- Deepchecks\n- OpenLLMetry\n- ...\n\n## Summary\n\nFinally, let me summarizes the following key points:\n\n- **Role of the Open Source Community**: The whitepaper clearly points out the role of the open-source community in advancing Cloud Native AI, including accelerating innovation and reducing costs through open-source projects and extensive collaboration.\n\n- **Importance of Cloud Native Technologies**: Cloud Native AI is built and deployed according to Cloud Native principles, highlighting the importance of repeatability and scalability. Cloud Native technologies provide an efficient development and runtime environment for AI applications, especially in terms of resource scheduling and service scalability.\n\n- **Challenges Exist**: Despite the many advantages brought by Cloud Native AI, there are still challenges in data preparation, model training resource requirements, and model security and isolation.\n\n- **Future Development Directions**: The whitepaper proposes development paths including optimizing resource scheduling algorithms to support AI workloads, developing new service mesh technologies to enhance performance and security, and leveraging open-source projects and community collaboration to further promote technological innovation and standardization.\n\n- **Key Technological Components**: Key technologies involved in Cloud Native AI include containers, microservices, service meshes, and serverless computing. Kubernetes plays a central role in deploying and managing AI applications, while service mesh technologies such as Istio and Envoy provide necessary traffic management and security.\n\nFor more details, please download the [Cloud Native AI Whitepaper](https:\/\/www.cncf.io\/reports\/cloud-native-artificial-intelligence-whitepaper\/).\n', '\/en\/blog\/cloud-native-ai-whitepaper\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">During KubeCon EU 2024, CNCF released its first Cloud Native Artificial Intelligence (CNAI) whitepaper. This article provides an in-depth analysis of the content of this whitepaper.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/tetrate-vulnerability-scaner/">TVS: Istio and Envoy CVE Scanning Solution</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Apr 12, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('TVS: Istio and Envoy CVE Scanning Solution', 'This article will introduce Tetrate’s newly launched tool – Tetrate Vulnerability Scanner (TVS), a CVE scanner customized for Istio and Envoy. ', '\nThis article will introduce Tetrate’s newly launched tool – [Tetrate Vulnerability Scanner (TVS)](https:\/\/docs.tetrate.io\/istio-subscription\/tools\/tvs\/), a CVE scanner customized for Istio and Envoy. Before diving into the specific features of TVS, let’s briefly review the concept of CVE and its core role in software security.\n\n## Overview of CVE\n\nCVE (Common Vulnerabilities and Exposures) is a public vulnerability database maintained by MITRE Corporation. It provides a standardized way to reference vulnerabilities in open-source software. Each CVE record has an identifier, description, and at least one public reference. CVE does not provide severity ratings for vulnerabilities. CVEs are not only an important resource for cybersecurity professionals but also a tool for developers and organizations to receive critical security updates. CVE Numbering Authorities (CNAs) are an integral part of the CVE program, assigning unique IDs to new CVEs. These IDs help find information related to vulnerabilities, including severity ratings (maintained by NIST’s NVD), affected software systems, and steps for remediation and damage control. For example, the well-known Log4j vulnerability in 2021 ([CVE-2021-44228](https:\/\/www.cve.org\/CVERecord?id=CVE-2021-44228)) had a severity rating of 10 due to its wide impact.\n\n### Practical Scenarios for CVEs\n\nIntegrating CVE scanning into CI\/CD pipelines is a common practice aimed at automatically identifying and preventing code with known vulnerabilities from entering the main branch. This approach helps ensure that applications do not rely on third-party packages or libraries with security vulnerabilities, enhancing application security. For example, GitHub’s [Dependabot](https:\/\/docs.github.com\/en\/code-security\/supply-chain-security\/understanding-your-software-supply-chain\/about-supply-chain-security#what-is-dependabot) can automatically detect CVEs in project dependencies and suggest fixes, making it an effective tool for maintaining project security. You may receive CVE notifications like [jQuery Cross-Site Scripting vulnerability](https:\/\/github.com\/advisories\/GHSA-257q-pv89-v3xv) whenever there is a vulnerability in your PR or commit. Then, you can choose to tolerate the vulnerability or apply a patch.\n\n## What is TVS?\n\nIstio often releases CVE notices on its official website, such as [ISTIO-SECURITY-2024-001](https:\/\/istio.io\/latest\/news\/security\/istio-security-2024-001\/). Previously, you had to track these notices manually, but now you can automate CVE scanning tasks with TVS, significantly reducing the workload of security teams.\n\nThe following figure shows the result of TVS.\n\n![TVS CLI](tvs.jpg)\n\nCurrently, TVS only provides a command-line tool, and it will be integrated as a service into TIS in the future.\n\nThe following diagram illustrates the workflow of TVS.\n\n\u0060\u0060\u0060mermaid \u0022TVS Workflow\u0022\ngraph TD\n    A([Start]) --\u003e B(Istio Containers Installed)\n    B --\u003e C(Collect SHA Digests)\n    C --\u003e D(Send Digests to Tetrate\u0027s APIs)\n    D --\u003e E{Is CVE Detected?}\n    E --\u003e|Yes| F[Log SHA Digests Without Personal Info]\n    E --\u003e|No| G[End, No Action Required]\n    F --\u003e H[Notify Users]\n    H --\u003e I[Apply Patches\/Workarounds]\n    I --\u003e J([End])\n\u0060\u0060\u0060\n\n![TVS Workflow](9232ba9319ac498b7fcf50bb60bff86b.svg)\n\n\n\n1. Begins after Istio installation.\n2. Collects SHA digests of installed Istio containers.\n3. Sends digests to Tetrate’s API.\n4. API detects CVE presence.\n   - If CVE is detected, logs SHA digests without personal information and notifies users.\n   - If no CVE is detected, no action is required.\n5. Upon receiving notification, users apply patches or mitigations.\n6. Process ends.\n\nTVS is available for free download and use by everyone. However, registration is required before performing CVE scans, as outlined in the [TIS documentation](https:\/\/docs.tetrate.io\/istio-subscription\/tools\/tvs\/).\n\n## Supply Chain Security Recommendations\n\nA [report](https:\/\/www.slim.ai\/blog\/container-report-2023) indicates that even the latest versions of the most popular containers have hundreds of CVEs.\n\nHere are some recommendations for ensuring security:\n\n- Start vulnerability scanning and remediation early, rather than waiting until the end.\n- Integrate vulnerability scanning tools into CI\/CD.\n- Regularly update Istio and Envoy to the latest versions.\n- Use Istio’s officially released [distroless images](https:\/\/istio.io\/latest\/docs\/ops\/configuration\/security\/harden-docker-images\/) or [TID](https:\/\/docs.tetrate.io\/istio-distro\/) to reduce the attack surface and minimize vulnerabilities.\n- Follow the [best practices for the software supply chain](https:\/\/github.com\/cncf\/tag-security\/blob\/main\/supply-chain-security\/supply-chain-security-paper\/sscsp) introduced by CNCF.\n- Follow [Istio security best practices](https:\/\/istio.io\/latest\/docs\/ops\/best-practices\/security\/).\n\n## Unique Value of TVS\n\nTVS provides a convenient CVE scanning operation through its command-line tool and is planned to be integrated into Kubernetes and Tetrate Istio Subscription (TIS) in the future to further simplify CVE management processes for Istio and Envoy. TIS provides CVE patches and backward compatibility support for up to 14 months from the Istio release, helping users get security updates on time while keeping the system stable.\n\nTVS is freely available for all users to download and use, with simple registration required before performing CVE scans. Additionally, you can register on the [Istio and Envoy alerts and patches page](https:\/\/tetrate.io\/register-for-istio-and-envoy-security-bulletins\/) to receive CVE notifications and patches as soon as they are available. For more information, refer to the [TIS documentation](https:\/\/docs.tetrate.io\/istio-subscription\/tools\/tvs\/).\n\nBy adopting TVS, an automated CVE scanning tool, enterprises can more effectively identify and address security vulnerabilities in Istio and Envoy, enhance infrastructure security, and reduce the burden on security teams, thereby promoting efficient security management processes.\n\n---\n\n*This blog was initially published at [tetrate.io](https:\/\/tetrate.io\/blog\/tvs-istio-and-envoy-cve-scanning-solution\/) .*\n', '\/en\/blog\/tetrate-vulnerability-scaner\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">This article will introduce Tetrate’s newly launched tool – Tetrate Vulnerability Scanner (TVS), a CVE scanner customized for Istio and Envoy. </p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/kubecon-eu-paris-recap/">KubeCon EU 2024: Impressions and Recap from Paris</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Mar 27, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/essays"> 
             Essays
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('KubeCon EU 2024: Impressions and Recap from Paris', 'Explore KubeCon EU 2024: From the latest developments in Istio and Cilium to an in-depth interpretation of cloud native trends such as AI convergence, the rise of Wasm, and enhanced observation.', '\nLast week, I attended [KubeCon EU 2024](https:\/\/events.linuxfoundation.org\/kubecon-cloudnativecon-europe\/) in Paris, marking my first participation in KubeCon outside of China. The conference was unprecedentedly grand, reportedly attracting 12,000 attendees. In this article, I\u0027ll share some observations from KubeCon, focusing mainly on the areas of service mesh and cloud-native infrastructure that caught my attention.\n\n![Istio Contributors at the Istio booth during KubeCon EU](istio-day.jpg)\n\n## Istio, Cilium, and Service Mesh\n\n[Istio](https:\/\/istio.io) and Service Mesh were hot topics, showcasing the latest developments and applications of these technologies within the cloud-native ecosystem. The conference covered various areas, including infrastructure optimization, data locality, distributed tracing, and multi-cluster deployment, reflecting the widespread attention and continuous innovation in Service Mesh technology.\n\n### Data Locality and Global Request Routing\n\nArthur Busser and Baudouin Herlicq from Pigment shared how Kubernetes and Istio can fulfill data locality requirements. They introduced methods using Istio for request routing based on custom headers, crucial for meeting data residency requirements such as GDPR and CCPA.\n\n### Distributed Tracing and Enhanced Observability\n\nChris Detsicas from ThousandEyes (part of Cisco) discussed configuring Istio with OpenTelemetry for effective distributed tracing, providing valuable visibility into microservices ecosystems for problem diagnosis and performance optimization.\n\n### Multi-cluster Deployment and Traffic Management\n\nHaiwen Zhang and Yongxi Zhang from China Mobile introduced a new approach to simplify Istio multi-cluster deployment. This method utilizes a globally unique Istio control plane, achieving global service discovery through the main cluster\u0027s Apiserver, automatically connecting the container networks of multiple clusters, and providing direct network connectivity for Pods. They highlighted the [Kosmos project](https:\/\/github.com\/kosmos-io\/kosmos), offering a new solution to simplify service mesh deployment and management in multi-cluster environments.\n\nAmeer Abbas and John Howard from Google discussed building 99.99% reliability services with infrastructure reliability at 99.9%. They proposed a series of application architecture prototypes (Archetypes) to design and implement highly reliable multi-cluster applications.\n\n- **Prototype 1: Active-Passive Zones** - Deploy all services in two zones of a single region, using read-only replicas of SQL databases, with fault tolerance within the zone achieved through L4 load balancers.\n- **Prototype 2: Multi-Zonal** - Deploy all services in three zones of a single region, using highly available SQL databases, with fault tolerance within the zone achieved through global or zonal load balancers.\n- **Prototype 3: Active-Passive Region** - Deploy all services in three zones of two regions, using SQL databases replicated across regions, with fault tolerance between regions achieved through DNS and load balancers.\n- **Prototype 4: Isolated Regions** - Deploy all services in three zones of two regions, using global databases like Spanner or CockroachDB, with fault tolerance between regions achieved through zonal load balancers and DNS.\n- **Prototype 5: Global** - Deploy all services in three zones of two or more regions, using global databases like Spanner or CockroachDB, with fault tolerance achieved globally through global load balancers.\n\n### Security and Zero Trust Architecture\n\nSeveral sessions emphasized the importance of securing Istio in production environments. Discussions led by Microsoft\u0027s Niranjan Shankar focused on steps and strategies to reinforce Istio\u0027s security using network policies, third-party Kubernetes tools, and cloud-provided security services to build zero trust and defense-in-depth architectures.\n\n### Infrastructure Compatibility and Future of Ambient Mesh\n\nBenjamin Leggett and Yuval Kohavi introduced an innovative approach to enable Istio\u0027s Ambient mode to support any Kubernetes CNI, detailed in the [Istio blog](https:\/\/istio.io\/latest\/zh\/blog\/2024\/inpod-traffic-redirection-ambient\/). This advancement addresses the limited CNI support in Ambient mesh, allowing applications to be included in Ambient mode without restarting Pods, thus simplifying operations and reducing infrastructure costs.\n\nThe Istio community announced that Ambient mode will become beta in the upcoming Istio 1.22 release, as described in the [CNCF blog](https:\/\/www.cncf.io\/blog\/2024\/03\/19\/istio-announces-the-beta-release-of-ambient-mode\/). Multiple presentations and discussions focused on the future of Istio Ambient Mesh, especially its potential to simplify workload operations and reduce infrastructure costs. The introduction of Istio Ambient Mesh signals a new direction for service mesh technology, offering a data plane architecture without sidecars, providing higher performance and lower resource consumption.\n\n### Innovation in Sidecar-less Service Mesh\n\nDiscussions at KubeCon EU 2024 evaluated and compared the pros and cons of using sidecar-based and sidecar-less (such as Istio\u0027s Ambient Mesh) service mesh models. Christian Posta\u0027s in-depth analysis of design decisions and trade-offs between Cilium and Istio in implementing sidecar-less service mesh highlighted the potential of this model in improving performance, reducing resource consumption, and simplifying operational tasks. By analyzing the transition from Istio to Cilium at The New York Times, it further demonstrated the effectiveness of the sidecar-less model in handling complex, multi-region service meshes, while also pointing out challenges and implementation considerations in this transition. These discussions foreshadowed the potential evolution of service mesh technology towards more flexible and efficient architectures, where the sidecar-less approach may become a key strategy for optimizing the performance and resource utilization of cloud-native applications.\n\n### Intersection of Cilium and Service Mesh\n\n[Cilium](https:\/\/cilium.io) was widely discussed at KubeCon EU 2024. As a technology based on eBPF, Cilium is not only seen as an efficient Container Network Interface (CNI) but also demonstrates strong potential in the service mesh domain. Through presentations by Isovalent and other organizations, Cilium was showcased as an advanced solution for connecting, observing, and securing service mesh. In particular, Cilium\u0027s sidecar-less service mesh implementation was considered a future direction, leveraging eBPF technology to achieve secure communication and fine-grained traffic management among microservices without adding the burden of traditional sidecar proxies. Additionally, Cilium\u0027s extensibility beyond service mesh, such as in multi-cloud networking and load balancing, highlights its position as a core component of the cloud-native ecosystem. These discussions and case studies of Cilium demonstrate its significant role in driving innovation in service mesh and cloud-native technologies.\n\n## Cloud Native Trends\n\nSeveral major trends are currently shaping the cloud-native landscape:\n\n1. **Enhanced Sustainability and Environmental Awareness**: For example, Deutsche Bahn is incorporating developers into its infrastructure greening process, highlighting a growing consideration of environmental factors in the design and operation of cloud-native solutions. This reflects a trend where companies are increasingly looking at reducing their environmental impact while pursuing technological advancements, achieving sustainable technology ecosystems through green computing and energy efficiency optimizations.\n\n2. **Integration of Artificial Intelligence with Cloud-Native Technologies**: Artificial intelligence (AI) is emerging as the next major challenge for Kubernetes and the cloud-native ecosystem. Discussions by Nvidia on AI strategies, CNCF\u0027s efforts to standardize AI in cloud-native futures, and various updates on tools and platforms integrating AI and machine learning (ML) underscore this trend. This trend indicates that seamlessly integrating AI and ML into cloud-native architectures can not only accelerate application development and deployment but also provide more intelligent and automated operational capabilities. CNCF has also announced the establishment of an AI Working Group and released an [AI Whitepaper](https:\/\/www.cncf.io\/reports\/cloud-native-artificial-intelligence-whitepaper\/).\n\n3. **Rise of WebAssembly (Wasm)**: Support for the latest Wasm standards by Cosmonic, along with Fermyon\u0027s donation of its open-source Wasm platform, [SpinKube](https:\/\/www.spinkube.dev\/), to CNCF, demonstrates the growing importance of WebAssembly in cloud-native application development. Wasm provides an efficient and secure way to run client and server-side code outside the browser, which is crucial for building cross-platform, high-performance cloud-native applications.\n\n4. **Enhanced Cloud-Native Observability**: For instance, New Relic\u0027s addition of native Kubernetes support to its observability platform highlights the increasing demand for monitoring, logging, and performance analysis of cloud-native applications. As the complexity of cloud-native architectures increases, enterprises need more robust tools to maintain system transparency and health, thereby optimizing performance and reliability.\n\n5. **Strengthening Collaboration and Open Source Spirit in the Cloud Native Community**: Initiatives such as CNCF\u0027s establishment of the [End User Technical Advisory Board](https:\/\/www.cncf.io\/people\/end-user-technical-advisory-board\/), and collaboration between Red Hat and Docker to develop the Testcontainers Cloud framework, reflect the cloud-native community\u0027s commitment to fostering a culture of collaboration and sharing. This open collaboration not only accelerates the development and adoption of new technologies but also provides a solid foundation for the healthy growth of the cloud-native ecosystem.\n\nThese trends collectively depict a diverse, continuously innovative, and increasingly mature cloud-native technology landscape, where sustainability, AI\/ML integration, WebAssembly, enhanced observability, and community collaboration are key drivers of progress in this field.\n\n## Conclusion\n\nInsights from KubeCon EU 2024 have revealed several significant advancements and future directions in the cloud-native technology domain. From ongoing innovations in service meshes to the growing emphasis of the cloud-native ecosystem on environmental sustainability, and the deep integration of artificial intelligence and machine learning technologies, as well as the increasing importance of WebAssembly in application development, these trends collectively constitute the forefront of current cloud-native technology.\n\nOf particular note are the latest developments in Istio and Cilium in the realm of service meshes, showcasing the potential of the Sidecar-less architecture and the role of eBPF technology in enhancing performance, security, and observability. These advancements not only provide developers with more efficient and flexible tools but also present new perspectives for the design and operation of cloud-native applications.\n\nSimultaneously, the continued development of the cloud-native community and its commitment to the open-source spirit provide a solid foundation for technological innovation and knowledge sharing. Through the strengthening of observability, promotion of environmental sustainability, and advancement of technological standardization, the cloud-native ecosystem demonstrates its profound development potential and vast application prospects.\n\nAs an observer and participant, I keenly feel that the rapid development of cloud-native technology presents unprecedented opportunities and challenges for us. In the future, with continuous technological evolution and collective community efforts, we have reason to believe that cloud-native technology will play a greater role in driving digital transformation and creating a more intelligent and sustainable technological world. Let us eagerly anticipate and actively engage in this exciting technological journey.\n', '\/en\/blog\/kubecon-eu-paris-recap\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">Explore KubeCon EU 2024: From the latest developments in Istio and Cilium to an in-depth interpretation of cloud native trends such as AI convergence, the rise of Wasm, and enhanced observation.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/ica-certificate/">ICA Certification: Latest Changes and Exam Preparation Guide for Istio Skills</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Mar 7, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('ICA Certification: Latest Changes and Exam Preparation Guide for Istio Skills', 'Learn about ICA certification\u0027s origin, changes, exam prep. Evolved from CIAT, it assesses Istio skills. Familiarize with Istio docs and take Tetrate\u0027s tutorial for better prep.', '\n## Changes and Reminders for ICA Certification\n\nUpcoming policy change: Please note that the ICA certification expiration policy will change on April 1, 2024, at 00:00UTC. Certifications obtained on or after this date will expire 24 months after meeting the certification requirements (including passing the exam). We encourage anyone interested and prepared to schedule and take the exam before the policy change. Please see more detailed information [here](https:\/\/example.com).\n\nThe current certification validity period is 3 years, and certifications obtained after April 1st will be valid for 2 years.\n\n## Background on Tetrate Academy\n\n[Tetrate Academy](https:\/\/academy.tetrate.io\/), operated by Tetrate, has been around for several years, launching Istio fundamentals tutorials, Envoy fundamentals tutorials, and CIAT certification exams, with over 13,000 people having taken Tetrate Academy courses. In September last year, Tetrate contributed CIAT to CNCF, renamed it [ICA exam](https:\/\/training.linuxfoundation.org\/certification\/istio-certified-associate-ica\/), and the certification exam was officially launched in November.\n\n{{\u003cfigure src=\u0022domains.jpg\u0022 caption=\u0022ICA domains by [Linux Foundation](https:\/\/training.linuxfoundation.org\/certification\/istio-certified-associate-ica\/)\u0022 alt=\u0022ICA domains\u0022\u003e}}\n\n## Exam Background\n\n- ICA is derived from the CIAT exam contributed by Tetrate, providing validation of extensive knowledge and skills in Istio.\n- The exam is conducted remotely online, with a time limit of 2 hours, during which candidates need to operate Kubernetes clusters and Istio in a virtual machine environment.\n- The exam includes a series of problem-solving questions and some multiple-choice questions, requiring a passing score of 75%.\n- The PSI system provides an online exam environment, and exam results will be emailed to candidates within 24 hours after the exam.\n- The exam environment provides tools such as Kubernetes clusters, Istio installation, VS Code, kubectl, istioctl, etc.\n- Access to Istio documentation is available during the exam, and questions and responses are in English only.\n\n## Recommendations and Reminders\n\n- Familiarize yourself with the [Istio documentation](https:\/\/istio.io) before the exam, and prepare in advance, including checking the PSI system, identification, and exam environment.\n- Take Tetrate\u0027s free [Istio fundamentals tutorial](https:\/\/academy.tetrate.io\/courses\/istio-fundamentals) to deepen your understanding of Istio.\n- Stay calm during the exam, answer familiar questions first, then unfamiliar ones, to ensure efficient completion of the exam.\n\n## Reference Links\n\n- [ICA Certification FAQs](https:\/\/docs.linuxfoundation.org\/tc-docs\/certification\/frequently-asked-questions-ica)\n- [Important Instructions for ICA Certification](https:\/\/docs.linuxfoundation.org\/tc-docs\/certification\/important-instructions-ica)', '\/en\/blog\/ica-certificate\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">Learn about ICA certification&#39;s origin, changes, exam prep. Evolved from CIAT, it assesses Istio skills. Familiarize with Istio docs and take Tetrate&#39;s tutorial for better prep.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/preserve-source-ip-in-istio/">Maintaining Traffic Transparency: Preserving Client Source IP in Istio</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Feb 28, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Maintaining Traffic Transparency: Preserving Client Source IP in Istio', 'This article focuses on how to maintain transparency of the client source IP in the Istio service mesh.', '\nThis blog post analyzes the challenges of server-side obtaining the client source IP in the Istio service mesh and provides solutions. The following topics will be covered:\n\n- Reasons for the loss of source IP during packet transmission.\n- How to identify the client source IP.\n- Strategies for passing source IP in north-south and east-west requests.\n- Handling methods for HTTP and TCP protocols.\n\n## The Importance of Preserving Source IP\n\nThe main reasons for preserving the client source IP include:\n\n- **Access Control Policies**: Performing authentication or security policies based on source IP.\n- **Load Balancing**: Implementing request routing based on the client IP.\n- **Data Analysis**: Access logs and monitoring metrics containing the actual source address, aiding developers in analysis.\n\n## Meaning of Preserving Source IP\n\nPreserving the source IP refers to avoiding the situation where the actual client source IP is replaced as the request goes out from the client, and passes through a load balancer or reverse proxy.\n\nHere is an example process of source IP address lost:\n\n\u0060\u0060\u0060mermaid\nsequenceDiagram\n    participant C as Client\n    participant LB as Load Balancer\n    participant IG as Ingress Gateway\n    participant S as Server\n    C-\u003e\u003eLB: Initial Request\n    LB-\u003e\u003eIG: Altered Request (IP Changed)\n    IG-\u003e\u003eS: Forwarded Request\n    Note over IG,S: Source IP Lost\n\u0060\u0060\u0060\n\n![Mermaid Diagram](9a331cc374c51421ecb64e58b25a6c4d.svg)\n\nThe above diagram represents the most common scenario. This article considers the following cases:\n\n1. North-South Traffic: Clients accessing servers through a load balancer (gateway)\n   1. Single-tier gateway\n   2. Multi-tier gateways\n2. East-West Traffic: Service-to-service communication within the mesh\n3. Protocols: HTTP and TCP\n\n## How to Confirm Client Source IP?\n\nIn the Istio service mesh, Envoy proxies typically add the client IP to the \u0022X-Forwarded-For\u0022 header of HTTP requests. Here are the steps to confirm the client IP:\n\n1. **Check the X-Forwarded-For Header**: It contains the IP addresses of various proxies along the request path.\n2. **Select the Last IP**: Usually, the last IP is the client IP closest to the server.\n3. **Verify the IP\u0027s Trustworthiness**: Check the trustworthiness of the proxy servers.\n4. **Use X-Envoy-External-Address**: Envoy can set this header, which includes the real client IP.\n\nFor more details, refer to the Envoy documentation on the [\u0060x-forwarded-for\u0060 header](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/http\/http_conn_man\/headers#config-http-conn-man-headers-x-forwarded-for). For TCP\/IP connections, you can parse the client IP from the protocol field.\n\n## Testing Environment\n\n**GKE**\n\n- Client Version: v1.28.4\n- Kustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\n- Server Version: v1.27.7-gke.1121000\n\n**Istio**\n\n- Client version: 1.20.1\n- Control plane version: 1.20.1\n- Data plane version: 1.20.1 (12 proxies)\n\n**CNI**\n\nWe use Cilium CNI but have not enabled the kube-proxy-less mode.\n\n- cilium-cli: v0.15.18 compiled with go1.21.5 on darwin\/amd64\n- cilium image (default): v1.14.4\n- cilium image (stable): unknown\n- cilium image (running): 1.14.5\n\n**Node**\n\n| Node Name                              | Internal IP | Remarks                   |\n| --------------------------------------| ----------- | --------------------------|\n| gke-cluster1-default-pool-5e4152ba-t5h3 | 10.128.0.53 |                          |\n| gke-cluster1-default-pool-5e4152ba-ubc9 | 10.128.0.52 |                          |\n| gke-cluster1-default-pool-5e4152ba-yzbg | 10.128.0.54 | Ingress Gateway Pod Node  |\n\nPublic IP of the local client computer used for testing: \u0060123.120.247.15\u0060\n\n## Deploying Test Example\n\nThe following diagram illustrates the testing approach:\n\n\u0060\u0060\u0060mermaid\nsequenceDiagram\n    participant C as Client\n    participant LB as Load Balancer\n    participant IG as Ingress Gateway\n    participant S as Echo Server\n    C-\u003e\u003eLB: Initial Request\n    LB-\u003e\u003eIG: Forward Request \n    IG-\u003e\u003eS: Forwarded Request\n\u0060\u0060\u0060\n\n![Mermaid Diagram](5f7a7c047a92dbcba5c733f206727c6a.svg)\n\nFirst, deploy Istio according to the [Istio documentation](https:\/\/istio.io\/latest\/docs\/setup\/install\/), and then enable sidecar auto-injection for the default namespace:\n\n\u0060\u0060\u0060bash\nkubectl label namespace default istio-injection=enabled\n\u0060\u0060\u0060\n\nDeploy the \u0060echo-server\u0060 application in Istio:\n\n\u0060\u0060\u0060bash\nkubectl create deployment echo-server --image=registry.k8s.io\/echoserver:1.4\nkubectl expose deployment echo-server --name=clusterip --port=80 --target-port=8080\n\u0060\u0060\u0060\n\nCreate an Ingress Gateway:\n\n\u0060\u0060\u0060bash\ncat \u003e config.yaml \u003c\u003cEOF\napiVersion: networking.istio.io\/v1beta1\nkind: Gateway\nmetadata:\n  name: clusterip-gateway\nspec:\n  selector:\n    istio: ingressgateway # Choose the appropriate selector for your environment\n  servers:\n    - port:\n        number: 80\n        name: http\n        protocol: HTTP\n      hosts:\n        - \u0022clusterip.jimmysong.io\u0022 # Replace with the desired hostname\n---\napiVersion: networking.istio.io\/v1beta1\nkind: VirtualService\nmetadata:\n  name: clusterip-virtualservice\nspec:\n  hosts:\n    - \u0022clusterip.jimmysong.io\u0022 # Replace with the same hostname as in the Gateway\n  gateways:\n    - clusterip-gateway # Use the name of the Gateway here\n  http:\n    - route:\n        - destination:\n            host: clusterip.default.svc.cluster.local # Replace with the actual hostname of your Service\n            port:\n              number: 80 # Port of the Service\nEOF\nkubectl apply -f config.yaml\n\u0060\u0060\u0060\n\nView the Envoy logs in the Ingress Gateway:\n\n\u0060\u0060\u0060bash\nkubectl logs -f deployment\/istio-ingressgateway -n istio-system\n\u0060\u0060\u0060\n\nView the Envoy logs in the Sleep Pod:\n\n\u0060\u0060\u0060bash\nkubectl logs -f deployment\/sleep -n default -c istio-proxy\n\u0060\u0060\u0060\n\nView the Envoy logs in the Echo Server:\n\n\u0060\u0060\u0060bash\nkubectl logs -f deployment\/echo-server -n default -c istio-proxy\n\u0060\u0060\u0060\n\nGet the public IP of the gateway:\n\n\u0060\u0060\u0060bash\nexport GATEWAY_IP=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath=\u0027{.status.loadBalancer.ingress[0].ip}\u0027)\n\u0060\u0060\u0060\n\nTest locally using curl:\n\n\u0060\u0060\u0060bash\ncurl -H \u0022Host: clusterip.jimmysong.io\u0022 $GATEWAY_IP\n\u0060\u0060\u0060\n\n### Resource IP\n\nAfter deploying the test application, you need to obtain the IP addresses of the following resources, which will be used in the upcoming experiments.\n\n**Pod**\n\nHere are the initial Pod IPs, but please note that as patches are applied to the Deployment, Pods may be recreated, and their names and IP addresses may change.\n\n| Pod Name                              | Pod IP      |\n| ------------------------------------- | ----------- |\n| echo-server-6d9f5d97d7-fznrq          | 10.32.1.205 |\n| sleep-9454cc476-2dskx                 | 10.32.3.202 |\n| istio-ingressgateway-6c96bdcd74-zh46d | 10.32.1.221 |\n\n**Service**\n\n| Service Name         | Cluster IP  | External IP   |\n| -------------------- | ----------- | ------------- |\n| clusterip            | 10.36.8.86  | -             |\n| sleep                | 10.36.14.12 | -             |\n| istio-ingressgateway | 10.36.4.127 | 35.188.212.88 |\n\n## North-South Traffic\n\nLet\u0027s first consider the scenario where the client is outside the Kubernetes cluster and accesses internal services through a load balancer.\n\n### Test 1: Cluster Traffic Policy, iptables Traffic Hijacking\n\nThis is the default situation after deploying the test application using the steps above, and it represents the commonly encountered scenario where the source IP address is said to be lost.\n\ncurl test:\n\n\u0060\u0060\u0060bash\ncurl -H \u0022Host: clusterip.jimmysong.io\u0022 $GATEWAY_IP\n\u0060\u0060\u0060\n\n{{\u003cdetail \u0022View Results\u0022\u003e}}\n\n{{\u003chighlight text \u0022linenos=table,hl_lines=2 21 23\u0022\u003e}}\nCLIENT VALUES:\nclient_address=127.0.0.6\ncommand=GET\nreal path=\/\nquery=nil\nrequest_version=1.1\nrequest_uri=http:\/\/clusterip.jimmysong.io:8080\/\n\nSERVER VALUES:\nserver_version=nginx: 1.10.0 - lua: 10001\n\nHEADERS RECEIVED:\naccept=*\/*\nhost=clusterip.jimmysong.io\nuser-agent=curl\/8.4.0\nx-b3-parentspanid=03c124c5f910001a\nx-b3-sampled=1\nx-b3-spanid=103dc912ec14f3b4\nx-b3-traceid=140ffa034822077f03c124c5f910001a\nx-envoy-attempt-count=1\nx-envoy-internal=true\nx-forwarded-client-cert=By=spiffe:\/\/cluster.local\/ns\/default\/sa\/default;Hash=79253e34e1c28d389e9bfb1a62ffe8944b2c3c369b46bf4a9faf055b55dedb7f;Subject=\u0022\u0022;URI=spiffe:\/\/cluster.local\/ns\/istio-system\/sa\/istio-ingressgateway-service-account\nx-forwarded-for=10.128.0.54\nx-forwarded-proto=http\nx-request-id=b3c05e22-594e-98da-ab23-da711a8f53ec\nBODY:\n-no body in request-\n{{\u003c\/highlight\u003e}}\n\n{{\u003c\/detail\u003e}}\n\nYou only need to focus on the \u0060client_address\u0060 and \u0060x-forwarded-for\u0060 results. Other information in the curl test results will be omitted in the following curl test results.\n\n{{\u003ccallout note Explanation\u003e}}\n\nMeaning of fields in the results:\n\n- \u0060client_address\u0060: The client IP address obtained through TCP\/IP protocol resolution, referred to as the remote address in Envoy.\n- \u0060x-forwarded-for\u0060: \u0060x-forwarded-for\u0060 (XFF) is a standard proxy header used to indicate the IP addresses that the request has passed through from the client to the server. A compliant proxy will add the IP address of the most recent client to the XFF list before proxying the request. See [Envoy documentation](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/http\/http_conn_man\/headers#x-forwarded-for) for details.\n\n{{\u003c\/callout\u003e}}\n\nFrom the test results, we can see that the source IP address becomes the IP address of the Ingress Gateway Pod\u0027s node (\u006010.128.0.54\u0060).\n\nThe following diagram shows the packet flow paths between the two Pods.\n\n\u0060\u0060\u0060mermaid\ngraph LR\nsubgraph IngressGatewayPod[Ingress Gateway Pod]\nA[\u0022Downstream Remote (Ingress Gateway Node)\u003cbr\u003e10.128.0.54:56532\u0022] --\u003e B\n    B[\u0022Downstream Local (Ingresss Gateway Pod)\u003cbr\u003e10.32.1.221:8080\u0022]--\u003eC\n    C[\u0022Upstream Local (Ingress Gateway Pod)\u003cbr\u003e10.32.1.221:59842\u0022]\n    C --\u003e D[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\nend\nsubgraph SourceIPAppPod[Echo Server Pod]\n    E[\u0022Downstream Remote (Ingress Gateway Pod)\u003cbr\u003e10.128.0.54:0\u0022] --\u003e F\n    F[\u0022Downstream Local (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\n    G[\u0022Upstream Local (InboundPassthroughClusterIpv4)\u003cbr\u003e127.0.0.6:60481\u0022]\n    H[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\n    F --\u003e G\n    G --\u003e H\nend\nIngressGatewayPod--\u003eSourceIPAppPod\n\u0060\u0060\u0060\n\n![Mermaid Diagram](77c177b53601d1d83794cc1b2f4a8b5a.svg)\n\nFor this scenario, preserving the source IP is straightforward and is also a standard option provided by Kubernetes.\n\n### How is the Source IP Lost?\n\nThe following diagram shows how the source IP of the client is lost during the request process.\n\n\u0060\u0060\u0060mermaid\nsequenceDiagram\n    participant C as Client\u003cbr\u003e123.120.247.15\n    participant LB as Load Balancer\u003cbr\u003e35.188.212.88\n    participant IG as Ingress Gateway\u003cbr\u003e10.32.1.221\n    participant S as Echo Server Pod\u003cbr\u003e10.32.1.205\n    C-\u003e\u003eLB: Initial Request\n    LB-\u003e\u003eIG: Altered Request (IP Changed)\u003cbr\u003eSNAT: 123.120.234.15 -\u003e 10.128.0.54\n    IG-\u003e\u003eS: Forwarded Request\n    Note over IG,S: Source IP Lost\n\u0060\u0060\u0060\n\n![Mermaid Diagram](708e3a4981b7deadfb203257e2ac5a64.svg)\n\nBecause the load balancer sends packets to any node in the Kubernetes cluster, SNAT is performed during this process, resulting in the loss of the client\u0027s source IP when it reaches the Server Pod.\n\n### How to Preserve the Client Source IP\n\nYou can control the load balancer to preserve the source IP by setting the \u0060externalTrafficPolicy\u0060 field in the service to \u0060Local\u0060.\n\n**externalTrafficPolicy**\n\n\u0060externalTrafficPolicy\u0060 is a standard [Service option](https:\/\/kubernetes.io\/docs\/tasks\/access-application-cluster\/create-external-load-balancer\/#preserving-the-client-source-ip) that defines whether incoming traffic to Kubernetes nodes is load-balanced and how it\u0027s load-balanced. \u0060Cluster\u0060 is the default policy, but \u0060Local\u0060 is typically used to preserve the source IP of incoming traffic to cluster nodes. \u0060Local\u0060 effectively disables load balancing on the cluster nodes so that traffic received by local Pods sees the source IP address.\n\n\u0060\u0060\u0060mermaid\ngraph TD;\n    A[Client Request] --\u003e|Sent to Service| B[Load Balancer]\n    B --\u003e|externalTrafficPolicy: Local| C[Node with Service Endpoint]\n    C --\u003e|Source IP Preserved| D[Service Handling Request]\n    B --\u003e|\u0022externalTrafficPolicy: Cluster (Default)\u0022| E[Any Node in Cluster]\n    E --\u003e|Source IP Altered| D\n\u0060\u0060\u0060\n\n![Mermaid Diagram](02f4d9919bbd6f3d5fc5682c3793896a.svg)\n\nIn other words, setting \u0060externalTrafficPolicy\u0060 to \u0060Local\u0060 allows packets to bypass kube-proxy on the nodes and reach the target Pod directly. However, most people do not set \u0060externalTrafficPolicy\u0060 when creating a Service in Kubernetes, so the default \u0060Cluster\u0060 policy is used.\n\nSince using the Local external traffic policy in Service can preserve the client\u0027s source IP address, why isn\u0027t it the default in Kubernetes?\n\nThe default setting of Kubernetes Service\u0027s \u0060externalTrafficPolicy\u0060 to \u0060Cluster\u0060 instead of \u0060Local\u0060 is primarily based on the following considerations:\n\n1. **Load Balancing**: Ensures even distribution of traffic across all nodes, preventing overload on a single node.\n2. **High Availability**: Allows traffic to be received by any node in the cluster, enhancing service availability.\n3. **Simplified Configuration**: The \u0060Cluster\u0060 mode reduces the complexity of network configurations.\n4. **Performance Optimization**: Avoids potential performance issues caused by preserving the client\u0027s source IP.\n5. **Universality**: Compatible with a variety of network environments and cluster configurations, suitable for a broader range of scenarios.\n\n### Test 2: Local Traffic Policy, iptables Traffic Hijacking\n\nSet the Ingress Gateway Service to use the Local external traffic policy:\n\n\u0060\u0060\u0060bash\nkubectl patch svc istio-ingressgateway -p \u0027{\u0022spec\u0022:{\u0022externalTrafficPolicy\u0022:\u0022Local\u0022}}\u0027 -n istio-system\n\u0060\u0060\u0060\n\nCurl test:\n\n\u0060\u0060\u0060bash\ncurl -H \u0022Host: clusterip.jimmysong.io\u0022 $GATEWAY_IP\n\u0060\u0060\u0060\n\n{{\u003cdetail \u0022View Results\u0022\u003e}}\n\n{{\u003chighlight text \u0022linenos=table,hl_lines=2 21 23\u0022\u003e}}\nCLIENT VALUES:\nclient_address=127.0.0.6\ncommand=GET\nreal path=\/\nquery=nil\nrequest_version=1.1\nrequest_uri=http:\/\/clusterip.jimmysong.io:8080\/\n\nSERVER VALUES:\nserver_version=nginx: 1.10.0 - lua: 10001\n\nHEADERS RECEIVED:\naccept=*\/*\nhost=clusterip.jimmysong.io\nuser-agent=curl\/8.4.0\nx-b3-parentspanid=060c393adb561603\nx-b3-sampled=1\nx-b3-spanid=8df3e10078cc826b\nx-b3-traceid=cf26040ae9536702060c393adb561603\nx-envoy-attempt-count=1\nx-envoy-external-address=123.120.247.15\nx-forwarded-client-cert=By=spiffe:\/\/cluster.local\/ns\/default\/sa\/default;Hash=79253e34e1c28d389e9bfb1a62ffe8944b2c3c369b46bf4a9faf055b55dedb7f;Subject=\u0022\u0022;URI=spiffe:\/\/cluster.local\/ns\/istio-system\/sa\/istio-ingressgateway-service-account\nx-forwarded-for=123.120.247.15\nx-forwarded-proto=http\nx-request-id=35bc2123-0971-9a9c-84c1-2aeee233a268\nBODY:\n-no body in request-\n{{\u003c\/highlight\u003e}}\n{{\u003c\/detail\u003e}}\n\nFrom the Envoy logs, we can see the current packet path:\n\n\u0060\u0060\u0060mermaid\ngraph LR\nsubgraph IngressGatewayPod[Ingress Gateway Pod]\n    B[\u0022Downstream Local (Ingress Gateway Pod)\u003cbr\u003e10.32.1.221:8080\u0022]\n    C[\u0022Upstream Local (Ingress Gateway Pod)\u003cbr\u003e10.32.1.221:59842\u0022]\nA[\u0022Downstream Remote (Client)\u003cbr\u003e123.120.247.15:62650\u0022] --\u003e B\nB --\u003e C\nC --\u003e D[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\nend\nsubgraph SourceIPAppPod[Echo Server Pod]\n    F[\u0022Downstream Local (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\n    G[\u0022Upstream Local (InboundPassthroughClusterIpv4)\u003cbr\u003e127.0.0.6:58639\u0022]\n    H[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.205:8080\u0022]\nE[\u0022Downstream Remote (Client)\u003cbr\u003e123.120.247.15:0\u0022] --\u003e F\nF --\u003e G\nG --\u003e H\nend\nIngressGatewayPod--\u003eSourceIPAppPod\n\u0060\u0060\u0060\n\n![Mermaid Diagram](bd32b793946c9c3457a8a10db33f395d.svg)\n\nThe client\u0027s source IP is correctly identified as \u0060123.120.247.15\u0060.\n\n## East-West Traffic\n\nIn the default Istio configuration, for east-west traffic as well, the server cannot obtain the correct client source IP.\n\n### Test 3: Local Traffic Policy, tproxy Traffic Hijacking\n\nChange the traffic interception method from iptables to [tproxy](\/en\/blog\/what-is-tproxy\/) for the Echo Server:\n\n\u0060\u0060\u0060bash\nkubectl patch deployment -n default echo-server -p \u0027{\u0022spec\u0022:{\u0022template\u0022:{\u0022metadata\u0022:{\u0022annotations\u0022:{\u0022sidecar.istio.io\/interceptionMode\u0022:\u0022TPROXY\u0022}}}}}\u0027\n\u0060\u0060\u0060\n\nNote: At this point, the Pod for Echo Server will be recreated, and the new Pod\u0027s name is \u0060echo-server-686d564647-r7nlq\u0060, with an IP address of 10.32.1.140.\n\nCurl test:\n\n\u0060\u0060\u0060bash\nkubectl exec -it deployment\/sleep -it -- curl clusterip\n\u0060\u0060\u0060\n\n{{\u003cdetail \u0022View Results\u0022\u003e}}\n{{\u003chighlight text \u0022linenos=table,hl_lines=2\u0022\u003e}}\nCLIENT VALUES:\nclient_address=10.32.3.202\ncommand=GET\nreal path=\/\nquery=nil\nrequest_version=1.1\nrequest_uri=http:\/\/clusterip:8080\/\n\nSERVER VALUES:\nserver_version=nginx: 1.10.0 - lua: 10001\n\nHEADERS RECEIVED:\naccept=*\/*\nhost=clusterip\nuser-agent=curl\/8.5.0\nx-b3-parentspanid=3c07f3b87cc547dd\nx-b3-sampled=1\nx-b3-spanid=97844ebdde748bfc\nx-b3-traceid=90f57b0fb260dfbf3c07f3b87cc547dd\nx-envoy-attempt-count=1\nx-forwarded-client-cert=By=spiffe:\/\/cluster.local\/ns\/default\/sa\/default;Hash=25af59fcf9fbe745eb75a318c47d55059d75914632d2536a43a80d342eaed27c;Subject=\u0022\u0022;URI=spiffe:\/\/cluster.local\/ns\/default\/sa\/sleep\nx-forwarded-proto=http\nx-request-id=e9b27bde-3cf6-9d8b-8f23-1cb0fa35d405\nBODY:\n-no body in request-\n{{\u003c\/highlight\u003e}}\n{{\u003c\/detail\u003e}}\n\nThe diagram below illustrates the packet path:\n\n\u0060\u0060\u0060mermaid\ngraph LR\nsubgraph SleepPod[Sleep Pod]\nA[\u0022Downstream Remote (Sleep Pod)\u003cbr\u003e10.32.3.202:38394\u0022] --\u003e B\nB[\u0022Downstream Local (Clusterip Service)\u003cbr\u003e10.36.8.86:80\u0022] --\u003e C\nC[\u0022Upstream Local (Sleep Pod)\u003cbr\u003e10.32.3.202:33786\u0022] --\u003e D[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.140:8080\u0022]\nend\nsubgraph SourceIPAppPod[Echo Server Pod]\nE[\u0022Downstream Remote (Sleep Pod)\u003cbr\u003e10.32.3.202:33786\u0022] --\u003e F\nF[\u0022Downstream Local (Echo Server Pod)\u003cbr\u003e10.32.1.140:8080\u0022] --\u003e G\nG[\u0022Upstream Local (Sleep Pod)\u003cbr\u003e10.32.3.202:34173\u0022] --\u003e H[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.140:8080\u0022]\nend\nSleepPod--\u003eSourceIPAppPod\n\u0060\u0060\u0060\n\n![Mermaid Diagram](eb87f7cdfe68c1b653b431af7281f2c9.svg)\n\nThe client\u0027s IP is correctly identified as \u006010.32.3.202\u0060.\n\n### Test 4: Local Traffic Policy, iptables Traffic Hijacking\n\nRestore the traffic interception method in the Echo Server to redirect:\n\n\u0060\u0060\u0060bash\nkubectl patch deployment -n default echo-server -p \u0027{\u0022spec\u0022:{\u0022template\u0022:{\u0022metadata\u0022:{\u0022annotations\u0022:{\u0022sidecar.istio.io\/interceptionMode\u0022:\u0022REDIRECT\u0022}}}}}\u0027\n\u0060\u0060\u0060\n\nNote: At this point, the Pod for the Echo Server will be recreated, and the new Pod\u0027s name is \u0060echo-server-6d9f5d97d7-bgpk6\u0060, with an IP address of 10.32.1.123.\n\nCurl test:\n\n\u0060\u0060\u0060bash\nkubectl exec -it deployment\/sleep -it -- curl clusterip\n\u0060\u0060\u0060\n\n{{\u003cdetail \u0022View Results\u0022\u003e}}\n{{\u003chighlight text \u0022linenos=table,hl_lines=2\u0022\u003e}}\nCLIENT VALUES:\nclient_address=127.0.0.6\ncommand=GET\nreal path=\/\nquery=nil\nrequest_version=1.1\nrequest_uri=http:\/\/clusterip:8080\/\n\nSERVER VALUES:\nserver_version=nginx: 1.10.0 - lua: 10001\n\nHEADERS RECEIVED:\naccept=*\/*\nhost=clusterip\nuser-agent=curl\/8.5.0\nx-b3-parentspanid=6123380e58ca0ce7\nx-b3-sampled=1\nx-b3-spanid=633848c0065ec91e\nx-b3-traceid=dbcda8b3673e70a46123380e58ca0ce7\nx-envoy-attempt-count=1\nx-forwarded-client-cert=By=spiffe:\/\/cluster.local\/ns\/default\/sa\/default;Hash=25af59fcf9fbe745eb75a318c47d55059d75914632d2536a43a80d342eaed27c;Subject=\u0022\u0022;URI=spiffe:\/\/cluster.local\/ns\/default\/sa\/sleep\nx-forwarded-proto=http\nx-request-id=b05e07e1-08ba-9449-90a9-a4a98277a8c0\nBODY:\n-no body in request-\n{{\u003c\/highlight\u003e}}\n{{\u003c\/detail\u003e}}\n\nThe diagram below illustrates the packet path:\n\n\u0060\u0060\u0060mermaid\ngraph LR\nsubgraph Sleep[Sleep Pod]\nA[\u0022Downstream Remote (Sleep Pod)\u003cbr\u003e10.32.3.202:34238\u0022] --\u003e B\nB[\u0022Downstream Local (Clusterip Service)\u003cbr\u003e10.36.8.86:80\u0022] --\u003e C\nC[\u0022Upstream Local (Sleep Pod)\u003cbr\u003e10.32.3.202:52776\u0022] --\u003e D[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.123:8080\u0022]\nend\nsubgraph SourceIPApp[Echo Server Pod]\nE[\u0022Downstream Remote (Sleep Pod)\u003cbr\u003e10.32.3.202:52776\u0022] --\u003e F\nF[\u0022Downstream Local (Echo Server Pod)\u003cbr\u003e10.32.1.123:8080\u0022] --\u003e G\nG[\u0022Upstream Local (InboundPassthroughClusterIpv4)\u003cbr\u003e127.0.0.6:49803\u0022] --\u003e H[\u0022Upstream Host (Echo Server Pod)\u003cbr\u003e10.32.1.123:8080\u0022]\nend\nSleep --\u003eSourceIPApp\n\u0060\u0060\u0060\n\n![Mermaid Diagram](ae5e1e766d0262189226721772529ec8.svg)\n\nThe client\u0027s source IP is identified as \u0060127.0.0.6\u0060.\n\n## Summary for Single-Layer Proxy Scenario\n\nIn a single-tier proxy scenario, you only need to set the \u0060externalTrafficPolicy\u0060 of the Ingress Gateway\u0027s Service to \u0060Local\u0060 to preserve the client\u0027s source IP. Modifying the traffic interception mode of the target service to \u0060TPROXY\u0060 will preserve the source IP in east-west requests.\n\n## Multi-Layer Proxy\n\nIf traffic has already passed through multiple tiers of proxies before entering the Istio Mesh, each time traffic passes through a proxy, the proxy parses the HTTP traffic and appends its own IP address to the \u0060x-forwarded-for\u0060 header. You can use the \u0060numTrustedProxies\u0060 configuration to specify the number of trusted proxy hops, referring to the [Envoy documentation](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/http\/http_conn_man\/headers#x-forwarded-for) for how to determine the \u0060X-Forwarded-For\u0060 header and trusted client addresses.\n\nIn practice, it can be challenging to determine how many tiers of proxy traffic have passed through before reaching the Istio Mesh, but you can use the \u0060x-forwarded-for\u0060 header to understand the forwarding path of the traffic.\n\nThe diagram below shows how Envoy confirms the source IP based on the \u0060x-forwarded-for\u0060 header and \u0060xff_num_trusted_hops\u0060 (corresponding to the \u0060numTrustedProxies\u0060 configuration in Istio). See the [Envoy documentation](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/http\/http_conn_man\/headers#x-forwarded-for) for details.\n\n\u0060\u0060\u0060mermaid\ngraph TD\n    A[Start] --\u003e|use_remote_address is false| B[Check XFF]\n    A --\u003e|use_remote_address is true| G[Check xff_num_trusted_hops]\n    B --\u003e|XFF contains at least one IP| C[Use last IP in XFF]\n    B --\u003e|XFF is empty| D[Use immediate downstream IP]\n    G --\u003e|xff_num_trusted_hops \u003e 0| H[\u0022Use (N)th IP from right in XFF\u0022]\n    G --\u003e|xff_num_trusted_hops \u003c= 0| D\n    H --\u003e|XFF contains \u003e= N addresses| I[Use Nth address from right]\n    H --\u003e|XFF contains \u003c N addresses| D\n\u0060\u0060\u0060\n\n![Mermaid Diagram](b82caafefa304b53c996da072373043a.svg)\n\nExecute the following command to enable trusted proxy configuration for the Ingress Gateway:\n\n\u0060\u0060\u0060bash\nkubectl patch deployment istio-ingressgateway -n istio-system -p \u0027{\u0022spec\u0022:{\u0022template\u0022:{\u0022metadata\u0022:{\u0022annotations\u0022:{\u0022proxy.istio.io\/config\u0022:\u0022{\\\u0022gatewayTopology\\\u0022:{\\\u0022numTrustedProxies\\\u0022: 2,\\\u0022forwardClientCertDetails\\\u0022:\\\u0022SANITIZE_SET\\\u0022}}\u0022}}}}}\u0027\n\u0060\u0060\u0060\n\nWhen the Istio Gateway receives a request, it sets the \u0060X-Envoy-External-Address\u0060 header to the second-to-last address in your \u0060X-Forwarded-For\u0060 header in the curl command (\u0060numTrustedProxies: 2\u0060). According to Istio\u0027s documentation, the Gateway appends its own IP to the \u0060X-Forwarded-For\u0060 header before forwarding it to the service sidecar. However, in practice, only the client source IP and the External Gateway Pod IP are present in the header.\n\nYou can undo this patch by executing the following command:\n\n\u0060\u0060\u0060bash\nkubectl patch deployment istio-ingressgateway -n istio-system -p \u0027{\u0022spec\u0022:{\u0022template\u0022:{\u0022metadata\u0022:{\u0022annotations\u0022:{\u0022proxy.istio.io\/config\u0022:\u0022{}\u0022}}}}}\u0027\n\u0060\u0060\u0060\n\n## TCP Traffic\n\nThe method mentioned above for obtaining the client source IP using headers applies only to L7 networks. For L4 network TCP traffic, you can use the Proxy Protocol.\n\nThe Proxy Protocol is a network protocol that adds a header at the beginning of a TCP connection to pass along some metadata, such as the client\u0027s real IP address and port number, during the connection establishment. This is particularly useful for applications deployed behind load balancers (LB) because load balancers often change the original IP address of the client to the LB\u0027s address, making it difficult for the server to know the real client\u0027s IP. Many proxy software supports the Proxy Protocol, including [Envoy](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/listeners\/listener_filters\/proxy_protocol), HAProxy, NGINX, and others.\n\nYou can use the following command to patch the Ingress Gateway to support the Proxy Protocol:\n\n\u0060\u0060\u0060bash\nkubectl patch deployment istio-ingressgateway -n istio-system -p \u0027{\u0022spec\u0022:{\u0022template\u0022:{\u0022metadata\u0022:{\u0022annotations\u0022:{\u0022proxy.istio.io\/config\u0022:\u0022{\\\\\u0022gatewayTopology\\\\\u0022:{\\\\\u0022proxyProtocol\\\\\u0022:{}}}\u0022}}}}}\u0027\n\u0060\u0060\u0060\n\nNote: Not all load balancers created by \u0060LoadBalancer\u0060 type Services in Kubernetes in public clouds support this configuration. For example, GKE does not support it. To enable Proxy Protocol on AWS NLB, refer to [this blog post](https:\/\/istio.io\/latest\/blog\/2020\/show-source-ip\/).\n\nIt\u0027s worth noting that Envoy does not recommend using the Proxy Protocol because it:\n\n- Only supports the TCP protocol.\n- Requires upstream hosts to support it.\n- May impact performance.\n\nFor Envoy\u0027s support of the Proxy Protocol, refer to [this documentation](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/intro\/arch_overview\/other_features\/ip_transparency#proxy-protocol).\n\n## Use Case Examples\n\nThe following are common scenarios for source IP addresses.\n\n### Access Control Based on Source IP Address\n\nIn Istio, you can configure access control policies based on source IP using the Ingress Gateway. This is achieved by setting the authorization policy for the Ingress Gateway to restrict access based on source IP addresses.\n\nThe following diagram shows the flow of traffic:\n\n\u0060\u0060\u0060mermaid\nsequenceDiagram\n    participant C as Client\n    participant P1 as Proxy 1\n    participant P2 as Proxy 2\n    participant Pn as Proxy N\n    participant IG as Ingress Gateway\n    participant S as Service\n\n    C-\u003e\u003e\u002bP1: Request with Source IP\n    P1-\u003e\u003e\u002bP2: Forward Request\n    P2-\u003e\u003e\u002bPn: Forward Request\n    Pn-\u003e\u003e\u002bIG: Forward Request\n    Note over IG: numTrustedProxies Set\n    IG-\u003e\u003e\u002bS: Forwarded Request\n    Note over IG: Authorization Policy Based on Source IP\n\u0060\u0060\u0060\n\n![Mermaid Diagram](635bc14feb9b6939b3319929849cd0b5.svg)\n\n#### Scenario Assumptions\n\nLet\u0027s assume a request passes through three proxies with IP addresses \u00601.1.1.1\u0060, \u00602.2.2.2\u0060, and \u00603.3.3.3\u0060. In the Ingress Gateway, \u0060numTrustedProxies\u0060 is set to 2, so Istio trusts the source IP as \u00602.2.2.2\u0060 (i.e., \u0060x-envoy-external-address\u0060).\n\n\u0060\u0060\u0060bash\ncurl -H \u0022Host: clusterip.jimmysong.io\u0022 -H \u0027X-Forwarded-For: 1.1.1.1,2.2.2.2,3.3.3.3\u0027 $GATEWAY_IP\n\u0060\u0060\u0060\n\n#### Blocking Specific Source IP\n\nIf you need to block requests from \u00602.2.2.2\u0060, you can use the following authorization policy:\n\n\u0060\u0060\u0060yaml\napiVersion: security.istio.io\/v1\nkind: AuthorizationPolicy\nmetadata:\n  name: ingress-policy\n  namespace: istio-system\nspec:\n  selector:\n    matchLabels:\n      app: istio-ingressgateway\n  action: DENY\n  rules:\n    - from:\n        - source:\n            remoteIpBlocks:\n            - \u00222.2.2.2\/24\u0022\n\u0060\u0060\u0060\n\n#### Using the Ultimate Client IP\n\nIf you want to identify the client IP directly connected to the Istio Mesh (i.e., the last IP in \u0060x-forwarded-for\u0060, e.g., \u0060123.120.234.15\u0060), you need to configure it using \u0060ipBlocks\u0060:\n\n\u0060\u0060\u0060yaml\napiVersion: security.istio.io\/v1\nkind: AuthorizationPolicy\nmetadata:\n  name: ingress-policy\n  namespace: istio-system\nspec:\n  selector:\n    matchLabels:\n      app: istio-ingressgateway\n  action: DENY\n  rules:\n    - from:\n        - source:\n            ipBlocks:\n            - \u0022123.120.234.15\/24\u0022\n\u0060\u0060\u0060\n\nThis approach, by configuring authorization policies for Istio\u0027s Ingress Gateway, allows for effective access control based on source IP. It enables administrators to set rules flexibly based on different requirements, such as blocking specific IPs or trusting the ultimate client IP, enhancing the security and flexibility of the services.\n\n#### Load Balancing Based on Source IP Address\n\nHere is an example configuration that shows how to use \u0060DestinationRule\u0060 to load balance based on source IP address:\n\n\u0060\u0060\u0060yaml\napiVersion: networking.istio.io\/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: example-destination-rule\nspec:\n  host: example-service\n  trafficPolicy:\n    loadBalancer:\n      consistentHash:\n        httpHeaderName: x-forwarded-for\n\u0060\u0060\u0060\n\nNote that if connecting directly to the Istio Ingress Gateway without going through another proxy, you may need to adjust \u0060httpHeaderName\u0060 or use a different hash key, such as \u0060useSourceIp\u0060 as shown below:\n\n\u0060\u0060\u0060yaml\nspec:\n  trafficPolicy:\n    loadBalancer:\n      consistentHash:\n        useSourceIp: true\n\u0060\u0060\u0060\n\n{{\u003ccallout note Notice\u003e}}\n\n- When using source IP addresses as keys for load balancing, make sure you understand how this may affect traffic distribution, especially if the source IP addresses are unevenly distributed.\n- As mentioned above, in some environments, the original source IP may be modified by network devices (such as load balancers or NAT devices), and you need to ensure that the \u0060x-forwarded-for\u0060 header or other corresponding mechanism accurately reflects the original client IP.\n\n{{\u003c\/callout\u003e}}\n\n## Summary\n\n- Preserving the source IP is crucial for implementing access control, load balancing, and data analysis.\n- Envoy proxies use the \u0060X-Forwarded-For\u0060 header to handle the client source IP in HTTP requests.\n- By setting \u0060externalTrafficPolicy\u0060 and choosing the appropriate traffic interception method (\u0060REDIRECT\u0060 or \u0060TPROXY\u0060), you can correctly obtain the client source IP in North-South and East-West traffic.\n- When dealing with traffic that passes through multiple tiers of proxies, configuring \u0060numTrustedProxies\u0060 is crucial.\n- For TCP traffic, the Proxy Protocol is an effective solution.\n\n## References\n\n- [x-forwarded-for - envoyproxy.io](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/configuration\/http\/http_conn_man\/headers#x-forwarded-for)\n- [Proxy protocol on AWS NLB and Istio ingress gateway - istio.io](https:\/\/istio.io\/latest\/blog\/2020\/show-source-ip\/)\n- [Configuring Gateway Network Topology - istio.io](https:\/\/istio.io\/latest\/docs\/ops\/configuration\/traffic-management\/network-topologies\/)\n- [IP Transparency - envoyproxy.io](https:\/\/www.envoyproxy.io\/docs\/envoy\/latest\/intro\/arch_overview\/other_features\/ip_transparency)\n- [Using Source IP - kubernetes.io](https:\/\/kubernetes.io\/docs\/tutorials\/services\/source-ip\/)\n- [Proxy Protocol - github.com](https:\/\/github.com\/haproxy\/haproxy\/blob\/master\/doc\/proxy-protocol.txt)\n\n---\n\n*This blog was initially published at [tetrate.io](https:\/\/tetrate.io\/blog\/istio-source-ip-transparency\/) .*\n', '\/en\/blog\/preserve-source-ip-in-istio\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">This article focuses on how to maintain transparency of the client source IP in the Istio service mesh.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/primary-remote-istio-ingress-gateway-mtls/">Deciphering Istio Multi-Cluster Authentication &amp; mTLS Connection</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Jan 16, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Deciphering Istio Multi-Cluster Authentication \u0026 mTLS Connection', 'This blog deeply analyzes the initial authentication and mTLS connection process of remote gateways in Istio\u0027s primary-remote deployment mode.', '\n## Introduction\n\nI often answer questions on [Istio\u0027s GitHub Discussions](https:\/\/github.com\/istio\/istio\/discussions), and recently, I came across a [discussion](https:\/\/github.com\/istio\/istio\/discussions\/48343) about Istio\u0027s primary-remote deployment, specifically regarding how the remote cluster\u0027s gateway initially authenticates to an external Istiod instance. This issue touches upon the core security mechanisms of service meshes in multi-cluster configurations, which I think merits more in-depth sharing in the community.\n\nIn the official Istio documentation on [Installing Primary-Remote on different networks](https:\/\/istio.io\/latest\/docs\/setup\/install\/multicluster\/primary-remote_multi-network\/), one of the steps is to [attach cluster2 as a remote cluster of cluster1](https:\/\/istio.io\/latest\/docs\/setup\/install\/multicluster\/primary-remote_multi-network\/#attach-cluster2-as-a-remote-cluster-of-cluster1). This process creates a Secret containing a kubeconfig configuration, which includes the certificates and tokens required to access the remote cluster (cluster2).\n\n\u0060\u0060\u0060yaml\n# This file is autogenerated, do not edit.\napiVersion: v1\nkind: Secret\nmetadata:\n  annotations:\n    networking.istio.io\/cluster: cluster2\n  creationTimestamp: null\n  labels:\n    istio\/multiCluster: \u0022true\u0022\n  name: istio-remote-secret-cluster2\n  namespace: istio-system\nstringData:\n  cluster2: |\n    apiVersion: v1\n    clusters:\n    - cluster:\n        certificate-authority-data: {CERTIFICATE}\n        server: {CLUSTER2-APISERVER-ADDRESS}\n      name: cluster2\n    contexts:\n    - context:\n        cluster: cluster2\n        user: cluster2\n      name: cluster2\n    current-context: cluster2\n    kind: Config\n    preferences: {}\n    users:\n    - name: cluster2\n      user:\n        token: {TOKEN}\n\u0060\u0060\u0060\n\nThe key role of this Secret is to enable Istio in the primary cluster (cluster1) to access the API server of the remote cluster, thereby obtaining service information. Additionally, in the remote cluster (cluster2), the Istiod service points to the primary cluster\u0027s Istiod service\u0027s LoadBalancer IP (ports 15012 and 15017), allowing cluster2 to communicate with the primary cluster\u0027s Istiod.\n\n## Visualizing Authentication\n\nSince both clusters share a CA (provided by the primary cluster) and the remote cluster can access its own API server, the Istiod in the primary cluster can validate requests from the remote cluster (cluster2). The following sequence diagram clearly shows this process:\n\n\u0060\u0060\u0060mermaid\nsequenceDiagram\n    participant IG as Ingress Gateway (Remote Cluster)\n    participant K8s as Kubernetes API (Remote Cluster)\n    participant SA as Service Account (Remote Cluster)\n    participant Istiod as Istiod (Primary Cluster)\n\n    Note over IG: Startup\n    IG-\u003e\u003eK8s: Request Service Account Token\n    K8s-\u003e\u003eSA: Create\/Retrieve Token\n    SA--\u003e\u003eIG: Return Token\n    Note over IG: Token Mounted in Pod\n\n    IG-\u003e\u003eIstiod: Authenticate with Token\n    Note over Istiod: Validate Token\n    Istiod-\u003e\u003eIstiod: Generate mTLS Certificates\n    Istiod--\u003e\u003eIG: Send mTLS Certificates\n\n    Note over IG: Use mTLS Certificates for Secure Communication in Mesh\n\u0060\u0060\u0060\n\n![Mermaid Diagram](72dd4a02f2175fd6f9cc1128148b0bf7.svg)\n\n\n\nThis process is a key component of Istio\u0027s multi-cluster configuration, ensuring secure cross-cluster communication within the service mesh. As seen in this discussion, both the remote gateway and the services depend on the primary cluster\u0027s CA for initial mTLS authentication, providing a solid foundation for secure communication across the entire service mesh.\n\n## Conclusion\n\nIn this blog, we explored how the gateway in a remote cluster initially authenticates to an external Istiod in Istio\u0027s primary-remote deployment. We explained how to create a Secret containing a kubeconfig to allow Istio in the primary cluster to access the remote cluster\u0027s API and how shared CA and service account tokens ensure the security of mTLS authentication. This process secures cross-cluster communication within the service mesh, providing key insights for understanding and implementing Istio\u0027s multi-cluster configuration.\n\n---\n\n*This blog was initially published at [tetrate.io](https:\/\/tetrate.io\/blog\/istio-multi-cluster-authentication-mtls\/).*', '\/en\/blog\/primary-remote-istio-ingress-gateway-mtls\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">This blog deeply analyzes the initial authentication and mTLS connection process of remote gateways in Istio&#39;s primary-remote deployment mode.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide/">Enhancing Istio with TIS: Comprehensive Installation and Monitoring Guide</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Jan 10, 2024</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/istio"> 
             Istio
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Enhancing Istio with TIS: Comprehensive Installation and Monitoring Guide', 'In this blog, I’ll guide you through installing Tetrate Istio Subscription (TIS) and activating its monitoring add-on.', '\nIn this blog, I’ll guide you through installing [Tetrate Istio Subscription (TIS)](https:\/\/tetrate.io\/tetrate-istio-subscription\/) and activating its monitoring add-on.\n\n## Understanding Tetrate Istio Subscription\n\nTetrate Istio Subscription is a comprehensive, enterprise-grade product offered by Tetrate. It provides thoroughly tested Istio versions compatible with all major cloud platforms. Derived from the open-source Tetrate Istio Distro project, TIS adds extensive support to these builds, including optional FIPS-validated cryptographic modules and a range of tested add-ons and integrations.\n\n## Why Choose TIS?\n\nTIS is not a fork but an upstream distribution of Istio tailored for specific environments. Enhancements made to Istio are integrated upstream. Key benefits of TIS include:\n\n1. **Extended Support**: TIS offers 14 months of security update support.\n2. **Commercial Support**: TIS provides business support options for enterprise use cases, including compliance needs.\n3. **Ease of Management**: TIS simplifies installation and management processes.\n4. **Multi-Environment Adaptability**: TIS supports various cloud environments.\n5. **FIPS Validation**: TIS offers FIPS-validated versions for high-security requirements.\n\n[Visit the TIS docs for more information ›](https:\/\/docs.tetrate.io\/istio-subscription\/)\n\n## Pre-Installation Requirements\n\nBefore installing TIS and its plugins, you’ll need:\n\n- [Terraform](https:\/\/www.terraform.io\/) for importing dashboards into Grafana.\n- Credentials from Tetrate for installing TIS.\n  - tis_username\n  - tis_password\n\n## Installing Istio and Monitoring Addons\n\nFirst, check the supported Istio versions with TIS:\n\n\u0060\u0060\u0060\nhelm search repo tetratelabs\/base --versions\nNAME            CHART VERSION  APP VERSION    DESCRIPTION\ntetratelabs\/base1.20.1\u002btetrate01.20.1-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.20.0\u002btetrate01.20.0-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.19.5\u002btetrate01.19.5-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.19.4\u002btetrate01.19.4-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.19.3\u002btetrate01.19.3-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.18.6\u002btetrate01.18.6-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.18.5\u002btetrate01.18.5-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.18.3\u002btetrate01.18.3-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.17.8\u002btetrate01.17.8-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.17.6\u002btetrate01.17.6-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.16.7\u002btetrate01.16.7-tetrate0Helm chart for deploying Istio cluster resource...\ntetratelabs\/base1.16.6\u002btetrate01.16.6-tetrate0Helm chart for deploying Istio cluster resource...\n\u0060\u0060\u0060\n\nWe’ll install the latest Istio version, 1.20.1.\n\n\u0060\u0060\u0060bash\nexport TIS_USER=\u0022\u003ctis_username\u003e\u0022\nexport TIS_PASS=\u0022\u003ctis_password\u003e\u0022\n# Helm chart version\nexport VERSION=1.20.1\u002btetrate0\n# Image tag\nexport TAG=1.20.1-tetrate0\nkubectl create namespace istio-system\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-system\n\n# Install Istio\nhelm install istio-base tetratelabs\/base -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION}\n\nhelm install istiod tetratelabs\/istiod -n istio-system \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# install ingress Gateway\nkubectl create namespace istio-ingress\n\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n istio-ingress\n\nhelm install istio-ingress tetratelabs\/istio-ingress -n istio-ingress \\\n    --set global.tag=${TAG} \\\n    --set global.hub=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --set \u0022global.imagePullSecrets[0]=tetrate-tis-creds\u0022 \\\n    --version ${VERSION} \\\n    --wait\n\n# Install TIS addon\nhelm install istio-monitoring-demo tis-addons\/istio-monitoring-demo --namespace tis --create-namespace\n\u0060\u0060\u0060\n\nPort forward the Grafana service and open it in your local browser: [http:\/\/localhost:3000](http:\/\/localhost:3000\/):\n\n\u0060\u0060\u0060bash\nkubectl port-forward --namespace tis svc\/grafana 3000:3000\n\u0060\u0060\u0060\n\nNote: Keep the port-forwarding command running, as we’ll need access to this port for importing the dashboard into Grafana.\n\n## Why TIS Monitoring Addon?\n\nThe Tetrate Istio Subscription (TIS) Monitoring Addon stands out by offering a tailored and advanced monitoring experience compared to standard Istio dashboards. It focuses on modern needs with four specialized dashboards, replacing outdated elements with relevant metrics. Key enhancements include a unified panel design, detailed service insights, and critical metrics like sidecar performance. Reserved for TIS customers, these dashboards reflect Tetrate’s commitment to providing value beyond basic support, ensuring a personalized and evolving monitoring solution. Choosing TIS Monitoring Addon means accessing a service that not only meets current needs but also adapts to future demands.\n\n## Installing Istio Monitoring Addons\n\nAfter logging in with the default user name and password admin\/admin, select Administration-Service accounts in the left navigation bar, and follow the instructions in the Grafana documentation to create a Service account with admin privilege.\n\n![Grafana Service Account](grafana-service-account.jpg)\n\nCreate a Service account for Grafana then use Terraform to import dashboards into Grafana:\n\n\u0060\u0060\u0060bash\ncat\u003e~\/.terraformrc\u003c\u003cEOF\ncredentials \u0022terraform.cloudsmith.io\u0022 {\n  token = \u0022tetrate\/tis-containers\/\u003ctis_password\u003e\u0022\n}\nEOF\n\n# Create a terraform module file\ncat\u003eistio-monitoring-grafana.tf\u003c\u003cEOF\nmodule \u0022istio_monitoring_grafana\u0022 {\n  source = \u0022terraform.cloudsmith.io\/tis-containers\/istio-monitoring-grafana\/tetrate\u0022\n  version = \u0022v0.2.0\u0022\n  gf_url  = \u0022http:\/\/localhost:3000\u0022\n  gf_auth = \u0022\u003cgrafana_service_account_token\u003e\u0022\n}\nEOF\n\n# Run the commands\nterraform init\nterraform plan\nterraform apply -auto-approve\n\u0060\u0060\u0060\n\nCongratulations, you have successfully imported four dashboards into Grafana:\n\n- Istio Workload Dashboard\n- Istio Service Dashboard\n- Istio Wasm Extension Dashboard\n- Istio Control Plan Dashboard\n\nHowever, some dashboards might not have data yet. Let’s generate some traffic in the mesh.\n\n## Testing the Monitoring\n\nDeploy the Bookinfo application and [ingress gateway](https:\/\/tetrate.io\/learn\/kubernetes\/what-is-kubernetes-ingress\/):\n\n\u0060\u0060\u0060bash\nkubectl create secret docker-registry tetrate-tis-creds \\\n    --docker-server=\u0022addon-containers.istio.tetratelabs.com\u0022 \\\n    --docker-username=${TIS_USER} \\\n    --docker-password=${TIS_PASS} \\\n    -n default\nkubectl label namespace default istio-injection=enabled\nkubectl apply -f https:\/\/raw.githubusercontent.com\/istio\/istio\/release-1.20\/samples\/bookinfo\/platform\/kube\/bookinfo.yaml -n default\nkubectl apply -f https:\/\/raw.githubusercontent.com\/istio\/istio\/release-1.20\/samples\/bookinfo\/platform\/kube\/bookinfo-gateway.yaml -n default\n\u0060\u0060\u0060\n\nRetrieve the ingress gateway IP and generate traffic:\n\n\u0060\u0060\u0060bash\nexport GATEWAY_IP=$(kubectl -n istio-ingress get service istio-ingressgateway -o jsonpath=\u0027{.status.loadBalancer.ingress[0].ip}\u0027)\nfor i in $(seq 1 100);do curl http:\/\/$GATEWAY_IP\/productpage ; sleep 3;done\n\u0060\u0060\u0060\n\nNow, when you visit the Grafana dashboard, you will see monitoring data.\n\n![Grafana Dashboard](istio-workload-dashboard.jpg)\n\nIn addition, while importing these dashboards, we also imported the following alert rules:\n\n![Altering Rules](alerting-rules.jpg)\n\nYou can also define alert rules in Grafana, such as [integrating Telegram](https:\/\/grafana.com\/blog\/2023\/12\/28\/how-to-integrate-grafana-alerting-and-telegram\/) and Slack to send notifications.\n\n## Cleanup\n\nRun the following command to clean up the Bookinfo app and TIS:\n\n\u0060\u0060\u0060bash\nkubectl delete -f samples\/bookinfo\/platform\/kube\/bookinfo.yaml\nkubectl delete -f samples\/bookinfo\/networking\/bookinfo-gateway.yaml\nhelm uninstall istio-ingress -n istio-ingress\nhelm uninstall istio-monitoring-demo -n tis\nhelm uninstall istiod -n istio-system\nhelm uninstall istio-base -n istio-system\nkubectl delete namespace tis\nkubectl delete namespace istio-ingress\nkubectl delete namespace istio-system\n\u0060\u0060\u0060\n\n## Conclusion\n\nBy following these steps, you have successfully set up and tested monitoring in Istio using TIS. Enjoy the insights and advantages of enhanced monitoring in your Istio environment!\n\n---\n\n*This blog was initially published at [tetrate.io](https:\/\/tetrate.io\/blog\/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide\/).*\n', '\/en\/blog\/enhancing-istio-with-tis-comprehensive-installation-and-monitoring-guide\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">In this blog, I’ll guide you through installing Tetrate Istio Subscription (TIS) and activating its monitoring add-on.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/en/blog/introducing-istio-advisor-plus-gpt/">Introducing Istio Advisor Plus GPT</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               Dec 25, 2023</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/en/categories/ai"> 
             AI
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Introducing Istio Advisor Plus GPT', 'Unlock the Power of Istio Advisor GPT with ChatGPT Integration.', '\nExperience it now: [Istio Advisor Plus GPT](https:\/\/chat.openai.com\/g\/g-pv9WQ7xgm-istio-advisor-plus)\n\n**Note**: A ChatGPT Plus subscription is required.\n\n## Introduction\n\nIntroducing Istio Advisor Plus GPT, a powerful integration of ChatGPT with Istio Advisor. This fusion of AI and Istio expertise offers many capabilities to enhance your Istio experience.\n\n## What Can You Achieve with Istio Advisor Plus GPT?\n\nIstio Advisor Plus GPT empowers you with:\n\n1. **Comprehensive Istio Insights**: Gain an in-depth understanding of Istio, covering core concepts, configurations, and best practices.\n2. **Configuration Assistance**: Get tailored guidance on configuring Istio components to suit your specific use cases.\n3. **Troubleshooting Expertise**: Quickly diagnose and resolve Istio issues with expert insights and recommendations.\n4. **Performance Optimization**: Optimize your Istio service mesh for efficiency and scalability.\n5. **Security Enhancement**: Implement robust security measures using Istio\u0027s security features in your service mesh.\n6. **Visual Representation**: Visualize complex networking and service mesh processes with interactive diagrams.\n7. **Upgrading Support**: Plan and execute Istio upgrades seamlessly with expert advice.\n8. **Bug Reporting Assistance**: Compile detailed bug reports for effective issue resolution.\n9. **Documentation Guidance**: Access relevant Istio documentation sections for deeper insights.\n10. **Ecosystem Integration**: Explore the integration of Istio with key ecosystem tools.\n\n## A Knowledge Repository at Your Disposal\n\nIstio Advisor Plus GPT offers an extensive knowledge base:\n\n1. **Istio and Envoy Fundamentals**: Delve into Istio and Envoy\u0027s core principles, architecture, and components.\n3. **Service Mesh Concepts**: Understand the foundational concepts and advantages of service meshes.\n4. **Tetrate Documentation**: Learn about Tetrate\u0027s products, including Tetrate Service Bridge (TSB).\n5. **Zero-Trust Security**: Master the principles of zero-trust security in the service mesh context.\n8. **Real-World Use Cases**: Explore real-world applications and case studies showcasing Istio\u0027s impact.\n9. **The Latest Open-Source Projects\u0027 Documents**: Istio, Envoy Gateway, Kubernetes Gateway API, Cilium, Envoy, Tetragon, SkyWalking\n\n## Structured and Comprehensive Responses\n\nOur responses are structured for clarity and comprehensiveness:\n\n1. **TLDR**: A concise summary of key points.\n2. **Explanation**: Broader context or background information.\n3. **Detailed Answer**: In-depth analysis or step-by-step guidance.\n4. **Example**: Practical illustrations of concepts.\n5. **Next Steps**: Actionable advice for implementation.\n6. **References**: Access to relevant sources.\n\nUnlock the full potential of Istio Advisor GPT with ChatGPT integration and revolutionize your Istio journey.\n', '\/en\/blog\/introducing-istio-advisor-plus-gpt\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">Unlock the Power of Istio Advisor GPT with ChatGPT Integration.</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     <li class="page-item">
       <a class="page-link" href="/en/blog/">
         ««
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a href="/en/blog/page/3/" class="page-link">
         «
       </a>
     </li>
     
     
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/en/blog/page/2/" class="page-link">
             2
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/en/blog/page/3/" class="page-link">
             3
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item page-item active ">
           <a href="/en/blog/page/4/" class="page-link">
             4
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/en/blog/page/5/" class="page-link">
             5
           </a>
         </li>
       
     
       
       
       
         
         
         
           
             
           
         
       
       
       
       
         <li class="page-item">
           <a href="/en/blog/page/6/" class="page-link">
             6
           </a>
         </li>
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
       
       
       
         
         
         
           
         
       
       
       
       
     
     
     
     <li class="page-item">
       <a href="/en/blog/page/5/" class="page-link">
         »
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a class="page-link" href="/en/blog/page/9/">
         »»
       </a>
     </li>
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      Columns
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/en/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(53)</span>
        </a>
      
        <a href="/en/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(12)</span>
        </a>
      
        <a href="/en/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(7)</span>
        </a>
      
        <a href="/en/categories/cloud-native" class="sidebar-item">
            <span>Cloud Native</span>
            <span>(5)</span>
        </a>
      
        <a href="/en/categories/essays" class="sidebar-item">
            <span>Essays</span>
            <span>(5)</span>
        </a>
      
        <a href="/en/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(2)</span>
        </a>
      
        <a href="/en/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(2)</span>
        </a>
      
        <a href="/en/categories/open-source" class="sidebar-item">
            <span>Open Source</span>
            <span>(2)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      Book
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/en/categories/translation" class="sidebar-item">
            <span>Translation</span>
            <span>(6)</span>
        </a>
      
        <a href="/en/categories/original" class="sidebar-item">
            <span>Original</span>
            <span>(2)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">Contact</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">Jimmy&rsquo;s LinkedIn</li>
            
            
            <li class="mb-4"><img src="/images/jimmysong-linkedin.png" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Blog</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/blog/istio-ambient-l7-flow-analysis/">Understanding L7 Traffic Management in Istio Ambient Mode: From ztunnel to Waypoint Proxy</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/envoy-ext-proc-guide/">Advanced Request and Response Processing in Microservice Architecture with Envoy&#39;s External Processing Filter</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/http2-envoy-tunnel-demo/">Implementing HTTP/2 CONNECT Tunnels with Envoy: Concepts and Practical Guide</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">links</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" >
                  Awesome Cloud Native
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://gateway.envoyproxy.io" target="_blank" rel="noopener noreferrer">
                  Envoy Gateway
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io" target="_blank" rel="noopener noreferrer">
                  Istio
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate - Service Mesh Company
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://docs.tetrate.io/istio-subscription/" target="_blank" rel="noopener noreferrer">
                  Tetrate Istio Subscription
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">Courses</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals" target="_blank" rel="noopener noreferrer">
                  Envoy Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals" target="_blank" rel="noopener noreferrer">
                  Istio Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">new notice</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-china-2024-panel/">KubeCon China 2024 panel Preview: Istio and Modern API Gateways – Leading the Future of Service Mesh</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/website-revamp-notice/">Website Revamp Notice</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-eu-2024/">See you in KubeCon Paris!</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2025 Jimmy Song All Right Reserved</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/en/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/en/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />





<script>
    anchors.add();
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>






  





<script src="/js/wowchemy-search.min.ce03c611044441cf6e84f9e4bef20818.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
