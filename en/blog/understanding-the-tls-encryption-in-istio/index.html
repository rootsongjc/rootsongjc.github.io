<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  
  <title>How Istio’s mTLS Traffic Encryption Works as Part of a Zero Trust Security Posture · Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="This article introduces TLS and mTLS, and describes how to enable mTLS in Istio and its application scenarios.">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.123.7">

  <!-- JS plugins -->
  
    
    <link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css" media="screen">
  
    
    <link rel="stylesheet" href="/plugins/fontawesome/v6/css/fontawesome.min.css" media="screen">
  
    
    <link rel="stylesheet" href="/plugins/fontawesome/v6/css/all.min.css" media="screen">
  
    
    <link rel="stylesheet" href="/plugins/tocbot/tocbot.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.ac18144d385d482b00261f4cda0743fad2a7c0f1d3bb7dc46b1b069ebaf65366.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.ac18144d385d482b00261f4cda0743fad2a7c0f1d3bb7dc46b1b069ebaf65366.css" media="screen">
  
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="screen" loading="lazy">

  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/en/blog/understanding-the-tls-encryption-in-istio/" />
  <meta property="og:title" content="How Istio’s mTLS Traffic Encryption Works as Part of a Zero Trust Security Posture" />
  <meta property="twitter:title" content="How Istio’s mTLS Traffic Encryption Works as Part of a Zero Trust Security Posture" />
  
  <meta property="og:description" content="This article introduces TLS and mTLS, and describes how to enable mTLS in Istio and its application scenarios." />
  <meta property="twitter:description" content="This article introduces TLS and mTLS, and describes how to enable mTLS in Istio and its application scenarios." />
  
  
  <meta property="og:image" content="https://jimmysong.io/images/banner/mtls.jpg" />
  <meta property="twitter:image" content="https://jimmysong.io/images/banner/mtls.jpg" />
  
  
  
</head>
<body>
    <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>

<header class="fixed-top header">
  
  
  <div class="top-header py-2 bg-white">
    <div class="container-xl">
      <div class="row no-gutters align-items-center">
        <div class="col-12">
            <dv class="d-flex justify-content-center">
                Press ⌘/CTRL + K to search within the site.
            </dv>
        </div>
      </div>
    </div>
  </div>
  
  
  <div class="navigation w-100  top-hider ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/en">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/about">About</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/blog">Blog</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/book">Library</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/notice">Notice</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/en/contact">Contact</a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="nav-link" href="/blog/understanding-the-tls-encryption-in-istio/">中文</a>
            
            
            
            
            
            
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>Search</span>
              </span>
              <span class="search-shortcuts">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


    <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>Search</p>
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="Close"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="Input the keyword" autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Input the keyword">
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

    
	
	
    
<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/page-title.webp'),url('/images/backgrounds/page-title.webp');">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1 text-white">
                    How Istio’s mTLS Traffic Encryption Works as Part of a Zero Trust Security Posture
                </p>
                <p class="page-description text-white">
                    This article introduces TLS and mTLS, and describes how to enable mTLS in Istio and its application scenarios.
                </p>
                
                <div class="page-metadata">
                  <ul class="list-inline">
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-calendar"></i>
                        </span>Dec 24, 2022</li>
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-folder-open"></i>
                        </span><a
                        href="/en/categories/istio"> 
                        Istio</a> </li>
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-clock"></i>
                        </span>9 Minute</li>
                    <li class="list-inline-item mr-2 mb-md-0"><span><i class="fa-regular fa-file-word"></i>
                        </span>1887 words</li>
                  </ul>
                </div>
                
            </div>
        </div>
    </div>
</section>




	


  <div class="container-xl blog mb-4">
    <div class="row">
      <div class="col-xl-8 article-content">
        <div class="row">
          
          <div class="col-12 content pt-4">
            
            <details class="mobile-toc d-print-none d-show-block mb-0 pt-2">
  <summary class="font-weight-bold">Click to show the outline</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-tls-and-mtls">What Is TLS and mTLS?</a></li>
    <li><a href="#what-is-tls-termination">What Is TLS Termination?</a></li>
    <li><a href="#how-to-implement-automatic-mtls-in-istio">How to Implement Automatic mTLS in Istio</a></li>
    <li><a href="#how-to-enable-automatic-mtls-in-istio">How to Enable Automatic mTLS in Istio</a>
      <ul>
        <li><a href="#use-peerauthentication-to-set-mtls-for-workloads">Use PeerAuthentication to Set mTLS for Workloads</a></li>
        <li><a href="#use-destinationrule-to-set-up-mtls-for-workloads">Use DestinationRule to Set up mTLS for Workloads</a></li>
      </ul>
    </li>
    <li><a href="#when-should-you-use-mtls">When Should You Use mTLS?</a></li>
    <li><a href="#when-shouldnt-you-use-mtls">When Shouldn’t You Use mTLS?</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
</details>

            
            <p>The Istio service mesh offers cloud native deployments a standard way to implement automatic <a href="https://en.wikipedia.org/wiki/Mutual_authentication#mTLS" title="mutual transport layer security (mTLS)" target="_blank" rel="noopener">mutual transport layer security (mTLS)</a>
. This reduces the attack surface of network communication by using strong identities to establish encrypted channels between workloads within the mesh that are both confidential and tamper-resistant. mTLS is a key component for building zero-trust application networks. To understand mTLS traffic encryption in Istio, this article will cover the following:</p>
<ul>
<li>An overview of TLS, mTLS, and TLS termination</li>
<li>An introduction to howTLS encryption works in Istio</li>
<li>How to use Istio to implement mTLS in Kubernetes</li>
<li>A discussion of when you do and don’t need mTLS</li>
</ul>
<h2 id="what-is-tls-and-mtls">What Is TLS and mTLS?</h2>
<p>TLS, the successor to Secure Sockets Layer (SSL), is a widely adopted security protocol used to create authenticated and encrypted connections between networked computers. For this reason, people often use the terms TLS and SSL interchangeably. In this article, we will refer to them collectively as TLS. TLS 1.0 was released in 1999, and the latest version is 1.3 (released in August 2018); versions 1.0 and 1.1 are deprecated.</p>
<p>The HTTPS we see when browsing the web uses TLS, as shown in Figure 1, which is built on top of TCP as the session layer in the OSI model. To ensure compatibility, TLS usually uses port 443, but you can use any port you want.</p>
<p><figure class="mx-auto text-center">
  
  
  
  
    
    <img src="/en/blog/understanding-the-tls-encryption-in-istio/http-vs-https.svg" data-img="/en/blog/understanding-the-tls-encryption-in-istio/http-vs-https.svg" alt="image" data-caption="Figure 1: HTTP vs. HTTPS">
    
  
  <figcaption>Figure 1: HTTP vs. HTTPS</figcaption>
</figure>
</p>
<p>TLS encryption is required when a client needs to confirm the identity of the server in order to guard against man-in-the-middle attacks and ensure communication security. Figure 2 shows how TLS-encrypted communication proceeds.</p>
<p><figure class="mx-auto text-center">
  
  
  
  
    
    <img src="/en/blog/understanding-the-tls-encryption-in-istio/tls-flow.svg" data-img="/en/blog/understanding-the-tls-encryption-in-istio/tls-flow.svg" alt="image" data-caption="Figure 2: simplified TLS handshake flow">
    
  
  <figcaption>Figure 2: simplified TLS handshake flow</figcaption>
</figure>
</p>
<ol>
<li>The server applies for and obtains a certificate (X.509 certificate) from a trusted <a href="https://en.wikipedia.org/wiki/Certificate_authority" title="certificate authority" target="_blank" rel="noopener">certificate authority</a>
 (CA).</li>
<li>A request from the client to the server containing information such as the TLS version and password combination supported by the client.</li>
<li>The server responds to the client request and attaches a digital certificate.</li>
<li>The client verifies the status, validity, and digital signature of the certificate and confirms the identity of the server.</li>
<li>Encrypted communication commences between the client and the server using a shared private key.</li>
</ol>
<p>The above is only an outline description of the TLS communication flow. If you’re interested in the details, please see <a href="https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/" title="this in-depth discussion of the complete TLS handshake process." target="_blank" rel="noopener">this in-depth discussion of the complete TLS handshake process.</a>
</p>
<p>From the above process, you will find that the certificate is the critical element representing the server’s identity. The server must use a certificate issued by an authoritatively certified CA in order to provide public services over the Internet. In contrast, you can manage certificates using your own public key infrastructure (PKI) for services inside of a private environment.</p>
<p>Mutual TLS, also referred to as mTLS, is the use of a two-way encrypted channel between a server and a client that necessitates certificate exchange and identity authentication between the parties.</p>
<h2 id="what-is-tls-termination">What Is TLS Termination?</h2>
<p>TLS termination is the process of decrypting TLS-encrypted traffic before it is forwarded to a web server. Offloading TLS traffic to an ingress gateway or specialized device improves web application performance while securing encrypted traffic. TLS termination is typically implemented at cluster ingress. All communication between the ingress and servers in the cluster will be conducted directly over HTTP in plaintext, enhancing service performance.</p>
<p><figure class="mx-auto text-center">
  
  
  
  
    
    <img src="/en/blog/understanding-the-tls-encryption-in-istio/tls-termination.svg" data-img="/en/blog/understanding-the-tls-encryption-in-istio/tls-termination.svg" alt="image" data-caption="Figure 3: TLS termination">
    
  
  <figcaption>Figure 3: TLS termination</figcaption>
</figure>
</p>
<p>By default, Istio enables mTLS for mesh-based services and ends TLS at the ingress gateway. Furthermore, you can pass through traffic to back-end services for processing.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">networking.istio.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Gateway</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">sample-gateway</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">servers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">port</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">https</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">HTTPS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">PASSTHROUGH</span><span class="w">
</span></span></span></code></pre></div><p>See <a href="https://istio.io/latest/docs/ops/configuration/traffic-management/tls-configuration/#gateways" title="Gateway TLS Configuration" target="_blank" rel="noopener">Gateway TLS Configuration</a>
 for details.</p>
<h2 id="how-to-implement-automatic-mtls-in-istio">How to Implement Automatic mTLS in Istio</h2>
<p>Figure 4 depicts the security architecture of Istio. This figure clearly shows that at the entry point, JSON Web Token (JWT) + TLS authentication and encryption are used, and that mTLS is enabled between all services within the Istio mesh.</p>
<p><figure class="mx-auto text-center">
  
  
  
  
    
    <img src="/en/blog/understanding-the-tls-encryption-in-istio/istio-security.svg" data-img="/en/blog/understanding-the-tls-encryption-in-istio/istio-security.svg" alt="image" data-caption="Istio 安全架构图">
    
  
  <figcaption>Istio 安全架构图</figcaption>
</figure>
</p>
<p>Istio includes a built-in CA, and <a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/security/secret" title="Secret Discovery Service (SDS)" target="_blank" rel="noopener">Secret Discovery Service (SDS)</a>
—one of the discovery services in Envoy <a href="https://www.envoyproxy.io/docs/envoy/latest/api-docs/xds_protocol" title="xDS" target="_blank" rel="noopener">xDS</a>
—enables the issuance and rotation of SVID certificates. The mTLS flow in the Istio mesh is as follows:</p>
<ol>
<li>The sidecar of every service requests a certificate from Istiod on behalf of the workload at startup, and Istiod issues the <a href="https://spiffe.io/docs/latest/spiffe-about/spiffe-concepts/#spiffe-verifiable-identity-document-svid" title="SVID" target="_blank" rel="noopener">SVID</a>
 certificate (the process is more complex, and I will explain it in a future blog).</li>
<li>The sidecar of every workload intercepts all client requests within the pod.</li>
<li>The client sidecar starts an mTLS handshake with the server sidecar. During the handshake, the <a href="https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/security/jwt_authn_filter" title="JWT" target="_blank" rel="noopener">JWT</a>
 and <a href="https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/security/ext_authz_filter" title="authentication filter" target="_blank" rel="noopener">authentication filter</a>
 in the client sidecar will authenticate the identity of the request, and store the identity in the filter metadata after the authentication. Then the request will go through the authorization filter to determine if the request is allowed.</li>
<li>If the request is authenticated and authorized, the client and the server start to establish a connection for communication.</li>
</ol>
<p>In Istio, authentication and authorization between services can be configured using one of three resource objects:</p>
<ul>
<li><strong><a href="https://istio.io/latest/docs/reference/config/security/request_authentication/" title="RequestAuthentication" target="_blank" rel="noopener">RequestAuthentication</a>
:</strong> To specify the service’s only currently supported request-level authentication method, JWT.</li>
<li><strong><a href="https://istio.io/latest/docs/reference/config/security/peer_authentication/" title="PeerAuthentication" target="_blank" rel="noopener">PeerAuthentication</a>
:</strong> To enable mTLS or plaintext requests, set the transport authentication mode.</li>
<li><strong><a href="https://istio.io/latest/docs/reference/config/security/authorization-policy/" title="AuthorizationPolicy" target="_blank" rel="noopener">AuthorizationPolicy</a>
:</strong> To specify who can do what when traffic between services is authorized? For instance, subject A either permits (ALLOW) or forbids (DENY) traffic from subject B.</li>
</ul>
<h2 id="how-to-enable-automatic-mtls-in-istio">How to Enable Automatic mTLS in Istio</h2>
<p>In PeerAuthentication, you can specify the mTLS mode that will be used for the target workload. Peer authentication is supported in the following modes:</p>
<ul>
<li>PERMISSIVE: The workload’s default setting that allows it to accept either mTLS or plain text traffic.</li>
<li>STRICT: The workload accepts only mTLS traffic.</li>
<li>DISABLE: Disable mTLS. From a security perspective, mTLS should not be disabled unless you have your own security solution.</li>
<li>UNSET: Inherited from the parent, with the following priority: service specific &gt; namespace scope &gt; mesh scope setting.</li>
</ul>
<p>Istio’s peer authentication uses <em>PERMISSIVE</em> mode by default, automatically sending <em>mTLS</em> traffic to these workloads and clear text traffic to workloads without a sidecar. After including Kubernetes services in the Istio mesh, we can use <em>PERMISSIVE</em> mode first to prevent services from failing <em>mTLS</em>. We can use one of two ways to enable strict mTLS mode for certain services:</p>
<ul>
<li>Use PeerAuthentication to define how traffic is transferred between sidecars.</li>
<li>Use DestinationRule to define the TLS settings in the traffic routing policy.</li>
</ul>
<p>The reviews service’s mTLS configuration in the default namespace can be seen in the example below.</p>
<h3 id="use-peerauthentication-to-set-mtls-for-workloads">Use PeerAuthentication to Set mTLS for Workloads</h3>
<p>For instance, the following configuration can be used to specify that a workload under a namespace has strict mTLS enabled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.istio.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PeerAuthentication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">foo-peer-policy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">reviews</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mtls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">STRICT</span><span class="w">
</span></span></span></code></pre></div><p>According to the <a href="https://istio.io/latest/docs/tasks/security/authentication/mtls-migration/" title="Istio documentation" target="_blank" rel="noopener">Istio documentation</a>
, you can also enable strict mTLS for all services in the mesh by configuring strict mTLS for the namespace istio-system where Istio is installed.</p>
<h3 id="use-destinationrule-to-set-up-mtls-for-workloads">Use DestinationRule to Set up mTLS for Workloads</h3>
<p>Traffic routing policies, such as load balancing, anomaly detection, TLS settings, etc., are set using DestinationRule. In the TLS settings, there are various modes. As shown below, use ISTIO_MUTUAL mode to enable Istio’s workload-based automatic TLS.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">networking.istio.io/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">DestinationRule</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">reviews</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">reviews</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trafficPolicy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">ISTIO_MUTUAL</span><span class="w">
</span></span></span></code></pre></div><h2 id="when-should-you-use-mtls">When Should You Use mTLS?</h2>
<p>The short answer is that you should use mTLS for network communication between application components that you have some control over—like between microservices in a cluster.</p>
<p>One-way TLS is typically used by Internet clients to connect to Web services, which means that only the server needs to show identification and is unconcerned with the identity of the client. One-way TLS allows you to use passwords, tokens, two-factor authentication, and other methods when you need to confirm the identity of the client. However, when using a service mesh, mTLS operates outside the application and doesn’t require many changes to the application logic, whereas such an authentication method requires internal application support.</p>
<p>As you can see from the example above, mTLS implementation calls for certificate exchange between services. As the number of services rises, managing numerous certificates becomes a laborious task. You can implement automatic mTLS and fix the certificate management issue with the aid of a service mesh.</p>
<h2 id="when-shouldnt-you-use-mtls">When Shouldn’t You Use mTLS?</h2>
<p>Although mTLS is the preferred protocol for securing inter-service communication in cloud-native applications, implementing mTLS necessitates a more complex, symmetric encryption and decryption process than one-way TLS. In some cases where there is high traffic volume or CPU utilization must be optimized, terminatingTLS at the traffic entry point and turning on mTLS internally for specific services only can help minimize request response times and decrease compute resource consumption for some traffic with lower security levels.</p>
<p>Additionally, it is necessary to <a href="https://istio.io/latest/docs/ops/configuration/mesh/app-health-check/#disable-the-http-probe-rewrite-for-a-pod" title="disable probe rewriting for pods" target="_blank" rel="noopener">disable probe rewriting for pods</a>
 when using services that cannot obtain certificates, such as health checks performed via HTTP on Kubelet and the inability to access the service’s health check endpoint via TLS.</p>
<p>Finally, when mesh services access some external services, mTLS is also not necessary.</p>
<h2 id="summary">Summary</h2>
<p>mTLS is a crucial component of creating a zero-trust application network, which makes it possible to encrypt traffic within the mesh. Istio makes it simple to enable automatic mTLS for Kubernetes services, doing away with the need to manage certificates. At the same time, we can selectively enable mTLS for a subset of the mesh’s services, enabling us to move services from Kubernetes to the mesh. In a subsequent blog, we’ll go into more detail about Istio’s certificate management system. Stay tuned.</p>
<hr>
<p>If you’re new to service mesh and Kubernetes security, we have a bunch of free online courses <a href="https://tetr8.io/academy" title="available at Tetrate Academy" target="_blank" rel="noopener">available at Tetrate Academy</a>
 that will quickly get you up to speed with Istio and Envoy.</p>
<p>If you’re looking for a fast way to get to production with Istio, check out <a href="https://tetr8.io/tid" title="Tetrate Istio Distribution (TID)" target="_blank" rel="noopener">Tetrate Istio Distribution (TID)</a>
. TID is Tetrate’s hardened, fully upstream Istio distribution, with FIPS-verified builds and support available. It’s a great way to get started with Istio knowing you have a trusted distribution to begin with, have an expert team supporting you, and also have the option to get to FIPS compliance quickly if you need to.Once you have Istio up and running, you will probably need simpler ways to manage and secure your services beyond what’s available in Istio, that’s where Tetrate Service Bridge comes in. You can learn more about how Tetrate Service Bridge makes service mesh more secure, manageable, and resilient <a href="https://tetr8.io/tsb" title="here" target="_blank" rel="noopener">here</a>
, or <a href="https://tetr8.io/contact" title="contact us for a quick demo" target="_blank" rel="noopener">contact us for a quick demo</a>
.</p>
<p><em>This blog was originally published at <a href="https://tetrate.io/blog/how-istios-mtls-traffic-encryption-works-as-part-of-a-zero-trust-security-posture/" title="tetrate.io" target="_blank" rel="noopener">tetrate.io</a>
.</em></p>

            <div class="border-bottom mb-2"></div>
          </div>

          <div class="col-12 mb-2">
            <p>Last updated on May 15, 2024</p>
            


          </div>
          
          <div class="col-12">
              <li class="list-inline-item mr-4 mb-3 mb-md-0 text-light">
              
              <a href="/en/tags/tls" class="badge"> 
                  TLS</a> 
              <a href="/en/tags/network" class="badge">  
                  Network</a> 
              <a href="/en/tags/mtls" class="badge">  
                  MTLS</a> 
              <a href="/en/tags/istio" class="badge">  
                  Istio</a> 
              <a href="/en/tags/security" class="badge">  
                  Security</a> 
              <a href="/en/tags/istio" class="badge">  
                  Istio</a> 
              <a href="/en/tags/service-mesh" class="badge">  
                  Service Mesh</a> </li>
          </div>

          
          
<div class="col-12">
<ul class="pager blog-pager">

<li class="previous">
<a href="https://jimmysong.io/en/blog/ambient-mesh-l4-traffic-path/" data-toggle="tooltip" data-placement="top" title="Transparent Traffic Intercepting and Routing in the L4 Network of Istio Ambient Mesh">&larr; Previous Post</a>
</li>
 
<li class="next">
<a href="https://jimmysong.io/en/blog/distributed-tracing-with-skywalking-in-istio/" data-toggle="tooltip" data-placement="top" title="How to Use SkyWalking for Distributed Tracing in Istio?">Next Post &rarr;</a>
</li>

</ul>
</div>


          
          
          <div class="col-12">
          
            <script src="https://giscus.app/client.js"
        data-repo="rootsongjc/rootsongjc.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzMTQ1MzczNA=="
        data-category="Announcements"
        data-category-id="DIC_kwDOAd_yJs4CPNtR"
        data-mapping="pathname"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        
        data-lang="en"
        
        crossorigin="anonymous"
        async>
</script>

          
          </div>
        </div>
      </div>
      <!-- sidebar -->
      <aside class="px-2 col-xl-4 mb-4 pt-4 d-none d-xl-block">
          <div class="sidebar">
          <!-- recommend -->
          





<div>
  <p class="sidebar-title">
  Related article
  </p>
  <!-- related-blog-item -->
    <ul class="related-list">
    
      <li>
          <a href="/en/blog/ambient-mesh-l4-traffic-path/">
            Transparent Traffic Intercepting and Routing in the L4 Network of Istio Ambient Mesh
          </a>
      </li>
    
      <li>
          <a href="/en/blog/beyond-istio-oss/">
            The Current State and Future of the Istio Service Mesh
          </a>
      </li>
    
      <li>
          <a href="/en/blog/why-istio-need-spire/">
            Why Would You Need Spire for Authentication With Istio?
          </a>
      </li>
    
      <li>
          <a href="/en/blog/istio-service-mesh-book/">
            In-Depth Understanding of Istio: Announcing the Publication of a New Istio Book
          </a>
      </li>
    
      <li>
          <a href="/en/blog/what-is-new-in-istio-1-13/">
            What&#39;s New in Istio 1.13?
          </a>
      </li>
    
    </ul>
</div>


          <!-- /recommend -->
          <!-- toc -->
          
  <div class="bg-white mb-4 sticky-top aside-toc">
    <p class="sidebar-title">
      Table of content
    </p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-tls-and-mtls">What Is TLS and mTLS?</a></li>
    <li><a href="#what-is-tls-termination">What Is TLS Termination?</a></li>
    <li><a href="#how-to-implement-automatic-mtls-in-istio">How to Implement Automatic mTLS in Istio</a></li>
    <li><a href="#how-to-enable-automatic-mtls-in-istio">How to Enable Automatic mTLS in Istio</a>
      <ul>
        <li><a href="#use-peerauthentication-to-set-mtls-for-workloads">Use PeerAuthentication to Set mTLS for Workloads</a></li>
        <li><a href="#use-destinationrule-to-set-up-mtls-for-workloads">Use DestinationRule to Set up mTLS for Workloads</a></li>
      </ul>
    </li>
    <li><a href="#when-should-you-use-mtls">When Should You Use mTLS?</a></li>
    <li><a href="#when-shouldnt-you-use-mtls">When Shouldn’t You Use mTLS?</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>



          <!-- /toc -->
          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>



      
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>
    $(document).ready(function() {
        var notificationEnabled =  true ;
        var notificationKey = 'hasSeenNotification';
        var notificationExpiryKey = 'notificationExpiry';
        var notificationExpiryDuration =  24  * 60 * 60 * 1000;  

        if (notificationEnabled) {
            var hasSeenNotification = localStorage.getItem(notificationKey);
            var notificationExpiry = localStorage.getItem(notificationExpiryKey);
            var currentTime = new Date().getTime();

            if (!hasSeenNotification || currentTime > notificationExpiry) {
                var notificationMessage = 'Press ⌘\/CTRL \u002b K to search within the site.';
                var notificationTitle = 'Notification';
                var notificationType = 'info';
                var notificationPositionClass = 'toast-bottom-left';
                var notificationShowDuration =  300 ;
                var notificationHideDuration =  1000 ;
                var notificationTimeOut =  5000 ;
                var notificationExtendedTimeOut =  1000 ;

                toastr.options = {
                    "closeButton": true,
                    "progressBar": true,
                    "positionClass": notificationPositionClass,
                    "showDuration": notificationShowDuration,
                    "hideDuration": notificationHideDuration,
                    "timeOut": notificationTimeOut,
                    "extendedTimeOut": notificationExtendedTimeOut,
                    "preventDuplicates": true  
                };

                if (notificationMessage) {
                    toastr[notificationType](notificationMessage, notificationTitle);
                }

                
                localStorage.setItem(notificationKey, 'true');
                localStorage.setItem(notificationExpiryKey, currentTime + notificationExpiryDuration);
            }
        }
    });
</script>


<footer>
  
  <div class="footer bg-footer section-sm border-bottom">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h4 text-white mb-4 text-uppercase">Contact</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">Jimmy&rsquo;s LinkedIn</li>
            
            
            <li class="mb-4"><img src="/images/jimmysong-linkedin.png" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h4 text-white mb-4 text-uppercase">Blog</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/blog/kubecon-eu-2024-transparency-report/">KubeCon EU 2024 Transparency Report Interpretation</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/cloud-native-ai-whitepaper/">In-depth Analysis of CNCF&#39;s Cloud Native AI Whitepaper</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/blog/tetrate-vulnerability-scaner/">TVS: Istio and Envoy CVE Scanning Solution</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h4 text-white mb-4 text-uppercase">links</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" >
                  Awesome Cloud Native
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  Cloud Native Community(China)
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate - Service Mesh Company
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://docs.tetrate.io/istio-distro/" target="_blank" rel="noopener noreferrer">
                  Tetrate Istio Distro
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h4 text-white mb-4 text-uppercase">Courses</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals" target="_blank" rel="noopener noreferrer">
                  Envoy Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals" target="_blank" rel="noopener noreferrer">
                  Istio Fundamentals
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h4 text-white mb-4 text-uppercase">new notice</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/en/notice/kubecon-eu-2024/">See you in KubeCon Paris!</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/cloud-native-public-library/">Announcement of Cloud Native Library</a></li>
            
            <li class="mb-3"><a class="text-color" href="/en/notice/tetrate-recruit/">The Enterprise Service Mesh company Tetrate is hiring</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2024 Jimmy Song All Right Reserved</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
                <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" rel="noopener">
                    <i class="fa-brands fa-x-twitter text-white"></i>
                </a>
            </li>
            
            <li class="list-inline-item">
                <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" rel="noopener">
                    <i class="fa-brands fa-github text-white"></i>
                </a>
            </li>
            
            <li class="list-inline-item">
                <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" rel="noopener">
                    <i class="fa-brands fa-linkedin text-white"></i>
                </a>
            </li>
            
            <li class="list-inline-item">
                <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" target="_blank" rel="noopener">
                    <i class="fa-solid fa-envelope text-white"></i>
                </a>
            </li>
            
            <li class="list-inline-item">
                <a class="d-inline-block p-2" href="/blog/index.xml" target="_blank" rel="noopener">
                    <i class="fa-solid fa-rss text-white"></i>
                </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>




<!-- JS Plugins -->

<script src="/plugins/jquery/jquery.min.js"></script>

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.7c76e0a2fadff877efed8207a0281b56cb8a89ca76695081c9b5b7fe1c1f8080.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>




<script>
    anchors.add();
</script>













<script src="/js/wowchemy-search.min.ededf7cbf91565cbbd0a3d0ba23bd7b5.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content">
      <div class="search-hit-name">
        <div class="article-metadata search-hit-type">{{relpermalink}}</div>
        <a href="{{relpermalink}}">{{title}}</a>
        <p class="search-hit-description">{{snippet}}</p>
      </div>
    </div>
  </div>
</script>

</body>

</html>
