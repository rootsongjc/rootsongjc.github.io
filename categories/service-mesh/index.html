<!DOCTYPE html>
<html lang="zh"><head>
  <meta charset="utf-8">
  
  <title>服务网格专栏 - Jimmy Song</title>
  

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="欢迎来到服务网格专栏，这里是关于服务网格技术的全面资源和深入解读。涵盖了从基础概念到高级应用的各种主题，包括服务发现、负载均衡、流量管理、安全策略和可观测性。无论你是初学者还是资深开发者，都能在这里找到有价值的内容。通过我们的教程、指南和最佳实践，你将能够更好地理解和应用服务网格技术，提升你的微服务架构的可靠性、可管理性和安全性。">
  <meta name="author" content="Jimmy Song">
  <meta name="generator" content="Hugo 0.136.0">

  <!-- CSS plugins -->
  
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
    
    
      
    
  
  
  <link rel="preload" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" as="style">
  <link rel="stylesheet" href="/css/combined.7ac6b2864cb09c5595ac8ca79f8ca0db6c69a657edac885ba2c2412080d68da0.css" media="screen">
  

  <!-- Main Stylesheet -->
  
  <link rel="preload" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" as="style">
  <link rel="stylesheet" href="/scss/style.min.784204edcd29c092198e88494fa2ae755eba9ae231d6fa7faf8e7da3207b4623.css" media="screen">

  <!-- Bigger picture css -->
  
  <link rel="stylesheet" href="/plugins/bigger-picture/bigger-picture.min.css" media="print" onload="this.media='all'">
  <!--Favicon generate by https://realfavicongenerator.net-->
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">

  <link href='/opensearchdescription.xml' rel='search' title='Content search' type='application/opensearchdescription+xml'/>

  <!--Twitter card-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="jimmysong.io" />
  <meta name="twitter:creator" content="@jimmysongio" />
  <meta property="og:url" content="https://jimmysong.io/categories/service-mesh/" />
  <meta property="og:title" content="服务网格专栏 | Jimmy Song" />
  <meta property="twitter:title" content="服务网格专栏 | Jimmy Song" />

  
  <meta property="og:description" content="欢迎来到服务网格专栏，这里是关于服务网格技术的全面资源和深入解读。涵盖了从基础概念到高级应用的各种主题，包括服务发现、负载均衡、流量管理、安全策略和可观测性。无论你是初学者还是资深开发者，都能在这里找到有价值的内容。通过我们的教程、指南和最佳实践，你将能够更好地理解和应用服务网格技术，提升你的微服务架构的可靠性、可管理性和安全性。" />
  <meta property="twitter:description" content="欢迎来到服务网格专栏，这里是关于服务网格技术的全面资源和深入解读。涵盖了从基础概念到高级应用的各种主题，包括服务发现、负载均衡、流量管理、安全策略和可观测性。无论你是初学者还是资深开发者，都能在这里找到有价值的内容。通过我们的教程、指南和最佳实践，你将能够更好地理解和应用服务网格技术，提升你的微服务架构的可靠性、可管理性和安全性。" />

  
  <meta property="og:image" content="https://jimmysong.io/images/backgrounds/favicon.png" />
  <meta property="twitter:image" content="https://jimmysong.io/images/backgrounds/favicon.png" />

  
  
</head>
<body>
<header class="fixed-top header">
  
  
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></button>
  
  <div class="navigation w-100 ">
    <div class="container-xl">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="/">
            
            <b>JIMMY SONG</b>
            
        </a>
        <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
          aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navigation">
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/blog">博客</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/book">资料</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/tags">标签</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/notice">公告</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/contact">联系</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/about">关于</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="/community/">社区</a>
              
            </li>
            
            
            
            <li class="nav-item">
              
              <a class="nav-link" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener">视频 <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i></a>
              
            </li>
            
            

          
          
          <li class="nav-item">
            
            
            
              
              
                
                
                
                  
                    
                    <a class="nav-link" href="/en/categories/service-mesh/">English</a>
                    
                  
                
              
              
              
                
                  
                    
                    
                  
                
                
                
              
          </li>
          
          
          <!-- search -->
           <button type="button" class="search-btn js-search" id="searchOpen" aria-label="Search">
              <div class="search-container d-flex justify-content-center">
              <span class="search-content">
                  <i class="fa fa-search"></i>
                  <span>搜索</span>
              </span>
              <span class="search-shortcuts d-none d-sm-block">
                  <kbd class="cmd-key">⌘</kbd>
                  <kbd class="k-key">K</kbd>
              </span>
              </div>
          </button>
          
          </ul>
        </div>
      </nav>
    </div>
  </div>
</header>


            <aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between">
        <div class="col-6 search-title">
          <p>站内搜索</p> 
        </div>
        <div class="col-6 col-search-close">
          <div class="js-search" aria-label="关闭"><i class="fa-solid fa-circle-xmark text-muted" aria-hidden="true"></i></div>
        </div>
      </div>

      <div id="search-box">
        <i class="fa-solid fa-magnifying-glass" id="search-icon" aria-hidden="true"></i>
        <input name="q" id="search-query" placeholder="请输入搜索词" autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control" aria-label="请输入搜索词">
        
        <div class="mt-4">
          <span>搜索类型: </span>
          <span>
            <input type="radio" id="all" name="search_type" value="all" checked>
            <label for="all">所有</label>
            
              <input type="radio" id="blog" name="search_type" value="blog">
              <label for="blog">原创</label>
              <input type="radio" id="trans" name="search_type" value="trans">
              <label for="trans">译文</label>
            
            <input type="radio" id="book" name="search_type" value="book">
            <label for="book">资料</label>
            <input type="radio" id="notice" name="search_type" value="notice">
            <label for="notice">公告</label>
          </span>
        </div>
      </div>
      
    </section>
    <section class="section-search-results">
      <div id="search-results-count" class="search-results-count"></div>
      <div id="search-hits">
        
      </div>
    </section>
  </div>
</aside>

        
        
            

<section class="bg-cover page-title-section overlay" style="background-image: url('/images/backgrounds/circle.svg'),url('/images/backgrounds/page-title.webp');background-size: cover;">
    <div class="container-xl">
        <div class="row">
            <div class="col-12">
                <p class="h1">
                    服务网格专栏
                </p>
                <p class="page-description">
                    欢迎来到服务网格专栏，这里是关于服务网格技术的全面资源和深入解读。涵盖了从基础概念到高级应用的各种主题，包括服务发现、负载均衡、流量管理、安全策略和可观测性。无论你是初学者还是资深开发者，都能在这里找到有价值的内容。通过我们的教程、指南和最佳实践，你将能够更好地理解和应用服务网格技术，提升你的微服务架构的可靠性、可管理性和安全性。
                </p>
                
            </div>
        </div>
    </div>
</section>

        


<section class="section-sm book-list-section bg-gray">
  <div class="container-xl">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          
          
          
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/introducing-kmesh-kernel-native-service-mesh/">介绍 Kmesh：用内核原生技术革新服务网格数据平面</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/09/14</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('介绍 Kmesh：用内核原生技术革新服务网格数据平面', 'Kmesh 利用 eBPF 和内核增强，实现高性能、低延迟的服务网格数据平面。它革新了传统的 Sidecar 架构，降低了资源消耗，适用于现代云原生应用。', '\n在近期整理服务网格数据平面的几种部署模式时，我关注到了徐中虎在 KubeCon China 2024 的分享《[Istio 数据平面的新选择：全新性能体验的架构创新](https:\/\/kccncossaidevchn2024.sched.com\/event\/1eYWy\/a-new-choice-for-istio-data-plane-architectural-innovation-for-a-brand-new-performance-experience-istioxiao-zha-sao-daepxia-mo-zha-zhonghu-xu-huawei?iframe=no)》。该分享介绍了 Kmesh，它利用 eBPF 和内核增强技术，消除了 Sidecar，并提出了双引擎模式，是一种创新性的服务网格解决方案。去年我已听闻 Kmesh，借此契机我深入研究了 Kmesh，撰写此博客与大家分享。\n\n{{\u003ccallout note \u0022注意\u0022\u003e}}\n\n**注意**：本文中所展示的所有数据均引用自 [《Istio 数据平面的新选择：全新性能体验的架构创新》](https:\/\/kccncossaidevchn2024.sched.com\/event\/1eYWy\/a-new-choice-for-istio-data-plane-architectural-innovation-for-a-brand-new-performance-experience-istioxiao-zha-sao-daepxia-mo-zha-zhonghu-xu-huawei?iframe=no)，我并未对这些数据的准确性进行独立验证。请读者自行判断和核实这些数据的可靠性。\n\n{{\u003c\/callout\u003e}}\n\n\n## 背景\n\n像 Istio 这样的服务网格已成为管理复杂微服务架构的核心，提供流量管理、安全性和可观测性等功能。Sidecar 模型，即在每个服务实例旁运行一个代理，已成为主要方法。虽然功能有效，但这种架构引入了显著的延迟和资源开销。\n\n## 传统 Sidecar 架构的局限性\n\n1. **延迟开销**：增加 Sidecar 代理会导致网络跳数和上下文切换增加，每次服务调用引入额外 **2 至 3 毫秒** 的延迟。对于对延迟敏感的应用，这种延迟是不可接受的。\n\n2. **资源消耗**：每个 Sidecar 都会消耗 CPU 和内存资源。在拥有数千个服务的大规模部署中，累积的资源开销巨大，虽然可以通过一定的技术手段进行优化，但依然降低了部署密度并增加了运营成本。\n\nIstio 的性能测量显示，即使没有流量分发，仍存在约 3 毫秒的固有延迟开销。随着连接数量的增长，延迟相应增加，这突显了 Sidecar 模型在高性能应用中的低效。\n\n## 行业应对挑战的尝试\n\n已经提出了多种解决方案来缓解 Sidecar 架构的缺点：\n\n### Cilium 服务网格\n\n- **方法**：将 eBPF 与 Envoy 相结合，创建一个无 Sidecar 的服务网格。\n- **机制**：\n  - **L4 流量**：使用 eBPF 进行高效的内核级数据路由。\n  - **L7 流量**：依赖 Envoy 进行应用层解析。\n- **局限性**：\n  - **L7 额外跳数**：通过 Envoy 进行 L7 管理引入了额外的网络跳数。\n  - **故障隔离**：在确保治理故障隔离方面存在挑战。\n\n### Istio Ambient Mesh\n\n- **方法**：使用 **ztunnel** 和 **waypoint** 代理，引入无 Sidecar 的架构。\n- **机制**：\n  - **用户空间处理**：所有流量拦截和管理都在用户空间进行。\n- **局限性**：\n  - **复杂的流量拦截**：用户空间的拦截增加了复杂性。\n  - **跳数增加**：L7 连接涉及多个网络跳数，增加了延迟。\n\n这些解决方案虽然创新，但并未完全解决 Sidecar 架构固有的延迟和资源开销问题。\n\n更多详细信息可以参考我的另一篇文章：[数据平面的几种部署模式](\/blog\/service-mesh-data-plane-deployment-modes\/)。\n\n## 介绍 Kmesh：一种内核原生的方法\n\n[Kmesh](https:\/\/github.com\/kmesh-net\/kmesh) 通过将流量治理直接集成到操作系统内核，定义了一种新的服务网格数据平面。利用 eBPF（扩展伯克利数据包过滤器）和内核增强，Kmesh 提供高性能、低延迟和资源高效的服务网格能力。\n\n### 技术架构\n\n下图展示了 Kmesh 的架构。\n\n![Kmesh 架构图：（根据 [Kmesh GitHub](https:\/\/github.com\/kmesh-net\/kmesh) 绘制）](kmesh-arch.svg)\n\n**核心组件**：\n\n- **Kmesh-Daemon**：每个节点的管理组件，负责：\n  - 管理 eBPF 程序。\n  - 从控制平面（如 Istiod）订阅 xDS 配置。\n  - 处理可观测性和指标收集。\n\n- **eBPF 编排**：在内核级实现流量拦截和管理，支持：\n  - L4 负载均衡。\n  - 流量加密和解密。\n  - 监控和简单的 L7 动态路由。\n\n- **Waypoint Proxy（双引擎模式下可选）**：处理高级 L7 流量治理，可按命名空间或服务进行部署。\n\n### 关键优势\n\n该分享中指出 Kmesh 具有以下优势，尤其是性能和资源利用率上：\n\n![Kmesh vs Sidecar vs Ambient（[来源](https:\/\/kccncossaidevchn2024.sched.com\/event\/1eYWy\/a-new-choice-for-istio-data-plane-architectural-innovation-for-a-brand-new-performance-experience-istioxiao-zha-sao-daepxia-mo-zha-zhonghu-xu-huawei?iframe=no)）](performance.webp)\n\n1. **高性能**：\n   - **延迟降低**：与传统 Sidecar 架构相比，内核原生的 L7 管理将转发延迟降低了超过 **60%**。\n   - **应用启动改进**：由于消除了 Sidecar 初始化，应用启动时间提升了 **40%**。\n\n2. **低资源开销**：\n   - **资源效率**：无需 Sidecar 代理，资源消耗减少了超过 **70%**。\n\n3. **高可用性**：\n   - **无缝升级**：内核级流量管理确保升级或重启 Kmesh 组件不会中断现有的服务连接。\n\n4. **安全隔离**：\n   - **增强的安全性**：利用基于 BPF 的虚拟机安全和 cgroup 级别的治理隔离，确保安全的多租户环境。\n\n5. **灵活的治理模型**：\n   - **部署模式**：提供内核原生模式以实现最大性能，和双引擎模式以获得部署灵活性。\n\n6. **无缝兼容性**：\n   - **控制平面集成**：完全兼容 xDS 协议，允许与 Istio 控制平面集成，支持 Istio API 和 Gateway API。\n\n## Kmesh vs Ambient vs Cilium mesh\n\n通过上文中对 Kmesh 的介绍，你会发现它与 Istio Ambient 模式及 Cilium mesh 有很多相似性，下表将从多个维度对比它们之间的区别。\n\n| 比较维度               | Kmesh                                                        | Istio Ambient 模式                                           | Cilium Mesh                                                  |\n| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| **流量拦截与处理方式** | \u0026bull; **内核级处理：** 利用 eBPF 和内核增强，将流量治理直接集成到操作系统内核中。\u003cbr\u003e\u0026bull;**模式选择：**\u003cbr\u003e\u0026nbsp;\u0026nbsp;\u0026bull; **内核原生模式：** L4 和 L7 流量全部在内核中处理，无需用户空间代理。\u003cbr\u003e\u0026nbsp;\u0026nbsp;\u0026bull; **双引擎模式：** L4 在内核中处理，L7 由 Waypoint Proxy 处理。 | \u0026bull; **用户空间处理：** 引入 **ztunnel** 和 **Waypoint Proxy**，在用户空间进行流量拦截和管理。\u003cbr\u003e\u0026bull; **无 Sidecar 架构：** 消除了 Sidecar，但增加了新的用户空间组件。 | \u0026bull; **混合处理：** 结合 eBPF 和 Envoy。\u003cbr\u003e\u0026bull; **L4 流量：** 在内核中使用 eBPF 处理。\u003cbr\u003e\u0026bull; **L7 流量：** 由用户空间的 Envoy 代理处理。 |\n| **性能与延迟**         | \u0026bull; **高性能：** 内核级处理，减少上下文切换和数据拷贝。\u003cbr\u003e\u0026bull; **延迟降低：** 转发延迟降低超过 **60%**。\u003cbr\u003e\u0026bull; **低延迟启动：** 应用启动时间提高 **40%**。 | \u0026bull; **性能改进但仍有延迟：** 比传统 Sidecar 架构有所提升，但用户空间处理和增加的网络跳数仍带来延迟。 | \u0026bull; **L4 性能优异：** L4 流量内核处理，高效。\u003cbr\u003e\u0026bull; **L7 存在开销：** L7 流量通过 Envoy，增加网络跳数和潜在延迟。 |\n| **架构复杂度**         | \u0026bull; **内核依赖：** 需要特定内核版本或增强，部署复杂度增加。\u003cbr\u003e\u0026bull; **组件简洁：** 内核处理，减少对用户空间组件的依赖。 | \u0026bull; **新增组件：** 引入 ztunnel 和 Waypoint Proxy，架构更复杂。\u003cbr\u003e\u0026bull; **Istio 生态：** 继承 Istio 的复杂性。 | \u0026bull; **双重组件：** 需要管理 eBPF 和 Envoy。\u003cbr\u003e\u0026bull; **L7 复杂性：** 处理 L7 流量时架构更复杂。\u003cbr\u003e\u0026bull; **CNI 集成：** 简化部分网络配置。 |\n| **安全性与隔离**       | \u0026bull; **内核级安全：** 利用 BPF 虚拟机和 cgroup 隔离，提供高安全保障。\u003cbr\u003e\u0026bull; **mTLS 内核支持：** 内核实现双向 TLS，加密性能高。 | \u0026bull; **用户空间安全：** 通过用户空间组件实现安全功能，可能增加攻击面。\u003cbr\u003e\u0026bull; **丰富策略支持：** 继承 Istio 的安全策略和配置能力。 | \u0026bull; **eBPF 安全特性：** 利用 eBPF 的安全模型。\u003cbr\u003e\u0026bull; **隔离挑战：** 治理故障隔离需额外考虑。 |\n| **兼容性与集成**       | \u0026bull; **Istio 控制平面：** 集成 Istio 控制平面，支持 xDS 协议，兼容 Istio API 和 Gateway API。\u003cbr\u003e\u0026bull; **Kubernetes 原生：** 无缝运行在 Kubernetes 上。 | \u0026bull; **完全兼容：** 作为 Istio 的一部分，完全兼容 Istio API 和生态系统。 | \u0026bull; **CNI 角色：** 作为 Kubernetes 的 CNI 插件，提供网络和服务网格功能。\u003cbr\u003e\u0026bull; **网络策略：** 提供强大的网络策略和安全功能。 |\n| **部署与运维考虑**     | \u0026bull; **内核要求：** 需修改内核或使用特定版本，注意兼容性。\u003cbr\u003e\u0026bull; **性能优先：** 适合追求极致性能的场景。 | \u0026bull; **易于迁移：** 为 Istio 用户提供无 Sidecar 替代方案，便于过渡。\u003cbr\u003e\u0026bull; **复杂性管理：** 需管理新增用户空间组件。 | \u0026bull; **现有 Cilium 用户：** 已使用 Cilium 时，集成服务网格功能简单。\u003cbr\u003e\u0026bull; **学习曲线：** 需熟悉 eBPF 与 Envoy 的结合。 |\n\n**总结：**\n\n- **Kmesh**：通过将流量治理下沉到内核，实现高性能和低延迟，适用于对性能和资源效率要求极高的应用。但需要特定的内核支持，部署时需考虑兼容性。\n\n- **Istio Ambient Mesh**：消除了 Sidecar，改进了性能，保留了 Istio 的丰富功能，但用户空间处理可能带来新的复杂性和延迟。\n\n- **Cilium Mesh**：利用 eBPF 提高 L4 性能，但 L7 流量处理依赖 Envoy，可能增加复杂性和延迟。适合已经使用 Cilium 的环境，提供强大的网络策略和安全功能。\n\n## Kmesh 的两种运行模式\n\nKmesh 提供两种运行模式，以满足不同的部署需求：\n\n### 内核原生模式\n\n**概述**：\n\n- **极致性能**：在 L4 和 L7 流量中实现最低的延迟，无额外的网络跳数。\n- **机制**：\n  - **内核增强**：使用 eBPF 和内核模块（ko）增强内核。\n  - **伪造的 TCP 连接**：在内核中利用“伪建链”来管理复杂的应用层流量。\n  - **流量管理**：在客户端发起通信时直接管理流量，消除不必要的上下文切换和数据拷贝。\n\n{{\u003ccallout tip \u0022伪建链\u0022\u003e}}\n\nKmesh 采用了一种称为“伪建链”的技术，当收到 downstream 的 TCP 请求时，eBPF 程序首先与 downstream 创建一个“伪 TCP 连接”，而不会立即与 upstream 服务建立实际连接。eBPF 程序在获取到 downstream 发出的 HTTP 消息后，根据消息进行 L7 路由处理，找到目标服务后再与 upstream 建立连接。通过这种方式，Kmesh 将 L7 层的处理下沉到内核中，提高了处理效率。\n\n{{\u003c\/callout\u003e}}\n\n**优势**：\n\n- **延迟降低**：转发延迟减少超过 60%。\n- **无需用户空间代理**：整个流量管理在内核内完成。\n\n**考虑因素**：\n\n- **内核版本要求**：可能需要特定的内核版本或增强，这可能影响部署的灵活性。\n\n### 双引擎模式\n\n**概述**：\n\n- **灵活治理**：在性能和更广泛的兼容性之间取得平衡。\n- **机制**：\n  - **内核级拦截**：使用 eBPF 在内核空间拦截流量。\n  - **Waypoint Proxy**：部署远程的 Waypoint Proxy 来处理复杂的 L7 流量管理。\n  - **层次分离**：将 L4 和 L7 的治理在内核空间（eBPF）和用户空间（Waypoint）之间分离。\n\n**优势**：\n\n- **延迟降低**：相比 Istio 的 Ambient Mesh，延迟减少了 **30%**。\n- **简化的流量拦截**：内核空间的拦截比用户空间更安全、更简单。\n- **降低采用门槛**：减少对特定内核版本的依赖，便于用户采用。\n\n**与 Ambient Mesh 的比较**：\n\n- **更少的网络跳数**：Kmesh 对于 L7 连接仅增加一个额外跳数，而 Ambient Mesh 可能增加多达三个。\n- **更简单的架构**：内核级拦截避免了用户空间拦截机制的复杂性。\n\n## 深入了解 Kmesh 的技术\n\n### eBPF 和内核增强\n\n**eBPF（扩展伯克利数据包过滤器）** 是一种强大的技术，允许安全高效地将自定义代码注入到 Linux 内核。Kmesh 利用 eBPF 来：\n\n- **拦截网络流量**：将 eBPF 程序附加到网络事件，实现对数据包的实时拦截和操作。\n- **实现负载均衡**：根据策略将流量导向合适的服务实例。\n- **执行流量加密**：在内核中处理 mTLS 加解密（开发中，计划 2024 年底支持），降低开销。\n- **收集可观测性数据**：在不影响应用性能的情况下收集指标和遥测数据。\n\n### 流量拦截和管理\n\n在内核原生模式中：\n\n- **伪造的连接**：Kmesh 在内核中创建伪造的 TCP 连接，避免涉及用户空间代理来管理流量。\n- **直接的数据包操作**：在内核级拦截和重定向数据包，消除在用户空间和内核空间之间移动数据包时的上下文切换和数据拷贝。\n\n在双引擎模式中：\n\n- **eBPF 拦截**：eBPF 程序处理初始的流量拦截和基本的 L4 管理。\n- **Waypoint Proxy**：对于路由、重试和头部操作等高级 L7 功能，流量被转发到按服务或命名空间部署的 Waypoint Proxy。\n\n### 安全和隔离\n\n- **BPF 虚拟机安全**：eBPF 在内核中的受限虚拟机中运行，确保注入的代码不会破坏内核稳定性。\n- **cgroup 级别隔离**：在 cgroup 级别应用治理策略，为不同的服务和工作负载提供隔离。\n- **mTLS 支持**：计划在内核中实现双向 TLS，提供零信任安全，而无需用户空间的加密开销。\n\n## 性能分析\n\n**测试设置**：\n\n- **基准工具**：使用 [Fortio](https:\/\/github.com\/fortio\/fortio) 生成负载并测量延迟。\n- **比较对象**：在四种配置下测量性能：\n  1. **基线**：没有任何服务网格的直接通信。\n  2. **Istio Sidecar**：传统的 Sidecar 部署。\n  3. **Istio Ambient Mesh**：使用 ztunnel 和 Waypoint 的无 Sidecar 部署。\n  4. **Kmesh**：包括内核原生模式和双引擎模式。\n\n**结果**：\n\n- **延迟**：\n  - **Kmesh 内核原生模式**：相比 Istio Sidecar，转发延迟降低了超过 **60%**。\n  - **Kmesh 双引擎模式**：相比 Istio Ambient Mesh，延迟减少了 **30%**。\n- **资源消耗**：\n  - **CPU 和内存**：Kmesh 将资源开销降低了超过 **70%**，因为无需 Sidecar 代理。\n- **应用启动时间**：\n  - 提高了 **40%**，因为应用不再需要等待 Sidecar 初始化。\n\n**解读**：\n\n- Kmesh 接近基线性能，使服务网格的开销可以忽略不计。\n- 消除上下文切换和数据拷贝对性能提升贡献显著。\n- 内核原生方法确保即使服务数量增加，性能也能保持一致。\n\n## 云原生集成与兼容性\n\n- **Kubernetes 原生**：Kmesh 无缝运行在 Kubernetes 上，管理 Pod 的进出流量，无需更改应用代码。\n- **控制平面集成**：\n  - **xDS 协议支持**：从 Istiod 订阅 xDS 配置，确保与 Istio 控制平面兼容。\n  - **Istio API 兼容性**：支持现有的 Istio API，允许用户使用熟悉的配置和策略。\n- **Gateway API 支持**：兼容 Gateway API，支持更灵活和丰富的流量管理。\n- **可观测性**：\n  - 集成 Prometheus 进行指标收集。\n  - 利用 eBPF 高效地收集数据，不影响性能。\n- **安全策略**：\n  - 支持现有的 Istio 安全策略，包括认证和授权。\n\n## 结论\n\nKmesh 通过将流量管理移入内核，代表了服务网格技术的范式转变。利用 eBPF 和内核增强，它解决了传统 Sidecar 架构中延迟和资源开销的关键问题。Kmesh 为现代云原生应用提供了灵活、高性能的解决方案，特别适用于需要低延迟和高吞吐量的场景。\n\n**主要收获**：\n\n- **性能**：通过消除不必要的开销，实现接近基线的性能。\n- **资源效率**：降低 CPU 和内存消耗，提升部署密度。\n- **灵活性**：提供多种运行模式，适应不同的部署场景。\n- **安全性**：通过内核级的执行和隔离机制增强安全性。\n- **兼容性**：与包括 Kubernetes 和 Istio 在内的现有云原生生态系统无缝集成。\n\n## 参考\n\n- [IstioCon 2023 要点总结](https:\/\/www.zhaohuabing.com\/post\/2023-09-26-istiocon-china\/)\n- [Istio 数据平面的新选择：全新性能体验的架构创新](https:\/\/kccncossaidevchn2024.sched.com\/event\/1eYWy\/a-new-choice-for-istio-data-plane-architectural-innovation-for-a-brand-new-performance-experience-istioxiao-zha-sao-daepxia-mo-zha-zhonghu-xu-huawei?iframe=no)', '\/blog\/introducing-kmesh-kernel-native-service-mesh\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">Kmesh 利用 eBPF 和内核增强，实现高性能、低延迟的服务网格数据平面。它革新了传统的 Sidecar 架构，降低了资源消耗，适用于现代云原生应用。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/service-mesh-data-plane-deployment-modes/">深入解析服务网格的四种数据平面部署模式：性能、安全性与成本分析</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/09/10</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('深入解析服务网格的四种数据平面部署模式：性能、安全性与成本分析', '本文解析四种服务网格数据平面部署模式：Sidecar、Ambient、Cilium mesh 和 gRPC。分析架构、性能、安全、管理复杂性和资源成本，提供选择建议，助你在不同场景做最优决策，无论追求高性能、低资源消耗还是高安全保障，都能找到合适模式。', '\n本文将向你介绍 Istio 服务网格的四种平面部署模式，通过分析它们的优缺点，根据他们的性能、可靠性和安全性给出选择建议。\n\n## 什么是服务网格？\n\n服务网格是一种基础设施层，通常使用应用代理来实现各种功能。以 Istio 为例，它通过应用代理让用户能够将应用感知的流量管理、强大的可观测性和稳健的安全能力编程到网络中。Istio 确保云原生和分布式系统具有弹性，使现代企业能够在不同平台上维护其工作负载，同时保持连接和受保护。它的功能包括零信任安全、策略管理和访问控制等安全和治理控制，以及金丝雀部署、A\/B 测试、负载均衡和故障恢复等网络功能，还能提供对整个网络流量的可观测性。Istio 不受单一集群、网络或运行时的限制，可以将在 Kubernetes 或虚拟机上运行的服务、多云、混合或本地的服务包含在单个网格中。其设计可扩展，并得到广泛生态系统的支持。\n\n服务网格的架构分为控制平面和数据平面，以 Istio 为例，\u0060istiod\u0060 是它的控制平面，而数据平面有两种部署模式，用户可以选择 sidecar 或 ambient 模式。\n\n![Istio 服务网格的架构图（来源 [istio.io](https:\/\/istio.io\/latest\/about\/service-mesh\/)）](service-mesh.svg)\n\n实际上服务网格的数据平面的部署模式不止这两种，加上 Istio 支持的 [gRPC 无 sidecar 的服务网格](https:\/\/istio.io\/latest\/blog\/2021\/proxyless-grpc\/)，以及 [Cilium service mesh](https:\/\/cilium.io\/use-cases\/service-mesh\/)，一共有四种部署模式。\n\n## 数据平面部署模式\n\n下表格从多个维度对服务网格数据平面的部署模式进行了比较。\n\n{{\u003ctable \u0022服务网格的四种部署模式对比\u0022\u003e}}\n\n| **数据平面模式**                          | **平台安全性** 威胁评估、风险                                | **资源效率** – 基础设施\/资源消耗等             | **可管理性** – 升级、漏洞等                                | **性能** – 延迟等                                          |\n| ----------------------------------------- | ------------------------------------------------------------ | ---------------------------------------------- | ---------------------------------------------------------- | ---------------------------------------------------------- |\n| **Sidecar模式**：每个服务实例的L4和L7代理 | 高安全性，因为每个服务实例都有独立的代理，减少了攻击面。风险管理取决于控制平面配置。 | 较高的资源消耗，因为每个实例需要独立的代理。   | 需要集中管理和配置，升级相对复杂，但可以通过控制平面简化。 | 请求需要通过代理转发，可能增加延迟。                       |\n| **Ambient模式**：共享L4 – L7每个服务模型  | 通过ztunnel进行本地路由设计的安全性。然而，共享代理可能会带来风险，其整体安全成熟度仍在发展中。 | 效率较高，因为多个服务共享相同的代理。         | 管理相对简单，但可能因共享代理而面临漏洞。                 | 本地路由性能良好，但在waypoint代理下可能会产生跨AZ的成本。 |\n| **Cilium Mesh模式**：共享L4和L7模型       | 中等安全性，专注于eBPF和细粒度访问控制。然而，身份和信任模型方面存在已知问题。 | 内核级处理提高效率，减少基础设施开销。         | 管理更复杂，需要处理多个服务的配置。                       | 性能可变；某些场景可能会引入显著的延迟。                   |\n| **gRPC模式**：L4和L7集成在应用模型中      | 虽然gRPC将代理功能集成在应用程序中，理论上减少了攻击面，但应用程序的复杂性和多样性实际上可能扩大它。gRPC模式的安全性依赖于具体的用例，需要对潜在威胁和攻击面进行仔细评估。 | 更高的效率，因为代理在与应用相同的进程中实现。 | 管理复杂，需要定期更新和维护应用层代理。                   | 性能优越，延迟低，适合实时应用。                           |\n\n{{\u003c\/table\u003e}}\n\n你可以从下图中更直观地看到这四种模式在成本和安全性方面的比较：\n\n![服务网格部署模式对比](istio-data-plane-deployment-modes.svg)\n\n下图说明了服务网格数据平面的不同部署模式中代理的潜在位置。\n\n![服务网格数据平面的不同部署模式中的代理位置](overview.svg)\n\n- **Sidecar 模式**：代理与应用程序容器位于同一个 Pod 中\n- **Ambient 模式**：L4 代理与应用程序容器位于同一个节点上，L7 代理不一定跟应用程序容器在同一个节点上\n- **Cilium 模式**：L4 和 L7 代理作为一个整体与应用程序容器在同一个节点上\n- **gRPC 模式**：gRPC 框架集成到应用程序中，共同部署在一个容器中\n\n## Sidecar 模式：每个服务实例一个 L4 和 L7 的代理\n\n下面展示的是 sidecar 模式中 Application 1 访问同节点上的 Application 2 及跨节点上的 Application 3 的通信路径。\n\n![Sidecar 模式：每个服务实例一个 L4 和 L7 代理](sidecar-mode.svg)\n\n这是最常见的服务网格部署模式，也是 [Istio](https:\/\/istio.io) 服务网格起初支持的模式。每个服务实例旁边部署一个代理（如 [Envoy](https:\/\/envoyproxy.io)），该代理处理进出该服务的所有网络通信，包括 L4 和 L7 网络通信。\n\n- **优点**：安全性高，因为每个服务实例都是隔离的，减少了潜在的攻击面。\n- **缺点**：资源消耗较高，因为每个服务实例都需要单独的代理，增加了基础设施成本。\n- **成熟度**：Istio Sidecar 模式的成熟度已经达到生产级别，它们经过广泛测试并准备好在实际环境中使用。\n\n## Ambient 模式：节点共享 L4 代理，服务账户共享 L7 代理\n\n下面展示的是 ambient 模式中 Application 1 访问同节点上的 Application 2 及跨节点上的 Application 3 的通信路径。\n\n![Ambient 模式：节点共享 L4 代理，服务账户共享 L7 代理](ambient-mode.svg)\n\n在这种模式下，每个节点上的共享L4代理为同一物理主机上的所有服务实例提供服务，而每个服务账户都有一个专用的L7代理。\n\n- **优点**：成本较低，因为多个服务共享同一个代理。\n- **缺点**：尽管ztunnel（Istio网格中）组件是为安全性设计的，共享代理可能会带来风险。此模型的安全成熟度仍在发展中。\n- **成熟度**：Istio的Ambient模式目前处于beta阶段，没有大规模的生产级最佳实践，也不支持多集群。\n\n## Cilium mesh 模式：共享的 L4 和 L7 代理\n\n下面展示的是 Cilium mesh 模式中 Application 1 访问同节点上的 Application 2 及跨节点上的 Application 3 的通信路径。\n\n![Cilium mesh 模式：共享的 L4 和 L7 代理](cilium-mesh-mode.svg)\n\n这种模式介于完全独立和完全共享之间，每个节点都有一个共享的L7代理。然而，身份和信任模型方面存在已知问题。使用eBPF的Cilium服务网格允许通过内核程序实现无需代理的网络策略。\n\n- **优点**：在特定场景下，内核级效率可以降低基础设施成本。\n- **缺点**：管理更复杂，某些场景可能会导致延迟增加。\n- **成熟度**：Cilium Mesh通过eBPF直接管理L4流量，并在每个节点上配置Envoy代理以通过CRD（如CiliumEnvoyConfig）控制L7流量。然而，由于身份模型不一致，其安全性令人担忧。该[代理](https:\/\/github.com\/cilium\/proxy)是经过定制过的，它具有最少的 Envoy 扩展和 Cilium 策略执行过滤器。因此，该 Cilium mesh 可能无法支持 Envoy 代理的全部功能。\n\n**注意**：该模式并非 Istio 的数据平面。\n\n## gRPC 模式：L4 和 L7 代理集成到应用程序内\n\n在gRPC模式中，没有部署外部代理；而是通过RPC框架将代理功能直接集成到应用程序中，导致对应用程序的显著侵入。服务网格控制平面使用一组称为xDS API的发现API来动态配置应用程序。应用程序中的gRPC客户端库提供对xDS API的广泛支持。利用这种能力，服务网格控制平面可以在服务容器内的这个库中直接编程L4和L7代理功能。\n\n下图展示了在 Istio 的 gRPC 模式中，控制平面如何与应用程序通信。\n\n![gRPC 模式：L4 和 L7 代理集成到应用程序内](grpc-mode.svg)\n\n在这种模式下，当gRPC服务与控制平面通信时，不需要传统的Sidecar代理，而是使用特定的代理进行初始化和与控制平面的通信。此设计减少了资源消耗和部署复杂性，同时仍能实现服务发现、流量管理等功能。\n\n- **优点**：高性能，由于代理与应用程序紧密集成，减少了网络跳跃和额外的开销。\n- **缺点**：高复杂性，需要在应用程序内部实现复杂的网络处理功能，这可能增加开发成本。\n- **安全性考虑**：这种模式的安全性存在争议。虽然将代理功能集成在应用程序中理论上减少了外部攻击面，但应用程序的多样性和复杂性可能会扩大整体攻击面。因此，在考虑gRPC模式的安全性时，必须仔细分析其具体用例中的安全威胁模型和攻击风险。\n- **成熟度**：Istio的gRPC模式仍处于实验阶段。\n\n## 如何选择？\n\n如前所述，选择服务网格数据平面部署模式的决定因素有多个：\n\n- 成熟度\n- 企业的安全需求\n- 资源限制\n- 性能要求\n- 网络开销\n- 管理复杂性的容忍度\n\n### 成熟度\n\n在考虑服务网格数据平面部署模式时，成熟度是一个关键因素。每种模式的成熟度都会影响其在生产环境中的可靠性和支持程度：\n\n- **Sidecar模式**：这是最成熟的服务网格部署模式，广泛应用于生产环境，并得到良好支持。\n- **Ambient模式**：尽管该模式提供了一些成本和性能优势，但它仍处于早期阶段，可能缺乏成熟的最佳实践和广泛的生态系统支持。\n- **Cilium Mesh模式**：作为一个相对较新的选择，它在使用eBPF的场景中提供了独特的技术优势。然而，其安全模型和身份管理的担忧表明，它可能不像其他模式那样成熟或可靠。\n- **gRPC模式**：尽管性能出色，但这种模式的复杂性和侵入性意味着它可能需要更多的定制开发，目前仍处于实验阶段。\n\n### 安全需求\n\n如果您的业务有较高的安全需求，如金融或医疗行业，那么**Sidecar模式**可能是最佳选择。这种模式通过确保每个服务实例都有自己独立的代理，从而最大限度地实现服务隔离。对于那些探索较新模式（如**Ambient模式**）的用户来说，必须了解虽然ztunnel旨在实现安全的本地路由，但该模式的整体安全策略仍在发展中。\n\n### 资源限制\n\n在资源受限的环境中，为每个服务实例部署一个单独的代理可能不切实际。在这种情况下，可以考虑**gRPC模式**或**Ambient模式**。**gRPC模式**特别适合已经广泛使用gRPC且愿意在应用程序内部处理复杂网络功能的组织。另一方面，**Ambient模式**通过共享代理来减少资源消耗。\n\n### 性能要求\n\n对于需要高性能和低延迟的应用程序，**gRPC模式**提供了最佳性能，因为它消除了传统代理引入的额外网络跳跃。然而，值得注意的是，gRPC模式仍处于实验阶段，可能不支持Istio的所有功能。请根据您的服务网格功能需求进行考虑。\n\n### 网络开销\n\n每种数据平面模式对网络开销都有不同的影响。**Sidecar模式**通过本地化路由减少了跨区域流量，但增加了网络跳跃，增加了延迟和计算使用。**Ambient模式**使用ztunnel进行本地路由，但在waypoint代理下可能会产生跨AZ的成本。**Cilium模式**将代理放置在与应用程序相同的节点上，可能减少节点间的流量，但可能引入更多的延迟。**gRPC模式**将RPC框架集成到应用程序中，最小化网络跳跃和开销，适用于高性能、低延迟的需求。\n\n### 对管理复杂性的容忍度\n\n选择服务网格数据平面模式时，管理复杂性也是一个重要的考虑因素。**Sidecar模式**和**gRPC模式**可能需要更复杂的配置和维护，而在某些部署环境中，**Ambient模式**可能提供更简化的管理体验。**Cilium模式**由于依赖于eBPF和多个配置点，可能需要更复杂的管理。\n\n## 结论\n\n选择正确的服务网格数据平面部署模式取决于多个特定因素，包括成熟度、安全性、资源限制、性能和管理复杂性。以下是一个快速指南：\n\n- **Sidecar模式**：最适合高安全需求，提供最大的隔离性。\n- **gRPC模式**：适用于高性能需求且已在使用gRPC的环境。\n- **Ambient模式**：适合成本效益和较低隔离需求，但安全模型正在演变中。\n- **Cilium Mesh模式**：可能适用于利用eBPF技术的基础设施，但需考虑安全性和管理复杂性。\n\n最佳选择将与您的应用程序需求、安全策略和技术熟悉度相一致。理解每种模式的优势和局限性，以做出平衡收益、风险和成本的明智决策。\n\n## 参考文献\n\n- [云原生应用的服务网格代理模型](https:\/\/csrc.nist.gov\/pubs\/sp\/800\/233\/ipd)\n', '\/blog\/service-mesh-data-plane-deployment-modes\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文解析四种服务网格数据平面部署模式：Sidecar、Ambient、Cilium mesh 和 gRPC。分析架构、性能、安全、管理复杂性和资源成本，提供选择建议，助你在不同场景做最优决策，无论追求高性能、低资源消耗还是高安全保障，都能找到合适模式。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/service-mesh-sidecar-vs-sidecarless-debate/">服务网格架构：Sidecar vs. Sidecarless，谁才是未来？</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/09/09</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('服务网格架构：Sidecar vs. Sidecarless，谁才是未来？', '探讨服务网格架构中 sidecar 与 sidecarless 的争论，比较 Cilium、Istio 和 Linkerd 在安全性、性能和架构复杂性方面的不同观点，帮助读者理解这些技术专家的看法和背后的争议。', '\n服务网格已经成为现代云原生应用架构中至关重要的一部分，帮助团队在大规模分布式系统中管理微服务通信、提高安全性并优化性能。然而，随着技术的不断演进，关于服务网格架构的最佳实践出现了激烈的争论，尤其是关于 sidecar 与 sidecarless 模式的选择问题。这场争论的核心在于如何在性能、资源利用、安全性和操作复杂性之间取得最佳平衡。近年来，Cilium 引入了无 sidecar 架构的 eBPF 技术，而 Istio 也推出了 Ambient 模式，结合了传统 sidecar 与无 sidecar 的优点。与此同时，Linkerd 则坚守 sidecar 架构，并对新兴的无 sidecar 方法持保守态度。这篇文章将深入探讨这些服务网格架构的主要观点和争议，并分析每种方法的优势与挑战。\n\n## 关于服务网格有无 sidecar 的争论\n\n关于服务网格的 sidecar 与无 sidecar 的争论是随着 Cilium 的推出和各大服务网格技术的演变而逐渐加剧的，尤其是在 2021 年之后：\n\n1. **Cilium Service Mesh 的推出（2021 年 12 月）**  ：Cilium 通过 eBPF 技术引入了无 sidecar 的服务网格架构，开始引发对传统 sidecar 模式的讨论。这一概念的提出标志着无 sidecar 架构的兴起。\n   \n2. **Linkerd 与 Istio 的反应（2021 年 12 月至 2022 年初）** ：Linkerd 的创始人 William Morgan 及其团队对 Cilium 的无 sidecar 方法表示担忧，认为这种方法可能会带来安全和性能上的问题。这一讨论逐渐演变为对 sidecar 与无 sidecar 架构的更广泛争辩。\n   \n3. **Istio 的 Ambient 概念（2022 年 5 月）** ：Istio 提出了 Ambient Mesh，尝试结合 sidecar 和主机级代理的优势，这进一步加剧了各方对服务网格架构的讨论。此时，业界对不同服务网格架构的看法开始分化。\n   \n4. **专家观点的发表（2021 年 12 月至 2023 年）**  ：多位行业专家如 Thomas Graf 和 William Morgan 等在不同场合发表了对 sidecar 与无 sidecar 架构的看法，形成了更为系统的争论。这些观点在多个会议和文章中被广泛讨论，推动了对服务网格架构的深入理解。\n\n## 各方观点\n\n下表摘录了各服务网格提供商及用户的公开观点。\n\n{{\u003ctable \u0022关于服务网格技术选型的公开观点\u0022\u003e}}\n\n| **人物**            | **职位\/公司**                             | **观点**                                                     |\n| ------------------- | ----------------------------------------- | ------------------------------------------------------------ |\n| **Andrey Rybka**    | Bloomberg                                 | 倾向于选择成熟度更高的 Istio，特别是在有 Google 等大公司支持的情况下。 |\n| **Ara Pulido**      | Datadog 开发者关系专家                     | 认为 eBPF 工具（如 Cilium）是 Kubernetes 网络扩展问题的解决方案，使用 Cilium 可以完全替代 kube-proxy，实现更细粒度的容器安全特性；移除 kube-proxy 后，操作简化，性能提升。 |\n| **Dale Ragan**      | SAP Concur Technologies 首席软件设计工程师 | 认为 eBPF 在安全方面提供了更好的优势，可同时应用于整个集群和各个服务；正在使用 Cilium 替代 Flannel 作为其生产环境中的容器网络接口（CNI）插件，并测试 Isovalent 的专有 SecOps 插件。 |\n| **Dan Wendlandt**   | Isovalent CEO                             | 认为 eBPF 和服务网格是互补的技术，eBPF 可作为服务网格的基础，为服务网格代理（如 Envoy）提供高效的数据进出服务。 |\n| **David Ortiz**     | Constant Contact 首席软件工程师            | 对 Istio 的 Ambient Mesh 非常感兴趣，认为其显著简化了 Istio 的操作流程，尤其是在升级方面，计划尽快采用这一技术。 |\n| **Filip Nikolic**   | PostFinance                               | 认为 eBPF 基础的无 sidecar 服务网格具有更高的网络性能和效率，并且安全实践也在不断进化。 |\n| **Greg Otto**       | Comcast 云服务执行董事                     | 对 Istio Ambient Mesh 感兴趣，计划在其成熟后进行评估；希望能够分别扩展和服务第 7 层（L7）和第 4 层（L4）功能，认为减少不必要的 L7 过滤可以减少安全暴露面和漏洞风险。 |\n| **John Mitchell**   | 独立数字化转型顾问                        | 认为 eBPF 正经历一个炒作周期，但它确实有潜力为 Kubernetes 提供高级网络安全特性，而无需改变应用程序代码。 |\n| **Kasper Nissen**   | Lunar 的首席平台架构师                     | 支持 sidecar 架构，认为它简单易用，并与其他容器技术相同；在全面部署服务网格后，资源消耗增加不多但功能增多；指出 sidecar 同步问题源于 Kubernetes 网络层的问题，建议在 Kubernetes 层面进行修复。 |\n| **Louis Ryan**      | Solo.io CTO                               | 强调 Istio 1.23 版引入的 Ambient Mesh 的优势，包括减少 sidecar 的使用，简化架构，提高性能，降低复杂性，并增强了灵活性与可扩展性。他认为，Ambient Mesh 能够帮助团队更轻松地管理微服务架构。 |\n| **Thomas Graf**     | Isovalent CTO                             | 主张通过 eBPF 和 Cilium 提供无边车的服务网格，优化 mTLS 认证，消除 sidecar 的使用，从而提高性能和安全性。认为分离认证握手和数据传输的模式能够实现更高效、更灵活的服务间认证，同时减少管理复杂性，并提供对多种网络协议的支持。 |\n| **William Morgan**  | Linkerd 创始人兼 Buoyant CEO                | 强烈批评无 sidecar 的 eBPF 方法，认为 sidecar 提供了更好的安全隔离和性能预测性，指出 sidecarless 架构可能重蹈 Linkerd 1 的覆辙。他认为，eBPF 和 sidecar 不是对立的，eBPF 可以用于网络优化，但不应替代 sidecar。主张继续使用更轻量的 sidecar 代理。 |\n| **Zachary Butcher** | Tetrate 创始工程师                         | 对 Ambient Mesh 持审慎乐观态度，认为它有助于降低服务网格的采用难度，但当前性能表现较差、功能有限，距离生产就绪还有很长的路要走。他建议用户暂时不要在生产环境中使用 Ambient Mesh，直到其成熟度提高。 |\n\n{{\u003c\/table\u003e}}\n\n## 个人观点\n\n近年来，我有幸见证并参与了许多关于服务网格架构选择的讨论和实践。我认为服务网格选择不应仅仅基于技术特性的比较，更应考虑到团队的具体需求、现有技术栈的兼容性以及未来的扩展性。\n\n在 sidecar 与 sidecarless 的选择问题上，我的看法是两者各有千秋。Sidecar 模型虽然在某些情况下可能会带来资源占用和管理复杂性的增加，但它提供了更细粒度的流量控制和安全策略实施，这对于需要高度精细化管理的企业环境是非常宝贵的。与此同时，sidecarless 模型，尤其是通过 eBPF 技术实现的，为服务网格带来了前所未有的性能优化和资源利用率提升，它对于构建高效率的大规模服务网格同样具有重要价值。\n\n因此，我的建议是，企业在选择服务网格架构时，应该从自身的业务需求出发，综合考虑安全性、性能、成本以及团队的运维能力，选择最适合自己的服务网格解决方案。\n\n## 总结\n\n总结下目前关于这三个流行的服务网格项目的主流看法：\n\n1. **Linkerd**：强调 sidecar 的安全隔离和性能稳定性，对 eBPF 无 sidecar 模式持批评态度，认为其复杂性和安全风险增加。\n2. **Istio**：引入 Ambient Mesh，部分采用无 sidecar 方法，以降低复杂性和提高性能，但仍保留 sidecar 的部分功能，体现出对现有 sidecar 架构的保留与创新。\n3. **Cilium**：主张通过 eBPF 无 sidecar 模式来优化网络性能和安全性，简化操作，同时保持对多种协议的支持，推动服务网格功能集成到 Linux 内核中。\n\n不同的观点反映了各自对服务网格架构设计的偏好与关注点，不同企业应根据自身需求和技术背景选择合适的服务网格方案。\n\n## 参考\n\n- [Sidecarless eBPF service mesh sparks debate](https:\/\/www.techtarget.com\/searchitoperations\/news\/365535362\/Sidecarless-eBPF-service-mesh-sparks-debate)\n\n- [eBPF or not: Sidecars are the future of the service mesh](https:\/\/thenewstack.io\/ebpf-or-not-sidecars-are-the-future-of-the-service-mesh\/)\n\n- [eBPF Service Mesh](https:\/\/isovalent.com\/blog\/post\/2021-12-08-ebpf-servicemesh\/)\n\n- [Linux kernel utility could solve Kubernetes networking woes](https:\/\/www.techtarget.com\/searchitoperations\/news\/252483517\/Linux-kernel-utility-could-solve-Kubernetes-networking-woes)\n\n- [Service Mesh Security](https:\/\/isovalent.com\/blog\/post\/2022-05-03-servicemesh-security\/)\n\n- [Istio 1.23 drops the sidecars for a simpler ambient mesh](https:\/\/thenewstack.io\/istio-1-23-drops-the-sidecars-for-a-simpler-ambient-mesh)\n\n- [Ambient Mesh: What you need to know about this experimental new deployment model for Istio](https:\/\/tetrate.io\/blog\/ambient-mesh-what-you-need-to-know-about-this-experimental-new-deployment-model-for-istio\/)\n\n- [Sidecarless service mesh: fad or the future?](https:\/\/www.techtarget.com\/searchitoperations\/news\/252526651\/Sidecarless-service-mesh-fad-or-the-future)\n', '\/blog\/service-mesh-sidecar-vs-sidecarless-debate\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">探讨服务网格架构中 sidecar 与 sidecarless 的争论，比较 Cilium、Istio 和 Linkerd 在安全性、性能和架构复杂性方面的不同观点，帮助读者理解这些技术专家的看法和背后的争议。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/integrating-dapr-with-cilium/">[译] 使用 Dapr 与 Cilium 打造无 Sidecar 服务网格</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/08/26</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.codecentric.de/wissens-hub/blog/integrating-dapr-with-cilium-a-sidecar-less-service-mesh-approach-combined-with-a-powerful-distributed-application-runtime" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('使用 Dapr 与 Cilium 打造无 Sidecar 服务网格：新一代分布式应用运行时', '本文探讨了将 Dapr 与 Cilium 集成的无 Sidecar 服务网格方法，强调了其高性能和安全性。', '\n几周前，我们介绍了 Dapr，并讨论了它与服务网格的重叠功能，尽管 Dapr 本身并不是一个服务网格。如之前的博客所述，近年来服务网格已成为现代云原生应用的关键组成部分，提供了诸如流量管理、安全性和可观测性等关键功能。传统的服务网格依赖于 sidecar 代理，这可能会引入复杂性和性能开销。而 Cilium 的无 sidecar 服务网格功能通过利用 eBPF 实现高效的内核级网络处理，结合 Dapr 这一强大的分布式应用运行时，这种集成承诺提供高性能、增强的安全性和简化的操作。\n\n## 无 Sidecar 服务网格的需求\n\n正如[这篇文章](https:\/\/www.codecentric.de\/wissens-hub\/blog\/sidecars-sidecarless-evolution-service-mesh-technologies-istio-cilium)所讨论的，Cilium 最初作为 Kubernetes 的一种 eBPF 驱动的容器网络接口（CNI）开始。随着时间的推移，Cilium 演变成了 Kubernetes 内部网络的多功能工具。2022 年 7 月，Cilium 服务网格的首个版本发布，引入了一种利用 eBPF 并在 Linux 内核中运行的无 sidecar 服务网格。\n\n![基于 Cilium 的服务网格](cilium-mesh.webp)\n\n这种服务网格旨在广泛利用 eBPF，专注于较低层次的网络（直到第 4 层）以提供其功能。然而，对于一个功能齐全的服务网格，较高层次的功能如服务调用依赖于第 7 层。通常，这些功能需要一个代理来实现重试和断路等功能。\n\n考虑到 Dapr 及其第 7 层功能，它传统上运行在基于 sidecar 的模型上。虽然这是准确的，但有一个与无 sidecar 架构相一致的替代方法。\n\n## 介绍 Dapr 共享\n\n[Dapr 共享](https:\/\/github.com\/dapr\/dapr-shared\/)提供了 Dapr 的另一种部署模型。虽然默认的方法仍然使用 sidecars，但 Dapr 共享允许用户轻松地将 Dapr 运行时（Daprd）部署为 Kubernetes 内的 DaemonSet（每个节点一个）或 Deployment（每个集群一个）。这种方法的显著优势在于，它在一定程度上将 Daprd 实例的生命周期与实际应用的生命周期解耦。你可能会问：这有什么好处？有几种情况下，这种方法是有利的：\n\n- 函数即服务（FaaS）集成：在 FaaS 中，实际函数的一个实例可能只在执行期间存在几秒钟。然而，你可能仍然希望使用 PubSub 进行异步消息传递。\n- 无 Sidecar 服务网格集成：当主要使用 Dapr 的构建模块时，类似于 FaaS 的示例，将 Daprd 的生命周期与其应用解耦是有益的。通过控制 Daprd 实例（\u0022代理\u0022）的数量，这种方法与无 sidecar 服务网格很好地集成。\n\n通过在这些情况下使用 Dapr 共享，我们仍然可以利用所有构建块和高级功能，如 mTLS 与服务调用结合使用。\n\n## 我们的示例案例和架构\n\n理论介绍完毕，现在是时候进行实践了。我们将设置一个简单而强大的架构，以演示 Dapr 和 Cilium 服务网格如何协同工作。\n\n![架构图](arch.webp)\n\n在这个设置中，我们将采用前沿技术。Cilium 将处理一般的网络层，并使用其 Gateway API 实现来管理流入我们演示集群的南北流量。对于东西流量，我们将利用 Cilium GAMMA 实现，通过 Dapr 共享运行时进行增强，以确保全面的集成。\n\n通过整合这些技术，我们将能够为我们的设置添加弹性和其他高级功能。这种架构将展示 Dapr 和 Cilium 之间的无缝协作，为 Kubernetes 环境提供强大而可扩展的网络解决方案。\n\n### 要求\n\n如果你想跟进，你将需要访问一个 Kubernetes 集群。这个集群应该安装了 Cilium 版本 1.16，配置如下：\n\n- 替换 Kube-proxy 或 NodePort 服务\n- 启用 GatewayAPI\n- 可访问的 Hubble 和 Hubble UI\n\n你可以按照[官方文档](https:\/\/docs.cilium.io\/en\/stable\/gettingstarted\/k8s-install-default\/)安装 Cilium。\n\n### 设置 Gateway API 和网关\n\n如前所述，我们将使用 GatewayAPI 来路由流量进入我们的集群。这可以通过定义一个 Gateway 资源轻松实现，如下所示：\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1\nkind: Gateway\nmetadata:\n  name: default-gateway\n  namespace: default\nspec:\n  gatewayClassName: cilium\n  listeners:\n  - allowedRoutes:\n      namespaces:\n        from: All\n    name: default-http\n    port: 80\n    protocol: HTTP\n\u0060\u0060\u0060\n\n有了这个资源并正确安装 Cilium，你可以运行以下命令来验证 Gateway 是否已成功编程并具有外部 IP：\n\n\u0060\u0060\u0060bash\nkubectl get gateway default-gateway\n\u0060\u0060\u0060\n\n这应该输出类似于：\n\n\u0060\u0060\u0060\nNAME              CLASS    ADDRESS          PROGRAMMED   AGE\ndefault-gateway   cilium   18.192.114.200   True         27h\n\u0060\u0060\u0060\n\n现在我们已经设置好了 Gateway，我们可以继续运行一个虚拟应用。\n\n### 虚拟应用和简单路由\n\n为了测试我们的设置，我们将部署由 Traefik Labs 创建的 whoami 镜像。这个应用显示 HTTP 请求头和其他相关信息，这对于验证我们的配置非常有用。让我们开始部署并使虚拟应用可访问。\n\n为 whoami 应用创建一个服务、部署和 HTTPRoute：\n\n\u0060\u0060\u0060yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: whoami\n  labels:\n    app: whoami\nspec:\n  ports:\n    - name: http\n      targetPort: 80\n      port: 80\n  selector:\n    app: whoami\n---\napiVersion: apps\/v1\nkind: Deployment\nmetadata:\n  name: whoami-v1\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: whoami\n      version: v1\n  template:\n    metadata:\n      labels:\n        app: whoami\n        version: v1\n    spec:\n      serviceAccountName: whoami\n      containers:\n        - image: traefik\/whoami\n          imagePullPolicy: IfNotPresent\n          name: whoami\n          ports:\n            - containerPort: 80\n          env:\n            - name: WHOAMI_NAME\n              value: \u0022v1\u0022\n---\napiVersion: gateway.networking.k8s.io\/v1\nkind: HTTPRoute\nmetadata:\n  name: whoami-route-service\nspec:\n  parentRefs:\n  - group: \u0022\u0022\n    kind: Service\n    name: whoami\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \/\n    backendRefs:\n    - name: whoami\n      port: 80\n\u0060\u0060\u0060\n\n部署这些资源后，你可以使用一个简单的 curl 命令来验证设置：\n\n\u0060\u0060\u0060\ncurl -v http:\/\/18.192.114.200\n\u0060\u0060\u0060\n\n预期输出应类似于：\n\n\u0060\u0060\u0060\n*   Trying 18.192.114.200:80...\n* Connected to 18.192.114.200 (18.192.114.200) port 80\n\u003e GET \/ HTTP\/1.1\n\u003e Host: 18.192.114.200\n\u003e User-Agent: curl\/8.4.0\n\u003e Accept: *\/*\n\u003e\n\u003c HTTP\/1.1 200 OK\n\u003c date: Tue, 30 Jul 2024 14:16:41 GMT\n\u003c content-length: 350\n\u003c content-type: text\/plain; charset=utf-8\n\u003c x-envoy-upstream-service-time: 6\n\u003c server: envoy\n\u003c\nName: v1\nHostname: whoami-v1-cd9b4bdf7-ht6dc\nIP: 127.0.0.1\nIP: ::1\nIP: 10.42.0.101\nIP: fe80::e0d3:4fff:fe30:95ef\nRemoteAddr: 10.42.1.170:35911\nGET \/ HTTP\/1.1\nHost: 18.192.114.200\nUser-Agent: curl\/8.4.0\nAccept: *\/*\nX-Envoy-Internal: true\nX-Forwarded-For: 10.42.1.82\nX-Forwarded-Proto: http\nX-Request-Id: bc928d69-06e2-427b-89f1-fab7c8bfb7e9\n\n* Connection #0 to host 18.192.114.200 left intact\n\u0060\u0060\u0060\n\n这确认了 whoami 应用是可访问的，且 GatewayAPI 正确路由流量进入我们的集群。\n\n### 安装 Dapr 运行时\n\n接下来，我们需要在我们的 Kubernetes 集群中安装 Dapr 运行时。这可以通过使用现有的 Helm chart 快速完成。执行以下命令安装 Dapr：\n\n\u0060\u0060\u0060bash\nhelm upgrade --install dapr dapr\/dapr \\\n--version=1.13 \\\n--namespace dapr-system \\\n--create-namespace \\\n--wait\n\u0060\u0060\u0060\n\n成功安装的输出看起来像这样：\n\n\u0060\u0060\u0060\nRelease \u0022dapr\u0022 has been upgraded. Happy Helming!\nNAME: dapr\nLAST DEPLOYED: Tue Jul 30 16:09:45 2024\nNAMESPACE: dapr-system\nSTATUS: deployed\nREVISION: 1\nTEST SUITE: None\nNOTES:\nThank you for installing Dapr: High-performance, lightweight serverless runtime for cloud and edge\n\nYour release is named dapr.\n\nTo get started with Dapr, we recommend using our quickstarts:\nhttps:\/\/github.com\/dapr\/quickstarts\n\nFor more information on running Dapr, visit:\nhttps:\/\/dapr.io\n\u0060\u0060\u0060\n\n要验证所有 Dapr 组件是否正确运行，检查 dapr-system 命名空间中的 pods：\n\n\u0060\u0060\u0060bash\nkubectl get pods -n dapr-system\n\u0060\u0060\u0060\n\n典型的输出应显示所有 Dapr 组件处于运行状态：\n\n\u0060\u0060\u0060\nNAME                                    READY   STATUS    RESTARTS   AGE\ndapr-operator-c449df54-px8q2            1\/1     Running   0          25h\ndapr-placement-server-0                 1\/1     Running   0          25h\ndapr-sentry-774c876df5-h2nhh            1\/1     Running   0          25h\ndapr-sidecar-injector-78769c6d9-zh2jw   1\/1     Running   0          25h\n\u0060\u0060\u0060\n\nDapr 成功安装并且所有组件健康后，我们可以继续安装我们的共享实例。\n\n### 部署 Dapr 共享实例\n\n现在，让我们设置我们的 Dapr 共享实例。我们需要部署两个实例：一个用于入口（Cilium Gateway）和一个用于虚拟的 whoami 应用。入口实例将作为 DaemonSet 部署，而 whoami 实例将作为 Deployment 部署。\n\n\u0060\u0060\u0060bash\nhelm upgrade --install ingress-shared oci:\/\/registry-1.docker.io\/daprio\/dapr-shared-chart --set shared.appId=ingress --set shared.strategy=daemonset --set shared.remoteURL=cilium-gateway-default-gateway.default.svc.cluster.local --set shared.remotePort=80 --set shared.daprd.mtls.enabled=true --namespace default\n\nhelm upgrade --install whoami-shared  oci:\/\/registry-1.docker.io\/daprio\/dapr-shared-chart --set shared.appId=whoami --set shared.strategy=deployment --set shared.remoteURL=whoami.default.svc.cluster.local --set shared.remotePort=80 --set shared.daprd.mtls.enabled=true --namespace default\n\u0060\u0060\u0060\n\n执行这些命令后，你可以使用以下命令验证 Dapr 共享实例是否正在正确运行：\n\n\u0060\u0060\u0060bash\nkubectl get pods\n\u0060\u0060\u0060\n\n你应该看到类似于这样的输出：\n\n\u0060\u0060\u0060\nNAME                                               READY   STATUS    RESTARTS   AGE\ningress-shared-dapr-shared-chart-bfnxc             1\/1     Running   0          29s\ningress-shared-dapr-shared-chart-lg62n             1\/1     Running   0          21s\nwhoami-shared-dapr-shared-chart-69fd8658db-kmzph   1\/1     Running   0          26s\n\u0060\u0060\u0060\n\n有了这些共享实例的运行，我们已经成功建立了一个强大的设置来处理应用流量和服务调用。\n\n### Daprise 操作\n\n现在来到了有趣的部分：\u0022Dapr 化\u0022我们的设置！我们将 Dapr 与 Cilium Gateway 和 whoami 应用整合，充分利用 Dapr 的功能。为了确保所有请求都通过专门的网关的 Dapr 共享实例流动，我们将配置 HTTPRoute 以针对这个 Dapr 实例。Dapr 期望特定的 URL 格式用于服务调用，因此我们将使用 Gateway API 中的 URLRewrite 过滤器来调整请求路径。\n\n使用以下配置更新之前的 HTTPRoute 资源：\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1\nkind: HTTPRoute\nmetadata:\n  name: whoami-route\nspec:\n  parentRefs:\n  - name: default-gateway\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \/\n    filters:\n    - type: URLRewrite\n      urlRewrite:\n        path: \n          type: ReplacePrefixMatch\n          replacePrefixMatch: \/v1.0\/invoke\/whoami.default\/method\/\/\n    backendRefs:\n    - name: ingress-dapr\n      port: 3500\n\u0060\u0060\u0060\n\n我们是如何\u0022Dapr 化\u0022它的？\n\n- filters: URLRewrite 过滤器重写 URL 以匹配 Dapr 的服务调用格式。（是的，\/\/是正确的）\n- backendRefs: 指向处理网关请求的 ingress-dapr 实例。\n\n为了验证一切是否正常工作，对网关的外部 IP 执行 curl 请求：\n\n\u0060\u0060\u0060bash\ncurl -v http:\/\/18.192.114.200\n\u0060\u0060\u0060\n\n你应该看到类似于这样的输出：\n\n\u0060\u0060\u0060\n*   Trying 18.192.114.200:80...\n* Connected to 18.192.114.200 (18.192.114.200) port 80\n\u003e GET \/ HTTP\/1.1\n\u003e Host: 18.192.114.200\n\u003e User-Agent: curl\/8.4.0\n\u003e Accept: *\/*\n\u003e\n\u003c HTTP\/1.1 200 OK\n\u003c content-length: 719\n\u003c content-type: text\/plain; charset=utf-8\n\u003c date: Tue, 30 Jul 2024 14:38:18 GMT\n\u003c traceparent: 00-00000000000000000000000000000000-0000000000000000-00\n\u003c x-envoy-upstream-service-time: 18\n\u003c server: envoy\n\u003c\nName: v1\nHostname: whoami-v1-cd9b4bdf7-4tmvr\nIP: 127.0.0.1\nIP: ::1\nIP: 10.42.1.30\nIP: fe80::7f:66ff:fe14:15ad\nRemoteAddr: 10.42.0.60:55178\nGET \/ HTTP\/1.1\nHost: whoami.default.svc.cluster.local:80\nUser-Agent: curl\/8.4.0\nAccept: *\/*\nAccept-Encoding: gzip\nDapr-Callee-App-Id: whoami\nDapr-Caller-App-Id: ingress\nForwarded: for=10.42.0.131;by=10.42\n\n.0.131;host=ingress-shared-dapr-shared-chart-bfnxc\nTraceparent: 00-00000000000000000000000000000000-0000000000000000-00\nX-Envoy-Internal: true\nX-Envoy-Original-Path: \/\nX-Forwarded-For: 10.42.1.110\nX-Forwarded-For: 10.42.0.131\nX-Forwarded-Host: ingress-shared-dapr-shared-chart-bfnxc\nX-Forwarded-Proto: http\nX-Request-Id: 5556df41-f78f-4c98-9526-f5025a787a1e\n\n* Connection #0 to host 18.192.114.200 left intact\n\u0060\u0060\u0060\n\n从头文件中，你可以看到\u0060Dapr-Callee-App-Id\u0060和\u0060Dapr-Caller-App-Id\u0060，表明流量正确通过 Dapr 实例路由。这个设置确保连接默认通过 mTLS（传输）加密，为我们的通信增加了额外的安全层。我们已经成功地将 Dapr 与 Cilium 的服务网格整合在一起，利用其先进的功能增强了应用的网络和服务调用。\n\n### 实现流量转移使用 Gamma\n\nDapr 不提供的一个功能，但 Cilium 提供的是流量转移。幸运的是，通过我们的集成，我们可以利用 Cilium 的 GAMMA（服务网格的 Gateway API）来启用这个功能。GAMMA 扩展了 Gateway API 以支持集群内的东西向流量管理，补充其用于南北向流量的用途。要设置流量转移，我们需要创建一个 HTTPRoute 配置，以便在应用的不同版本之间进行负载平衡。通过利用 GAMMA，你可以在不同版本的应用之间转移流量，使得部署新功能或进行金丝雀发布更容易，最小化中断。首先，我们将部署 whoami 应用的新版本并为其创建额外的服务。以下是部署 whoami 版本 2 并设置必要服务的 YAML 配置：\n\n\u0060\u0060\u0060yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: whoami-v1\n  labels:\n    app: whoami\n    version: v1\nspec:\n  ports:\n    - name: http\n      targetPort: 80\n      port: 80\n  selector:\n    app: whoami\n    version: v1\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: whoami-v2\n  labels:\n    app: whoami\n    version: v2\nspec:\n  ports:\n    - name: http\n      targetPort: 80\n      port: 80\n  selector:\n    app: whoami\n    version: v2\n---\napiVersion: apps\/v1\nkind: Deployment\nmetadata:\n  name: whoami-v2\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: whoami\n      version: v2\n  template:\n    metadata:\n      labels:\n        app: whoami\n        version: v2\n    spec:\n      serviceAccountName: whoami\n      containers:\n        - image: traefik\/whoami\n          imagePullPolicy: IfNotPresent\n          name: whoami\n          ports:\n            - containerPort: 80\n          env:\n            - name: WHOAMI_NAME\n              value: \u0022v2\u0022\n\u0060\u0060\u0060\n\n接下来，我们配置一个 HTTPRoute 来启用在 whoami-v1 和 whoami-v2 之间的流量转移。HTTPRoute 将根据定义的权重将一定比例的流量路由到每个应用版本。\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1\nkind: HTTPRoute\nmetadata:\n  name: whoami-route-service\nspec:\n  parentRefs:\n  - group: \u0022\u0022\n    kind: Service\n    name: whoami\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \/\n    backendRefs:\n    - name: whoami-v1\n      port: 80\n      weight: 50\n    - name: whoami-v2\n      port: 80\n      weight: 50\n\u0060\u0060\u0060\n\n这里重要的部分是\u0060parentRefs\u0060。虽然在传统的 Gateway API 中，我们使用这个来绑定该 \u0060HTTPRoute\u0060 到一个网关，我们在这里将其绑定到\u0060whoami\u0060服务，启用 GAMMA 案例。\n\n此外，通过在\u0060backendRef\u0060中定义\u0060weight\u0060，我们可以调整我们希望如何转移流量。为了确保流量转移工作正确，你可以进行多次 curl 请求并检查响应，以验证流量是否按照指定在 whoami-v1 和 whoami-v2 之间分配。\n\n\u0060\u0060\u0060\ncurl http:\/\/18.192.114.200\nName: v1\nHostname: whoami-v1-cd9b4bdf7-4tmvr\nIP: 127.0.0.1\nIP: ::1\nIP: 10.42.1.30\nIP: fe80::7f:66ff:fe14:15ad\nRemoteAddr: 10.42.0.60:55178\nGET \/ HTTP\/1.1\nHost: whoami.default.svc.cluster.local:80\nUser-Agent: curl\/8.4.0\nAccept: *\/*\nAccept-Encoding: gzip\nDapr-Callee-App-Id: whoami\nDapr-Caller-App-Id: ingress\nForwarded: for=10.42.0.131;by=10.42.0.131;host=ingress-shared-dapr-shared-chart-bfnxc\nTraceparent: 00-00000000000000000000000000000000-0000000000000000-00\nX-Envoy-Internal: true\nX-Envoy-Original-Path: \/\nX-Forwarded-For: 10.42.1.110\nX-Forwarded-For: 10.42.0.131\nX-Forwarded-Host: ingress-shared-dapr-shared-chart-bfnxc\nX-Forwarded-Proto: http\nX-Request-Id: e9d8ab85-8ae7-46a9-8b44-42240d1d6833\n---\ncurl http:\/\/18.192.114.200\nName: v2\nHostname: whoami-v2-766bb5fbd5-bfx9j\nIP: 127.0.0.1\nIP: ::1\nIP: 10.42.1.181\nIP: fe80::d441:87ff:fea1:d123\nRemoteAddr: 10.42.1.27:32774\nGET \/ HTTP\/1.1\nHost: whoami.default.svc.cluster.local:80\nUser-Agent: curl\/8.4.0\nAccept: *\/*\nAccept-Encoding: gzip\nDapr-Callee-App-Id: whoami\nDapr-Caller-App-Id: ingress\nForwarded: for=10.42.0.131;by=10.42.0.131;host=ingress-shared-dapr-shared-chart-bfnxc\nTraceparent: 00-00000000000000000000000000000000-0000000000000000-00\nX-Envoy-Internal: true\nX-Envoy-Original-Path: \/\nX-Forwarded-For: 10.42.1.64\nX-Forwarded-For: 10.42.0.131\nX-Forwarded-Host: ingress-shared-dapr-shared-chart-bfnxc\nX-Forwarded-Proto: http\nX-Request-Id: f1df7207-098c-4a98-8a97-858ce1f9c0ed\n\u0060\u0060\u0060\n\n你应该会看到基于配置的流量权重，从两个应用版本收到响应。此外，我们可以查阅\u0060hubble flow\u0060日志来检查实际连接情况：\n\n\u0060\u0060\u0060\nJul 29 15:18:13.883: kube-system\/svclb-cilium-gateway-default-gateway-f455e04d-jljl8:54047 (ingress) -\u003e default\/ingress-shared-dapr-shared-chart-g2596:3500 (ID:33809) http-request FORWARDED (HTTP\/1.1 GET http:\/\/whoami.cloud-native.rocks\/v1.0\/invoke\/whoami.default\/method\/something)\nJul 29 15:18:13.884: 10.42.1.170:39105 (ingress) \u003c\u003e default\/ingress-shared-dapr-shared-chart-g2596:3500 (ID:33809) to-overlay FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:13.884: 10.42.1.170:39105 (ingress)\n\n -\u003e default\/ingress-shared-dapr-shared-chart-g2596:3500 (ID:33809) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:13.890: default\/ingress-shared-dapr-shared-chart-g2596:55194 (ID:33809) -\u003e default\/whoami-shared-dapr-shared-chart-crmxz:50002 (ID:14274) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:13.890: default\/ingress-shared-dapr-shared-chart-g2596:55194 (ID:33809) \u003c- default\/whoami-shared-dapr-shared-chart-crmxz:50002 (ID:14274) to-endpoint FORWARDED (TCP Flags: ACK)\nJul 29 15:18:13.891: default\/whoami-shared-dapr-shared-chart-crmxz:46028 (ID:14274) -\u003e default\/whoami-v1-cd9b4bdf7-gxkvt:80 (ID:26920) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:13.891: default\/whoami-shared-dapr-shared-chart-crmxz:46028 (ID:14274) \u003c- default\/whoami-v1-cd9b4bdf7-gxkvt:80 (ID:26920) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:13.893: 10.42.1.170:39105 (ingress) \u003c\u003e default\/ingress-shared-dapr-shared-chart-g2596:3500 (ID:33809) to-overlay FORWARDED (TCP Flags: ACK)\nJul 29 15:18:13.895: kube-system\/svclb-cilium-gateway-default-gateway-f455e04d-jljl8:54047 (ingress) \u003c- default\/ingress-shared-dapr-shared-chart-g2596:3500 (ID:33809) http-response FORWARDED (HTTP\/1.1 200 15ms (GET http:\/\/whoami.cloud-native.rocks\/v1.0\/invoke\/whoami.default\/method\/something))\nJul 29 15:18:14.405: kube-system\/svclb-cilium-gateway-default-gateway-f455e04d-jljl8:54048 (ingress) -\u003e default\/ingress-shared-dapr-shared-chart-zxv74:3500 (ID:33809) http-request FORWARDED (HTTP\/1.1 GET http:\/\/whoami.cloud-native.rocks\/v1.0\/invoke\/whoami.default\/method\/something)\nJul 29 15:18:14.406: 10.42.1.170:38391 (ingress) -\u003e default\/ingress-shared-dapr-shared-chart-zxv74:3500 (ID:33809) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:14.414: default\/ingress-shared-dapr-shared-chart-zxv74:55876 (ID:33809) -\u003e default\/whoami-shared-dapr-shared-chart-g572c:50002 (ID:14274) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:14.414: default\/whoami-shared-dapr-shared-chart-g572c:58854 (ID:14274) -\u003e default\/whoami-v2-766bb5fbd5-jvtcd:80 (ID:2184) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:14.414: default\/ingress-shared-dapr-shared-chart-zxv74:55876 (ID:33809) \u003c- default\/whoami-shared-dapr-shared-chart-g572c:50002 (ID:14274) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\nJul 29 15:18:14.415: default\/whoami-shared-dapr-shared-chart-g572c:58854 (ID:14274) \u003c- default\/whoami-v2-766bb5fbd5-jvtcd:80 (ID:2184) to-endpoint FORWARDED (TCP Flags: ACK, PSH)\n\u0060\u0060\u0060\n\n这个日志显示，流量被重定向到\u0060whoami-v1\u0060以及\u0060whoami-v2\u0060。在 hubble UI 中，这也是可见的。\n\n![流量拓扑图](topo.webp)\n\n## 使用网络策略进行访问控制\n\n有了 Cilium 处理到 Dapr 的流量，我们可以利用 Cilium 的网络策略来配置访问控制。与 Dapr 的访问控制在第 7 层（应用层）操作不同，Cilium 的方法在更低的网络堆栈层次上工作，提供更细粒度的控制。\n\n下面是如何使用 Cilium 的 CiliumNetworkPolicy 配置访问控制：\n\n\u0060\u0060\u0060yaml\napiVersion: cilium.io\/v2\nkind: CiliumNetworkPolicy\nmetadata:\n  name: \u0022allow-ingress-shared-to-whoami\u0022\nspec:\n  endpointSelector:\n    matchLabels:\n      dapr.io\/app-id: whoami\n  ingress:\n  - fromEndpoints:\n    - matchLabels:\n         dapr.io\/app-id: ingress\n    toPorts:\n    - ports:\n      - port: \u002250002\u0022\n        protocol: TCP\n---\napiVersion: \u0022cilium.io\/v2\u0022\nkind: CiliumNetworkPolicy\nmetadata:\n  name: \u0022allow-ingress-to-ingress-shared\u0022\nspec:\n  endpointSelector:\n    matchLabels:\n      dapr.io\/app-id: ingress\n  ingress:\n  - fromEntities:\n    - ingress\n    toPorts:\n    - ports:\n      - port: \u00223500\u0022\n        protocol: TCP\n\u0060\u0060\u0060\n\n这两个策略将限制我们集群中的流量流向。它们确保只允许 cilium-gateway 连接到 ingress-dapr 实例。类似地，ingress-dapr 实例是唯一允许与 whoami-dapr 实例通信的实体。这个设置确保 Dapr 共享实例是彼此唯一的通信者，增强了安全性和控制。Cilium 在第 3 层和第 4 层应用网络策略，提供了在流量到达应用层之前的更细粒度控制。这通过在网络堆栈的早期阻止未经授权的访问来减少不必要的流量，并通过提升性能来增强性能。\n\n## 优势 1 - 本地重定向策略\n\nCilium 1.16 引入了一个名为 Local Redirect Policy 的 beta 功能。这个功能允许你将流量重定向到同一节点上的本地端点，而不是在整个集群中路由。这对于优化流量流和确保某些连接保持本地特别有用。\n\n\u0060\u0060\u0060yaml\napiVersion: \u0022cilium.io\/v2\u0022\nkind: CiliumLocalRedirectPolicy\nmetadata:\n  name: \u0022redirect-ingress\u0022\nspec:\n  redirectFrontend:\n    serviceMatcher:\n      serviceName: ingress-dapr\n      namespace: default\n  redirectBackend:\n    localEndpointSelector:\n      matchLabels:\n        dapr.io\/app-id: ingress\n    toPorts:\n      - port: \u00223500\u0022\n        protocol: TCP\n\u0060\u0060\u0060\n\n我们将使用这个策略确保从\u0060cilium-gateway\u0060到其 Dapr 共享实例的流量保持在节点上。这种方法将连接保持在同一节点上，确保在流量离开节点之前建立并维持 mTLS。请注意，由于这是一个 beta 功能，你需要在 Cilium 中启用它。有关启用此功能的指南，请参阅 Cilium 文档。\n\n## 优势 2 - mTLS 和强身份\n\n将 Cilium 整合到你的设置中的另一个优势是使用 Cilium 的 mTLS 功能，而不是 Dapr 的。Cilium 通过节点间的 Wireguard 或 IPSec 隧道提供 mTLS，与 Dapr 通过双向 gRPC 连接使用 mTLS 的方法相比，提供了明显的好处。\n\n- 内核级执行：Cilium 的 mTLS 可以直接在 Linux 内核中执行，利用 Wireguard 或 IPSec。这种方法通常比 Dapr 通过 gRPC 的用户空间实现的 mTLS 提供更好的性能。\n- 广泛的加密覆盖：Cilium 确保所有服务到服务的连接都\n- 加密，而不仅仅是那些通过 Dapr 进行的。这提供了一个更全面的安全模型。\n\n一旦在 Cilium 本身启用了 mTLS，你可以通过将其附加到\u0060CiliumNetworkPolicy\u0060来在 Cilium 中强制执行 mTLS：\n\n  \u0060\u0060\u0060yaml\n  authentication:\n      mode: \u0022required\u0022\n  \u0060\u0060\u0060\n\nCilium 将检查匹配的强身份以及 mTLS 验证。\n\n## 总结\n\n总之，Dapr 与 Cilium 的无 sidecar 服务网格的整合为微服务架构打开了新的可能性。通过利用 Dapr 共享，我们可以将 Dapr 运行时的生命周期与应用解耦，允许更灵活的部署。Dapr 的强大服务调用能力与 Cilium 的高效、基于 eBPF 的网络和服务网格功能的结合，使得微服务交互具有高性能、安全性和弹性。\n\n这次演示展示了这些技术如何协调一致，创造了一个简化服务管理的前沿基础设施，同时增强了可扩展性和可靠性。Dapr 和 Cilium 的整合代表了构建下一代分布式应用的重要一步。\n', '\/trans\/integrating-dapr-with-cilium\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文探讨了将 Dapr 与 Cilium 集成的无 Sidecar 服务网格方法，强调了其高性能和安全性。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/gateway-api-istio-ingress-evolution/">探索 Kubernetes Ingress、Gateway API 与 Istio 的演进和转型</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2024/07/02</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('探索 Kubernetes Ingress、Gateway API 与 Istio 的演进和转型', '本文深入分析了 Kubernetes Gateway API、Istio 与 Ingress 的联系、差异及迁移策略。', '\n随着 Istio 1.22 版本的发布，Istio API 已正式升级至 v1 版本，同期，Kubernetes Gateway API 也更新至 v1.1 版本。本篇文章旨在深入探索 Ingress API、Istio API 与 Kubernetes Gateway API 之间的联系与区别，并详述它们在现实应用中的选择及迁移策略。\n\n## 前言\n\n之前，我曾撰写一篇文章，讨论了 [为何 Gateway API 是 Kubernetes 与服务网格入口中的未来方向](\/blog\/why-gateway-api-is-the-future-of-ingress-and-mesh\/)。文章中指出，作为 Kubernetes 的初始入口网关，Ingress 的资源模型由于过于简单，难以满足当下的可编程网络需求。作为其接班人，Gateway API 近年来发展迅速，获得了广泛支持，包括众多新兴的开源网关项目如 [Envoy Gateway](https:\/\/gateway.envoyproxy.io) 也选择基于 Gateway API 开发。此外，一些传统网关项目也开始适配 Gateway API，或通过 [ingress2gateway](https:\/\/github.com\/kubernetes-sigs\/ingress2gateway) 这样的工具进行迁移。\n\nGateway API，作为 Kubernetes 入口网关的最新成果，通过角色划分来分离关注点，并支持跨 namespace，更适合多云环境。它整合了入口网关（南北向）与服务网格（东西向，集群内路由）的重叠功能，为云原生时代的统一流量管理提供了新的参考模型。\n\nIngress API、Gateway API 与 Istio API 都能实现网关功能，它们之间具体有何联系与区别？本文将为你揭晓这一迷题，并提供 Kubernetes 环境中网关的选择和迁移策略。\n\n## Kubernetes 中的流量管理\n\n随着微服务架构的广泛应用和日益增长的复杂性，Kubernetes 的流量管理工具也在不断演进以适应各种技术需求。Ingress API、Istio API 与 Kubernetes Gateway API 分别标志着这一演变的不同阶段。\n\n**Ingress API** 提供了 Kubernetes 的基本流量管理功能，允许用户通过定义简单的路由规则（例如 HTTP 和 HTTPS）来管理外部访问集群内服务的流量。其设计虽简洁，但功能有限，主要适用于规模较小、结构较简单的应用场景。\n\n相比之下，**Istio API** 作为服务网格的一部分，提供了一系列高级流量管理功能，如流量镜像、金丝雀发布和断路器，适合于需要复杂流量管理的大规模微服务架构。\n\n为了克服 Ingress API 的局限性并集成类似 Istio 的高级功能，**Kubernetes Gateway API** 因应而生。它不仅在设计上提供了更高的灵活性和扩展性，还通过社区的广泛支持，成为连接传统 Ingress 实现和现代服务网格技术如 Istio 的桥梁，目前主流的开源网关都是基于 Gateway API 或已进行适配。\n\n以下表格概述了这三者的核心特点和推荐使用场景：\n\n| API 名称    | 对象类型                    | 状态                    | 推荐使用场景                                                 |\n| ----------- | --------------------------- | ----------------------- | ------------------------------------------------------------ |\n| Ingress API | \u0060Ingress\u0060                   | 稳定 (Kubernetes v1.19) | 适用于小规模和简单的应用场景，主要用于基本的路由配置         |\n| Istio API   | \u0060VirtualService\u0060、\u0060Gateway\u0060 | 稳定 (Istio 1.22)       | 适用于高度复杂的微服务架构，需细粒度控制和高级流量管理特性的场景 |\n| Gateway API | \u0060HTTPRoute\u0060、\u0060Gateway\u0060      | 稳定 (Gateway API v1.1) | 适用于新部署或现有部署，需提高灵活性和可扩展性的场景，特别是结合 Istio 使用 |\n\n[Gateway API v1.1](https:\/\/kubernetes.io\/blog\/2024\/05\/09\/gateway-api-v1-1\/) 的推出，特别是其在提升与现有 Ingress 配置兼容性方面的改进，为用户提供了一个平稳的迁移途径，使从传统的 Ingress 解决方案向更现代的、功能更全面的 Gateway API 的过渡变得更为顺畅。\n\n## 从 Ingress 迁移到 Kubernetes Gateway API\n\n若想从 Ingress 迁移到 Gateway API，请按以下步骤操作：\n\n1. **理解关键差异**：与 Ingress 相比，Gateway API 引入了多种新的概念和资源类型，如 \u0060Gateway\u0060、\u0060HTTPRoute\u0060 和 \u0060TLSRoute\u0060。这些资源提供了更多的配置选项和灵活性，请参阅 [Gateway API 文档](https:\/\/gateway-api.sigs.k8s.io\/guides\/)以了解其配置。\n2. **配置入口点**：创建 \u0060Gateway\u0060 资源配置，明确定义如何接收外部流量，包括配置协议、端口和 TLS 终端。\n3. **映射旧资源**：将现有的 Ingress 资源映射到对应的 Gateway API 资源。例如，Ingress 中的 host 和 path 规则需要转换为 HTTPRoute 中的路由规则。\n4. **测试与部署**：在正式迁移之前，在测试环境中验证新的 Gateway API 配置，确保所有流量路由正常，无安全漏洞。\n\n为了简化迁移过程，你可以使用工具如 [ingress2gateway](https:\/\/github.com\/kubernetes-sigs\/ingress2gateway)，该工具能自动将 Ingress 配置转换为 Gateway API 格式。\n\n## 实际迁移示例\n\n以下是一个简单的 HTTP 网关配置示例，展示了如何将 Ingress 迁移到 Gateway API。\n\n假设现有一个 Ingress 配置如下：\n\n\u0060\u0060\u0060yaml\napiVersion: networking.k8s.io\/v1\nkind: Ingress\nmetadata:\n  name: example-ingress\nspec:\n  rules:\n  - host: example.com\n    http:\n      paths:\n      - path: \/\n        pathType: Prefix\n        backend:\n          service:\n            name: example-service\n            port:\n              number: 80\n\u0060\u0060\u0060\n\n要将其迁移到 Gateway API，首先需要创建一个 Gateway 对象：\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1\nkind: Gateway\nmetadata:\n  name: example-gateway\nspec:\n  gatewayClassName: example-gateway-class\n  listeners:\n    - name: http\n      protocol: HTTP\n      port: 80\n      allowedRoutes:\n        kinds\n          - kind: HTTPRoute\n\u0060\u0060\u0060\n\n请确保 \u0060gatewayClassName\u0060 指向你集群中配置的有效 GatewayClass。GatewayClass 通常由集群管理员设置，是一个为 Gateway 提供配置的资源。\n\n接下来，创建 HTTPRoute 资源来定义路由规则，将流量路由到后端服务：\n\n\u0060\u0060\u0060yaml\napiVersion: gateway.networking.k8s.io\/v1\nkind: HTTPRoute\nmetadata:\n  name: example-httproute\nspec:\n  parentRefs:\n  - name: example-gateway\n  hostnames:\n  - \u0022example.com\u0022\n  rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: \u0022\/\u0022\n    backendRefs:\n    - name: example-service\n      port: 80\n\u0060\u0060\u0060\n\n在此示例中，我们看到：\n\n- \u0060Ingress\u0060 对象中的规则被直接映射到 \u0060HTTPRoute\u0060 对象中。\n- 路由规则中的主机名匹配、路径匹配以及后端服务配置保持不变，只是对象和字段名称有所不同。\n\n## 考虑的挑战\n\n虽然可以将 Ingress 迁移到 Gateway API，并可能同时运行它们，但需要考虑以下挑战和迁移的必要性：\n\n- **功能差异**：某些 Ingress 控制器的特定功能可能在 Gateway API 中没有直接对应，可能需要通过额外的配置或自定义资源来实现。\n- **多资源管理**：Gateway API 的使用可能涉及比 Ingress 更多的资源类型和更复杂的配置，这可能增加管理的复杂性。\n\n对于现有的 Ingress 和 Istio API 用户，是否需要迁移到 Gateway API 取决于具体情况。以下是一些迁移建议：\n\n- **新部署**：建议直接采用 Gateway API，以便利用其先进特性和预见未来的发展。\n- **现有部署**：如果现有系统运行稳定且无需高级特性，可以继续使用现有 API；如果希望利用 Gateway API 的新特性或计划未来长期发展，逐步迁移则是一个理智的选择。\n\n对于不同网关对 Gateway API 的支持情况，可以参考 [Gateway API 实现项目的一致性报告](https:\/\/gateway-api.sigs.k8s.io\/implementations\/v1.1\/)了解详细信息。\n\n## 总结\n\nIngress API、Istio API 和 Kubernetes Gateway API 各具特色，适应不同的应用场景和需求。选择合适的 API，进行合理的规划和管理，可以显著提高系统的灵活性和稳定性。随着 Gateway API 的持续发展和成熟，它将越来越成为未来流量管理的主流选择。\n\n选择合适的网关技术，结合你的具体需求和现有架构，可以更好地管理和优化流量，确保应用的高效和稳定运行。随着技术的进步和社区的发展，Gateway API 提供了一个强大且灵活的框架，使得从传统的 Ingress 迁移到更现代的解决方案变得更为简单和高效。\n\n## 参考\n\n- [Migrating from Ingress - gateway-api.sigs.k8s.io](https:\/\/gateway-api.sigs.k8s.io\/guides\/migrating-from-ingress\/)\n- [Extending Gateway API support in Istio - istio.io](https:\/\/istio.io\/latest\/blog\/2022\/gateway-api-beta\/)', '\/blog\/gateway-api-istio-ingress-evolution\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文深入分析了 Kubernetes Gateway API、Istio 与 Ingress 的联系、差异及迁移策略。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/cncf-archives-the-service-mesh-interface-smi-project/">[译] CNCF 将服务网格接口（SMI）项目归档</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/12/12</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://www.cncf.io/blog/2023/10/03/cncf-archives-the-service-mesh-interface-smi-project/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('CNCF 将服务网格接口（SMI）项目归档', 'CNCF（技术监督委员会（TOC））已经投票批准归档 Service Mesh Interface（SMI）项目。', '\n本文译自 [CNCF 官方博客](https:\/\/www.cncf.io\/blog\/2023\/10\/03\/cncf-archives-the-service-mesh-interface-smi-project\/)。\n\nCNCF（[**技术监督委员会（TOC）**](https:\/\/github.com\/cncf\/toc)）已经投票批准[**归档**](https:\/\/github.com\/cncf\/toc\/pull\/1156)服务网格接口（SMI）项目。\n\nSMI 被创建为在 Kubernetes 上为服务网格提供标准接口以及最常见的服务网格用例的基本功能集。它于 2020 年 3 月被接受为 CNCF 沙盒项目。\n\nSMI 是第五个被 CNCF 归档的项目。开源项目有一个生命周期，项目可能因各种原因而不活跃。还有一些情况下，项目可能不再希望得到 CNCF、维护者或 TOC 的支持。\n\nCNCF 的 CTO Chris Aniszczyk 表示：“在 CNCF 中，项目有一个生命周期，有时包括归档项目，特别是因为沙盒项目是用于实验的。这实际上是维护一个健康的开源生态系统的一部分。”他还说：“项目将自然地在生命周期中移动，并可能变得不太活跃，或者可能不再适合某个用例。就 SMI 而言，维护者已经决定将精力集中在 Kubernetes SIG Network 倡议下的 [GAMMA](https:\/\/kubernetes.io\/blog\/2023\/08\/29\/gateway-api-v0-8\/) 服务网格上。”\n\n在 2022 年 7 月，SMI 团队更新了项目博客站点：[宣布 SMI 参与 Gateway API GAMMA 倡议](https:\/\/smi-spec.io\/blog\/announcing-smi-gateway-api-gamma\/)。在 SMI 旗下没有进一步的工作，SMI 维护者目前建议归档 SMI 项目，并鼓励人们参与 GAMMA 倡议。\n\n一旦项目被归档：\n\n- CNCF 将不再为该项目提供支持\n- 它将在网上列为归档项目\n- CNCF 可以提供服务，如文档更新，以帮助用户过渡。\n- CNCF 将不再为该项目提供其他营销活动\n\nCNCF TOC 感谢 SMI 项目的维护者和贡献者在推动云原生服务网格技术和标准化方面发挥的重要作用。\n\n了解更多关于 [CNCF 归档流程](https:\/\/github.com\/cncf\/toc\/blob\/main\/process\/archiving.md) 的信息。\n', '\/trans\/cncf-archives-the-service-mesh-interface-smi-project\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">CNCF（技术监督委员会（TOC））已经投票批准归档 Service Mesh Interface（SMI）项目。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/osm-deprecated/">[译] OSM（Open Service Mesh）项目将停止更新，团队将协力 Istio 服务网格开发</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/05/05</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://openservicemesh.io/blog/osm-project-update/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('OSM（Open Service Mesh）项目将停止更新，团队将协力 Istio 服务网格开发', '开放服务网格（OSM）宣布停止更新，将与 Istio 社区更加紧密地合作，以加速实现下一代服务网格技术的发展。服务网格社区的发展，如 Kubernetes Gateway API 和 GAMMA，进一步凸显了服务网格在当今云原生栈中的关键重要性和成熟度。OSM 团队将与 Istio 社区合作，包括利用 Kubernetes 的 ClusterTrustBundles 功能增强 Istio 的网格证书管理体验，提出“安全模式”功能方法，改进 Istio 的遥测体验，并与 Istio 新宣布的无 Sidecar 环境网格模式进行合作。', '\n开放服务网格（OSM）于 2020 年 8 月推出，并于此后不久加入了 CNCF。自那以后，OSM 一直在与社区紧密合作，提供一个使用可互操作的服务网格 API 集合的简化操作服务网格体验，这些 API 集合通过[服务网格接口（SMI）](https:\/\/smi-spec.io\/)实现。\n\n服务网格社区涌现了大量的兴奋、进步和共享的想法，这些想法与 OSM 的指导原则相一致。OSM 的宪章一直是提供一个聚焦于易于消费和操作的服务网格体验。同样，另一个服务网格社区项目 Istio 也简化了操作，并且 Istio 项目继续发展和支持一组新的用例和功能，以推进未来各种工作负载，例如无 Sidecar 模式。随着 [Istio 项目加入 CNCF 的宣布](https:\/\/istio.io\/latest\/blog\/2022\/istio-accepted-into-cncf\/)，OSM 团队很高兴能够与 Istio 社区更加紧密地合作。这种合作将导致 OSM 项目在与 CNCF 的档案工作中向着 Istio 项目进行重点资源的集中。\n\n## 服务网格成熟度\n\n随着云原生采用的势头不断增强，用户需要服务网格提供的核心功能和可扩展性来支持他们的云原生微服务。增强功能，如 [Kubernetes Gateway API](https:\/\/gateway-api.sigs.k8s.io\/) 和 [用于网格管理和管控的网关 API（GAMMA）](https:\/\/gateway-api.sigs.k8s.io\/contributing\/gamma\/)，进一步凸显了服务网格在当今云原生栈中的关键重要性和成熟度。\n\n因此，服务网格正在发展以满足未来云原生工作负载的需求，这是 OSM 团队在项目路线图和技术决策方面的关注点。我们看到社区继续致力于为服务网格用户提供简化的操作体验是一个重要的投资领域，无论是在时间还是资源方面。随着社区在诸如 Gateway API 之类的功能上进行投资，例如通过 GAMMA 为标准的一组服务网格 API 和无 Sidecar 代理模式，我们认为这些是激发集体努力的领域。这些社区主导的举措为增强协作提供了坚实的基础，并创造了一个更可持续的服务网格生态系统。\n\n## 前进的道路\n\nOSM 维护人员很高兴与 Istio 社区以及 Gateway API 和 GAMMA 的项目合作，在 CNCF 提供的强大治理和协作生态系统下开展合作。Istio 项目继续发展以支持一组新的用例和功能，例如带[环境网格（Ambient Mesh）的宣布](https:\/\/istio.io\/latest\/blog\/2022\/introducing-ambient-mesh\/)的无 Sidecar 模式。\n\nOSM 团队一直致力于满足社区需求，提供亟需的服务网格功能，以解决当前问题并开发下一代服务网格技术。这个决定将使团队帮助加速实现这一目标。**此外，将不再发布 OSM 的新版本。**\n\n目前，与 Istio 的即刻兴趣和合作包括利用 Kubernetes 的 ClusterTrustBundles 功能增强 Istio 的网格证书管理体验（[RFC：ClusterTrustBundle 与 Istio 的集成](https:\/\/docs.google.com\/document\/d\/1eVKo57JVQ8QGjqRkMYGHDraS_vANJf3tTUWqqbvcylQ\/edit)），提出“安全模式”功能方法，为 Istio 提供一种简化的方式，以对最稳定的 API 进行任务关键型企业环境的防护（[提案：Istio 安全模式](https:\/\/docs.google.com\/document\/d\/1aaORW2Ak4Vfpr-N68Q04qS7iskDdF3v7lcZFQsFA_L0\/edit)），改进 Istio 的遥测体验，并与 Istio 新宣布的无 Sidecar 环境网格模式进行合作。鉴于有许多共享目标，OSM 团队认为这是一种有效和高效的协作方式，可以推动社区向前发展。我们很高兴宣布这一努力，并期待更多贡献者和维护者加入塑造下一代服务网格的发展。如果您尚未加入 Istio 的 CNCF Slack 频道，请考虑加入，成为当前和未来讨论 Istio 的一部分。\n', '\/trans\/osm-deprecated\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">开放服务网格（OSM）宣布停止更新，将与 Istio 社区更加紧密地合作，以加速实现下一代服务网格技术的发展。服务网格社区的发展，如 Kubernetes Gateway API 和 GAMMA，进一步凸显了服务网格在当今云原生栈中的关键重要性和成熟度。OSM 团队将与 Istio 社区合作，包括利用 Kubernetes 的 ClusterTrustBundles 功能增强 Istio 的网格证书管理体验，提出“安全模式”功能方法，改进 Istio 的遥测体验，并与 Istio 新宣布的无 Sidecar 环境网格模式进行合作。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/introducing-tetrate-service-express/">[译] Tetrate 推出针对 Amazon EKS 设计的服务网格解决方案 TSE</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/04/13</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://tetrate.io/blog/introducing-tetrate-service-express/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Tetrate 推出针对 Amazon EKS 设计的服务网格解决方案 TSE', 'Tetrate Service Express (TSE) 是一款基于开源软件的服务连接、安全和弹性自动化解决方案，专为 Amazon EKS 设计。', '\nTetrate Service Express (TSE) 是一款基于开源软件的服务连接、安全和弹性自动化解决方案，专为 Amazon EKS 设计。\n\n本文译自：[Tetrate Service Express 介绍](https:\/\/tetrate.io\/blog\/introducing-tetrate-service-express\/)\n\n## 快速实现 Amazon EKS 上安全和弹性的服务网格\n\n今天我们很高兴地宣布 Tetrate Service Express (TSE)，这是一款针对 Amazon EKS 的服务连接、安全和弹性自动化解决方案。我们基于 Istio 和 Envoy 等开源服务网格组件构建了 TSE，并针对 AWS 对 TSE 进行了简化安装、配置和操作的优化。如果您的团队正在 AWS 上进行服务网格实验，并且需要快速证明投资回报率，而无需掌握复杂的 Istio 和 AWS 基元，那么 TSE 就是适合您的选择！如果您的团队已经在单个集群上拥有了服务网格，但希望将网格扩展到多个集群甚至区域，那么 TSE 也可以帮助您。事实上，TSE 是唯一一款基于开源软件并针对 AWS 进行优化的产品，预先集成了最受欢迎的 AWS 服务，可在几分钟内让您上手。\n\n如果您想快速了解 Tetrate Service Express 的功能，在[此处](https:\/\/tetr8.io\/tse)加入等待列表以获取您的评估副本。\n\n如果您想深入了解 Tetrate Service Express 的新功能，请继续阅读。\n\n## 为什么选择 Tetrate Service Express\n\n如果您的组织想要创造更好的客户体验、提高运营效率或保护知识产权，那么很可能必须构建和运行软件——更高质量、更快速的发布、更好的正常运行时间。而且很可能，应用程序开发团队、运营团队和平台团队正在借助两种创新趋势来实现这些目标：云基础设施的灵活性和微服务。\n\n在云中构建微服务时，许多团队选择 Amazon EKS 的便利性。然而，随着他们扩展 EKS 工作负载，他们会发现自己面临以下问题：\n\n- 如何保护分布在 AWS 上的微服务组件？\n- 如何在更新或负载下单个组件失败时保持可靠性？\n- 当一切都是动态的，手动配置不再起作用时，如何管理服务之间的流量？\n\n越来越多的平台运营团队会在微服务之上创建一个专用的基础设施层——服务网格——它提供了跨微服务组件的服务发现、安全性、认证和可观测性。Istio 和 Envoy 是服务网格控制平面和数据平面的开源标准，但 Istio 和 Envoy 只是部分解决方案，因为它们为运行 Amazon EKS 的团队添加了新的操作复杂性。\n\n![Amazon EKS 上的服务网格挑战](image.png)\n\nTetrate Service Express 为平台团队提供了 Istio 和 Envoy 之上的服务网格自动化。它处理在 Amazon EKS 上安装和配置开源组件，与 AWS 服务集成，并为平台运营商提供管理控制台，以快速配置服务网格以实现安全、弹性和可观测性。\n\n![Tetrate Service Express 提供了一种一致的、可自动化的方法，用于在 Amazon EKS 内部和跨 Amazon EKS 连接、保护和观察服务](image-1.png)\n\n## 快速安装 Amazon EKS 和集成 AWS 服务\n\n让 Istio 在 EKS 上运行可能变得更加容易（例如使用[Tetrate Istio Distro EKS add-on](https:\/\/tetrate.io\/blog\/tid-add-on-for-eks\/)），但在您可以操作功能性服务网格之前，还需要完成更多的工作：\n\n- 如何确保所有服务网格组件都已正确安装和配置？\n- 如何定义 Istio 和 Envoy 周围的网络基础架构，以实现安全的跨集群连接和可用性？\n- 如何观察和排查网格上的服务，以协助扩展和优化？\n\nTSE 可以使用 Helm chart 轻松安装在 EKS 上，并与 Route 53 和 NLB（或其他 AWS 负载平衡器类型）轻松集成，以便您可以快速：\n\n- 定位服务的边缘和入口网关，以管理和安全地控制入口和出口流量。\n- 通过内置身份验证、速率限制、HA 和安全性提供应用程序的 API。\n- 获取服务和应用程序的 MELT（度量、事件、日志、跟踪）。\n\n![使用 Tetrate Service Express 和示例配置开始](image-2.png)\n\n## 一步式服务间的 mTLS 加密\n\n服务网格的第一个用例之一是使用 mTLS 启用服务间加密，但一旦你扩展到多个集群，事情就会很快变得复杂：\n\n- 如何在各个集群之间建立和管理单个信任根？\n- 如何在全面支持零信任姿态的情况下，强制执行 mTLS？\n- 如何定期轮换证书，并在泄漏或损坏证书的情况下做出响应？\n\nTetrate Service Express 通过提供以下内容使服务易于加密并应用零信任姿态：\n\n- 内置的易于使用的证书颁发机构，可在所有群集中轮换和管理证书。\n- 在管理级别上定义对所有服务的 mTLS 需求。\n- 从默认的拒绝所有姿态开始创建细粒度的访问策略。\n\n![默认设置 mTLS](image-3.png)\n\n## 集群和区域之间的易于故障转移设置\n\n在定义应用程序基础架构时，设置服务的内部高可用性可能是比较复杂的事情，特别是在不同的区域内。一些可能遇到的问题包括：\n\n- 如何配置 Route53、Amazon 负载均衡和其他负载均衡服务，以在不同的集群之间实现可靠的 HA？\n- 如何在没有 Hairpinning 的情况下设置跨集群通信和内部高可用性？\n- 当服务失败时如何自动化网络配置更改？\n\nTetrate Service Express 通过提供以下功能使获取服务 HA 易于实现：\n\n- 对服务发布进行自动配置的入口、Amazon 负载均衡和 Route 53。\n- 为内部高可用性自动配置内部和东\/西网关。\n- 动态重新配置网络规则，以在最小中断的情况下在集群之间和之间传输流量。\n\n![配置跨区域故障转移](image-4.png)\n\n## 接下来\n\n这只是我们要从 Tetrate Service Express 中突出显示的一些功能。Tetrate Service Express 将在本月晚些时候发布技术预览版，但是您现在可以加入等待列表，以在发布时获取评估副本。一旦您加入等待列表，我们将与您联系，向您提供访问评估软件、新文档门户网站和 Slack 社区频道的信息。\n\n我们还计划推出一系列额外的博客、视频和网络研讨会，以展示更多 TSE 的功能。下一场网络研讨会定于 5 月举行，请[立即注册](https:\/\/app.livestorm.co\/p\/06a20bee-58b0-4976-977d-c2e4b16dbe68)。最后，请不要忘记在[Twitter](https:\/\/twitter.com\/Tetrateio)或[LinkedIn](https:\/\/www.linkedin.com\/company\/tetrate)上关注 Tetrate，以便在新的 TSE 内容可用时获得即时更新！\n', '\/trans\/introducing-tetrate-service-express\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">Tetrate Service Express (TSE) 是一款基于开源软件的服务连接、安全和弹性自动化解决方案，专为 Amazon EKS 设计。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/trans/understanding-istio-and-open-policy-agent-opa/">[译] Istio 中的外部授权过滤器：使用 OPA 实现灵活的授权策略</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/03/28</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fas fa-language"></i>
              <a href="https://tetrate.io/blog/understanding-istio-and-open-policy-agent-opa/" target="_blank" rel="noopener">原文</a>
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('Istio 中的外部授权过滤器：使用 OPA 实现灵活的授权策略', '本文介绍了如何将服务网格和开放策略代理（OPA）结合使用，以实现基于身份的分割的五个策略检查。服务网格为前四项检查提供了执行点，而 OPA 则在第五项中发挥作用。本文还探讨了如何将特定于业务的策略应用于请求，以及如何使用 OIDC 或专用授权基础设施来实现最终用户对资源的授权。', '\n客户向我们询问服务网格实践中关于开放策略代理 (OPA) 和服务网格如何结合使用的问题。我们探讨了关于服务网格和 OPA 策略的最佳实践，以及它们如何相互补充的想法。为了构建讨论框架，我们使用了 NIST 的零信任架构标准。在即将发布的 NIST 标准文档特别出版物 800-207A 中，基于身份的分段是一个主要概念。最低标准包括五项策略检查，应应用于进入的每个请求系统和每个后续跃点。您可以观看我们在今年的 CloudNativeSecurityCon 上与来自 NIST 的 Ramaswami Chandramouli 进行的深入讨论的[演示](https:\/\/www.youtube.com\/watch?v=s2lIaFhkA8c)。\n\n**使用服务网格实现基于身份的分割的五个策略检查：**\n\n1. 传输中加密\n2. 服务身份和认证\n3. 服务到服务授权\n4. 最终用户身份和身份验证\n5. 最终用户对资源的授权\n\n简而言之，服务网格是一个专用的基础设施层，专门用于为前四项检查实施策略，并在第五项中发挥一定作用。OPA 的亮点在于第五点：最终用户对资源的授权。\n\nIstio 的 sidecar 代理充当微服务应用程序的安全内核。Envoy 数据平面是一个通用的策略执行点 (PEP)，可以拦截所有流量并可以在应用层应用策略。就此而言，它是一个参考监视器 ( [NIST SP 800-204B](https:\/\/csrc.nist.gov\/publications\/detail\/sp\/800-204b\/final) )。将 Envoy 作为 PEP，我们可以将安全问题从应用程序转移到网格中。\n\n策略**检查 1-2：传输中的加密和服务身份与认证**。为了满足前两个策略检查、传输中的加密以及服务身份和身份验证，网格为系统中的所有通信实施 mTLS。\n\n**策略检查 3：服务到服务授权。** 服务网格还提供策略三，即服务到服务的授权。OPA 可以在这里开始发挥作用，但由于 OPA 是通用的，它没有围绕服务通信的 DSL，因此您必须自己创建它。另一方面，我们认为策略往往更自然，更容易用专为它构建的语言来表达。服务网格 —— 更重要的是，我们在 Istio 之上构建的应用程序连接和安全平台 [Tetrate Service Bridge](https:\/\/tetrate.io\/tetrate-service-bridge\/)—— 具有对编写服务到服务策略有意义的名词。\n\n**策略检查 4：最终用户身份和身份验证。** 对于第四个策略检查，我们需要在系统的每一跳验证最终用户身份。服务网格提供执行点来进行检查，但有关用户身份验证的实际决定既不在服务网格领域也不在 OPA 范围内。相反，我们需要委托给受信任的身份提供者来在此处做出判决。\n\n**策略检查 5：最终用户对资源的授权。** 零信任云原生访问控制的第五个策略检查是 OPA 可以发挥重要作用的地方。服务网格没有最终用户和资源之间关系的模型，因此不适合编写有关它的策略。NIST 的指南是通过 OIDC 与现有系统集成或利用专用授权基础设施 —— 例如，NIST 的下一代访问控制 (NGAC) 和 Open Policy Agent。\n\n例如，以媒体流服务及其播放列表为例。我们可能需要授权最终用户访问数百万到数十亿个播放列表。就像 OPA 不是特别适合服务到服务的授权一样，Istio 授权策略也不适合最终用户到资源的授权；但是，OPA 适合。\n\nOPA 也非常适合超越 NIST ZTA 策略框架的步骤：**将特定于业务的策略应用于请求。** 在我们完成零信任的五项策略检查之后，我们可以委托 OPA 作为规则引擎来执行业务策略。\n\n在接下来的几个月里，我们将对此发表更多看法，尤其是在 SP 800-207A 进入起草过程时。但是，与此同时，我们在 Cloud Native Security Con 上的谈话录音对这些问题进行了更深入的讨论：\n\n- [ZTA 基于身份的分割 ——Zack Butcher、Tetrate 和 Ramaswamy Chandramouli，NIST](https:\/\/www.youtube.com\/watch?v=s2lIaFhkA8c)\n- [赞助主题演讲：从 Google 到 NIST — 云原生安全的未来 — Zack Butcher，Tetrate](https:\/\/www.youtube.com\/watch?v=YdcVALVwwY4)\n', '\/trans\/understanding-istio-and-open-policy-agent-opa\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">本文介绍了如何将服务网格和开放策略代理（OPA）结合使用，以实现基于身份的分割的五个策略检查。服务网格为前四项检查提供了执行点，而 OPA 则在第五项中发挥作用。本文还探讨了如何将特定于业务的策略应用于请求，以及如何使用 OIDC 或专用授权基础设施来实现最终用户对资源的授权。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
              <div class="col-sm-6 mb-3">
  <article class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow">
    
    
    <div class="card-body blog-list-card-body">
      <p class="card-title"><a href="/blog/tsb-tips/">关于 TSB 你应该知道的事情</a></p>
      
      <div class="blog-list-metadata">
          <ul class="list-inline">
             
             <li class="list-inline-item mr-2 mb-md-0"><i class="fa-regular fa-calendar"></i>
               2023/02/22</li>
             <li class="list-inline-item mr-2 md-md-0"><i class="fa-regular fa-folder-open"></i>
             
             <a href="/categories/service-mesh"> 
             Service Mesh
             </a>
             
             </li>
             
             <li class="list-inline-item mr-2 mb-md-0">
              

             </li>
             
             <li class="list-inline-item mr-2 mb-md-0 export-button" style="display: none;">
              <a href="#" onclick="exportToMarkdown('关于 TSB 你应该知道的事情', '如果你对服务网格（Service Mesh）和 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中很多疑惑。', '\n本文假设你熟悉服务网格和 Istio，对 Tetrate 出品的商业化服务网格管理工具 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中的一些困惑。\n\n本文中包含了：\n\n- 关于 TSB 的一些 FAQ\n- TSB 的一些基本资源对象\n- TSB 实现的一些细节\n\n## TSB FAQ\n\n笔者将罗列一些关于 TSB 的知识点，主要是关于它与 Istio 之间的不同点：\n\n1. TSB 全称 Tetrate Service Bridge，是 Tetrate 公司的旗舰产品，首发于 2018 年，目前版本是 1.7，这是一款商业化产品，你需要购买才能使用，如果想要了解更多或请求试用请在[这里](https:\/\/tetrate.io\/tetrate-service-bridge\/)登记；\n2. TSB 可以私有化部署也可以在 GKE、AWS、Azure、OpenShift、EKS Anywhere 等平台中单独或跨平台部署；\n3. TSB 并不是对 Istio 的改进版，它是在 Istio 之上建立的管理平面，它可以与 Istio 完全兼容，并适配最新版的 Istio；\n4. TSB 并不是 Kubernetes 管理平台，它不能用于管理 Kubernetes 中的资源；\n5. TSB 是基于 Istio、Envoy 和 Apache SkyWalking 构建；\n6. TSB 通过定义 Tenant、Workspace 等资源对象为 Istio 增加了多租户和多集群管理功能；\n7. 为了实现多集群服务网格的管理，TSB 中定义了一系列 Group 资源，如 Traffic、Security、Gateway 等，这些 CRD 最终将转化为 Istio 中的 CRD 应用到服务网格；\n8. TSB 定义了 Tier1Gateway CRD 实现了跨集群的二层网关；\n9. TSB 部署和管理比较复杂，Tetrate 即将推出轻量级的 Tetrate Service Express（TSE）简化服务网格管理；\n\n## TSB 中的资源对象 {#tsb-resources}\n\n图 1 展示了 TSB 的基本资源对象，其中只要分为五大类：\n\n- 为了实现多租户和多集群管理的资源对象，如 Tenant、Organization、Workspace 等；\n- 主要功能对象配置组，如 Traffic、Security、Gateway 等；\n- Istio 原生 CRD；\n- 角色和权限管理；\n- 其他扩展；\n\n![图 1：Tetrate Service Bridge 中的资源对象](tsb-crd.svg)\n\nTSB 是建立在 Istio 之上的，下表中列出了 TSB 中的可以通过 tctl 命令获取的资源对象，其中部分名称与 Kubernetes 中原生资源对象重复，但它们并不相同：\n\n| **名称**                    | **说明**                                                     |\n| --------------------------- | ------------------------------------------------------------ |\n| ApplicationAccessBindings   | 配置应用程序用户访问权限。                                   |\n| AccessBindings              | 为 TSB 中任何资源的用户分配访问角色的配置。                  |\n| AuthorizationPolicy         | 同 Istio 中的授权策略。                                      |\n| APIAccessBindings           | 配置 API 用户访问权限。                                      |\n| Application                 | 应用程序的配置，应用程序表示一组相互关联的服务逻辑分组，并公开一组实现完整业务逻辑的 API。 |\n| Cluster                     | Kubernetes 集群。要想将 Kubernetes 集群纳入 TSB 管理，首先需要声明 Cluster 添加，然后是部署 TSB Agent 和控制平面（包括 Istio、XCP、GitOps、OAP 等组件）。 |\n| DestinationRule             | Istio 原生 CRD，主要用来划分可路由的集群及负载均衡规则。     |\n| EnvoyFilter                 | Istio 原生 CRD，主要用来扩展 Envoy 的功能。                  |\n| EgressGateway               | 配置工作负载作为出口网关。                                   |\n| GatewayAccessBindings       | 配置网关组用户访问权限。                                     |\n| GatewayGroup                | 网关组。                                                     |\n| Gateway                     | 管理 TSB 中设置的网关，而非 Istio 中的原生 Gateway CRD。     |\n| IstioInternalAccessBindings | 为 Istio 内部组的用户分配访问角色的配置。                    |\n| IngressGateway              | 配置负载作为入口网关，类似于 Istio 中的原生 Gateway。        |\n| IstioInternalGroup          | 配置 Istio 内部的 TSB 资源。                                 |\n| OrganizationAccessBindings  | 配置组织用户访问权限。                                       |\n| Organization                | 组织。                                                       |\n| OrganizationSetting         | 组织的默认配置，如区域 Failover、安全、流量、网络配置等。    |\n| Metric                      | 运行时获取的服务度量。                                       |\n| Source                      | Sources 服务公开了管理来自资源的遥测源。                     |\n| PeerAuthentication          | Istio 原生 CRD，配置对等认证（配置 mTLS）。                  |\n| RequestAuthentication       | Istio 原生 CRD，配置请求认证（JWT 规则配置）。               |\n| ServiceAccount              | 不同于 Kubernetes 中的原生资源对象，TSB 自定义的服务账号配置。 |\n| SecurityAccessBindings      | 配置安全组用户访问权限。                                     |\n| Sidecar                     | 配置预安装的 Istio Sidecar。                                 |\n| ServiceEntry                | Istio 原生 CRD，添加服务对象。                               |\n| SecurityGroup               | 安全配置组。                                                 |\n| ServiceRoute                | 配置服务路由。                                               |\n| SecuritySetting             | 安全设置将配置应用于 SecurityGroup 或 Workspace 中的一组代理工作负载。当应用于 SecurityGroup 时，缺失的字段将从 Workspace 范围设置继承值 (如果有的话)。 |\n| ServiceSecuritySetting      | 安全组配置。                                                 |\n| Service                     | 注册中心中的服务，表示所有这些单独服务的聚合和逻辑视图，并提供聚合指标等高级功能。 |\n| Tier1Gateway                | TSB 一级网关配置，指定网关负载。                             |\n| TrafficAccessBindings       | 流量访问角色配置。                                           |\n| TrafficGroup                | 流量管理组。                                                 |\n| TenantAccessBindings        | 租户角色配置。                                               |\n| TenantSetting               | 租户配置。                                                   |\n| TrafficSetting              | 流量配置。                                                   |\n| VirtualService              | Istio 原生 CRD，配置流量路由。                               |\n| WorkspaceAccessBindings     | Workspace 角色配置。                                         |\n| WasmExtension               | 配置管理 Wasm 扩展。                                         |\n| WasmPlugin                  | Istio 原生 CRD，配置 Wasm 插件。                             |\n| Workspace                   | 划定工作空间。                                               |\n| WorkspaceSetting            | 配置工作空间。                                               |\n\n你可以使用 tctl 命令行工具来管理 TSB，它的使用方法与 kubectl 类似，上面的列表是使用 \u0060tctl get\u0060 命令可以列出的资源对象。实际上 TSB 中的资源对象不止这些，关于 TSB 中 API 资源的详细说明请参考 [TSB 文档](https:\/\/docs.tetrate.io\/service-bridge\/1.6.x\/en-us\/reference)。\n\n## TSB 架构 {#tsb-arch}\n\n我在上文中提到，TSB 是在 Istio 之上构建的管理平面，为 Istio 增加了多租户和多集群管理功能，TSB 的组件架构及其功能如图 2 所示。\n\n![图 2：TSB 组件架构图](tsb-arch.svg)\n\nTSB 的全局控制平面可以和管理平面部署在同一个 Kubernetes 集群中，也可以单独部署。\n\nTSB 管理平面的架构如图 3 所示。\n\n![图 3：TSB 管理平面架构图](tsb-management-plane.svg)\n\n管理平面与各个 Kubernetes 集群中的 Istio 联系，管理多集群环境下的服务网格。\n\nTSB 控制平面的架构如图 4 所示。\n\n![图 4：TSB 控制平面架构](tsb-control-plane.svg)\n\n为了实现跨集群的多租户管理，TSB 定义了一系列逻辑对象，如图 5 所示。\n\n![图 5：TSB 中的多租户管理层级](tsb-resource-hierarchy.svg)\n\n## 更多 {#more}\n\n如果您不熟悉服务网格和 Kubernetes 安全性，我们在 [Tetrate Academy](https:\/\/tetr8.io\/academy) 提供了一系列免费在线课程，可以让您快速了解 Istio 和 Envoy。\n\n如果您正在寻找一种快速将 Istio 投入生产的方法，请查看 [Tetrate Istio Distribution (TID)](https:\/\/tetr8.io\/tid)。TID 是 Tetrate 的强化、完全上游的 Istio 发行版，具有经过 FIPS 验证的构建和支持。这是开始使用 Istio 的好方法，因为您知道您有一个值得信赖的发行版，有一个支持您的专家团队，并且如果需要，还可以选择快速获得 FIPS 合规性。\n\n一旦启动并运行 Istio，您可能需要更简单的方法来管理和保护您的服务，而不仅仅是 Istio 中可用的方法，这就是 Tetrate Service Bridge 的用武之地。您可以[在这里](https:\/\/tetr8.io\/tsb)详细了解 Tetrate Service Bridge 如何使服务网格更安全、更易于管理和弹性，或[联系我们进行快速演示](https:\/\/tetr8.io\/contact)。 \n\n## 参考 {#refrence}\n\n- [TSB 简介 - tetrate.io](https:\/\/tetrate.io\/tetrate-service-bridge\/)\n- [TSB 文档 - docs.tetrate.io](https:\/\/docs.tetrate.io\/service-bridge\/)\n- [TSB API 参考 - docs.tetrate.io](https:\/\/docs.tetrate.io\/service-bridge\/1.6.x\/en-us\/reference)\n', '\/blog\/tsb-tips\/')">
                <i class="fas fa-file-download"></i>
              </a>
             </li>
          </ul>
      </div>
      <p class="card-text">如果你对服务网格（Service Mesh）和 Tetrate Service Bridge 感兴趣，那么这篇文章可以解答你心中很多疑惑。</p>
    </div>
  </article>
</div>


<script>
  function convertImageLinks(rawContent, permalink) {
      
      const baseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const blogPath = permalink.replace(/^\/|\/$/g, ''); 
      return rawContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, altText, relativePath) {
          
          if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {
              return match; 
          }
          return `![${altText}](${baseUrl}${blogPath}/${relativePath})`;
      });
  }
  
  function convertRelativeLinks(rawContent) {
      
      const domain = 'https://jimmysong.io'; 
      return rawContent.replace(/\[([^\]]+)\]\((\/[^)]+)\)/g, function(match, linkText, relativePath) {
          return `[${linkText}](${domain}${relativePath})`;
      });
  }
  
  function exportToMarkdown(title, description, rawContent, permalink) {
      const githubBaseUrl = 'https://raw.githubusercontent.com/rootsongjc/rootsongjc.github.io/master/'; 
      const filename = title + '.md';
  
      
      const convertedContent = convertImageLinks(rawContent, permalink);
      
      
      const contentWithLinks = convertRelativeLinks(convertedContent);
  
      
      const contentWithHeader = `> ${description}\n>\n> 阅读原文请转到：https://jimmysong.io${permalink}\n${contentWithLinks}`;
  
      
      const contentWithFooter = `${contentWithHeader}\n\n---\n`;
  
      
      const element = document.createElement('a');
      element.setAttribute('href', 'data:text/markdown;charset=utf-8,' + encodeURIComponent(contentWithFooter));
      element.setAttribute('download', filename);
  
      element.style.display = 'none';
      document.body.appendChild(element);
  
      element.click();
  
      document.body.removeChild(element);
  }
  
  
  if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
      document.querySelectorAll('.export-button').forEach(function(button) {
          button.style.display = 'inline';
      });
  }
</script>
          
          <div class="col-12">
 
 
 
 
 
 
 
 
 
 
 
 <nav aria-label="Page navigation">
   <ul class="pagination justify-content-center">
     
     
     
     
     
     
       
       
       
         
       
       
       
         <li class="page-item page-item active ">
           <a href="/categories/service-mesh/" class="page-link">
             1
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/categories/service-mesh/page/2/" class="page-link">
             2
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/categories/service-mesh/page/3/" class="page-link">
             3
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/categories/service-mesh/page/4/" class="page-link">
             4
           </a>
         </li>
       
     
       
       
       
         
       
       
       
         <li class="page-item">
           <a href="/categories/service-mesh/page/5/" class="page-link">
             5
           </a>
         </li>
       
     
     
     
     <li class="page-item">
       <a href="/categories/service-mesh/page/2/" class="page-link">
         »
       </a>
     </li>
     
     
     
     <li class="page-item">
       <a class="page-link" href="/categories/service-mesh/page/5/">
         »»
       </a>
     </li>
     
   </ul>
 </nav>
 
</div>

        </div>
      </div>
      <!-- sidebar -->
      <aside class="col-lg-4 order-1 order-lg-2 d-none d-sm-block">
          <div class="sidebar">
          <!-- categories -->
<div class="blog-categories mb-4">
  <p class="sidebar-title">
      专栏
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/istio" class="sidebar-item">
            <span>Istio</span>
            <span>(81)</span>
        </a>
      
        <a href="/categories/service-mesh" class="sidebar-item">
            <span>Service Mesh</span>
            <span>(42)</span>
        </a>
      
        <a href="/categories/kubernetes" class="sidebar-item">
            <span>Kubernetes</span>
            <span>(25)</span>
        </a>
      
        <a href="/categories/%e9%9a%8f%e7%ac%94" class="sidebar-item">
            <span>随笔</span>
            <span>(22)</span>
        </a>
      
        <a href="/categories/%e5%85%b6%e4%bb%96" class="sidebar-item">
            <span>其他</span>
            <span>(19)</span>
        </a>
      
        <a href="/categories/envoy" class="sidebar-item">
            <span>Envoy</span>
            <span>(18)</span>
        </a>
      
        <a href="/categories/%e4%b8%9a%e6%80%81" class="sidebar-item">
            <span>业态</span>
            <span>(17)</span>
        </a>
      
        <a href="/categories/%e4%ba%91%e5%8e%9f%e7%94%9f" class="sidebar-item">
            <span>云原生</span>
            <span>(14)</span>
        </a>
      
        <a href="/categories/ai" class="sidebar-item">
            <span>AI</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%ae%89%e5%85%a8" class="sidebar-item">
            <span>安全</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e5%bc%80%e6%ba%90" class="sidebar-item">
            <span>开源</span>
            <span>(9)</span>
        </a>
      
        <a href="/categories/%e6%97%85%e8%a1%8c" class="sidebar-item">
            <span>旅行</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e5%b7%a5%e5%85%b7" class="sidebar-item">
            <span>工具</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8f%af%e8%a7%82%e6%b5%8b%e6%80%a7" class="sidebar-item">
            <span>可观测性</span>
            <span>(5)</span>
        </a>
  </div>
</div>

<div class="blog-categories mb-4">
  <p class="sidebar-title">
      资料
  </p>
  
  
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
        
      
      
  
  <div class="bg-gray">
      
        <a href="/categories/%e5%87%ba%e7%89%88%e7%89%a9" class="sidebar-item">
            <span>出版物</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e7%94%b5%e5%ad%90%e4%b9%a6" class="sidebar-item">
            <span>翻译电子书</span>
            <span>(8)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e6%96%87%e6%a1%a3" class="sidebar-item">
            <span>翻译文档</span>
            <span>(7)</span>
        </a>
      
        <a href="/categories/%e7%bf%bb%e8%af%91%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>翻译图书</span>
            <span>(6)</span>
        </a>
      
        <a href="/categories/%e5%8e%9f%e5%88%9b%e5%9b%be%e4%b9%a6" class="sidebar-item">
            <span>原创图书</span>
            <span>(2)</span>
        </a>
      
        <a href="/categories/%e6%95%99%e7%a8%8b%e6%89%8b%e5%86%8c" class="sidebar-item">
            <span>教程手册</span>
            <span>(2)</span>
        </a>
  </div>
</div>





          </div>
      </aside>
      <!-- /sidebar -->
    </div>
  </div>
</section>




<footer>
  
  <div class="footer bg-footer section-sm border-bottom overlay ">
    <div class="container-xl">
      <div class="row">
        <div class="col col-xl-4 d-sm-none mb-2 mb-lg-0 d-xl-block d-none">
          
          <p class="h3 text-white mb-4 text-uppercase">联系</p>
          
          <ul class="list-unstyled">
            
            
            <li class="mb-4 text-color">微信公众号</li>
            
            
            <li class="mb-4"><img src="/images/servicemesher-wechat.webp" width="118px" height="118px" alt="footer image"></li>
            
            
            
          
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">博客</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/blog/envoy-ext-proc-guide/">深入解析 Envoy 外部处理过滤器（ext_proc）</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/istio-ambient-l7-flow-analysis/">深入 Istio Ambient 模式：从 ztunnel 到 Waypoint 代理的 L7 流量路径解析</a></li>
            
            <li class="mb-3"><a class="text-color" href="/blog/building-private-ai-knowledge-base-anythingllm/">探索 AnythingLLM：借助开源 AI 打造私有化智能知识库</a></li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">链接</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://istio.io/latest/zh/" target="_blank" rel="noopener noreferrer">
                  Istio 服务网格
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://tetrate.io/?jimmysong" target="_blank" rel="noopener noreferrer">
                  Tetrate 公司
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://space.bilibili.com/515485124" target="_blank" rel="noopener noreferrer">
                  云原生学院|Bilibili
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/awesome-cloud-native/" target="_blank" rel="noopener noreferrer">
                  云原生开源项目大全
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://cloudnative.to" target="_blank" rel="noopener noreferrer">
                  云原生社区（中国）
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">教程</p>
          <ul class="list-unstyled">
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Envoy 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="https://academy.tetrate.io/courses/istio-fundamentals-zh" target="_blank" rel="noopener noreferrer">
                  Istio 基础教程
                  
                  <i class="fa-solid fa-arrow-up-right-from-square icon-small"></i>
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/kubernetes-handbook/" >
                  Kubernetes 基础教程
                  
              </a>
            </li>
            
            <li class="mb-3">
              <a class="text-color" href="/book/envoy-made-simple/" >
                  简明 Envoy 教程
                  
              </a>
            </li>
            
          </ul>
        </div>

        
        <div class="col col-xl-2 col-6 col-sm-3 mb-2">
          <p class="h3 text-white mb-4 text-uppercase">通知</p>
          <ul class="list-unstyled">
            
            <li class="mb-3"><a class="text-color" href="/notice/nist-sp-800-233-service-mesh-proxy-models/">资料分享：云原生应用服务网格代理模型的威胁分析指南</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/kubecon-china-2024-panel/">KubeCon China 2024（香港）</a></li>
            
            <li class="mb-3"><a class="text-color" href="/notice/website-revamp-notice/">网站改版通知</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

  
  <div class="copyright py-4 bg-footer overlay">
    <div class="container-xl">
      <div class="row">
        <div class="col-sm-6 text-sm-left text-center">
          <p class="mb-0 text-color">© 2017-2024 Jimmy Song 保留所有权利</p>
        </div>
        <div class="col-sm-6 text-sm-right text-center">
          <ul class="list-inline">
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://twitter.com/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/contact/" >
                    <i class="fa-brands fa-weixin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://github.com/rootsongjc" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-github text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="https://linkedin.com/in/jimmysongio" target="_blank" title="Social link" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="mailto:rootsongjc@gmail.com" >
                    <i class="fa-solid fa-envelope text-white"></i>
              </a>
            </li>
            
            <li class="list-inline-item">
              <a class="d-inline-block p-2" href="/blog/index.xml" >
                    <i class="fa-solid fa-rss text-white"></i>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<!-- JS Plugins -->

<script src="/plugins/popper/popper.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/filterizr/jquery.filterizr.min.js"></script>

<script src="/plugins/search/fuse.min.js"></script>

<script src="/plugins/search/mark.js"></script>

<script src="/plugins/hex_md5/hex_md5.js"></script>

<script src="/plugins/anchor/anchor.min.js"></script>

<script src="/plugins/tocbot/tocbot.min.js"></script>

<script src="/plugins/bigger-picture/bigger-picture.min.js"></script>


<!-- Main Script -->

<script src="/js/script.min.f94c22b1d478bfc9e2e0a7d954429e47b7e6d36edd423758482e04154ae1842e.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-ESY906ZWZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ESY906ZWZ0');
</script>


<!-- Baidu analysis -->
<meta name="baidu-site-verification" content="g8IYR9SNLF" />










<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>










<script src="/js/wowchemy-search.min.7a37268e7bbe4a9160c2e4c33b749816.js" type="module"></script>
<script id="search-hit-fuse-template" type="text/x-template">
  <div class="search-hit" id="summary-{{key}}">
    <div class="search-hit-content border-bottom">
      <div class="search-hit-name">
        <div class='search-hit-link'><a href="{{relpermalink}}">{{title}}</a></div>
        <div class="search-hit-metadata d-flex">
            <span class="mr-1"><i class="fa-regular fa-calendar mr-1"></i>{{date}}</span>
            <span class="mr-1"><i class="fa-regular fa-folder-open mr-1"></i>{{section}}</span>
            <span class="d-sm-block d-none"><i class="fa-solid fa-link mr-1"></i>{{relpermalink}}</span>
        </div>
        <div class="search-hit-description">{{snippet}}</div>
      </div>
    </div>
  </div>
</script>



    </body>
</html>
