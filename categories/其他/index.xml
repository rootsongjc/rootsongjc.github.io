
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Jimmy Song â€“ å…¶ä»–</title>
    <link>https://jimmysong.io/categories/%E5%85%B6%E4%BB%96/</link>
    <description>Recent content in å…¶ä»– on Jimmy Song</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <managingEditor>Jimmy Song</managingEditor>
    <webMaster>Jimmy Song</webMaster>
    
      <follow_challenge>
        <feedId>51621818828612637</feedId>
        <userId>59800919738273792</userId>
      </follow_challenge>
    
    
    <lastBuildDate>Sun, 13 Apr 2025 19:22:45 +0800</lastBuildDate>
    
	  <atom:link href="https://jimmysong.io/categories/%E5%85%B6%E4%BB%96/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
                                                         
    
                                                   
                           
    <item>
      <title>KubeCon EU 2025 å‚ä¼šæŠ¥å‘Šï¼šå¡‘é€ äº‘åŸç”Ÿæ ¼å±€çš„æ´å¯Ÿä¸è¶‹åŠ¿</title>
      <link>https://jimmysong.io/blog/kubecon-eu-2025-london-recap/</link>
      <pubDate>Sun, 13 Apr 2025 19:22:45 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/kubecon-eu-2025-london-recap/</guid>
      <description>
        
        
        &lt;p&gt;ä¸Šå‘¨ï¼Œæˆ‘å‰å¾€ä¼¦æ•¦å‚åŠ äº† &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-europe/&#34; title=&#34;KubeCon &amp;#43; CloudNativeCon Europe 2025&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;KubeCon + CloudNativeCon Europe 2025&lt;/a&gt;ï¼Œè¿™æ˜¯äº‘åŸç”Ÿé¢†åŸŸåœ¨æ¬§æ´²ä¸€å¹´ä¸€åº¦çš„ç››ä¼šã€‚ä»Šå¹´çš„å¤§ä¼šæ±‡èšäº†è¶…è¿‡ 12,500 åå¼€å‘è€…ã€ç»´æŠ¤è€…å’Œç”¨æˆ·ï¼Œåœºé¢çƒ­çƒˆã€è¯é¢˜æ·±åº¦åè¶³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´å¥½åœ°æ€»ç»“è¿™æ¬¡å¤§ä¼šçš„å†…å®¹å’Œè¶‹åŠ¿ï¼Œæˆ‘åˆ¶ä½œäº†ä¸€ä»½ &lt;strong&gt;HTML/PDF æ ¼å¼çš„æŠ¥å‘Š&lt;/strong&gt;ï¼Œå¯¹é‡ç‚¹ä¸»é¢˜è¿›è¡Œäº†å½’çº³ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AI åœ¨ Kubernetes ä¸­çš„è½åœ°ä¸è¶‹åŠ¿&lt;/li&gt;
&lt;li&gt;å®‰å…¨ç­–ç•¥æ¼”è¿›ï¼ˆä¾›åº”é“¾ã€èº«ä»½ä¿¡ä»»ç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;å¹³å°å·¥ç¨‹ä»å·¥å…·èµ°å‘ä½“éªŒä¸æŒ‡æ ‡&lt;/li&gt;
&lt;li&gt;å¤šé›†ç¾¤ä¸è¾¹ç¼˜è®¡ç®—çš„ç°å®åº”ç”¨&lt;/li&gt;
&lt;li&gt;å¯æŒç»­æ€§ä¸ç»¿è‰²è®¡ç®—çš„å‘¼å£°å¢å¼º&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸ‘‰ &lt;a href=&#34;https://jimmysong.io/files/zh/kubecon-eu-2025-london-recap.html&#34; title=&#34;ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š&#34;&gt;&lt;strong&gt;ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¬¢è¿ä½ é˜…è¯»æŠ¥å‘Šï¼Œä¹Ÿæ¬¢è¿é€šè¿‡è¯„è®ºã€é‚®ä»¶ç­‰æ–¹å¼ä¸æˆ‘äº¤æµä½ å¯¹å¤§ä¼šè¶‹åŠ¿çš„çœ‹æ³•ï¼&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>Cilium 2024 å¹´åº¦æŠ¥å‘Šè§£è¯»</title>
      <link>https://jimmysong.io/blog/cilium-annual-report-2024/</link>
      <pubDate>Tue, 07 Jan 2025 18:28:38 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/cilium-annual-report-2024/</guid>
      <description>
        
        
        &lt;p&gt;è¿‘æ—¥ Cilium é¡¹ç›®å‘å¸ƒäº† 2024 å¹´åº¦æŠ¥å‘Šï¼Œè§ &lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium_Annual_Report_2024.pdf&#34; title=&#34;Github&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github&lt;/a&gt;ã€‚è¿™ä»½æŠ¥å‘Šè¯¦ç»†å›é¡¾äº† Cilium åœ¨è¿‡å»ä¸€å¹´ä¸­æ‰€å–å¾—çš„é‡å¤§æˆå°±ï¼Œå¹¶å±•æœ›äº†å…¶åœ¨äº‘åŸç”Ÿç½‘ç»œå’Œå®‰å…¨é¢†åŸŸçš„æœªæ¥å‘å±•æ–¹å‘ã€‚Cilium é¡¹ç›®è‡ªé¦–æ¬¡æäº¤ä»¥æ¥ï¼Œå†ç»è¿‘åå¹´å‘å±•ï¼Œå…¶åŠ¿å¤´æŒç»­å¼ºåŠ²ï¼Œæ­£å¼•é¢†äº‘åŸç”Ÿç½‘ç»œå’Œå®‰å…¨é¢†åŸŸçš„æ–°å˜é©ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cilium-annual-report-2024/f1.svg&#34; data-img=&#34;/blog/cilium-annual-report-2024/f1.svg&#34; alt=&#34;image&#34; data-caption=&#34;Cilium 2024 å¹´åº¦æŠ¥å‘Šæ¦‚è¿°&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Cilium 2024 å¹´åº¦æŠ¥å‘Šæ¦‚è¿°&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;h2 id=&#34;cilium-çš„å“è¶Šå‘å±•&#34;&gt;Cilium çš„å“è¶Šå‘å±•&lt;/h2&gt;
&lt;p&gt;2024 å¹´æ˜¯ Cilium å‘å±•å†ç¨‹ä¸­è‡³å…³é‡è¦çš„ä¸€å¹´ï¼Œå®ƒä¸ä»…å·©å›ºäº†å…¶ä½œä¸º Kubernetes äº‹å®æ ‡å‡† CNI çš„åœ°ä½ï¼Œæ›´å‘å±•æˆä¸º Kubernetes ç¯å¢ƒä¸‹çš„ç»¼åˆç½‘ç»œå †æ ˆã€‚Cilium çš„æ¼”è¿›å±•ç¤ºäº†å…¶åº”å¯¹ç°ä»£äº‘åŸç”Ÿç¯å¢ƒæŒ‘æˆ˜çš„å“è¶Šèƒ½åŠ›ï¼Œä»æœ€åˆçš„ pod åˆ° pod è¿æ¥æ–¹æ¡ˆï¼Œæ‰©å±•åˆ°ä¸€ä¸ªç»Ÿä¸€ç½‘ç»œã€å¯è§‚å¯Ÿæ€§å’Œå®‰å…¨æ€§çš„é¡¹ç›®ï¼Œè¿™ä¸€åˆ‡éƒ½ç”± eBPF æŠ€æœ¯é©±åŠ¨ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cilium-annual-report-2024/f2.svg&#34; data-img=&#34;/blog/cilium-annual-report-2024/f2.svg&#34; alt=&#34;image&#34; data-caption=&#34;Cilium åœ¨ 2024 å¹´çš„æ¼”å˜&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Cilium åœ¨ 2024 å¹´çš„æ¼”å˜&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;h2 id=&#34;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&#34;&gt;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&lt;/h2&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cilium-annual-report-2024/f3.svg&#34; data-img=&#34;/blog/cilium-annual-report-2024/f3.svg&#34; alt=&#34;image&#34; data-caption=&#34;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¤¾åŒºè“¬å‹ƒå‘å±•&lt;/strong&gt;ï¼šCilium ç¤¾åŒºæŒç»­å£®å¤§ï¼Œè´¡çŒ®è€…å’Œè´¡çŒ®å…¬å¸æ•°é‡ä¸æ–­å¢åŠ ï¼Œç”¨æˆ·éå¸ƒé‡‘èã€ç‰©æµã€åª’ä½“ã€ç”µä¿¡ç­‰ä¼—å¤šè¡Œä¸šã€‚è‡ªåŠ å…¥ CNCF ä»¥æ¥ï¼Œè´¡çŒ®å…¬å¸æ•°é‡å¢é•¿äº† 90%ï¼Œè¾¾åˆ° 1,011 å®¶ï¼Œä¸ªäººè´¡çŒ®è€…å¢é•¿äº† 252%ï¼Œè¾¾åˆ° 4,464 äººã€‚Cilium è¿˜æ˜¯ CNCF ç”Ÿæ€ç³»ç»Ÿä¸­ç¬¬ä¸‰å¤§å‘å±•æœ€å¿«çš„é¡¹ç›®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯åˆ›æ–°&lt;/strong&gt;ï¼šCilium åœ¨ 2024 å¹´å‘å¸ƒäº† 1.15 å’Œ 1.16 ä¸¤ä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œå¸¦æ¥äº†è¯¸å¤šåˆ›æ–°åŠŸèƒ½ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cilium 1.15&lt;/strong&gt;: å¼•å…¥äº†å¯¹ Gateway API 1.0 çš„å…¨é¢æ”¯æŒï¼Œä½¿ Cluster Mesh çš„å¯æ‰©å±•æ€§ç¿»å€ï¼Œå¢å¼ºäº†å¯è§‚æµ‹æ€§ï¼Œå°†æµé‡ä¸ç½‘ç»œç­–ç•¥å…³è”ï¼Œå¹¶æ‰©å±•äº† BGP çš„åŠŸèƒ½ï¼Œä»¥æ›´å¥½åœ°é›†æˆå¤–éƒ¨ä¸–ç•Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cilium 1.16&lt;/strong&gt;: ä»¥â€œæ›´å¿«ã€æ›´å¼ºã€æ›´æ™ºèƒ½â€ä¸ºä¸»é¢˜ï¼Œé€šè¿‡ netkit æ¶ˆé™¤äº†è™šæ‹Ÿç½‘ç»œå¼€é”€ï¼Œå®ç°äº†ä¸»æœºå’Œå®¹å™¨ä¹‹é—´çš„æ€§èƒ½å¯¹ç­‰ï¼›å¼•å…¥äº† BGPv2 APIï¼Œæ”¯æŒç”¨æˆ·å®šä¹‰å¤æ‚çš„ç½‘ç»œç­–ç•¥ï¼›æ”¯æŒå¤šæ’­æ•°æ®è·¯å¾„ï¼›å¹¶æ˜¾è‘—ä¼˜åŒ–äº† CPU å’Œå†…å­˜ä½¿ç”¨ï¼ŒåŒæ—¶å°†å°¾éƒ¨å»¶è¿Ÿé™ä½äº†é«˜è¾¾ 5 å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¿æ³›åº”ç”¨&lt;/strong&gt;ï¼šç”¨æˆ·è°ƒæŸ¥æ˜¾ç¤ºï¼ŒCilium æ­£åœ¨é€æ­¥æ¥ç®¡ Kubernetes ç½‘ç»œå †æ ˆï¼ŒCluster Meshã€BGP å’Œ Gateway API ç­‰åŠŸèƒ½å·²å¹¿æ³›åº”ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚95% çš„å—è®¿è€…è¿è¡Œå¤šä¸ª Kubernetes é›†ç¾¤ï¼Œè€Œ Cilium è¢« CNCF æŠ€æœ¯é›·è¾¾è¯„ä¸ºé¡¶çº§å¤šé›†ç¾¤ç®¡ç†å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œä¸šè®¤å¯&lt;/strong&gt;ï¼šCilium è£è· OpenUK 2024 å¹´åº¦å¼€æºè½¯ä»¶å¥–ã€‚åŒæ—¶ï¼Œåœ¨ CNCF çš„å¤šé›†ç¾¤ç®¡ç†æŠ€æœ¯é›·è¾¾ä¸­ï¼ŒCilium è¢«è¯„ä¸ºæœ€å€¼å¾—é‡‡ç”¨çš„æŠ€æœ¯ï¼Œå¹¶åœ¨å®ç”¨æ€§å’Œæˆç†Ÿåº¦æ–¹é¢å‡è·å¾—æœ€é«˜åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;eBPF å®‰å…¨&lt;/strong&gt;ï¼šeBPF åŸºé‡‘ä¼šå‘å¸ƒäº†ä¸¤ä»½é‡è¦ç ”ç©¶æŠ¥å‘Šï¼Œæå‡äº†åŸºäº eBPF éƒ¨ç½²çš„å®‰å…¨æ€§ä¸æ“ä½œæŒ‡å¯¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;eBPF å®‰å…¨å¨èƒæ¨¡å‹&lt;/strong&gt;ï¼šè¯¦ç»†é˜è¿°äº† eBPF çš„æ½œåœ¨é£é™©ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„ç¼“è§£ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;eBPF éªŒè¯å™¨ä»£ç å®¡è®¡&lt;/strong&gt;ï¼šå¼ºè°ƒäº†éªŒè¯å™¨åœ¨ä¿éšœ eBPF éƒ¨ç½²å®‰å…¨æ–¹é¢çš„ä½œç”¨ï¼Œå¹¶æå‡ºäº†æ”¹è¿›å»ºè®®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç”¨æˆ·åé¦ˆä¸åº”ç”¨æ¡ˆä¾‹&#34;&gt;ç”¨æˆ·åé¦ˆä¸åº”ç”¨æ¡ˆä¾‹&lt;/h2&gt;
&lt;p&gt;æ¥è‡ªç”¨æˆ·çš„åé¦ˆå’Œæ¡ˆä¾‹è¿›ä¸€æ­¥å°è¯äº† Cilium åœ¨æ€§èƒ½ã€æˆæœ¬æ•ˆç›Šä»¥åŠåŠŸèƒ½æ–¹é¢çš„ä¼˜åŠ¿ã€‚ç”¨æˆ·æ™®éè®¤ä¸ºï¼ŒCilium æœ‰æ•ˆé™ä½äº†ç½‘ç»œæˆæœ¬å’Œ CPU æ¶ˆè€—ï¼ŒåŒæ—¶æä¾›äº†å“è¶Šçš„æ€§èƒ½å’Œä½å»¶è¿Ÿã€‚æ­¤å¤–ï¼ŒCilium çš„å¯è§‚å¯Ÿæ€§å·¥å…·ï¼ˆå¦‚ Hubbleï¼‰ä»¥åŠç½‘ç»œç­–ç•¥åŠŸèƒ½ä¹Ÿå—åˆ°äº†ç”¨æˆ·çš„å¹¿æ³›å¥½è¯„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœªæ¥å±•æœ›&#34;&gt;æœªæ¥å±•æœ›&lt;/h2&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cilium-annual-report-2024/f4.svg&#34; data-img=&#34;/blog/cilium-annual-report-2024/f4.svg&#34; alt=&#34;image&#34; data-caption=&#34;Cilium 2025 å¹´å‘å±•å±•æœ›&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Cilium 2025 å¹´å‘å±•å±•æœ›&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;å±•æœ› 2025 å¹´ï¼ŒCilium çš„å‘å±•åŠ¿å¤´å°†æŒç»­å¢å¼ºã€‚å¹³å°å·¥ç¨‹å’Œæ•´åˆè¶‹åŠ¿æ­£åœ¨é‡å¡‘ç»„ç»‡ç®¡ç† Kubernetes ç½‘ç»œçš„æ–¹å¼ï¼Œè€Œ Cilium æ­£å¤„äºè¿™åœºå˜é©çš„æ ¸å¿ƒã€‚æˆ‘ä»¬é¢„è®¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å †æ ˆå°†è¿›ä¸€æ­¥æ•´åˆç½‘ç»œåŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;Tetragon åœ¨é«˜çº§å®‰å…¨å¯è§‚å¯Ÿæ€§æ–¹é¢çš„åº”ç”¨å°†æ›´åŠ æ™®åŠã€‚&lt;/li&gt;
&lt;li&gt;Cilium å°†æ›´æ·±å…¥åœ°é›†æˆå¤–éƒ¨å’Œä¼ ç»Ÿå·¥ä½œè´Ÿè½½è‡³ Kubernetes ç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä¸ä»…ä¼šè¢«å¹¿æ³›ç”¨ä½œ CNIï¼Œæ›´å°†ä½œä¸ºå…¨é¢çš„ Kubernetes ç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;Tetragon å°†ä¸æ–­è¿›åŒ–ï¼Œæä¾›æ›´å¼ºå¤§çš„æ£€æµ‹èƒ½åŠ›å’Œæ›´å…·è¡ŒåŠ¨åŠ›çš„å¨èƒå“åº”æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;Cilium çš„æ··åˆäº‘å’Œå¤šäº‘é›†æˆå°†åœ¨ 2025 å¹´å‘æŒ¥æ›´å¤§çš„ä½œç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cilium å¯¹å¤–éƒ¨å·¥ä½œè´Ÿè½½ã€4 å±‚è´Ÿè½½å‡è¡¡ä»¥åŠ BGP å¢å¼ºåŠŸèƒ½çš„æ”¯æŒå°†å¼¥åˆ Kubernetes åŸç”Ÿç³»ç»Ÿä¸ä¼ ç»Ÿç³»ç»Ÿä¹‹é—´çš„é¸¿æ²Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Cilium é¡¹ç›®åœ¨ 2024 å¹´å–å¾—äº†å·¨å¤§æˆåŠŸï¼Œç¡®ç«‹äº†å…¶åœ¨ Kubernetes ç½‘ç»œé¢†åŸŸçš„é¢†å¯¼åœ°ä½ã€‚Cilium ä¸ä»…ä»…æ˜¯ä¸€ä¸ª CNIï¼Œæ›´æ˜¯ä¸€ä¸ªæ¶µç›–ç½‘ç»œã€å¯è§‚å¯Ÿæ€§å’Œå®‰å…¨æ€§çš„ç»¼åˆ Kubernetes ç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚éšç€äº‘åŸç”ŸæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼ŒCilium å°†ç»§ç»­å¼•é¢†è¡Œä¸šåˆ›æ–°ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¼ºå¤§ã€æ›´å¯é çš„äº‘åŸç”Ÿç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šæœ¬æ–‡ä¸­çš„å›¾ç‰‡åˆ©ç”¨ &lt;a href=&#34;https://www.napkin.ai/&#34; title=&#34;napkin.ai&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;napkin.ai&lt;/a&gt; åˆ¶ä½œã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—ï¼šæ¢ç´¢ Linux å¥—æ¥å­—çš„ä½¿ç”¨</title>
      <link>https://jimmysong.io/blog/cross-network-namespace-socket/</link>
      <pubDate>Thu, 07 Nov 2024 16:48:08 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/cross-network-namespace-socket/</guid>
      <description>
        
        
        &lt;p&gt;æœ€è¿‘æˆ‘åœ¨ç ”ç©¶ Istio Ambient æ¨¡å¼ä¸­çš„é€æ˜æµé‡åŠ«æŒï¼Œè¿‡ç¨‹ä¸­æ¶‰åŠäº†è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—çš„åŠŸèƒ½ã€‚åœ¨ Istio å®˜æ–¹çš„åšå®¢ &lt;a href=&#34;https://istio.io/latest/blog/2024/inpod-traffic-redirection-ambient/&#34; title=&#34;Maturing Istio Ambient: Compatibility Across Various Kubernetes Providers and CNIs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maturing Istio Ambient: Compatibility Across Various Kubernetes Providers and CNIs&lt;/a&gt; ä¸­ä¹Ÿæåˆ°äº†è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘å¯¹ Linux å¥—æ¥å­— API çš„è¿™ä¸ªåŠŸèƒ½äº§ç”Ÿäº†æµ“åšçš„å…´è¶£ã€‚æ‰€ä»¥ï¼Œæˆ‘å†³å®šå†™ä¸‹è¿™ç¯‡åšå®¢ï¼Œåˆ†äº«å¦‚ä½•åœ¨ Linux ç³»ç»Ÿä¸­è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—çš„ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç½‘ç»œå‘½åç©ºé—´ç®€ä»‹&#34;&gt;ç½‘ç»œå‘½åç©ºé—´ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;ç½‘ç»œå‘½åç©ºé—´æ˜¯ä¸€ç§ Linux å†…æ ¸ç‰¹æ€§ï¼Œå¯ä»¥æŠŠç³»ç»Ÿçš„ç½‘ç»œèµ„æºï¼ˆä¾‹å¦‚ IP åœ°å€ã€è·¯ç”±è¡¨ç­‰ï¼‰åˆ†å‰²æˆå¤šä¸ªç‹¬ç«‹çš„å®ä¾‹ã€‚è¿™æ ·æ¯ä¸ªå®ä¾‹å°±å¯ä»¥ä¸ºä¸åŒçš„è¿›ç¨‹æä¾›ç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒã€‚æ¯”å¦‚ï¼ŒDocker ä½¿ç”¨ç½‘ç»œå‘½åç©ºé—´ä¸ºæ¯ä¸ªå®¹å™¨æä¾›ç‹¬ç«‹çš„ç½‘ç»œæ ˆï¼Œè®©å®ƒä»¬ä¹‹é—´çš„ç½‘ç»œèµ„æºäº’ç›¸éš”ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ç½‘ç»œå‘½åç©ºé—´ï¼Œä¸åŒçš„è¿›ç¨‹å¯ä»¥æœ‰ç‹¬ç«‹çš„ç½‘ç»œé…ç½®ï¼Œæ¯”å¦‚ä¸åŒçš„ IP åœ°å€å’Œè·¯ç”±è®¾ç½®ã€‚ä½†å³ä½¿ç½‘ç»œå‘½åç©ºé—´å®ç°äº†éš”ç¦»ï¼ŒLinux çš„å¥—æ¥å­— API ä»ç„¶å¯ä»¥è®©è¿›ç¨‹è·¨ç½‘ç»œå‘½åç©ºé—´æ“ä½œå¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—&#34;&gt;è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªå‘½åç©ºé—´ä¸­è¿è¡Œçš„è¿›ç¨‹å¯ä»¥åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼Œå¹¶å°†å®ƒæ”¾åˆ°å¦ä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ä¸­ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥å®ç°éå¸¸çµæ´»çš„ç½‘ç»œé€šä¿¡ã€‚æ¯”å¦‚ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç‰¹å®šçš„ç½‘ç»œå‘½åç©ºé—´ä¸­åˆ›å»ºç›‘å¬å¥—æ¥å­—ï¼Œè®©å…¶ä»–å‘½åç©ºé—´ä¸­çš„è¿›ç¨‹å…±äº«è¿™ä¸ªå¥—æ¥å­—ã€‚è¿™ç§åŠŸèƒ½åœ¨å®¹å™¨ç¼–æ’å’Œå¾®æœåŠ¡æ¶æ„ä¸­éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½¿ç”¨ &lt;code&gt;nc&lt;/code&gt; å‘½ä»¤åˆ›å»ºå¥—æ¥å­—ï¼Œä½¿å…¶ç»‘å®šåˆ°æŒ‡å®šçš„ç½‘ç»œè®¾å¤‡æˆ–å‘½åç©ºé—´ã€‚&lt;/p&gt;

&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cross-network-namespace-socket/f04c2c199e66b82ef451c2e3c2be99e1.svg&#34; data-img=&#34;/blog/cross-network-namespace-socket/f04c2c199e66b82ef451c2e3c2be99e1.svg&#34; alt=&#34;image&#34; data-caption=&#34;Mermaid Diagram&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Mermaid Diagram&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;h2 id=&#34;ä½¿ç”¨-docker-æ¼”ç¤ºè¿™ä¸€åŠŸèƒ½&#34;&gt;ä½¿ç”¨ Docker æ¼”ç¤ºè¿™ä¸€åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä½¿ç”¨çš„ macOS ä¸æ”¯æŒ Linux çš„ç½‘ç»œå‘½åç©ºé—´ï¼Œä½†å¯ä»¥ä½¿ç”¨ Docker Desktop æ¨¡æ‹Ÿç›¸åº”çš„ç¯å¢ƒã€‚ä¸‹é¢æ˜¯åœ¨ macOS ä¸Šä½¿ç”¨ Docker æ¥æ¼”ç¤ºçš„æ–¹æ³•ï¼š&lt;/p&gt;

&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/cross-network-namespace-socket/73a1a7081b41c63c1e7f98a87e4f8580.svg&#34; data-img=&#34;/blog/cross-network-namespace-socket/73a1a7081b41c63c1e7f98a87e4f8580.svg&#34; alt=&#34;image&#34; data-caption=&#34;Mermaid Diagram&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Mermaid Diagram&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®‰è£… Docker Desktop&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸‹è½½å¹¶å®‰è£… Docker Desktopï¼Œå¯ä»¥åœ¨ macOS ä¸Šè¿è¡Œ Linux å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å¯åŠ¨ Docker Desktop åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨ä¸­æ¨¡æ‹Ÿç½‘ç»œå‘½åç©ºé—´çš„ç›¸å…³æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é…ç½®è™šæ‹Ÿç½‘ç»œ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºè™šæ‹Ÿç½‘ç»œæ¥å£
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker network create --driver bridge my_bridge
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªå®¹å™¨åˆ†é… IP åœ°å€ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥ç›¸äº’é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»ºç½‘ç»œå‘½åç©ºé—´ï¼ˆä½¿ç”¨ Docker å®¹å™¨æ¨¡æ‹Ÿï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ Docker åˆ›å»ºä¸¤ä¸ªå®¹å™¨ï¼Œåˆ†åˆ«æ¨¡æ‹Ÿä¸¤ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -d --name ns1 --network my_bridge --privileged alpine sleep infinity
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -d --name ns2 --network my_bridge --privileged alpine sleep infinity
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºå®¹å™¨æ—¶ç›´æ¥å°†å®ƒä»¬è¿æ¥åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘ç»œï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥ç›¸äº’é€šä¿¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è·¨å‘½åç©ºé—´åˆ›å»ºå¥—æ¥å­—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;docker exec&lt;/code&gt; å‘½ä»¤è¿›å…¥å®¹å™¨å¹¶é…ç½®ç½‘ç»œæ¥å£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨ &lt;code&gt;ns1&lt;/code&gt; å®¹å™¨ä¸­è¿è¡Œä¸€ä¸ªç›‘å¬å¥—æ¥å­—ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; ns1 sh -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;nc -l -k -p 8080&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·å– &lt;code&gt;ns1&lt;/code&gt; å®¹å™¨çš„ IP åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;NS1_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;docker inspect -f &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}&amp;#39;&lt;/span&gt; ns1&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨ &lt;code&gt;ns2&lt;/code&gt; å®¹å™¨ä¸­ï¼Œä½¿ç”¨ &lt;code&gt;nc&lt;/code&gt; å‘½ä»¤è®¿é—® &lt;code&gt;ns1&lt;/code&gt; å®¹å™¨ä¸­çš„å¥—æ¥å­—ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; ns2 sh -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;echo &amp;#39;Hello from ns2&amp;#39; | nc &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NS1_IP&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 8080&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ &lt;code&gt;ns1&lt;/code&gt; å®¹å™¨çš„ç•Œé¢ä¸­çœ‹åˆ°æ¥è‡ª &lt;code&gt;ns2&lt;/code&gt; å®¹å™¨çš„ &lt;code&gt;Hello from ns2&lt;/code&gt; å­—ç¬¦ä¸²ã€‚å°½ç®¡ &lt;code&gt;ns1&lt;/code&gt; å’Œ &lt;code&gt;ns2&lt;/code&gt; å±äºä¸åŒçš„å®¹å™¨ï¼Œä½†é€šè¿‡æ­£ç¡®çš„é…ç½®ï¼Œ&lt;code&gt;ns2&lt;/code&gt; ä»ç„¶å¯ä»¥è®¿é—® &lt;code&gt;ns1&lt;/code&gt; ä¸­çš„å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯ä»¥ç†è§£ä¸ºé€šè¿‡åœ¨ &lt;code&gt;ns2&lt;/code&gt; ç›‘å¬ &lt;code&gt;ns1&lt;/code&gt; çš„å¥—æ¥å­—ï¼Œç±»ä¼¼äºå»ºç«‹äº†ä¸€ä¸ªâ€œéš§é“â€æ¥å®ç°é€šä¿¡ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯å»ºç«‹äº†ä¸€æ¡ç›´æ¥çš„é€šä¿¡é€šé“ï¼Œä½¿å¾—ä¸¤ä¸ªå®¹å™¨ä¹‹é—´èƒ½å¤Ÿè¿›è¡Œæ•°æ®äº¤æ¢ã€‚è™½ç„¶å®ƒæ²¡æœ‰çœŸæ­£æ„å»º VPN é‚£æ ·å¤æ‚çš„éš§é“ï¼Œä½†ä»é€»è¾‘ä¸Šæ¥è¯´ï¼Œ&lt;code&gt;ns2&lt;/code&gt; å’Œ &lt;code&gt;ns1&lt;/code&gt; ä¹‹é—´å¯ä»¥é€šè¿‡è¿™ä¸ªå¥—æ¥å­—æ¥ä¼ é€’æ•°æ®ï¼Œç›¸å½“äºå»ºç«‹äº†ä¸€ä¸ªè½»é‡çº§çš„ç‚¹å¯¹ç‚¹è¿æ¥é€šé“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®é™…åº”ç”¨åœºæ™¯&#34;&gt;å®é™…åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;p&gt;è¿™ç§â€œéš§é“â€å¼çš„é€šä¿¡åœ¨è®¸å¤šå®é™…åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é€æ˜ä»£ç†å’Œè´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼šé€šè¿‡å¥—æ¥å­—éš§é“å¯ä»¥å°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å®¹å™¨ä¸­ï¼Œå¸¸ç”¨äºé€æ˜ä»£ç†æˆ–è´Ÿè½½å‡è¡¡ã€‚Istioã€&lt;strong&gt;Envoy Proxy&lt;/strong&gt; å’Œ &lt;strong&gt;HAProxy&lt;/strong&gt; ç­‰å·¥å…·åˆ©ç”¨ç±»ä¼¼æœºåˆ¶æ¥ç®¡ç†æœåŠ¡é—´æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨å®¹å™¨æ—¥å¿—æ”¶é›†&lt;/strong&gt;ï¼šé€šè¿‡å¥—æ¥å­—éš§é“ï¼Œå¯ä»¥å°†å¤šä¸ªå®¹å™¨çš„æ—¥å¿—é›†ä¸­æ”¶é›†åˆ°ä¸€ä¸ªå¤„ç†å®¹å™¨ä¸­ã€‚&lt;strong&gt;Fluentd&lt;/strong&gt; å’Œ &lt;strong&gt;Logstash&lt;/strong&gt; æ˜¯å¸¸ç”¨çš„æ—¥å¿—æ”¶é›†å·¥å…·ï¼Œç”¨äºç®€åŒ–æ—¥å¿—å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨å®¡æŸ¥å’Œå…¥ä¾µæ£€æµ‹&lt;/strong&gt;ï¼šå°†å¤šä¸ªå‘½åç©ºé—´çš„æµé‡é›†ä¸­åˆ°ä¸€ä¸ªç›‘æ§å®¹å™¨ä¸­è¿›è¡Œç»Ÿä¸€æ£€æµ‹ã€‚&lt;strong&gt;Suricata&lt;/strong&gt;ã€&lt;strong&gt;Snort&lt;/strong&gt; å’Œ &lt;strong&gt;Zeek&lt;/strong&gt; ç­‰å¼€æºå·¥å…·å¯ç”¨äºç½‘ç»œå®‰å…¨åˆ†æå’Œå®¡æŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è°ƒè¯•å’Œæµ‹è¯•&lt;/strong&gt;ï¼šå¼€å‘äººå‘˜å¯ä»¥å°†æµ‹è¯•æµé‡è½¬å‘åˆ°å…¶ä»–å‘½åç©ºé—´çš„æœåŠ¡ï¼Œç”¨äºéªŒè¯å’Œè°ƒè¯•ã€‚&lt;strong&gt;Wireshark&lt;/strong&gt; å¯ä»¥ç”¨äºæ•è·ç½‘ç»œåŒ…ï¼Œä»¥ä¾¿è¿›è¡Œæ·±å…¥çš„ç½‘ç»œè°ƒè¯•å’Œåˆ†æã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;è·¨ç½‘ç»œå‘½åç©ºé—´ç®¡ç†å¥—æ¥å­—åœ¨å®¹å™¨ç®¡ç†ã€è°ƒåº¦ç³»ç»Ÿå’Œå¾®æœåŠ¡æ¶æ„ä¸­æœ‰å¾ˆå¤šåº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨è¿™ç§æ–¹å¼å®ç°æœåŠ¡çš„é€æ˜è´Ÿè½½å‡è¡¡ï¼Œå»ºç«‹éš§é“æˆ–è¿›è¡Œç½‘ç»œæµé‡è°ƒè¯•ã€‚ä½†è¿™ç§çµæ´»æ€§ä¹Ÿè¦æ±‚æˆ‘ä»¬åœ¨è®¾è®¡ç½‘ç»œå®‰å…¨ç­–ç•¥æ—¶æ›´åŠ è°¨æ…ï¼Œä»¥é˜²æ­¢ä¸åŒå‘½åç©ºé—´ä¹‹é—´çš„æ½œåœ¨é€šä¿¡å¸¦æ¥çš„å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ä½¿ç”¨ eBPF æ£€æµ‹å’Œä¼˜åŒ– Linux å®¹å™¨çš„å™ªå£°é‚»å±…é—®é¢˜</title>
      <link>https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/</link>
      <pubDate>Thu, 12 Sep 2024 16:35:35 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/</guid>
      <description>
        
        
        &lt;p&gt;Netflix çš„è®¡ç®—ä¸æ€§èƒ½å·¥ç¨‹å›¢é˜Ÿå®šæœŸè°ƒæŸ¥æˆ‘ä»¬å¤šç§Ÿæˆ·ç¯å¢ƒä¸­çš„æ€§èƒ½é—®é¢˜ã€‚é¦–å…ˆæ˜¯ç¡®å®šé—®é¢˜æ˜¯æºè‡ªåº”ç”¨ç¨‹åºè¿˜æ˜¯åº•å±‚åŸºç¡€è®¾æ–½ã€‚ä¸€ä¸ªç»å¸¸å¤æ‚åŒ–è¿™ä¸€è¿‡ç¨‹çš„é—®é¢˜æ˜¯â€œå™ªå£°é‚»å±…â€é—®é¢˜ã€‚åœ¨æˆ‘ä»¬çš„å¤šç§Ÿæˆ·è®¡ç®—å¹³å° &lt;a href=&#34;https://netflixtechblog.com/titus-the-netflix-container-management-platform-is-now-open-source-f868c9fb5436&#34; title=&#34;Titus&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Titus&lt;/a&gt;ï¼Œâ€œå™ªå£°é‚»å±…â€æŒ‡çš„æ˜¯å¤§é‡ä½¿ç”¨æœåŠ¡å™¨èµ„æºçš„å®¹å™¨æˆ–ç³»ç»ŸæœåŠ¡ï¼Œå¯¼è‡´ç›¸é‚»å®¹å™¨çš„æ€§èƒ½ä¸‹é™ã€‚æˆ‘ä»¬é€šå¸¸å…³æ³¨ CPU åˆ©ç”¨ç‡ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘ä»¬å·¥ä½œè´Ÿè½½ä¸­å™ªå£°é‚»å±…é—®é¢˜çš„æœ€å¸¸è§æ¥æºã€‚&lt;/p&gt;
&lt;p&gt;æ£€æµ‹å™ªå£°é‚»å±…çš„å½±å“æ˜¯å¤æ‚çš„ã€‚ä¼ ç»Ÿçš„æ€§èƒ½åˆ†æå·¥å…·å¦‚ &lt;a href=&#34;https://www.brendangregg.com/perf.html&#34; title=&#34;perf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perf&lt;/a&gt; å¯èƒ½ä¼šå¼•å…¥æ˜¾è‘—çš„å¼€é”€ï¼Œä»è€ŒåŠ å‰§æ€§èƒ½ä¸‹é™ã€‚æ­¤å¤–ï¼Œè¿™äº›å·¥å…·é€šå¸¸åœ¨äº‹åéƒ¨ç½²ï¼Œå¯¹æœ‰æ•ˆè°ƒæŸ¥æ¥è¯´å·²ç»å¤ªè¿Ÿäº†ã€‚å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼Œè°ƒè¯•å™ªå£°é‚»å±…é—®é¢˜éœ€è¦ç›¸å½“çš„åº•å±‚ä¸“ä¸šçŸ¥è¯†å’Œä¸“é—¨çš„å·¥å…·ã€‚åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºæˆ‘ä»¬å¦‚ä½•åˆ©ç”¨ &lt;a href=&#34;https://ebpf.io/&#34; title=&#34;eBPF&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt; å®ç° Linux è°ƒåº¦å™¨çš„æŒç»­ã€ä½å¼€é”€çš„æ£€æµ‹ï¼Œæœ‰æ•ˆåœ°è‡ªåŠ©ç›‘æ§å™ªå£°é‚»å±…é—®é¢˜ã€‚ä½ å°†å­¦ä¹ åˆ° Linux å†…æ ¸æ£€æµ‹å¦‚ä½•æ”¹å–„ä½ çš„åŸºç¡€è®¾æ–½å¯è§‚æµ‹æ€§ï¼Œå¹¶å¸¦æ¥æ›´æ·±å…¥çš„æ´å¯Ÿå’Œå¢å¼ºçš„ç›‘æ§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŒç»­æ£€æµ‹-linux-è°ƒåº¦å™¨&#34;&gt;æŒç»­æ£€æµ‹ Linux è°ƒåº¦å™¨&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†ç¡®ä¿æˆ‘ä»¬ä¾èµ–ä½å»¶è¿Ÿå“åº”çš„å·¥ä½œè´Ÿè½½çš„å¯é æ€§ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªå®¹å™¨çš„ &lt;a href=&#34;https://en.wikipedia.org/wiki/Run_queue&#34; title=&#34;run queue&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;run queue&lt;/a&gt; å»¶è¿Ÿè¿›è¡Œäº†æ£€æµ‹ï¼Œè¿™ä¸ªæŒ‡æ ‡è¡¡é‡è¿›ç¨‹åœ¨è°ƒåº¦é˜Ÿåˆ—ä¸­ç­‰å¾…è¢«æ´¾å‘åˆ° CPU çš„æ—¶é—´ã€‚åœ¨æ­¤é˜Ÿåˆ—ä¸­çš„é•¿æ—¶é—´ç­‰å¾…å¯èƒ½æ˜¯æ€§èƒ½é—®é¢˜çš„å¾å…†ï¼Œå°¤å…¶æ˜¯å½“å®¹å™¨æ²¡æœ‰ä½¿ç”¨å…¶å…¨éƒ¨ CPU åˆ†é…æ—¶ã€‚æŒç»­çš„æ£€æµ‹å¯¹äºæŠ“ä½è¿™ç±»é—®é¢˜è‡³å…³é‡è¦ï¼Œè€Œ eBPF é€šè¿‡æœ€å°çš„å¼€é”€è¿›å…¥ Linux è°ƒåº¦å™¨ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæœ‰æ•ˆåœ°ç›‘æ§ run queue å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‘å‡º run queue å»¶è¿ŸæŒ‡æ ‡ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ä¸‰ä¸ª eBPF é’©å­ï¼š&lt;code&gt;sched_wakeup&lt;/code&gt;ã€&lt;code&gt;sched_wakeup_new&lt;/code&gt; å’Œ &lt;code&gt;sched_switch&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f1_hu_edcb634c04b0888e.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f1.png&#34; data-img=&#34;/trans/noisy-neighbor-detection-with-ebpf/f1.png&#34; data-width=&#34;1778&#34; data-height=&#34;1000&#34; alt=&#34;image&#34; data-caption=&#34;å›¾ 1ï¼šæµ‹é‡å’Œæ£€æµ‹ run queue å»¶è¿Ÿçš„å›¾ç¤º&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;å›¾ 1ï¼šæµ‹é‡å’Œæ£€æµ‹ run queue å»¶è¿Ÿçš„å›¾ç¤º&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;sched_wakeup&lt;/code&gt; å’Œ &lt;code&gt;sched_wakeup_new&lt;/code&gt; é’©å­åœ¨è¿›ç¨‹çŠ¶æ€ä»â€œç¡çœ â€å˜ä¸ºâ€œå¯è¿è¡Œâ€æ—¶è°ƒç”¨ã€‚å®ƒä»¬è®©æˆ‘ä»¬è¯†åˆ«å‡ºè¿›ç¨‹å‡†å¤‡è¿è¡Œå¹¶ç­‰å¾… CPU æ—¶é—´çš„æ—¶åˆ»ã€‚åœ¨æ­¤äº‹ä»¶ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå¹¶ä½¿ç”¨è¿›ç¨‹ ID ä½œä¸ºé”®ï¼Œå°†å…¶å­˜å‚¨åœ¨ eBPF å“ˆå¸Œå›¾ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BPF_MAP_TYPE_HASH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MAX_TASK_ENTRIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;runq_enqueued&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;.maps&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tp_btf/sched_wakeup&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tp_sched_wakeup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;task&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bpf_ktime_get_ns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bpf_map_update_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runq_enqueued&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BPF_NOEXIST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç›¸åï¼Œ&lt;code&gt;sched_switch&lt;/code&gt; é’©å­åœ¨ CPU åœ¨è¿›ç¨‹é—´åˆ‡æ¢æ—¶è§¦å‘ã€‚è¿™ä¸ªé’©å­æä¾›äº†å½“å‰åˆ©ç”¨ CPU çš„è¿›ç¨‹å’Œå³å°†æ¥ç®¡çš„è¿›ç¨‹çš„æŒ‡é’ˆã€‚æˆ‘ä»¬ä½¿ç”¨å³å°†æ‰§è¡Œä»»åŠ¡çš„è¿›ç¨‹ ID (PID) æ¥è·å–ä¹‹å‰å­˜å‚¨çš„æ—¶é—´æˆ³ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ç®€å•åœ°å‡å»æ—¶é—´æˆ³æ¥è®¡ç®— run queue å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tp_btf/sched_switch&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tp_sched_switch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prev&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prev_pid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prev&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;next_pid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è·å–ä¸‹ä¸€ä¸ªä»»åŠ¡å…¥é˜Ÿçš„æ—¶é—´æˆ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tsp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runq_enqueued&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next_pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tsp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æœªè®°å½•å…¥é˜Ÿ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// åœ¨åˆ é™¤å­˜å‚¨çš„æ—¶é—´æˆ³å‰è®¡ç®— runq å»¶è¿Ÿ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;now&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bpf_ktime_get_ns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;runq_lat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;now&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tsp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä» enqueued å›¾ä¸­åˆ é™¤ PID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;bpf_map_delete_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runq_enqueued&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next_pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;....&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;eBPF çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯å®ƒèƒ½æä¾›æŒ‡å‘å®é™…å†…æ ¸æ•°æ®ç»“æ„çš„æŒ‡é’ˆï¼Œè¿™äº›ç»“æ„ä»£è¡¨è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œä¹Ÿç§°ä¸ºå†…æ ¸æœ¯è¯­ä¸­çš„ä»»åŠ¡ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®å…³äºè¿›ç¨‹å­˜å‚¨çš„å¤§é‡ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦è¿›ç¨‹çš„ cgroup ID ä»¥å°†å…¶ä¸å®¹å™¨å…³è”ï¼Œä½†æ˜¯è¿›ç¨‹ç»“æ„ä¸­çš„ cgroup ä¿¡æ¯å—åˆ° &lt;a href=&#34;https://elixir.bootlin.com/linux/v6.6.16/source/include/linux/sched.h#L1225&#34; title=&#34;RCU (Read Copy Update) é”&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RCU (Read Copy Update) é”&lt;/a&gt; çš„ä¿æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®‰å…¨åœ°è®¿é—®è¿™äº›å— RCU ä¿æŠ¤çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ eBPF ä¸­çš„ &lt;a href=&#34;https://docs.kernel.org/bpf/kfuncs.html&#34; title=&#34;kfuncs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kfuncs&lt;/a&gt;ã€‚kfuncs æ˜¯å¯ä»¥ä» eBPF ç¨‹åºè°ƒç”¨çš„å†…æ ¸å‡½æ•°ã€‚è¿™äº›å‡½æ•°ç¡®ä¿æˆ‘ä»¬çš„ eBPF ç¨‹åºåœ¨æ£€ç´¢ä»»åŠ¡ç»“æ„ä¸­çš„ cgroup ID æ—¶ä¿æŒå®‰å…¨å’Œé«˜æ•ˆã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bpf_rcu_read_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__ksym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bpf_rcu_read_unlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__ksym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_task_cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;task_struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;css_set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bpf_rcu_read_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cgroups&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;task&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dfl_cgrp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bpf_rcu_read_unlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ•°æ®å‡†å¤‡å¥½åï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶æ‰“åŒ…å¹¶å‘é€åˆ°ç”¨æˆ·ç©ºé—´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©äº† eBPF &lt;a href=&#34;https://nakryiko.com/posts/bpf-ringbuf/&#34; title=&#34;ç¯å½¢ç¼“å†²åŒº&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¯å½¢ç¼“å†²åŒº&lt;/a&gt;ã€‚å®ƒæ—¢é«˜æ•ˆåˆé«˜æ€§èƒ½ï¼Œä¸”ç”¨æˆ·å‹å¥½ã€‚å®ƒå¯ä»¥å¤„ç†å˜é•¿æ•°æ®è®°å½•ï¼Œå¹¶å…è®¸æ•°æ®è¯»å–è€Œæ— éœ€é¢å¤–çš„å†…å­˜å¤åˆ¶æˆ–ç³»ç»Ÿè°ƒç”¨ã€‚ç„¶è€Œï¼Œå¤§é‡æ•°æ®ç‚¹ä½¿å¾—ç”¨æˆ·ç©ºé—´ç¨‹åºçš„ CPU ä½¿ç”¨è¿‡å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ eBPF ä¸­å®æ–½äº†é€Ÿç‡é™åˆ¶ä»¥é‡‡æ ·æ•°æ®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BPF_MAP_TYPE_RINGBUF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RINGBUF_SIZE_BYTES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;events&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;.maps&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BPF_MAP_TYPE_PERCPU_HASH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MAX_TASK_ENTRIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;__uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id_to_last_event_ts&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;.maps&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nc&#34;&gt;runq_event&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prev_cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;runq_lat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;SEC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tp_btf/sched_switch&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tp_sched_switch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ....
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// ä¸Šè¿°ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// ....
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prev_cgroup_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_task_cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prev&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_task_cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æŒ‰æ¯ä¸ª cgroup ID æ¯ä¸ª CPU è¿›è¡Œé€Ÿç‡é™åˆ¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// å¹³è¡¡å¯è§‚æµ‹æ€§ä¸æ€§èƒ½å¼€é”€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;last_ts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroup_id_to_last_event_ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;last_ts_val&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;last_ts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;NULL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;last_ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// åœ¨è¿›è¡Œæ›´å¤šå·¥ä½œä¹‹å‰æ£€æŸ¥è€ƒè™‘ä¸­çš„ cgroup ID çš„é€Ÿç‡é™åˆ¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;last_ts_val&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RATE_LIMIT_NS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// é€Ÿç‡é™åˆ¶è¶…å‡ºï¼Œä¸¢å¼ƒäº‹ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;runq_event&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bpf_ringbuf_reserve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;events&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prev_cgroup_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prev_cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runq_lat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;runq_lat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;bpf_ringbuf_submit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// æ›´æ–°å½“å‰ cgroup ID çš„æœ€åä¸€ä¸ªäº‹ä»¶æ—¶é—´æˆ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;bpf_map_update_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroup_id_to_last_event_ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cgroup_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BPF_ANY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ Go å¼€å‘çš„ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºå¤„ç†ç¯å½¢ç¼“å†²åŒºä¸­çš„äº‹ä»¶ï¼Œä»¥å‘æˆ‘ä»¬çš„åº¦é‡åç«¯ &lt;a href=&#34;https://netflixtechblog.com/introducing-atlas-netflixs-primary-telemetry-platform-bd31f4d8ed9a&#34; title=&#34;Atlas&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Atlas&lt;/a&gt; å‘å‡ºåº¦é‡ã€‚æ¯ä¸ªäº‹ä»¶åŒ…å«ä¸€ä¸ªå¸¦æœ‰ cgroup ID çš„ run queue å»¶è¿Ÿæ ·æœ¬ï¼Œæˆ‘ä»¬å°†å…¶ä¸ä¸»æœºä¸Šè¿è¡Œçš„å®¹å™¨å…³è”ã€‚å¦‚æœæ²¡æœ‰å‘ç°è¿™ç§å…³è”ï¼Œæˆ‘ä»¬ä¼šå°†å…¶åˆ†ç±»ä¸ºç³»ç»ŸæœåŠ¡ã€‚å½“ cgroup ID ä¸å®¹å™¨å…³è”æ—¶ï¼Œæˆ‘ä»¬ä¼šä¸ºè¯¥å®¹å™¨å‘å‡ºç™¾åˆ†ä½è®¡æ—¶å™¨ Atlas åº¦é‡ï¼ˆ&lt;code&gt;runq.latency&lt;/code&gt;ï¼‰ã€‚æˆ‘ä»¬è¿˜å¢åŠ äº†ä¸€ä¸ªè®¡æ•°å™¨åº¦é‡ï¼ˆ&lt;code&gt;sched.switch.out&lt;/code&gt;ï¼‰æ¥ç›‘æ§å®¹å™¨è¿›ç¨‹çš„æŠ¢å æƒ…å†µã€‚é€šè¿‡è®¿é—®è¢«æŠ¢å è¿›ç¨‹çš„ &lt;code&gt;prev_cgroup_id&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºåº¦é‡æ ‡è®°æŠ¢å çš„åŸå› ï¼Œæ— è®ºæ˜¯åŒä¸€å®¹å™¨ï¼ˆæˆ– cgroupï¼‰å†…çš„è¿›ç¨‹ã€å¦ä¸€ä¸ªå®¹å™¨çš„è¿›ç¨‹è¿˜æ˜¯ç³»ç»ŸæœåŠ¡çš„è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼Œ&lt;code&gt;runq.latency&lt;/code&gt; åº¦é‡å’Œ &lt;code&gt;sched.switch.out&lt;/code&gt; åº¦é‡éƒ½éœ€è¦ç¡®å®šå®¹å™¨æ˜¯å¦å—åˆ°å™ªå£°é‚»å±…çš„å½±å“ï¼Œè¿™æ˜¯æˆ‘ä»¬æ—¨åœ¨å®ç°çš„ç›®æ ‡ã€‚å•ç‹¬ä¾èµ– &lt;code&gt;runq.latency&lt;/code&gt; åº¦é‡å¯èƒ½ä¼šå¯¼è‡´è¯¯è§£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®¹å™¨å¤„äºæˆ–è¶…è¿‡å…¶ cgroup CPU é™åˆ¶ï¼Œè°ƒåº¦å™¨å°†å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œå¯¼è‡´é˜Ÿåˆ—ä¸­çš„å»¶è¿Ÿæ˜æ˜¾å¢åŠ ã€‚å¦‚æœæˆ‘ä»¬åªè€ƒè™‘è¿™ä¸ªåº¦é‡ï¼Œæˆ‘ä»¬å¯èƒ½é”™è¯¯åœ°å°†æ€§èƒ½ä¸‹é™å½’å’äºå™ªå£°é‚»å±…ï¼Œè€Œå®é™…ä¸Šæ˜¯å› ä¸ºå®¹å™¨è§¦åŠäº†å…¶ CPU é…é¢ã€‚ç„¶è€Œï¼Œå½“ä¸¤ä¸ªåº¦é‡åŒæ—¶å‡ºç°å°–å³°ï¼Œå°¤å…¶æ˜¯å½“åŸå› æ˜¯ä¸åŒå®¹å™¨æˆ–ç³»ç»Ÿè¿›ç¨‹æ—¶ï¼Œæ˜æ˜¾è¡¨æ˜äº†å™ªå£°é‚»å±…é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å™ªå£°é‚»å±…çš„æ•…äº‹&#34;&gt;å™ªå£°é‚»å±…çš„æ•…äº‹&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€å°è¿è¡Œå•ä¸ªå®¹å™¨çš„æœåŠ¡å™¨çš„ &lt;code&gt;runq.latency&lt;/code&gt; åº¦é‡ï¼Œè¯¥å®¹å™¨æ‹¥æœ‰å……è¶³çš„ CPU å®¹é‡ã€‚99 ç™¾åˆ†ä½å¹³å‡ä¸º 83.4 å¾®ç§’ï¼ˆå¾®ç§’ï¼‰ï¼Œä½œä¸ºæˆ‘ä»¬çš„åŸºå‡†ã€‚å°½ç®¡æœ‰äº›å°–å³°è¾¾åˆ° 400 å¾®ç§’ï¼Œä½†å»¶è¿Ÿä»åœ¨å¯æ¥å—çš„å‚æ•°èŒƒå›´å†…ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f2_hu_de4a3b4dda196666.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f2.png&#34; data-img=&#34;/trans/noisy-neighbor-detection-with-ebpf/f2.png&#34; data-width=&#34;2000&#34; data-height=&#34;838&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;container1 çš„ 99 ç™¾åˆ†ä½ runq.latency å¹³å‡ä¸º 83 å¾®ç§’ï¼ˆå¾®ç§’ï¼‰ï¼Œå°–å³°å¯è¾¾ 400 å¾®ç§’ï¼Œæ²¡æœ‰ç›¸é‚»å®¹å™¨ã€‚è¿™ä½œä¸ºä¸€ä¸ªå®¹å™¨åœ¨ä¸»æœºä¸Šæœªäº‰å¤º CPU çš„åŸºå‡†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ 10:35ï¼Œå¯åŠ¨ &lt;code&gt;container2&lt;/code&gt;ï¼Œå®ƒå……åˆ†åˆ©ç”¨äº†ä¸»æœºä¸Šçš„æ‰€æœ‰ CPUï¼Œå¯¼è‡´ &lt;code&gt;container1&lt;/code&gt; çš„ P99 run queue å»¶è¿Ÿå‡ºç°äº† 131 æ¯«ç§’çš„å°–å³°ï¼ˆ131,000 å¾®ç§’ï¼‰ã€‚å¦‚æœç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºæ­£åœ¨æœåŠ¡ HTTP æµé‡ï¼Œåˆ™è¿™ä¸€å°–å³°å°†åœ¨ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºä¸­å¯è§ã€‚å¦‚æœç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºæ‰€æœ‰è€…æŠ¥å‘Šäº†æ— æ³•è§£é‡Šçš„å»¶è¿Ÿå°–å³°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ run queue å»¶è¿Ÿåº¦é‡è¿…é€Ÿè¯†åˆ«å™ªå£°é‚»å±…é—®é¢˜ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f3_hu_3984e5201ef23bd3.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f3.png&#34; data-img=&#34;/trans/noisy-neighbor-detection-with-ebpf/f3.png&#34; data-width=&#34;2000&#34; data-height=&#34;916&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;åœ¨ 10:35 å¯åŠ¨çš„ container2 å……åˆ†åˆ©ç”¨äº†ä¸»æœºä¸Šçš„æ‰€æœ‰ CPUï¼Œ&lt;strong&gt;å¯¼è‡´ container1 çš„ P99 run queue å»¶è¿Ÿå‡ºç°äº† 131 æ¯«ç§’çš„å°–å³°&lt;/strong&gt;ï¼Œå› ä¸ºç³»ç»Ÿè¿›ç¨‹çš„æŠ¢å å¢åŠ ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€ä¸ªå™ªå£°é‚»å±…é—®é¢˜ï¼Œå³ç³»ç»ŸæœåŠ¡ä¸å®¹å™¨ç«äº‰ CPU æ—¶é—´ã€‚æˆ‘ä»¬çš„åº¦é‡æ˜¾ç¤ºï¼Œå™ªå£°é‚»å±…å®é™…ä¸Šæ˜¯ç³»ç»Ÿè¿›ç¨‹ï¼Œå¯èƒ½æ˜¯ç”± &lt;code&gt;container2&lt;/code&gt; æ¶ˆè€—æ‰€æœ‰å¯ç”¨ CPU å®¹é‡è§¦å‘çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¼˜åŒ–-ebpf-ä»£ç &#34;&gt;ä¼˜åŒ– eBPF ä»£ç &lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªåä¸º &lt;a href=&#34;https://netflixtechblog.com/announcing-bpftop-streamlining-ebpf-performance-optimization-6a727c1ae2e5&#34; title=&#34;bpftop&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bpftop&lt;/a&gt; çš„å¼€æº eBPF è¿›ç¨‹ç›‘æ§å·¥å…·ï¼Œç”¨æ¥æµ‹é‡æ­¤å†…æ ¸çƒ­è·¯å¾„ä¸­ eBPF ä»£ç çš„å¼€é”€ã€‚æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;bpftop&lt;/code&gt; è¿›è¡Œçš„æ€§èƒ½åˆ†ææ˜¾ç¤ºï¼Œæ£€æµ‹ä»ªå¢åŠ çš„å¼€é”€ä¸åˆ°æ¯ä¸ª &lt;code&gt;sched_*&lt;/code&gt; é’©å­ 600 çº³ç§’ã€‚æˆ‘ä»¬å¯¹åœ¨å®¹å™¨ä¸­è¿è¡Œçš„ Java æœåŠ¡è¿›è¡Œäº†æ€§èƒ½åˆ†æï¼Œå‘ç°æ£€æµ‹ä»£ç æœªå¼•å…¥æ˜¾è‘—å¼€é”€ã€‚å¼€å¯ä¸å…³é—­ run queue æ£€æµ‹ä»£ç çš„æ€§èƒ½å·®å¼‚åœ¨æ¯«ç§’çº§ä¸å¯æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å¯¹å†…æ ¸ä¸­å¦‚ä½•æµ‹é‡ eBPF ç»Ÿè®¡ä¿¡æ¯çš„ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ”¹è¿›è®¡ç®—çš„æœºä¼šã€‚æˆ‘ä»¬æäº¤äº†è¿™ä¸ª &lt;a href=&#34;https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ce09cbdd988887662546a1175bcfdfc6c8fdd150&#34; title=&#34;patch&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;patch&lt;/a&gt;ï¼Œå¹¶åŒ…æ‹¬åœ¨ Linux å†…æ ¸ 6.10 ç‰ˆæœ¬ä¸­ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/trans/noisy-neighbor-detection-with-ebpf/f4.gif&#34; data-img=&#34;/trans/noisy-neighbor-detection-with-ebpf/f4.gif&#34; data-width=&#34;1231&#34; data-height=&#34;255&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;é€šè¿‡è¯•é”™å’Œä½¿ç”¨ &lt;code&gt;bpftop&lt;/code&gt;ï¼Œæˆ‘ä»¬ç¡®å®šäº†å‡ ç§ä¼˜åŒ–ï¼Œå¸®åŠ©ä¿æŒäº†æˆ‘ä»¬ eBPF ä»£ç çš„ä½å¼€é”€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬å‘ç° &lt;code&gt;BPF_MAP_TYPE_HASH&lt;/code&gt; å­˜å‚¨å…¥é˜Ÿæ—¶é—´æˆ³æ—¶æœ€ä¸ºé«˜æ•ˆã€‚ä½¿ç”¨ &lt;code&gt;BPF_MAP_TYPE_TASK_STORAGE&lt;/code&gt; ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™è¿‘ä¸€å€ã€‚&lt;code&gt;BPF_MAP_TYPE_PERCPU_HASH&lt;/code&gt; çš„æ€§èƒ½ç•¥ä½äº &lt;code&gt;BPF_MAP_TYPE_HASH&lt;/code&gt;ï¼Œè¿™æ˜¯æ„æ–™ä¹‹å¤–çš„ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒæŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BPF_MAP_TYPE_LRU_HASH&lt;/code&gt; æ˜ å°„çš„æ“ä½œæ¯”å¸¸è§„å“ˆå¸Œæ˜ å°„æ…¢ 40-50 çº³ç§’ã€‚ç”±äº PID æµå¤±å¼•èµ·çš„ç©ºé—´é—®é¢˜ï¼Œæˆ‘ä»¬æœ€åˆä½¿ç”¨äº†å®ƒä»¬æ¥å­˜å‚¨å…¥é˜Ÿæ—¶é—´æˆ³ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬é€‰æ‹©äº†å¢å¤§å°ºå¯¸çš„ &lt;code&gt;BPF_MAP_TYPE_HASH&lt;/code&gt;ï¼Œä»¥é™ä½è¿™ä¸€é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BPF_CORE_READ&lt;/code&gt; å¸®åŠ©æ¯æ¬¡è°ƒç”¨å¢åŠ  20-30 çº³ç§’ã€‚åœ¨ç‰¹åˆ«æ˜¯é‚£äº›â€œBTF å¯ç”¨â€çš„åŸå§‹è·Ÿè¸ªç‚¹ï¼ˆ&lt;code&gt;tp_btf/*&lt;/code&gt;ï¼‰çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è®¿é—®ä»»åŠ¡ç»“æ„æˆå‘˜æ˜¯å®‰å…¨ä¸”æ›´é«˜æ•ˆçš„ã€‚Andrii Nakryiko åœ¨è¿™ç¯‡ &lt;a href=&#34;https://nakryiko.com/posts/bpf-core-reference-guide/#btf-enabled-bpf-program-types-with-direct-memory-reads&#34; title=&#34;åšå®¢æ–‡ç« &#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åšå®¢æ–‡ç« &lt;/a&gt; ä¸­æ¨èäº†è¿™ç§æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sched_switch&lt;/code&gt;ã€&lt;code&gt;sched_wakeup&lt;/code&gt; å’Œ &lt;code&gt;sched_wakeup_new&lt;/code&gt; éƒ½ä¼šå› å†…æ ¸ä»»åŠ¡è§¦å‘ï¼Œè¿™äº›ä»»åŠ¡çš„ PID ä¸º 0ã€‚æˆ‘ä»¬å‘ç°ç›‘æ§è¿™äº›ä»»åŠ¡æ˜¯ä¸å¿…è¦çš„ï¼Œå› æ­¤æˆ‘ä»¬å®æ–½äº†å‡ ç§æå‰é€€å‡ºæ¡ä»¶å’Œæ¡ä»¶é€»è¾‘ï¼Œä»¥é˜²åœ¨å¤„ç†å†…æ ¸ä»»åŠ¡æ—¶æ‰§è¡Œä»£ä»·é«˜æ˜‚çš„æ“ä½œï¼Œå¦‚è®¿é—® BPF æ˜ å°„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå†…æ ¸ä»»åŠ¡å°±åƒä»»ä½•å¸¸è§„è¿›ç¨‹ä¸€æ ·é€šè¿‡è°ƒåº¦é˜Ÿåˆ—æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çš„å‘ç°çªå‡ºäº†ä½¿ç”¨ eBPF å¯¹ Linux å†…æ ¸è¿›è¡Œä½å¼€é”€æŒç»­æ£€æµ‹çš„ä»·å€¼ã€‚æˆ‘ä»¬å·²å°†è¿™äº›åº¦é‡æ•´åˆåˆ°å®¢æˆ·ä»ªè¡¨æ¿ä¸­ï¼Œä½¿å…¶èƒ½å¤Ÿæä¾›å¯æ“ä½œçš„æ´å¯Ÿï¼Œå¹¶æŒ‡å¯¼å¤šç§Ÿæˆ·æ€§èƒ½è®¨è®ºã€‚æˆ‘ä»¬ç°åœ¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›åº¦é‡æ¥å®Œå–„ CPU éš”ç¦»ç­–ç•¥ï¼Œä»¥æœ€å°åŒ–å™ªå£°é‚»å±…çš„å½±å“ã€‚æ­¤å¤–ï¼Œè¿™äº›åº¦é‡ä½¿æˆ‘ä»¬æ·±å…¥äº†è§£äº† Linux è°ƒåº¦å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¡¹å·¥ä½œè¿˜åŠ æ·±äº†æˆ‘ä»¬å¯¹ eBPF æŠ€æœ¯çš„ç†è§£ï¼Œå¹¶å¼ºè°ƒäº†åƒ &lt;code&gt;bpftop&lt;/code&gt; è¿™æ ·çš„å·¥å…·å¯¹ä¼˜åŒ– eBPF ä»£ç çš„é‡è¦æ€§ã€‚éšç€ eBPF çš„é‡‡ç”¨å¢åŠ ï¼Œæˆ‘ä»¬é¢„è§æ›´å¤šçš„åŸºç¡€è®¾æ–½å¯è§‚æµ‹æ€§å’Œä¸šåŠ¡é€»è¾‘å°†è½¬å‘ä½¿ç”¨å®ƒã€‚åœ¨è¿™æ–¹é¢æœ‰ä¸€ä¸ªå‰æ™¯å¹¿é˜”çš„é¡¹ç›®æ˜¯ &lt;a href=&#34;https://github.com/sched-ext/scx&#34; title=&#34;sched_ext&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sched_ext&lt;/a&gt;ï¼Œå®ƒæœ‰æ½œåŠ›é©æ–°è°ƒåº¦å†³ç­–çš„åˆ¶å®šæ–¹å¼ï¼Œå¹¶æ ¹æ®ç‰¹å®šå·¥ä½œè´Ÿè½½éœ€æ±‚è¿›è¡Œå®šåˆ¶ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ç”¨ eBPF æ´å¯Ÿåº”ç”¨å±‚ç½‘ç»œæµé‡</title>
      <link>https://jimmysong.io/trans/application-traffic-with-ebpf/</link>
      <pubDate>Wed, 10 Jan 2024 12:00:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/application-traffic-with-ebpf/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨&lt;a href=&#34;../ebpf-adventures-in-networking/&#34; title=&#34;å…ˆå‰çš„å¸–å­&#34;&gt;å…ˆå‰çš„å¸–å­&lt;/a&gt;ä¸­ï¼Œæˆ‘ç¨å¾®è°ˆåˆ°äº†å»ºç«‹ eBPF çŸ¥è¯†ï¼Œä»¥å¼€å§‹æ›´å¤šåœ°äº†è§£ç½‘ç»œé€‚é…å™¨çš„è¾“å…¥å’Œè¾“å‡ºæƒ…å†µã€‚åŸºæœ¬ä¸Šï¼Œå°†ä»¥å¤ªç½‘å¸§å¹¶å‰¥ç¦»æ ‡å¤´ï¼ˆä»¥å¤ªç½‘æ ‡å¤´+IP æ ‡å¤´+TCP/UDP æ ‡å¤´ï¼‰ï¼Œæœ€ç»ˆä½ å°†å¾—åˆ°æ¥è‡ªåº”ç”¨ç¨‹åºæˆ–æ•°æ®è§’åº¦çš„æ•°æ®åŒ…ä¸­å‰©ä½™çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„ä»£ç éƒ½åœ¨â€œå­¦ä¹  eBPFâ€å­˜å‚¨åº“ä¸­ï¼Œå…·ä½“çš„ eBPF ä»£ç åœ¨&lt;a href=&#34;https://github.com/thebsdbox/learning-ebpf/blob/main/ebpf/http/http.c&#34; title=&#34;è¿™é‡Œ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚è¿™ç¯‡æ–‡ç« çš„è®¡åˆ’æ˜¯é€æ­¥ä»‹ç»æˆ‘è®¤ä¸ºæœ‰ç”¨æˆ–å¯èƒ½é‡è¦çš„éƒ¨åˆ†&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šæ­¤ä»£ç ç¡®å®å¯¹å…¥å£/å‡ºå£æ•°æ®åŒ…è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œå› æ­¤éœ€è¦ 6.1+ çš„ Linux å†…æ ¸æ‰èƒ½ä½¿ç”¨ä¸€äº› eBPF åŠ©æ‰‹å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ˜ å°„&#34;&gt;æ˜ å°„ï¼&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½ä»¥å‰é‡åˆ°è¿‡è¿™äº›å§ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä¸ç”¨æ‹…å¿ƒï¼ç®€è€Œè¨€ä¹‹ï¼ŒeBPF æ˜ å°„æ˜¯åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ä¸­çš„ eBPF ç¨‹åºä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œéå¸¸é…·çš„ä¸€ç‚¹æ˜¯è¿™äº›æ˜ å°„ä½¿ç”¨é”®å’Œå€¼&amp;hellip;æ‰€ä»¥æˆ‘ä¸å¿…å¾ªç¯æ¯”è¾ƒæ•°æ®å¹¶å¯»æ‰¾åŒ¹é…çš„å†…å®¹ï¼Œæˆ‘ä¼ é€’ä¸€ä¸ªé”®ï¼Œå¦‚æœæœ‰åŒ¹é…çš„å†…å®¹ï¼Œæˆ‘å°±å¾—åˆ°ç›¸åº”çš„æ•°æ®:D&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯æˆ‘å°†è¦ä½¿ç”¨çš„æ˜ å°„ï¼Œç§°ä¸º&lt;code&gt;url_map&lt;/code&gt;ï¼Œé”®æ˜¯ 20 ä¸ªå­—ç¬¦é•¿ï¼ˆå¯ä»¥è¯´æ˜¯æœ‰ç•Œçš„â€œå­—ç¬¦ä¸²â€ï¼‰ï¼Œåˆ†é…ç»™è¯¥é”®çš„å€¼æ˜¯æˆ‘åœ¨ä¸Šé¢å®šä¹‰çš„ç»“æ„ä½“ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;// å®šä¹‰ä¸é”®å…³è”çš„ä¸åŒURL
struct url_path {
  __u8 path_len;
  __u8 path[max_path_len]; // è¿™åº”è¯¥æ˜¯ä¸€ä¸ªcharï¼Œä½†åœ¨è¿™é‡Œå’ŒGoä¹‹é—´çš„ä»£ç ç”Ÿæˆæœ‰ç‚¹ä¸åŒ...
};

// å®šä¹‰æˆ‘çš„URLæ˜ å°„
struct {
  __uint(type, BPF_MAP_TYPE_HASH);
  __uint(max_entries, 1024);
  __type(key, char[max_path_len]);
  __type(value, struct url_path);
}
url_map SEC(&amp;#34;.maps&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ebpf-ç¨‹åº&#34;&gt;eBPF ç¨‹åºï¼&lt;/h2&gt;
&lt;p&gt;ä»£ç ä¸­å®šä¹‰äº†ä¸¤ä¸ª eBPF ç¨‹åº&lt;code&gt;tc_egress&lt;/code&gt;å’Œ&lt;code&gt;tc_ingress&lt;/code&gt;ï¼Œå¦‚æœä½ èƒ½çŒœåˆ°å®ƒä»¬æ˜¯å¦‚ä½•è¿æ¥çš„ï¼Œé‚£å°±åŠ åˆ†ï¼åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åªå…³æ³¨&lt;code&gt;tc_ingress&lt;/code&gt;ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;å°±åƒæˆ‘ä»¬åœ¨å·²ç»å­˜åœ¨çš„ä¼—å¤šç¤ºä¾‹ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ ‡å¤´è¯†åˆ«çš„æ“ä½œã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿›è¡Œåˆç†æ€§æ£€æŸ¥ï¼Œå¹¶å°†&lt;code&gt;data&lt;/code&gt;å¼ºåˆ¶è½¬æ¢ä¸º&lt;code&gt;ethhdr&lt;/code&gt;ç±»å‹ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Ethernet_frame&#34; title=&#34;ä»¥å¤ªç½‘æ ‡å¤´&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»¥å¤ªç½‘æ ‡å¤´&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡è¯»å–ä»¥å¤ªç½‘æ ‡å¤´å†…éƒ¨çš„&lt;code&gt;h_proto&lt;/code&gt;ï¼ˆä¹Ÿç§°ä¸º&lt;code&gt;Ethertype&lt;/code&gt;ï¼‰æ¥æŸ¥æ‰¾ä»¥å¤ªç½‘å¸§å†…éƒ¨çš„åè®®ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä»¥å¤ªç½‘æ ‡å¤´åçš„æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸º&lt;code&gt;iphdr&lt;/code&gt;ç±»å‹ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Internet_Protocol_version_4#Header&#34; title=&#34;IP æ ‡å¤´&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IP æ ‡å¤´&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ IP æ ‡å¤´å†…æŸ¥æ‰¾åè®®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®å®š IP æ ‡å¤´çš„å¤§å°ï¼ˆåŸæ¥å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å¤§å°ï¼&lt;code&gt;Â¯\_(ãƒ„)_/Â¯&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼Œæˆ‘ä»¬å°†å…¶å€¼ä¹˜ä»¥å››ï¼Œä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆï¼å¥½å§ï¼Œè¿™ä¸ªå€¼ä¹˜ä»¥ 32 ä½ä»¥ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼Œæ‰€ä»¥å¦‚æœå€¼ä¸º 6ï¼Œé‚£ä¹ˆæ ‡å¤´å°†æ˜¯ 192 ä½ï¼ˆæˆ– 24 å­—èŠ‚ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ç®€å•åœ°ç¡®å®š IP æ ‡å¤´çš„å­—èŠ‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå€¼ä¹˜ä»¥ 4ï¼&lt;/li&gt;
&lt;li&gt;å°†ä»¥ IP æ ‡å¤´åçš„æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸º&lt;code&gt;tcphdr&lt;/code&gt;ç±»å‹ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_segment_structure&#34; title=&#34;TCP æ ‡å¤´&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP æ ‡å¤´&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åƒæ­¥éª¤ï¼ˆ5ï¼‰ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®š TCP æ ‡å¤´çš„å¤§å°ï¼ˆå®ƒä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„ï¼‰ï¼Œåœ¨è¿™é‡Œçš„æ­¥éª¤ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å€¼&lt;code&gt;doff&lt;/code&gt;ä¹˜ä»¥å››æ¥ç¡®å®šæ ‡å¤´çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡è®¡ç®—æ‰€æœ‰è¿™äº›ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¨æ–­å‡ºæ•°æ®ä½äºä»¥å¤ªç½‘æ ‡å¤´å¤§å°ã€IP æ ‡å¤´å¤§å°å’Œ TCP æ ‡å¤´å¤§å°çš„æœ«å°¾ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä» IP æ ‡å¤´ä¸­å‡å» IP å’Œ TCP æ ‡å¤´çš„å¤§å°æ¥ç¡®å®šåº”ç”¨ç¨‹åºæ•°æ®çš„å¤§å°ï¼Œä½¿ç”¨&lt;code&gt;tot_len&lt;/code&gt;ï¼ˆæ€»é•¿åº¦ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;åº”ç”¨æ•°æ®&#34;&gt;åº”ç”¨æ•°æ®ï¼ï¼&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è¯»å–è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸Šé¢æåˆ°çš„ä¸€äº›ä¸œè¥¿ï¼&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ•°æ®åç§»é‡ï¼ˆæ•°æ®èµ·å§‹ä½ç½®ï¼‰ï¼Œå®ƒä½äºä»¥å¤ªç½‘æ ‡å¤´+IP æ ‡å¤´å¤§å°ï¼ˆä¸€æ—¦è®¡ç®—å‡ºæ¥ï¼‰å’Œ TCP æ ‡å¤´ï¼ˆå†æ¬¡ï¼Œä¸€æ—¦è®¡ç®—å‡ºæ¥ï¼‰ä¹‹åã€‚æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªç¼“å†²åŒºæ¥å­˜å‚¨æˆ‘ä»¬å°†ä»å¥—æ¥å­—ç¼“å†²åŒºä¸­è¯»å–çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ç”¨äºå­˜å‚¨æˆ‘ä»¬åº”ç”¨ç¨‹åºæ•°æ®çš„æ•°æ®ç¼“å†²åŒº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// è®¡ç®—æ•°æ®å®é™…ä½ç½®çš„åç§»é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poffset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ETH_HLEN&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ip_hlen&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tcp_hlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä»å¥—æ¥å­—ç¼“å†²åŒºåŠ è½½æ•°æ®ï¼Œpoffset ä» TCP æ ‡å¤´çš„æœ«å°¾å¼€å§‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bpf_skb_load_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;skb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;poffset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;bpf_skb_load_bytes&lt;/code&gt;ä»å¥—æ¥å­—ç¼“å†²åŒºï¼ˆ&lt;code&gt;skb&lt;/code&gt;ï¼‰ä¸­è¯»å–ä¸€å®šé‡çš„æ•°æ®ï¼ˆ60 ä¸ªå­—èŠ‚ï¼‰åˆ°æˆ‘ä»¬çš„ç¼“å†²åŒºï¼ˆ&lt;code&gt;pdata&lt;/code&gt;ï¼‰ï¼Œèµ·å§‹ä½ç½®æ˜¯æˆ‘ä»¬çŸ¥é“æ•°æ®ä½äºçš„åç§»é‡ï¼ˆ&lt;code&gt;poffset&lt;/code&gt;ï¼‰ï¼&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰äº† 60 å­—èŠ‚çš„æ•°æ®ï¼Œåº”è¯¥è¶³å¤Ÿè®©æˆ‘ä»¬ç¼–å†™ä¸€äº›ä»£ç æ¥ç†è§£å®ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;http-æ•°æ®--&#34;&gt;HTTP æ•°æ® :-)&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬å°è¯•è¿›è¡Œ HTTP è¯·æ±‚æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; ~ curl code/test -vvv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;*   Trying 192.168.0.22:80...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;* Connected to code (192.168.0.22) port 80 (#0)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;gt; GET /test HTTP/1.1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;gt; Host: code
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;gt; User-Agent: curl/7.87.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;gt; Accept: */*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘æ­£åœ¨ä½¿ç”¨&lt;code&gt;curl&lt;/code&gt;ä»ä¸»æœº&lt;code&gt;code&lt;/code&gt;ï¼ˆcode æ˜¯æˆ‘çš„å¼€å‘ VMï¼Œè¿è¡Œ code-serverï¼‰è¯·æ±‚ URL &lt;code&gt;/test&lt;/code&gt;ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼ˆæ¯è¡Œä»¥&lt;code&gt;&amp;gt;&lt;/code&gt;å¼€å¤´ï¼Œç”¨äºç¡®å®šé€šä¿¡çš„æ–¹å‘ï¼‰ã€‚HTTP è¯·æ±‚ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®é€šå¸¸æ˜¯ä¸€ä¸ª&lt;em&gt;åŠ¨è¯&lt;/em&gt;ï¼Œåé¢æ˜¯æˆ‘ä»¬å¸Œæœ›ä¸ä¹‹äº¤äº’çš„èµ„æºï¼Œç„¶åæ˜¯ HTTP è§„èŒƒå’Œå›è½¦ç¬¦ï¼Œå¦‚&lt;a href=&#34;https://en.wikipedia.org/wiki/HTTP#HTTP/1.1_request_messages&#34; title=&#34;HTTP æ ‡å‡†&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HTTP æ ‡å‡†&lt;/a&gt;ä¸­å®šä¹‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å…³å¿ƒçš„è¡Œæ˜¯&lt;code&gt;GET /test&lt;/code&gt;ï¼ˆåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬/æˆ‘ä¸å¤ªå…³å¿ƒ HTTP è§„èŒƒ:Dï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯è¯»å–&lt;code&gt;pdata&lt;/code&gt;çš„å‰ä¸‰ä¸ªå­—ç¬¦ï¼ŒæŸ¥æ‰¾&lt;code&gt;pdata[0] == G&lt;/code&gt;ï¼Œ&lt;code&gt;pdata[1] == E&lt;/code&gt;å’Œ&lt;code&gt;pdata[2] == T&lt;/code&gt;ï¼Œè¿™å°†æœ‰æ•ˆåœ°å¸®åŠ©æˆ‘ä»¬ç¡®å®šé¦–å…ˆæ˜¯å¦æ˜¯ HTTP è¯·æ±‚ï¼Œç‰¹åˆ«æ˜¯æ˜¯å¦æ˜¯ HTTP è¯·æ±‚ï¼&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬éªŒè¯äº†è¿™å‰ 3 ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å°†æƒ³è¦ä»ç¬¬ 4 ä¸ªå­—èŠ‚ï¼ˆè¯·æ±‚çš„å‰ä¸‰ä¸ªå­—èŠ‚åŠ ä¸Šä¸€ä¸ªç”¨äºåˆ†éš”çš„ç©ºæ ¼ï¼‰å¼€å§‹è¯»å–æ›´å¤šæ•°æ®ï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_path_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;memset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æŸ¥æ‰¾è¯·æ±‚ URIï¼ˆä»åç§»é‡ 4 å¼€å§‹ï¼‰ï¼Œä»¥ç©ºæ ¼ç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;path_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„å‡½æ•°å°†ä» HTTP æ•°æ®çš„ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆä»ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹ï¼‰è¯»å–å…¶ä½™çš„æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç©ºæ ¼ä¸ºæ­¢ï¼Œç•™ä¸‹æˆ‘ä»¬è¦&lt;code&gt;GET&lt;/code&gt;çš„ URLï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªè°ƒè¯•æ‰“å°è¯­å¥æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;bpf_printk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;lt;- incoming path [%s], length [%d]&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;idle&amp;gt;-0       [001] dNs3. 2252901.017812: bpf_trace_printk: &amp;lt;- incoming path [/test], length [5]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¯¹-http-åº”ç”¨ç¨‹åºè¯·æ±‚é‡‡å–è¡ŒåŠ¨&#34;&gt;å¯¹ HTTP åº”ç”¨ç¨‹åºè¯·æ±‚é‡‡å–è¡ŒåŠ¨&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°è§£é‡Šè¯¦ç»†è¯´æ˜äº†æˆ‘ä»¬å¦‚ä½•è¯»å–æ•°æ®ä»¥åŠå¦‚ä½•è¯»å–æ•°æ®ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³è¦â€œåŠ¨æ€â€æŸ¥æ‰¾ HTTP è¯·æ±‚ï¼Œæˆ‘ä»¬å°†éœ€è¦ä½¿ç”¨ eBPF æ˜ å°„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„ Go ç”¨æˆ·ç©ºé—´ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;path&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;The URL Path to watch for&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// åˆ›å»ºä¸€ä¸ª uint8 æ•°ç»„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;urlPath&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å°†æˆ‘ä»¬çš„å­—èŠ‚å¤åˆ¶åˆ° uint8 æ•°ç»„ä¸­ï¼ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;urlPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å°†æˆ‘ä»¬çš„ urlPath ä½œä¸ºé”®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;objs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;UrlMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;urlPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;bpfUrlPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;urlPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;PathLen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uint8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;urlPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œå½“æˆ‘ä»¬å¯åŠ¨ Go ç¨‹åºæ—¶ï¼Œå®ƒå°†ä»æ ‡å¿—&lt;code&gt;-path&lt;/code&gt;ä¸­è¯»å–ï¼Œå¹¶å°†å…¶ç”¨ä½œæˆ‘ä»¬ eBPF æ˜ å°„ä¸­çš„&lt;strong&gt;é”®&lt;/strong&gt;ï¼Œå¯ä»¥æš‚æ—¶å¿½ç•¥å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;url_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;found_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;found_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;bpf_printk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Looks like we&amp;#39;ve found your path [%s]&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// å¯èƒ½è¿›è¡Œæ›´å¤šæ“ä½œï¼Œé˜»æ­¢æµé‡æˆ–é‡å®šå‘ï¼Ÿ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æˆ‘ä»¬çš„ eBPF ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†å¯¹ HTTP è¯·æ±‚è¿›è¡Œæ˜ å°„æŸ¥æ‰¾ï¼Œå¦‚æœè¯¥è¯·æ±‚ä½œä¸º char æ•°ç»„å­˜åœ¨äº&lt;strong&gt;é”®&lt;/strong&gt;ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œï¼&lt;/p&gt;
&lt;p&gt;ç°åœ¨å¯åŠ¨æˆ‘ä»¬çš„ Go ç¨‹åº &lt;code&gt;sudo ./http -interface ens160 -path /test&lt;/code&gt; å°†å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;INFO[0000] Starting ğŸ the eBPF HTTP watcher, on interface [ens160] for path [/test]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;INFO[0000] Loaded TC QDisc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;INFO[0000] Press Ctrl-C to exit and remove the program
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] d.s3. 2252901.015575: bpf_trace_printk: &amp;lt;- 0.0.0.0:56345 -&amp;gt; 0.0.0.0:80
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] D.s3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;. 2252901.015642: bpf_trace_printk: -&amp;gt; 192.168.0.22:80 -&amp;gt; 192.168.0.180:56345
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] d.s3. 2252901.017552: bpf_trace_printk: &amp;lt;- 0.0.0.0:56345 -&amp;gt; 0.0.0.0:80
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] d.s3. 2252901.017793: bpf_trace_printk: &amp;lt;- 0.0.0.0:56345 -&amp;gt; 0.0.0.0:80
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] dNs3. 2252901.017812: bpf_trace_printk: &amp;lt;- incoming path [/test], length [5]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &amp;lt;idle&amp;gt;-0       [001] dNs3. 2252901.017814: bpf_trace_printk: Looks like we&amp;#39;ve found your path [/test]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;è§£æ HTTP å¹¶ä¸å¤ªå›°éš¾ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åè®®ï¼Œå®ƒä½¿ç”¨ç®€å•çš„åŠ¨è¯å’Œç»“æ„çš„ç®€å•æ–¹æ³•ï¼Œä½¿ç”¨ç©ºæ ¼å’Œå›è½¦ç¬¦æ¥åŒºåˆ†ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¹Ÿé€‚ç”¨äºå…¶ä»–åè®®ï¼Œå¦‚ DNSã€POP3 æˆ– SMTPã€‚å½“æ•°æ®åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§è§£å¯†çš„æ–¹æ³•ï¼Œç„¶åæ‰èƒ½è§£ææ•°æ®ï¼ˆè¿™è¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›&amp;hellip;ï¼‰ã€‚ä½†æ˜¯ï¼Œæˆ‘å¸Œæœ›è¿™ä¼šæ¿€å‘ä½ æ›´å¤šåœ°å°è¯•ä½¿ç”¨ eBPF æ¥è§£æå’Œæ“ä½œåº”ç”¨ç¨‹åºçš„æƒ³æ³•ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸€ç›´æƒ³å†™ä¸€äº›æœ‰å¸Œæœ›æœ‰ç”¨çš„å…³äº eBPF çš„å¸–å­ï¼Œå°½ç®¡é€šå¸¸åœ¨æˆ‘æƒ³å‡ºå¯èƒ½æœ‰ç”¨çš„ä¸œè¥¿ä¹‹åï¼Œåˆ«äººå·²ç»æŠ¢å…ˆä¸€æ­¥ã€‚é‰´äºæˆ‘å·²ç»åœ¨ä¸€æ®µæ—¶é—´é‡Œä»¥æŸç§æ–¹å¼å…³æ³¨ç½‘ç»œï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯æˆ‘å…³æ³¨çš„é¢†åŸŸï¼Œå°½ç®¡æˆ‘ç¡®å®ä¸ºæœ€è¿‘çš„ eBPF å³°ä¼š 2023 ç¼–å†™äº†ä¸€äº›æœ‰è¶£çš„å†…å®¹ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæœ‰å¾ˆå¤šäººå¼€å§‹æ’°å†™ eBPF å†…å®¹ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½ä¼šå‚è€ƒä»–ä»¬çš„å¸–å­ï¼Œè€Œä¸æ˜¯é‡å¤å†…å®¹ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>å¦‚ä½•ç”¨ eBPF æ”¹å˜ç½‘ç»œç¼–ç¨‹çš„æ¸¸æˆè§„åˆ™</title>
      <link>https://jimmysong.io/trans/ebpf-adventures-in-networking/</link>
      <pubDate>Wed, 10 Jan 2024 08:00:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/ebpf-adventures-in-networking/</guid>
      <description>
        
        
        &lt;p&gt;æˆ‘ä¸€ç›´æƒ³å†™ä¸€äº›å…³äº eBPF çš„å¸–å­ï¼Œå¸Œæœ›å®ƒä»¬èƒ½æœ‰æ‰€å¸®åŠ©ï¼Œå°½ç®¡é€šå¸¸åœ¨æˆ‘æƒ³åˆ°å¯èƒ½æœ‰ç”¨çš„ä¸œè¥¿æ—¶ï¼Œå…¶ä»–äººå·²ç»å…ˆæˆ‘ä¸€æ­¥äº†ã€‚é‰´äºæˆ‘å·²ç»åœ¨ç½‘ç»œæ–¹é¢é›†ä¸­ç²¾åŠ›ä¸€æ®µæ—¶é—´ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯æˆ‘ä¸“æ³¨çš„é¢†åŸŸï¼Œå°½ç®¡æˆ‘ç¡®å®è®¾æ³•ä¸ºæœ€è¿‘çš„ eBPF å³°ä¼š 2023 å‡†å¤‡äº†ä¸€äº›æˆ‘è®¤ä¸ºå¾ˆæœ‰è¶£çš„ä¸œè¥¿ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæœ‰å¾ˆå¤šäººå¼€å§‹æ’°å†™å…³äº eBPF çš„å†…å®¹ï¼Œå› æ­¤æˆ‘å¯èƒ½ä¼šå‚è€ƒä»–ä»¬çš„å¸–å­ï¼Œè€Œä¸æ˜¯é‡å¤å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°†ä»ä¸€äº›åœ¨ Linux å†…æ ¸ä¸­å¯èƒ½æˆ–å¯èƒ½ä¸ä¼šé‡åˆ°çš„é¦–å­—æ¯ç¼©å†™æˆ–æŠ€æœ¯å¼€å§‹ã€‚ä½†åŸºæœ¬ä¸Šä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›æ˜¯ä½ ä¿®æ”¹æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿä»¥ä¸ç½‘ç»œæ•°æ®äº¤äº’çš„ä¸»è¦é€‰é¡¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;xdp&#34;&gt;XDP&lt;/h3&gt;
&lt;p&gt;å…³äº eXpress Data Plane å·²ç»å­˜åœ¨å¤§é‡ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä¸ä¼šæ·±å…¥æ¢è®¨å¤ªå¤šç»†èŠ‚ã€‚&lt;code&gt;tl;dr&lt;/code&gt;æ˜¯ XDP eBPF ç¨‹åºæŒ‚é’©åˆ° XDP å°†ä½¿å…¶èƒ½å¤Ÿè®¿é—®ç”±å†…æ ¸è‡ªèº«å¤„ç†ä¹‹å‰çš„ä¼ å…¥ç½‘ç»œå¸§ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒeBPF ç¨‹åºå°†åŠ è½½åˆ° NIC é©±åŠ¨ç¨‹åºæœ¬èº«ä¸­ï¼Œè¿™å°†æœ‰æ•ˆåœ°å°†ç¨‹åºå¸è½½åˆ° NIC æœ¬èº«ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹&#34;&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ€ä½³æ€§èƒ½&lt;/li&gt;
&lt;li&gt;éå¸¸é€‚ç”¨äºé˜²ç«å¢™ã€DDoS é˜²æŠ¤æˆ–è´Ÿè½½å‡è¡¡ç­‰ç”¨ä¾‹&lt;/li&gt;
&lt;li&gt;åœ¨ä»»ä½•å…¶ä»–å†…å®¹è¿›è¡Œä¿®æ”¹ä¹‹å‰çœ‹åˆ°ä¼ å…¥çš„æµé‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¼ºç‚¹&#34;&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»…æ”¯æŒå…¥ç«™æµé‡ï¼Œä½¿ç”¨ XDP ç¨‹åºçœ‹åˆ°çš„ä»»ä½•æµé‡éƒ½åªæ˜¯ä¼ å…¥æµé‡ï¼Œç›®å‰æ— æ³•çœ‹åˆ°å‡ºç«™æµé‡&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;XDP&lt;/code&gt;æ•°æ®ç»“æ„ï¼Œä¸å¤§å¤šæ•°å¥—æ¥å­—ç¼–ç¨‹çš„é»˜è®¤æ•°æ®ç»“æ„&lt;code&gt;SKB&lt;/code&gt;æœ‰ä¸€äº›ä¸åŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tctraffic-controlæˆ–æµé‡æ§åˆ¶&#34;&gt;TCï¼ˆTraffic Controlï¼‰æˆ–æµé‡æ§åˆ¶&lt;/h3&gt;
&lt;p&gt;Traffic Control æ˜¯å†…æ ¸ç½‘ç»œç»“æ„çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬æ·»åŠ è¯¸å¦‚ qdisc å’Œè¿‡æ»¤å™¨ä¹‹ç±»çš„åŠŸèƒ½åˆ°æ¥å£çš„èƒ½åŠ›ã€‚qdisc ä¸»è¦é›†ä¸­åœ¨ä¸º TBDï¼ˆå¾…å®šï¼‰æä¾›æœåŠ¡ï¼Œè€Œè¿‡æ»¤å™¨é€šå¸¸åœ¨åº•å±‚å®é™…ä¸Šæ˜¯ä¸€ä¸ª eBPF ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„å·¥ä½œæµç¨‹æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªå…³æ³¨å…¥å£æˆ–å‡ºå£çš„ qdiscï¼Œæˆ–è€…æ›¿æ¢ä¸€ä¸ªç°æœ‰çš„ qdiscã€‚qdisc å°†é™„åŠ åˆ°æ¥å£ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;åŠ è½½ä½ çš„ eBPF ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå°†å…¶é™„åŠ åˆ°é€šè¿‡æ¥å£ä¸Šçš„ qdisc ä¸Šçš„å…¥å£æˆ–å‡ºå£ä¹‹ä¸€ã€‚è¯¥è¿‡æ»¤å™¨å°†ä¸ eBPF ç¨‹åºç›¸å…³è”ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ä¼ å…¥æˆ–ä¼ å‡ºçš„æµé‡ç°åœ¨éƒ½ä¼šé€šè¿‡ä¸€ä¸ªç¨‹åºè¿è¡Œï¼ˆå¦‚æœè¿æ¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è·åˆ© ğŸ’°&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹-1&#34;&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æä¾›å…¥å£å’Œå‡ºå£çš„æŒ‚é’©ç‚¹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¼ ç»Ÿçš„&lt;code&gt;SKB&lt;/code&gt;æ•°æ®ç»“æ„&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¼ºç‚¹-1&#34;&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å°† TC ç¨‹åºé™„åŠ åˆ°å…¥å£æˆ–å‡ºå£é˜Ÿåˆ—ç¨å¾®å¤æ‚ä¸€äº›ã€‚ç”¨æˆ·éœ€è¦ä½¿ç”¨ qdisc æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼ŒæŸäº› eBPF SDK ä¸ä¼šåŸç”Ÿæ”¯æŒ TC ç¨‹åºçš„ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;TC eBPF ç¨‹åºçœ‹åˆ°çš„æµé‡å¯èƒ½å·²ç»è¢«ä¹‹å‰çš„ XDP ç¨‹åºæˆ–å†…æ ¸æœ¬èº«ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç³»ç»Ÿè°ƒç”¨&#34;&gt;ç³»ç»Ÿè°ƒç”¨&lt;/h3&gt;
&lt;p&gt;ä¸å…¶ä»–ä¸¤ç§ä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†ç½‘ç»œçš„æ–¹æ³•ç›¸æ¯”ï¼Œè¿™å¯èƒ½ä¼šæ˜¾å¾—æœ‰äº›å¥‡æ€ªï¼Œå› ä¸ºå®ƒæ˜¯å°†ä¸€äº› eBPF ä»£ç é™„åŠ åˆ°å†…æ ¸ä¸­çš„ç³»ç»Ÿè°ƒç”¨çš„ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œå…·ä½“æ¥è¯´æ˜¯&lt;code&gt;tcp4_connect()&lt;/code&gt; / &lt;code&gt;tcp6_connect()&lt;/code&gt;ç­‰è°ƒç”¨ã€‚è¿™åœ¨åè®®æ ˆä¸­ç•¥å¾®é åï¼Œå› ä¸ºåœ¨æ­¤æ—¶ï¼Œä¼ å…¥æ•°æ®åŒ…å·²ç»ç»è¿‡äº†å¾ˆå¤šå†…æ ¸é€»è¾‘ï¼Œè€Œ eBPF å†…çœç‚¹æ˜¯å½“æµé‡å³å°†ä¸åº”ç”¨ç¨‹åºæœ¬èº«äº¤äº’æ—¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¼–å†™ç½‘ç»œç¨‹åº&#34;&gt;ç¼–å†™ç½‘ç»œç¨‹åºï¼&lt;/h2&gt;
&lt;p&gt;æ‰€ä»¥åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬ï¼ˆå¸Œæœ›ï¼‰æ„è¯†åˆ°æˆ‘ä»¬æœ‰è®¸å¤šä¸åŒçš„å…¥å£ç‚¹ï¼Œå…è®¸æˆ‘ä»¬åœ¨â€œä¼ é€å¸¦â€ä¸Šæ³¨å…¥æˆ‘ä»¬çš„ä»£ç ï¼Œè¿™ä¸ªä¼ é€å¸¦ä» NIC å¼€å§‹ï¼Œä¸€ç›´åˆ°åº”ç”¨ç¨‹åºï¼ˆä»¥åŠåœ¨å‡ºç«™çš„æƒ…å†µä¸‹ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å›é¡¾&#34;&gt;å›é¡¾&lt;/h3&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬æ‰€è°“çš„â€œä¼ é€å¸¦â€çš„å¼€å¤´ï¼Œæˆ‘ä»¬å¯ä»¥é™„åŠ æˆ‘ä»¬çš„ XDP ç¨‹åºå¹¶è·å¾—æœªç»è§¦ç¢°çš„åŸå§‹ç½‘ç»œæ•°æ®ã€‚åœ¨â€œä¼ é€å¸¦â€çš„ä¸­é—´ï¼Œæˆ‘ä»¬çš„ TC ç¨‹åºå°†æˆä¸ºé€šè¿‡å†…æ ¸çš„è·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶æ¥æ”¶å¯èƒ½è¢«ä¿®æ”¹çš„ç½‘ç»œæ•°æ®ã€‚åœ¨ä¼ é€å¸¦çš„æœ«ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç é™„åŠ åˆ°åº”ç”¨ç¨‹åºå°†åœ¨å®ƒè¢«è¿è¡Œä¹‹å‰è·å–ç½‘ç»œæ•°æ®çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥åœ¨ä¼ é€å¸¦çš„æœ«ç«¯è¿›è¡Œé™„åŠ ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®è¡¨ç¤º&#34;&gt;æ•°æ®è¡¨ç¤º&lt;/h3&gt;
&lt;p&gt;ä½ çš„ç¨‹åºé™„åŠ åˆ°çš„ä½ç½®å†³å®šäº†ä¸¤ä¸ªä¸»è¦äº‹ç‰©ï¼Œä¸€ä¸ªæ˜¯æ½œåœ¨çš„æµé‡ä¿®æ”¹çš„ç›¸å¯¹çº§åˆ«ï¼Œå¦ä¸€ä¸ªæ˜¯æµé‡çš„è¡¨ç¤ºæ–¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;xdp-ç»“æ„&#34;&gt;XDP ç»“æ„&lt;/h3&gt;
&lt;p&gt;æˆ‘ä¼šå†™å…³äºå®ƒçš„å†…å®¹ï¼Œä½†æ˜¯ DataDog å·²ç»åšäº†ï¼Œä½ å¯ä»¥åœ¨&lt;a href=&#34;https://www.datadoghq.com/blog/xdp-intro/#the-flow-of-an-xdp-program&#34; title=&#34;è¿™é‡Œ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;é˜…è¯»ã€‚&lt;/p&gt;
&lt;h3 id=&#34;skbå¥—æ¥å­—ç¼“å†²åŒº&#34;&gt;SKBï¼ˆå¥—æ¥å­—ç¼“å†²åŒºï¼‰&lt;/h3&gt;
&lt;p&gt;SKB æ˜¯åœ¨ eBPF æ·»åŠ åˆ°å†…æ ¸ä¹‹å‰å°±å­˜åœ¨äºå†…æ ¸ä¸­çš„æ•°æ®ç±»å‹ï¼Œå®ƒå·²ç»å…·å¤‡äº†ä¸€äº›ä½¿ä¸ SKB å¯¹è±¡äº¤äº’å˜å¾—ç¨å¾®å®¹æ˜“ä¸€äº›çš„è¾…åŠ©åŠŸèƒ½ã€‚æœ‰å…³æ›´æ·±å…¥çš„ SKB ä»‹ç»ï¼Œä½ å¯ä»¥é˜…è¯»æ­¤æ–‡ -&amp;gt; &lt;a href=&#34;http://vger.kernel.org/~davem/skb_data.html&#34; title=&#34;http://vger.kernel.org/~davem/skb_data.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://vger.kernel.org/~davem/skb_data.html&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;è§£ææ•°æ®&#34;&gt;è§£ææ•°æ®&lt;/h3&gt;
&lt;p&gt;æ— è®ºä¸å“ªä¸ªç»“æ„è¿›è¡Œäº¤äº’ï¼Œå®ƒä»¬éƒ½å…±äº«ä¸€äº›å…±åŒä¹‹å¤„ï¼Œè¿™ä¸»è¦æ˜¯ä¸¤ä¸ªå˜é‡ï¼Œå¯¹äºè¿™ä¸¤ç§æ•°æ®ç±»å‹æ¥è¯´æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›å˜é‡æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;data&lt;/code&gt;ï¼Œå®ƒæ˜¯ eBPF ç¨‹åºæ¥æ”¶åˆ°çš„æ•°æ®çš„æŒ‡é’ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;data_len&lt;/code&gt;ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šäº†æœ‰å¤šå°‘æ•°æ®å¯ç”¨ï¼ˆä»¥å¸®åŠ©ç¡®ä¿ä½ æ°¸è¿œä¸ä¼šè®¿é—®&lt;code&gt;data&lt;/code&gt;è¶…è¿‡&lt;code&gt;data_len&lt;/code&gt;ï¼ˆæ˜¾è€Œæ˜“è§çš„çœŸç† ğŸ¤“ï¼‰ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥è¿™ä¸€åˆ‡ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†ç­‰ç­‰&amp;hellip; &lt;code&gt;*data&lt;/code&gt;ä¸­å®é™…ä¸Šæœ‰ä»€ä¹ˆï¼Ÿï¼ˆè¿™å–å†³äºä½ çš„å‘ç°ï¼‰&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸æ–­â€œè½¬æ¢â€&lt;code&gt;*data&lt;/code&gt;å¹¶æ²¿ç€å®ƒç§»åŠ¨ä»¥å‰¥ç¦»å„ç§æ ‡å¤´ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£å’ŒæŸ¥æ‰¾åº•å±‚æ•°æ®ï¼&lt;/p&gt;
&lt;h3 id=&#34;è½¬æ¢&#34;&gt;è½¬æ¢ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥è·³è¿‡æ­¤éƒ¨åˆ†ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿï¼ˆä¸”ç³Ÿç³•ï¼‰çš„ç¤ºä¾‹ï¼Œè¯´æ˜äº†æˆ‘ä»¬é€šå¸¸å¦‚ä½•å°†ä¸€äº›åŸå§‹æ•°æ®è½¬æ¢ä¸ºæœ‰æ„ä¹‰çš„ä¸œè¥¿ã€‚ç›®å‰ï¼Œ&lt;code&gt;*data&lt;/code&gt;å°†åªæ˜¯ä¸€ä¸²éšæœºæ•°æ®ï¼Œæ¯«æ— æ„ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦æœ‰æ•ˆåœ°ä¸ºå…¶æ·»åŠ â€œæ ¼å¼â€ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç†è§£å…¶å¤–è§‚ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸‹éšæœºæ•°æ®è¡Œï¼šâ€œBobby0004500100.503 Harvard Drive90210â€ï¼Œå…¶ä¸­ä¸€äº›å¯¹è£¸çœ¼æ¥è¯´æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æœ‰äº›æ˜¯ä¸æ¸…æ¥šçš„ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è±¡ä¸€ä¸‹åä¸ºâ€œpersonâ€çš„æ•°æ®ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Name: string
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Age: number
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Balance: float
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Street: string
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ZipCode: number
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬è¦å°†æˆ‘ä»¬çš„éšæœºæ•°æ®â€œè½¬æ¢â€ä¸ºä¸Šé¢çš„â€œpersonâ€ç»“æ„ï¼Œå®ƒå°†çªç„¶å˜æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Name: Bobby
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Age: &lt;span class=&#34;m&#34;&gt;45&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Balance: 100.50
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Street: &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Harvard Drive
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ZipCode: &lt;span class=&#34;m&#34;&gt;90210&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨çªç„¶é—´ï¼Œæˆ‘èƒ½å¤Ÿç†è§£å¹¶è®¿é—®ç»“æ„ä¸­çš„åº•å±‚å˜é‡ï¼Œå› ä¸ºå®ƒä»¬ç°åœ¨æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå³ person-&amp;gt;Nameï¼Œå¹¶ä¸”å‘ç°æ­¤ç‰¹å®šçš„ person ç±»å‹å¯¹è±¡å…·æœ‰åç§°å˜é‡â€œBobbyâ€ï¼&lt;/p&gt;
&lt;p&gt;è¿™æ­£æ˜¯æˆ‘ä»¬å°†å¯¹æˆ‘ä»¬çš„&lt;code&gt;*data&lt;/code&gt;æ‰€åšçš„ï¼&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®ä¸­åŒ…å«ä»€ä¹ˆ&#34;&gt;æ•°æ®ä¸­åŒ…å«ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å› æ­¤ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¡®å®šæ•°æ®æ˜¯å¦ä»¥ä»¥å¤ªç½‘å¸§å¼€å¤´ï¼å‡ ä¹æ‰€æœ‰ä¼ è¾“çš„æ•°æ®éƒ½ä»¥ä»¥å¤ªç½‘å¸§å¼€å¤´ï¼Œè¿™ç›¸å½“ç®€å•ï¼Œä½†å…¶ä½œç”¨æ˜¯å…·æœ‰æºå’Œç›®æ ‡ç¡¬ä»¶åœ°å€ï¼ˆæ— è®ºè™šæ‹ŸåŒ–/å®¹å™¨åŒ–/æœ‰çº¿ç½‘ç»œè¿˜æ˜¯ WiFi å¦‚ä½•ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯å°†æˆ‘ä»¬çš„&lt;code&gt;*data&lt;/code&gt;è½¬æ¢ä¸ºç±»å‹&lt;code&gt;ETHHDR&lt;/code&gt;ï¼Œå¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬ç°åœ¨å°†èƒ½å¤Ÿäº†è§£ç»„æˆä»¥å¤ªç½‘å¤´æ•°æ®ç±»å‹çš„å˜é‡ã€‚è¿™äº›åŒ…æ‹¬æºå’Œç›®æ ‡ MAC åœ°å€ï¼Œä½†æ›´é‡è¦çš„æ˜¯å‰©ä½™æ•°æ®çš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚å†æ¬¡ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»¥å¤ªç½‘å¤´ä¹‹åçš„&lt;code&gt;*data&lt;/code&gt;å†…å®¹é€šå¸¸æ˜¯ IP å¤´ï¼Œä½†æˆ‘ä»¬å°†é€šè¿‡æ£€æŸ¥ä»¥å¤ªç½‘å¸§çš„ TBD å˜é‡æ¥éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬éªŒè¯ä¸‹ä¸€ç»„æ•°æ®æ˜¯ IP å¤´ï¼Œæˆ‘ä»¬å°†éœ€è¦å°†ä»¥å¤ªç½‘å¤´ä¹‹åçš„æ•°æ®è½¬æ¢ä¸º IPHDR ç±»å‹ã€‚ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿè®¿é—® IP ç‰¹å®šçš„æ•°æ®ï¼Œä¾‹å¦‚æº IPï¼ˆ&lt;code&gt;saddr&lt;/code&gt;ï¼‰æˆ–ç›®æ ‡åœ°å€ï¼ˆ&lt;code&gt;daddr&lt;/code&gt;ï¼‰ï¼Œå†æ¬¡é‡è¦çš„æ˜¯ IP å¤´åŒ…å«ä¸€ä¸ªå˜é‡ï¼Œè¯¦ç»†è¯´æ˜äº† IP å¤´ä¹‹åçš„æ•°æ®æ˜¯ä»€ä¹ˆã€‚è¿™é€šå¸¸æ˜¯ TCP å¤´æˆ– UDP å¤´ï¼Œä½†è¿˜æœ‰å…¶ä»–é€‰æ‹©ï¼Œä¾‹å¦‚ sctp ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬æŸ¥çœ‹äº† IP å¤´çš„å†…éƒ¨å¹¶ç¡®å®šæ•°æ®ç±»å‹æ˜¯ TCPï¼ˆä¹Ÿå¯èƒ½æ˜¯ UDP æˆ–å…¶ä»–å†…å®¹ï¼‰ï¼Œæˆ‘ä»¬å°†æŠŠä»¥å¤ªç½‘å¤´å’Œ IP å¤´ä¹‹åçš„æ•°æ®éƒ½è½¬æ¢ä¸º TCP å¤´ç±»å‹ï¼ï¼ˆå‡ ä¹å®Œæˆäº†ï¼‰ã€‚é€šè¿‡è®¿é—® TCP å¤´çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾— TCP ç‰¹å®šçš„æ•°æ®ï¼Œä¾‹å¦‚æºç«¯å£æˆ–ç›®æ ‡ç«¯å£ï¼Œç”¨äºéªŒè¯æ•°æ®çš„æœ‰æ•ˆæ€§çš„æ ¡éªŒå’Œä»¥åŠå…¶ä»–æœ‰ç”¨çš„å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å‡ ä¹æ‹¥æœ‰ä¸€åˆ‡ï¼Œä½†æ˜¯ TCP å¤´çš„é•¿åº¦å¯èƒ½æ˜¯å¯å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡æŸ¥çœ‹ tcl_len å˜é‡æ¥ç¡®å®šè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä¹˜ä»¥ 4ã€‚ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†è®¿é—®æœ€ç»ˆæ•°æ®æ‰€éœ€çš„ä¸€åˆ‡ï¼&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;code&gt;*data&lt;/code&gt;æŒ‡å‘æ•°æ®çš„å¼€å¤´ï¼æˆ‘ä»¬å·²ç»ç¡®å®šäº†ä»¥å¤ªç½‘å¤´ä¹‹åæ˜¯ IP å¤´ï¼Œæœ€åæ˜¯ TCP å¤´ï¼Œè¿™æ„å‘³ç€`*data + ä»¥å¤ªç½‘å¤´ + IP å¤´ + TCP å¤´ = å®é™…åº”ç”¨ç¨‹åºæ•°æ®ï¼&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›ä¿¡æ¯åšä»€ä¹ˆ&#34;&gt;æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›ä¿¡æ¯åšä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬è§£æå„ç§æ ‡å¤´æ—¶ï¼Œå®é™…ä¸Šåœ¨ OSI æ¨¡å‹çš„ä¸åŒå±‚æ¬¡ä¸Šè§£é”äº†è¶Šæ¥è¶Šå¤šçš„ä¿¡æ¯ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;[ç¬¬ 2 å±‚]&lt;/strong&gt; ä»¥å¤ªç½‘å¤´ä¸ºæˆ‘ä»¬æä¾›äº†æºå’Œç›®æ ‡ç¡¬ä»¶åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥æ½œåœ¨åœ°é˜»æ­¢ä»æˆ‘ä»¬çŸ¥é“å±é™©çš„æº MAC åœ°å€å¤„ç†çš„å¸§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;[ç¬¬ 3 å±‚]&lt;/strong&gt; IP å¤´åŒ…å«æºå’Œç›®æ ‡ IP åœ°å€ï¼Œå†æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥åƒé˜²ç«å¢™ä¸€æ ·è¿ä½œï¼Œé€šè¿‡ä½¿ç”¨ eBPF ç¨‹åºä¸¢å¼ƒç‰¹å®š IP åœ°å€çš„æ‰€æœ‰æµé‡ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® IP åœ°å€é‡å®šå‘æµé‡ï¼Œæˆ–è€…ç”šè‡³åœ¨è¿™ä¸€å±‚å®æ–½è´Ÿè½½å‡è¡¡é€»è¾‘ï¼Œä»¥å°†æµé‡é‡å®šå‘åˆ°å…¶ä»–åº•å±‚ IP åœ°å€é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;[ç¬¬ 4 å±‚]&lt;/strong&gt; TCP æˆ– UDP æ ‡å¤´å®šä¹‰äº†ç›®æ ‡ç«¯å£å·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥ç¡®å®šåº”ç”¨ç¨‹åºåè®®æ˜¯ä»€ä¹ˆï¼ˆå³ç«¯å£ 80 é€šå¸¸æ„å‘³ç€å‰©ä½™çš„*data å¯èƒ½æ˜¯ HTTP æ•°æ®ï¼‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ‰§è¡Œè´Ÿè½½å‡è¡¡ç­‰æ“ä½œï¼ŒåŸºäºç›®æ ‡ï¼ˆå³åœ¨å¤šä¸ªå…¶ä»–è´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹‹é—´å¹³è¡¡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;[ç¬¬ 7 å±‚]&lt;/strong&gt; æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œå„ç§æ ‡å¤´é›†åˆçš„æœ«å°¾çš„æ•°æ®æ˜¯å®é™…çš„åº”ç”¨ç¨‹åºæ•°æ®ï¼Œåªè¦æˆ‘ä»¬çŸ¥é“æ ¼å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è§£æå®ƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¤–éƒ¨ Web æµè§ˆå™¨å°è¯•è®¿é—®æˆ‘çš„è®¡ç®—æœºä¸Šçš„&lt;code&gt;/index.html&lt;/code&gt;å¹¶é™„åŠ äº† eBPF ç¨‹åºï¼Œæˆ‘ä¼šè§£æåˆ° TCPï¼Œç„¶åç¡®å®šå®ƒæ˜¯ç«¯å£ 80ï¼Œç„¶ååº”ç”¨ç¨‹åºæ•°æ®åº”è¯¥æ˜¯ HTTP æ ¼å¼ã€‚æˆ‘å¯ä»¥é€šè¿‡æŸ¥çœ‹åº”ç”¨ç¨‹åºæ•°æ®çš„å‰ä¸‰ä¸ªå­—ç¬¦ï¼ˆåœ¨æ‰€æœ‰æ ‡å¤´ä¹‹åï¼‰æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨ä»¥ä¸‹ä¼ªä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ApplicationData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; EthernetHDR + IPHDR + TCPHDR // å°†æ‰€æœ‰æ ‡å¤´é•¿åº¦ç›¸åŠ ä»¥æ‰¾åˆ°æ•°æ®
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;If &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; data&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ApplicationData&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;G&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; data&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ApplicationData+1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;E&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; data&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ApplicationData+2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;T&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	// è¿™æ˜¯ä¸€ä¸ªHTTP GETè¯·æ±‚
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	// åšä¸€äº›ä»¤äººå…´å¥‹çš„äº‹æƒ…
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬â€œæœ‰ç‚¹â€ç†è§£äº†è¿™ä¸ªé€»è¾‘ï¼Œä¹Ÿè®¸æˆ‘ä»¬åº”è¯¥è€ƒè™‘å®æ–½ä¸€äº›ä»£ç æ¥å®Œæˆæ‰€æœ‰è¿™äº›&amp;hellip;ä½†è¿™å°†æ˜¯å¦ä¸€å¤©çš„äº‹æƒ…ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—</title>
      <link>https://jimmysong.io/trans/cilium-gateway-api/</link>
      <pubDate>Thu, 04 Jan 2024 08:00:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/cilium-gateway-api/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨ Kubernetes ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºåï¼Œé€šå¸¸çš„ä¸‹ä¸€æ­¥æ˜¯è®©ç”¨æˆ·å¯ä»¥è®¿é—®å®ƒã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; title=&#34;Ingress æ§åˆ¶å™¨&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;&lt;/a&gt;ï¼Œä¾‹å¦‚ Nginxã€Haproxyã€Traefik æˆ–æ¥è‡ªäº‘æä¾›å•†çš„æ§åˆ¶å™¨ï¼Œæ¥å¼•å¯¼ä¼ å…¥çš„æµé‡åˆ°åº”ç”¨ç¨‹åºï¼Œç®¡ç†è´Ÿè½½å¹³è¡¡ã€TLS ç»ˆæ­¢ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä»ä¼—å¤š&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; title=&#34;å¯ç”¨çš„é€‰é¡¹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯ç”¨çš„é€‰é¡¹&lt;/a&gt; ä¸­è¿›è¡Œé€‰æ‹©ã€‚Cilium æ˜¯å…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„é€‰é¡¹ï¼Œæ—¨åœ¨å¤„ç†æ‰€æœ‰è¿™äº›ç½‘ç»œæ–¹é¢çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; title=&#34;Cilium&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Cilium&lt;/strong&gt;&lt;/a&gt; æ˜¯ä¸€ä¸ªåŸºäº eBPF çš„å¼€æºç½‘ç»œå’Œå®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œå…¶é‡‡ç”¨é€Ÿåº¦å¢é•¿è¿…çŒ›ã€‚å®ƒå¯èƒ½æ˜¯æä¾›æœ€å¤šåŠŸèƒ½çš„ç½‘ç»œæ’ä»¶ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ä¼šæ¶µç›–æ‰€æœ‰åŠŸèƒ½ï¼Œä½†å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ¶‰åŠä½¿ç”¨&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; title=&#34;Gateway API&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Gateway API&lt;/strong&gt;&lt;/a&gt; (&lt;code&gt;GAPI&lt;/code&gt;) ç®¡ç†ä¼ å…¥æµé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬çš„ç›®æ ‡&#34;&gt;æˆ‘ä»¬çš„ç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‡†ç¡®äº†è§£ &lt;strong&gt;Gateway API&lt;/strong&gt; æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•ä»£è¡¨ä» &lt;code&gt;Ingress&lt;/code&gt; API è¿›åŒ–è€Œæ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ¼”ç¤ºä»¥ GitOps æ–¹å¼éƒ¨ç½²çš„çœŸå®åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰çš„é™åˆ¶å’Œå³å°†æ¨å‡ºçš„æ–°åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;



&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æç¤º
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    &lt;p&gt;æœ¬æ–‡ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤éƒ½æ¥è‡ªè¿™ä¸ª&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; title=&#34;git å­˜å‚¨åº“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;git å­˜å‚¨åº“&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é¼“åŠ±ä½ æ¢ç´¢å®ƒï¼Œå› ä¸ºå®ƒè¿œè¿œè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å¯ç”¨äº† kube-proxy æ›¿ä»£å¹¶å…·æœ‰ä¸“ç”¨ Daemonset ç”¨äº &lt;code&gt;Envoy&lt;/code&gt; çš„ &lt;code&gt;Cilium&lt;/code&gt; é…ç½®çš„ &lt;strong&gt;EKS&lt;/strong&gt; é›†ç¾¤çš„å®‰è£…ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºäº†å…·æœ‰ä¾èµ–å…³ç³»ç®¡ç†å’Œæˆ‘è®¤ä¸ºéå¸¸é«˜æ•ˆçš„ DRY ä»£ç çš„ &lt;code&gt;Flux&lt;/code&gt; ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;ç®€åŒ–äº†ç”¨äºå¹³å°ç»„ä»¶çš„ IAM æƒé™ç®¡ç†çš„ &lt;code&gt;Crossplane&lt;/code&gt; å’Œ &lt;a href=&#34;https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html&#34; title=&#34;IRSA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IRSA&lt;/a&gt; ç»„åˆã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;External-DNS&lt;/code&gt; å’Œ &lt;code&gt;Let&#39;s Encrypt&lt;/code&gt; è‡ªåŠ¨ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªæƒ³æ³•æ˜¯åªéœ€å‡ åˆ†é’Ÿå†…è®¾ç½®å¥½ä¸€åˆ‡ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚&lt;/p&gt;

  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;ä»‹ç»-gateway-api&#34;&gt;ä»‹ç» Gateway API&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæœ‰è®¸å¤š&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;é€‰é¡¹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹å®šæ€§å’Œç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ‰æ—¶ä¼šä½¿å®ƒä»¬çš„ä½¿ç”¨å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼ŒKubernetes ä¸­ä¼ ç»Ÿçš„ &lt;code&gt;Ingress&lt;/code&gt; API å…·æœ‰éå¸¸æœ‰é™çš„å‚æ•°ã€‚ä¸€äº›è§£å†³æ–¹æ¡ˆç”šè‡³åˆ›å»ºäº†è‡ªå·±çš„&lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/&#34; title=&#34;CRDs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRDs&lt;/a&gt;ï¼ˆKubernetes è‡ªå®šä¹‰èµ„æºï¼‰ï¼Œè€Œå…¶ä»–è§£å†³æ–¹æ¡ˆåˆ™ä½¿ç”¨ &lt;code&gt;annotations&lt;/code&gt; æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯&lt;strong&gt;Gateway API&lt;/strong&gt;çš„ç”¨æ­¦ä¹‹åœ°ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§&lt;strong&gt;æ ‡å‡†&lt;/strong&gt;ï¼Œå…è®¸å£°æ˜é«˜çº§ç½‘ç»œåŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº•å±‚æ§åˆ¶å™¨è¿›è¡Œç‰¹å®šæ‰©å±•ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰æ§åˆ¶å™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ APIï¼Œå› æ­¤å¯ä»¥åœ¨ä¸æ”¹å˜é…ç½®çš„æƒ…å†µä¸‹ä»ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆKubernetes æ¸…å•æè¿°äº†å¦‚ä½•è·¯ç”±ä¼ å…¥æµé‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å°†è¦æ¢è®¨çš„æ¦‚å¿µä¸­ï¼ŒGAPI å¼•å…¥äº†ä¸€ä¸ªç²¾ç»†çš„æˆæƒæ¨¡å‹ï¼Œå®šä¹‰äº†å…·æœ‰ä¸åŒæƒé™çš„&lt;strong&gt;æ˜¾å¼è§’è‰²&lt;/strong&gt;ï¼ˆæœ‰å…³ GAPI å®‰å…¨æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/security-model/#roles-and-personas&#34; title=&#34;è¿™é‡Œ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡¹ç›®ç”±&lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; title=&#34;sig-network-kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sig-network-kubernetes&lt;/a&gt;å·¥ä½œç»„æ¨åŠ¨ï¼Œè¿˜æœ‰ä¸€ä¸ª Slack &lt;a href=&#34;https://kubernetes.slack.com/archives/CR0H13KGA&#34; title=&#34;é¢‘é“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢‘é“&lt;/a&gt;ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶è”ç³»ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨ GAPI ä¸ Ciliumï¼&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾å·²éƒ¨ç½²äº†ä¸€ä¸ª EKS é›†ç¾¤ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/tree/main/terraform/eks&#34; title=&#34;æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•&lt;/a&gt;ä½œä¸ºæœ¬æ–‡çš„åŸºç¡€ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›&lt;strong&gt;è¦æ£€æŸ¥çš„è¦ç‚¹&lt;/strong&gt;ï¼Œä»¥ä¾¿ä½¿ç”¨ GAPIã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„æè¿°çš„å®‰è£…æ–¹æ³•åŸºäº &lt;code&gt;Helm&lt;/code&gt;ï¼Œæ‰€æœ‰çš„ &lt;code&gt;values&lt;/code&gt; å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/terraform/eks/helm_values/cilium.yaml&#34; title=&#34;è¿™é‡Œ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/tree/main/config/crd&#34; title=&#34;Gateway API&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt;å­˜å‚¨åº“ä¸­&lt;strong&gt;å®‰è£…&lt;/strong&gt;å¯ç”¨çš„ &lt;code&gt;CRDs&lt;/code&gt;ã€‚&lt;/p&gt;



&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æ³¨æ„
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    å¦‚æœ Cilium è®¾ç½®ä¸ºæ”¯æŒ &lt;code&gt;GAPI&lt;/code&gt;ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œå¹¶ä¸”ç¼ºå°‘ CRDsï¼Œåˆ™å®ƒå°†æ— æ³•å¯åŠ¨ã€‚åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; title=&#34;æ¼”ç¤ºå­˜å‚¨åº“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;GAPI CRDs&lt;/strong&gt;åœ¨é›†ç¾¤åˆ›å»ºæœŸé—´å®‰è£…ä¸€æ¬¡ï¼Œä»¥ä¾¿ Cilium å¯ä»¥å¯åŠ¨ï¼Œç„¶åç”± Flux ç®¡ç†ã€‚
  &lt;/div&gt;
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ Cilium å’Œ &lt;code&gt;eBPF&lt;/code&gt; çš„ç½‘ç»œè½¬å‘åŠŸèƒ½&lt;strong&gt;æ›¿æ¢&lt;/strong&gt; &lt;code&gt;kube-proxy&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;kubeProxyReplacement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯ç”¨&lt;/strong&gt; Gateway API æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;gatewayAPI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥&lt;/strong&gt;å®‰è£…ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å®‰è£…åä¸º &lt;code&gt;cilium&lt;/code&gt; çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æˆ‘ä¸ªäººä½¿ç”¨ &lt;a href=&#34;https://blog.ogenki.io/post/asdf/asdf/&#34; title=&#34;asdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;asdf&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf plugin-add cilium-cli
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf install cilium-cli 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf global cilium 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å…è®¸ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status --wait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Deployment             cilium-operator    Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium             Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium-envoy       Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Containers:            cilium             Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Cluster Pods:          33/33 managed by Cilium
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Helm chart version:    1.14.2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Image versions         cilium             quay.io/cilium/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    quay.io/cilium/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       quay.io/cilium/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† Gateway API æ”¯æŒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium config view | grep -w &amp;#34;enable-gateway-api&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api                                true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api-secrets-sync                   true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹ç«¯åˆ°ç«¯æµ‹è¯•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium connectivity test
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œæ­¤å‘½ä»¤ï¼ˆ&lt;code&gt;connectivity test&lt;/code&gt;ï¼‰å½“å‰åœ¨å¯ç”¨ Envoy ä½œä¸º DaemonSet æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚(&lt;a href=&#34;https://github.com/cilium/cilium/issues/28057&#34; title=&#34;Github Issue&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;



&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æç¤º
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Envoy ä½œä¸º DaemonSet&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä»£ç†è¿˜åœ¨åŒä¸€ Pod ä¸­è¿è¡Œ &lt;code&gt;Envoy&lt;/code&gt;ï¼Œå¹¶å§”æ‰˜ç»™å®ƒçº§åˆ« 7 çš„ç½‘ç»œæ“ä½œã€‚ä»ç‰ˆæœ¬ &lt;code&gt;v1.14&lt;/code&gt; å¼€å§‹ï¼Œå¯ä»¥å°† Envoy å•ç‹¬éƒ¨ç½²ï¼Œè¿™å¸¦æ¥äº†ä¸€äº›å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¿®æ”¹/é‡æ–°å¯åŠ¨ä¸€ä¸ªç»„ä»¶ï¼ˆæ— è®ºæ˜¯ Cilium è¿˜æ˜¯ Envoyï¼‰ï¼Œéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ›´å¥½åœ°åˆ†é…èµ„æºç»™æ¯ä¸ªç»„ä»¶ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æŸä¸ª Pod è¢«æ”»å‡»çš„æƒ…å†µä¸‹é™åˆ¶æ”»å‡»é¢ã€‚&lt;/li&gt;
&lt;li&gt;Envoy æ—¥å¿—å’Œ Cilium ä»£ç†æ—¥å¿—ä¸ä¼šæ··åˆåœ¨ä¸€èµ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ­¤åŠŸèƒ½æ˜¯å¦å·²å¯ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-release-114/#h-envoy-daemonset&#34; title=&#34;æ›´å¤šä¿¡æ¯&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;

  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;å…¥å£ç‚¹gatewayclass-å’Œ-gateway&#34;&gt;å…¥å£ç‚¹ï¼šGatewayClass å’Œ Gateway&lt;/h2&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/cilium-gateway-api/gateway_hu_a2c793692ef28465.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/cilium-gateway-api/gateway.jpg&#34; data-img=&#34;/trans/cilium-gateway-api/gateway.jpg&#34; data-width=&#34;1374&#34; data-height=&#34;1008&#34; alt=&#34;image&#34; data-caption=&#34;ç½‘å…³&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;ç½‘å…³&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä¸€æ—¦æ»¡è¶³å…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¤šä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Gateway API CRDs å®šä¹‰çš„è‡ªå®šä¹‰èµ„æºã€‚è€Œä¸”ï¼Œåœ¨å®‰è£… Cilium åï¼Œä¸€ä¸ª &lt;code&gt;GatewayClass&lt;/code&gt; ç«‹å³å¯ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gatewayclasses.gateway.networking.k8s.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME     CONTROLLER                     ACCEPTED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium   io.cilium/gateway-controller   True       7m59s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ Kubernetes é›†ç¾¤ä¸Šï¼Œä½ å¯ä»¥é…ç½®å¤šä¸ª &lt;code&gt;GatewayClasses&lt;/code&gt;ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;Gateway&lt;/code&gt; é…ç½®ä¸­å¼•ç”¨ GatewayClass æ¥ä½¿ç”¨ &lt;code&gt;Linkerd&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Gateway&lt;/code&gt; æ˜¯å…è®¸è§¦å‘åœ¨äº‘æä¾›å•†ä¸­åˆ›å»ºè´Ÿè½½å‡è¡¡ç»„ä»¶çš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/gateway.yaml&#34; title=&#34;apps/base/echo/gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ AWSï¼ˆEKSï¼‰ä¸Šï¼Œé…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ—¶ï¼ŒCilium ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º &lt;code&gt;LoadBalancer&lt;/code&gt; çš„ &lt;code&gt;Service&lt;/code&gt;ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆ&lt;a href=&#34;https://kubernetes-sigs.github.io/aws-load-balancer-controller&#34; title=&#34;AWS Load Balancer Controller&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Load Balancer Controller&lt;/a&gt;ï¼‰å¤„ç†äº‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆ&lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html&#34; title=&#34;NLB&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NLB&lt;/a&gt;ï¼‰çš„åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get svc -n echo cilium-gateway-echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395/TCP   2m58s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹Ÿä¸ &lt;code&gt;Gateway&lt;/code&gt; ç›¸å…³è”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gateway -n echo echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è·¯ç”±è§„åˆ™httproute&#34;&gt;è·¯ç”±è§„åˆ™ï¼šHTTPRoute&lt;/h2&gt;
&lt;h3 id=&#34;åŸºæœ¬è§„åˆ™&#34;&gt;åŸºæœ¬è§„åˆ™&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/cilium-gateway-api/httproute_hu_13148ac749b54ec.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/cilium-gateway-api/httproute.jpg&#34; data-img=&#34;/trans/cilium-gateway-api/httproute.jpg&#34; data-width=&#34;1930&#34; data-height=&#34;1394&#34; alt=&#34;image&#34; data-caption=&#34;HTTPRoute&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;HTTPRoute&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä¸Šé¢çš„å›¾è¡¨å¯æ€»ç»“ä¸ºå‡ å¥è¯ï¼š&lt;code&gt;HTTPRoute&lt;/code&gt; å…è®¸é€šè¿‡å¼•ç”¨ Gateway å¹¶å®šä¹‰æ‰€éœ€çš„è·¯ç”±å‚æ•°æ¥é…ç½®åˆ°æœåŠ¡çš„è·¯ç”±ã€‚&lt;/p&gt;



&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æç¤º
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Kyverno&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆªæ­¢ç›®å‰ï¼Œæ— æ³•é…ç½®ç”± &lt;code&gt;Gateways&lt;/code&gt; ç”Ÿæˆçš„æœåŠ¡çš„æ³¨é‡Šï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; title=&#34;Github Issue&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚å·²æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³åœ¨åˆ›å»º &lt;code&gt;Gateway&lt;/code&gt; åç«‹å³ä¿®æ”¹ç”± &lt;code&gt;Gateway&lt;/code&gt; åˆ›å»ºçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Kyverno æ˜¯ä¸€ç§ç¡®ä¿é…ç½®ç¬¦åˆæœ€ä½³å®è·µå’Œå®‰å…¨è¦æ±‚çš„å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»…ä½¿ç”¨å®ƒæ¥è½»æ¾æè¿°&lt;a href=&#34;https://kyverno.io/docs/writing-policies/mutate/&#34; title=&#34;çªå˜&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çªå˜&lt;/a&gt;è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/mycluster-0/echo-gw-clusterpolicy.yaml&#34; title=&#34;security/mycluster-0/echo-gw-clusterpolicy.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;security/mycluster-0/echo-gw-clusterpolicy.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mutate-svc-annotations&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kinds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium-gateway-echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mutate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patchStrategicMerge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;external-dns.alpha.kubernetes.io/hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo.${domain_name}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;internet-facing&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-backend-protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tcp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;loadBalancerClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service.k8s.aws/nlb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼ŒæœåŠ¡ &lt;code&gt;cilium-gateway-echo&lt;/code&gt; å°†æ·»åŠ  AWS æ§åˆ¶å™¨çš„æ³¨é‡Šï¼Œä»¥åŠä¸€ä¸ªå…è®¸è‡ªåŠ¨ DNS è®°å½•é…ç½®çš„æ³¨é‡Šã€‚&lt;/p&gt;

  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute.yaml&#34; title=&#34;apps/base/echo/httproute.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹éå¸¸ç®€å•ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° &lt;code&gt;echo-1-echo-server&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parentRefs&lt;/code&gt; æŒ‡ç¤ºä½¿ç”¨å“ªä¸ª &lt;code&gt;Gateway&lt;/code&gt;ï¼Œç„¶ååœ¨ &lt;code&gt;rules&lt;/code&gt; éƒ¨åˆ†å®šä¹‰äº†è·¯ç”±è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;è·¯ç”±è§„åˆ™è¿˜å¯ä»¥åŸºäº &lt;code&gt;path&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;foo.bar.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/login&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…åŸºäº HTTP æ ‡å¤´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯è®¿é—®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s http://echo.cloud.ogenki.io | jq -rc &amp;#39;.environment.HOSTNAME&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1-echo-server-fd88497d-w6sgn
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¯¥æœåŠ¡ä»¥ HTTP æ–¹å¼æš´éœ²ï¼Œæ²¡æœ‰è¯ä¹¦ã€‚è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®-tls-è¯ä¹¦&#34;&gt;é…ç½® TLS è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;æœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ GAPI é…ç½® TLSã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¸¸è§çš„æƒ…å†µï¼šHTTPS åè®®å’Œåœ¨ Gateway ä¸Šç»ˆæ­¢ TLSã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³è¦é…ç½®ä¹‹å‰ä½¿ç”¨çš„åŸŸå &lt;code&gt;echo.cloud.ogenki.io&lt;/code&gt;ã€‚é…ç½®ä¸»è¦é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/tls-gateway.yaml&#34; title=&#34;apps/base/echo/tls-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/tls-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cert-manager.io/cluster-issuer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;letsencrypt-prod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯å¼•ç”¨ä¸€ä¸ªåŒ…å«åç§°ä¸º &lt;code&gt;echo-tls&lt;/code&gt; çš„è¯ä¹¦çš„å¯†é’¥ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ &lt;strong&gt;Let&amp;rsquo;s Encrypt&lt;/strong&gt; å’Œ &lt;code&gt;cert-manager&lt;/code&gt; æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;



&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æç¤º
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    &lt;p&gt;}
&lt;strong&gt;cert-manager&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;cert-manager&lt;/code&gt;ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°ç”± &lt;code&gt;Gateway&lt;/code&gt; æš´éœ²çš„è¯ä¹¦éå¸¸ç®€å•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å…è®¸æ§åˆ¶å™¨è®¿é—® &lt;a href=&#34;https://aws.amazon.com/route53/&#34; title=&#34;route53&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;route53&lt;/a&gt;ï¼Œä»¥è§£å†³ DNS01 æŒ‘æˆ˜ï¼ˆè¿™æ˜¯ä¸€ç§ç¡®ä¿å®¢æˆ·ç«¯åªèƒ½ä¸ºè‡ªå·±æ‹¥æœ‰çš„åŸŸè¯·æ±‚è¯ä¹¦çš„æœºåˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/base/cert-manager/cluster-issuer-staging.yaml&#34; title=&#34;ClusterIssuer&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ClusterIssuer&lt;/a&gt; èµ„æºæè¿°äº†ä½¿ç”¨ cert-manager ç”Ÿæˆè¯ä¹¦æ‰€éœ€çš„é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨é‡Š &lt;code&gt;cert-manager.io/cluster-issuer&lt;/code&gt; å¹¶è®¾ç½®å­˜å‚¨è¯ä¹¦çš„ Kubernetes å¯†é’¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cert-manager.io/docs/usage/gateway/&#34; title=&#34;æ›´å¤šä¿¡æ¯&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¼”ç¤ºå­˜å‚¨åº“ä¸­ï¼Œæƒé™æ˜¯ä½¿ç”¨ &lt;code&gt;Crossplane&lt;/code&gt; åˆ†é…çš„ï¼Œå®ƒè´Ÿè´£åœ¨ AWS ä¸­é…ç½®è¿™äº› IAM æƒé™ã€‚&lt;/p&gt;

  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä½¿è·¯ç”±æ­£å¸¸å·¥ä½œï¼Œä½ è¿˜éœ€è¦å°† &lt;code&gt;HTTPRoute&lt;/code&gt; é™„åŠ åˆ°æ­£ç¡®çš„ &lt;code&gt;Gateway&lt;/code&gt; å¹¶æŒ‡å®šåŸŸåã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡ ç§’é’Ÿåï¼Œè¯ä¹¦å°†è¢«åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get cert -n echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME       READY   SECRET     AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-tls   True    echo-tls   43m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯ä¹¦ç¡®å®æ¥è‡ª Let&amp;rsquo;s Encryptï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl https://echo.cloud.ogenki.io -v 2&amp;gt;&amp;amp;1 | grep -A 6 &amp;#39;Server certificate&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;* Server certificate:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subject: CN=echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  start date: Sep 15 14:43:00 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  expire date: Dec 14 14:42:59 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subjectAltName: host &amp;#34;echo.cloud.ogenki.io&amp;#34; matched cert&amp;#39;s &amp;#34;echo.cloud.ogenki.io&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  issuer: C=US; O=Let&amp;#39;s Encrypt; CN=R3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  SSL certificate verify ok.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æç¤º
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    GAPI è¿˜å…è®¸ä½ é…ç½® &lt;strong&gt;ç«¯åˆ°ç«¯çš„ TLS&lt;/strong&gt;ï¼Œä¸€ç›´åˆ°å®¹å™¨ã€‚è¿™æ˜¯é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; ä¸º &lt;code&gt;Passthrough&lt;/code&gt; æ¨¡å¼å¹¶ä½¿ç”¨ &lt;code&gt;TLSRoute&lt;/code&gt; èµ„æºæ¥å®Œæˆçš„ã€‚è¯ä¹¦ä¹Ÿå¿…é¡»ç”±æ‰§è¡Œ TLS ç»ˆæ­¢çš„ pod æºå¸¦ã€‚
  &lt;/div&gt;
&lt;/div&gt;

&lt;h3 id=&#34;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº«-gateway&#34;&gt;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº« Gateway&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/cilium-gateway-api/shared-gateway_hu_ea5837ff2c91b6fe.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/cilium-gateway-api/shared-gateway.jpg&#34; data-img=&#34;/trans/cilium-gateway-api/shared-gateway.jpg&#34; data-width=&#34;1734&#34; data-height=&#34;1156&#34; alt=&#34;image&#34; data-caption=&#34;å…±äº«ç½‘å…³&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;å…±äº«ç½‘å…³&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;GAPI&lt;/code&gt;ï¼Œä½ å¯ä»¥åœ¨ &lt;code&gt;å‘½åç©ºé—´&lt;/code&gt; ä¹‹é—´è·¯ç”±æµé‡ã€‚è¿™å¾—ç›Šäºæ¯ä¸ªåŠŸèƒ½çš„ä¸åŒèµ„æºï¼šä¸€ä¸ª &lt;code&gt;Gateway&lt;/code&gt; å…è®¸é…ç½®åŸºç¡€è®¾æ–½ï¼Œä»¥åŠ &lt;code&gt;*Routes&lt;/code&gt;ã€‚è¿™äº›è·¯ç”±å¯ä»¥é™„åŠ åˆ°ä½äºå¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ Gatewayã€‚å› æ­¤ï¼Œä¸åŒçš„å›¢é˜Ÿ/é¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™éœ€è¦æŒ‡å®šå“ªä¸ªè·¯ç”±å…è®¸å¼•ç”¨è¯¥ Gatewayã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºå†…éƒ¨å·¥å…·çš„ Gatewayï¼Œåä¸º &lt;code&gt;platform&lt;/code&gt;ã€‚é€šè¿‡ä½¿ç”¨ &lt;code&gt;allowedRoutes&lt;/code&gt; å‚æ•°ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†å“ªäº›å‘½åç©ºé—´å…è®¸é™„åŠ åˆ°æ­¤ Gatewayã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/infrastructure/base/gapi/platform-gateway.yaml&#34; title=&#34;infrastructure/base/gapi/platform-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;infrastructure/base/gapi/platform-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Selector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchExpressions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/metadata.name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;In&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;observability&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;flux-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å‘½åç©ºé—´ &lt;code&gt;observability&lt;/code&gt; å’Œ &lt;code&gt;flux-system&lt;/code&gt; ä¸­é…ç½®çš„ &lt;code&gt;HTTPRoutes&lt;/code&gt; é™„åŠ åˆ°æ­¤å”¯ä¸€çš„ &lt;code&gt;Gateway&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;infrastructure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼Œä½¿ç”¨æ¥è‡ªäº‘æä¾›å•†çš„ç›¸åŒè´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short ${NLB_DOMAIN}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short grafana-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short gitops-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class=&#34;alert alert-note-container&#34;&gt;
  
  &lt;div class=&#34;alert-note-title px-2 py-2&#34;&gt;
    æ³¨æ„
  &lt;/div&gt;
  
  &lt;div class=&#34;alert-note px-2&#34;&gt;
    è¿™äº›å†…éƒ¨å·¥å…·ä¸åº”è¯¥æš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œä½†æ˜¯ä½ çŸ¥é“ï¼šè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…éƒ¨ Gatewayï¼ˆç§æœ‰ IPï¼‰é€šè¿‡è°ƒæ•´æ³¨é‡Šå¹¶ä½¿ç”¨ç§æœ‰è¿æ¥ç³»ç»Ÿï¼ˆVPNã€éš§é“ç­‰ï¼‰æ¥å®ç°ã€‚
  &lt;/div&gt;
&lt;/div&gt;

&lt;h3 id=&#34;æµé‡åˆ†æµ&#34;&gt;æµé‡åˆ†æµ&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/cilium-gateway-api/split_hu_87ccceac85e4a623.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/cilium-gateway-api/split.jpg&#34; data-img=&#34;/trans/cilium-gateway-api/split.jpg&#34; data-width=&#34;1524&#34; data-height=&#34;1036&#34; alt=&#34;image&#34; data-caption=&#34;åˆ†æµ&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;åˆ†æµ&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ç”±æœåŠ¡ç½‘æ ¼å¸¸å¸¸æä¾›çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨æ—¶ï¼ˆA/B æµ‹è¯•æˆ–é‡‘ä¸é›€éƒ¨ç½²ï¼‰å¯¹éƒ¨åˆ†æµé‡æµ‹è¯•åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ã€‚&lt;code&gt;GAPI&lt;/code&gt;é€šè¿‡ä½¿ç”¨æƒé‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿å…¶å˜å¾—éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°† 5% çš„æµé‡è½¬å‘åˆ°æœåŠ¡ &lt;code&gt;echo-2-echo-server&lt;/code&gt; çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute-split.yaml&#34; title=&#34;apps/base/echo/httproute-split.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute-split.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;split-echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-2-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥åˆ†å‘æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/scripts/check-split.sh&#34; title=&#34;scripts/check-split.sh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scripts/check-split.sh&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;./scripts/check-split.sh https://split-echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1 çš„è¯·æ±‚æ¬¡æ•°ï¼š95
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-2 çš„è¯·æ±‚æ¬¡æ•°ï¼š5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¿®æ”¹æ ‡å¤´&#34;&gt;ä¿®æ”¹æ ‡å¤´&lt;/h3&gt;
&lt;p&gt;è¿˜å¯ä»¥æ›´æ”¹ HTTP &lt;strong&gt;æ ‡å¤´&lt;/strong&gt;ï¼šæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚è¿™äº›ä¿®æ”¹å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;HTTPRoute&lt;/code&gt; æ¸…å•ä¸­ä½¿ç”¨ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/httproute#filters-optional&#34; title=&#34;filters&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;filters&lt;/a&gt; åº”ç”¨äºè¯·æ±‚æ ‡å¤´æˆ–å“åº”æ ‡å¤´ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;strong&gt;è¯·æ±‚&lt;/strong&gt; ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/req-header-add&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RequestHeaderModifier&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requestHeaderModifier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤å…è®¸æŸ¥çœ‹æ ‡å¤´æ˜¯å¦ç¡®å®å·²æ·»åŠ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s https://echo.cloud.ogenki.io/req-header-add | jq &amp;#39;.request.headers&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;host&amp;#34;: &amp;#34;echo.cloud.ogenki.io&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;user-agent&amp;#34;: &amp;#34;curl/8.2.1&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;accept&amp;#34;: &amp;#34;*/*&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-for&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-proto&amp;#34;: &amp;#34;https&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-envoy-external-address&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-request-id&amp;#34;: &amp;#34;320ba4d2-3bd6-4c2f-8a97-74296a9f3f26&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;foo&amp;#34;: &amp;#34;bar&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ†é…é€‚å½“çš„æƒé™&#34;&gt;åˆ†é…é€‚å½“çš„æƒé™&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;GAPI&lt;/code&gt; æä¾›äº†ä¸€ç§æ¸…æ™°çš„æƒé™å…±äº«æ¨¡å‹ï¼Œç”¨äºç®¡ç†æµé‡è·¯ç”±åŸºç¡€è®¾æ–½ï¼ˆç”±é›†ç¾¤ç®¡ç†å‘˜ç®¡ç†ï¼‰å’Œåº”ç”¨ç¨‹åºï¼ˆç”±å¼€å‘äººå‘˜ç®¡ç†ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¤šä¸ªè‡ªå®šä¹‰èµ„æºçš„å¯ç”¨æ€§å…è®¸ä½¿ç”¨ Kubernetes çš„ &lt;strong&gt;RBAC&lt;/strong&gt; é…ç½®ä»¥å£°æ˜æ€§æ–¹å¼åˆ†é…æƒé™ã€‚æˆ‘å·²ç»æ·»åŠ äº†ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„æ¼”ç¤ºé›†ç¾¤ä¸­æ²¡æœ‰æ•ˆæœï¼Œä½†å¯èƒ½ä¼šç»™ä½ ä¸€ä¸ªæƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„é…ç½®æˆäºˆ &lt;code&gt;developers&lt;/code&gt; ç»„çš„æˆå‘˜åœ¨ echo å‘½åç©ºé—´å†…ç®¡ç† &lt;code&gt;HTTPRoutes&lt;/code&gt; çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä»…æä¾›å¯¹ &lt;code&gt;Gateways&lt;/code&gt; çš„è¯»å–æƒé™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;httproutes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateways&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;list&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;developers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&#34;&gt;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&lt;/h2&gt;
&lt;p&gt;äººä»¬å¯èƒ½ä¼šå¯¹é€šå¸¸ç§°ä¸º &lt;code&gt;API ç½‘å…³&lt;/code&gt; çš„ä¸œè¥¿æ„Ÿåˆ°å›°æƒ‘ã€‚å·²ç»åˆ›å»ºäº† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/faq/&#34; title=&#34;FAQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAQ&lt;/a&gt; çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä»¥æ¾„æ¸…å®ƒä¸ &lt;code&gt;Gateway API&lt;/code&gt; çš„ä¸åŒä¹‹å¤„ã€‚å°½ç®¡ GAPI æä¾›äº†é€šå¸¸åœ¨ API ç½‘å…³ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ï¼Œä½†å®ƒä¸»è¦æ˜¯ Kubernetes çš„ä¸€ä¸ªç‰¹å®šå®ç°ã€‚ç„¶è€Œï¼Œé€‰æ‹©è¿™ä¸ªåç§°ç¡®å®å¯èƒ½å¼•èµ· &lt;strong&gt;æ··æ·†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡ä»…å…³æ³¨å…¥ç«™æµé‡ï¼Œé€šå¸¸ç”± &lt;em&gt;Ingress Controllers&lt;/em&gt; ç®¡ç†ï¼Œç§°ä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#northsouth-traffic&#34; title=&#34;å—åŒ—&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å—åŒ—&lt;/a&gt;ï¼Œè¿™å®é™…ä¸Šæ˜¯ GAPI çš„åˆå§‹èŒƒå›´ã€‚æœ€è¿‘çš„ä¸€ä¸ªåä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/gamma/&#34; title=&#34;GAMMA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;GAMMA&lt;/strong&gt;&lt;/a&gt; çš„å€¡è®®æ—¨åœ¨å¤„ç† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#eastwest-traffic&#34; title=&#34;ä¸œè¥¿æµé‡&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸œè¥¿æµé‡&lt;/a&gt; è·¯ç”±ï¼Œè¿™å°†åœ¨å°†æ¥æ ‡å‡†åŒ–æŸäº›å¸¸è§çš„åŠŸèƒ½ï¼Œé€šå¸¸ç”± &lt;code&gt;Service Meshes&lt;/code&gt; è§£å†³æ–¹æ¡ˆæä¾›ã€‚ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://kubernetes.io/blog/2023/08/29/gateway-api-v0-8/&#34; title=&#34;æ­¤æ–‡ç« &#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤æ–‡ç« &lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„æƒ³æ³•&#34;&gt;æœ€åçš„æƒ³æ³•&lt;/h2&gt;
&lt;p&gt;è€å®è¯´ï¼Œæˆ‘å·²ç»çŸ¥é“ &lt;strong&gt;Gateway API&lt;/strong&gt; æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚å°½ç®¡æˆ‘è¯»äº†ä¸€äº›æ–‡ç« ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰çœŸæ­£æ·±å…¥ç ”ç©¶è¿‡ã€‚æˆ‘ä¼šæƒ³ï¼šâ€œä¸ºä»€ä¹ˆè¦éº»çƒ¦å‘¢ï¼Ÿæˆ‘çš„ &lt;em&gt;Ingress Controller&lt;/em&gt; å¯ä»¥å·¥ä½œï¼Œè€Œä¸”è¿™éœ€è¦å­¦ä¹ æ›²çº¿ã€‚â€&lt;/p&gt;
&lt;p&gt;GAPI æ­£åœ¨å´­éœ²å¤´è§’ï¼Œå³å°†å‘å¸ƒ GA ç‰ˆæœ¬ã€‚å¤šä¸ª &lt;a href=&#34;https://gateway-api.sigs.k8s.io/implementations/&#34; title=&#34;é¡¹ç›®&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¡¹ç›®&lt;/a&gt; å·²ç»æ‹¥æŠ±å®ƒï¼Œè¿™ä¸ªç”¨äºç®¡ç† Kubernetes å†…æµé‡çš„ API å°†è¿…é€Ÿæˆä¸ºæ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¿…é¡»è¯´ï¼Œé…ç½® GAPI æ„Ÿè§‰ç›´è§‚è€Œæ˜ç¡®ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹å–å¾—äº†å¹³è¡¡ï¼Œèµ‹äºˆå¼€å‘äººå‘˜æƒåŠ›è€Œä¸ä¼šæŸå®³å®‰å…¨æ€§ã€‚è€Œä¸”æ— ç¼çš„åŸºç¡€è®¾æ–½ç®¡ç†ï¼Ÿä½ å¯ä»¥åœ¨ä¸è§¦åŠ &lt;code&gt;*Routes&lt;/code&gt; çš„æƒ…å†µä¸‹åœ¨ä¸åŒçš„å®ç°ä¹‹é—´åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±ç”¨ &lt;code&gt;Cilium&lt;/code&gt; äº¤æ¢æˆ‘çš„ Ingress Controller å—ï¼Ÿ&lt;strong&gt;è¿˜æ²¡æœ‰ï¼Œä½†å®ƒå³å°†åˆ°æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼ŒCilium çš„åŠŸèƒ½éå¸¸å¹¿æ³›ï¼šåœ¨ Kubernetes å‘¨å›´æœ‰å¤§é‡çš„å·¥å…·ï¼ŒCilium è„±é¢–è€Œå‡ºï¼Œæ‰¿è¯ºæä¾›æŒ‡æ ‡ã€è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ã€å®‰å…¨æ€§ï¼Œä»¥åŠ &lt;em&gt;Ingress Controller&lt;/em&gt; ä¸ GAPIã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21929&#34; title=&#34;TCP å’Œ UDP æ”¯æŒ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP å’Œ UDP æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21928&#34; title=&#34;GRPC æ”¯æŒ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GRPC æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦ä½¿ç”¨å˜å¼‚è§„åˆ™æ¥é…ç½®äº‘ç»„ä»¶ï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; title=&#34;Github Issue&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ–‡è®¨è®ºçš„è®¸å¤šåŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µã€‚ä¾‹å¦‚ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ‘å†™ä½œæ—¶çš„ &lt;code&gt;v1.14.2&lt;/code&gt;ï¼‰æ”¯æŒçš„ &lt;a href=&#34;https://github.com/cilium/cilium/pull/27472&#34; title=&#34;æ‰©å±•åŠŸèƒ½&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‰©å±•åŠŸèƒ½&lt;/a&gt;ã€‚æˆ‘å°è¯•è®¾ç½®ä¸€ä¸ªç®€å•çš„ HTTP&amp;gt;HTTPS é‡å®šå‘ï¼Œä½†é‡åˆ°äº† &lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/issues/1185&#34; title=&#34;è¿™ä¸ªé—®é¢˜&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ªé—®é¢˜&lt;/a&gt;ã€‚å› æ­¤ï¼Œæˆ‘é¢„è®¡ API å°†æ¥ä¼šæœ‰ä¸€äº›ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æˆ‘åªæ˜¯æ¶‰åŠäº† Cilium çš„ GAPI èƒ½å¤Ÿæä¾›çš„ä¸€å°éƒ¨åˆ†å†…å®¹ï¼ˆè€å®è¯´ï¼Œè¿™ç¯‡æ–‡ç« å·²ç»ç›¸å½“é•¿äº†ï¼‰ï¼Œä½†æˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥å¾ˆå¿«åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒã€‚ä½†è€ƒè™‘åˆ°å‰é¢æåˆ°çš„å‡ ç‚¹ï¼Œæˆ‘å»ºè®®ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³ä¸ºæœªæ¥åšå‡†å¤‡ï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™äº†ï¼&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; title=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://gateway-api.sigs.k8s.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&#34; title=&#34;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-gateway-api/&#34; title=&#34;https://isovalent.com/blog/post/cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&#34; title=&#34;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Isovalent çš„ &lt;a href=&#34;https://isovalent.com/resource-library/labs/&#34; title=&#34;labs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;labs&lt;/a&gt; æ˜¯å¼€å§‹ä½¿ç”¨ Gateway API å¹¶ä¸”ä½ å°†è·å¾—æ–°çš„å¾½ç« ä»¥æ·»åŠ åˆ°ä½ çš„æ”¶è—ä¸­çš„å¥½æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>JWT åœ¨ API ç½‘å…³ä¸­çš„è§’è‰²ï¼šæœåŠ¡é—´è®¤è¯çš„æ–°è§†è§’</title>
      <link>https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/</link>
      <pubDate>Fri, 08 Dec 2023 12:30:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/</guid>
      <description>
        
        
        &lt;p&gt;äº‘åŸç”Ÿæ¶æ„ä¸­çš„ API ç½‘å…³ç»„ä»¶è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå°†å…³é”®çš„ API å®‰å…¨æ€§å’Œç­–ç•¥åŠŸèƒ½å¸è½½åˆ°ä¸€ä¸ªå…¬å…±ä½ç½®ï¼Œä½¿åç«¯ API å’ŒæœåŠ¡èƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚API èº«ä»½éªŒè¯ã€æˆæƒã€å®¡è®¡ã€é™æµç­‰ä»»åŠ¡å¯èƒ½ä¼šéå¸¸å¤æ‚ä¸”éš¾ä»¥æ­£ç¡®å®ç°ï¼Œå› æ­¤è®¸å¤šç»„ç»‡é€‰æ‹©ä½¿ç”¨ API ç½‘å…³æ¥å¤„ç†å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹äºæœåŠ¡ä¸æœåŠ¡ï¼ˆS2Sï¼‰æˆ–å†…éƒ¨ä¸œ/è¥¿æµé‡å‘¢ï¼Ÿå¼ºåˆ¶ S2S æµé‡â€œå›å¤´â€é€šè¿‡ API ç½‘å…³ä¼šå¼•å…¥é¢å¤–çš„è·³è·ƒã€æ›´å¤šçš„å»¶è¿Ÿã€å¢åŠ çš„æµé‡ä»¥åŠæ•ˆç‡é™ä½ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/hairpin-api-gateway-calls_hu_ae9f04ff53e72979.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/hairpin-api-gateway-calls.png&#34; data-img=&#34;/trans/jwts-authenticate-services-api-gateways/hairpin-api-gateway-calls.png&#34; data-width=&#34;1024&#34; data-height=&#34;768&#34; alt=&#34;image&#34; data-caption=&#34;é€šè¿‡ API ç½‘å…³çš„ S2S æµé‡â€œå›å¤´â€ç¤ºæ„å›¾&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;é€šè¿‡ API ç½‘å…³çš„ S2S æµé‡â€œå›å¤´â€ç¤ºæ„å›¾&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæ‚¨è·³è¿‡ API ç½‘å…³ç›´æ¥è°ƒç”¨æœåŠ¡ï¼Œå¦‚ä½•ç¡®ä¿æµé‡çš„å®‰å…¨æ€§ï¼Ÿæ¥æ”¶æœåŠ¡å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯å¹¶çŸ¥é“æ˜¯è°åœ¨è°ƒç”¨å®ƒï¼Ÿ&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/service-a-b_hu_29648d6247c4f7f3.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/service-a-b.png&#34; data-img=&#34;/trans/jwts-authenticate-services-api-gateways/service-a-b.png&#34; data-width=&#34;1024&#34; data-height=&#34;334&#34; alt=&#34;image&#34; data-caption=&#34;æ˜¾ç¤º Service B éœ€è¦å¯¹ Service A è¿›è¡Œèº«ä»½éªŒè¯çš„ç¤ºæ„å›¾&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;æ˜¾ç¤º Service B éœ€è¦å¯¹ Service A è¿›è¡Œèº«ä»½éªŒè¯çš„ç¤ºæ„å›¾&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä¿éšœ S2S é€šä¿¡çš„ä¸¤ç§å¸¸è§æ–¹å¼æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLSï¼‰å’Œå®¢æˆ·ç«¯è¯ä¹¦ï¼ˆåŒå‘ TLS æˆ– mTLSï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç­¾åçš„ JSON Web Tokensï¼ˆJWTï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://www.solo.io/topics/service-mesh/&#34; title=&#34;æœåŠ¡ç½‘æ ¼&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;é€šè¿‡ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•è‡ªåŠ¨åŒ–äº†è®¸å¤šæœ€ä½³å®è·µå¹¶å‡è½»äº†ä¸ä¹‹ç›¸å…³çš„&lt;a href=&#34;https://istio.io/latest/blog/2023/secure-apps-with-istio/&#34; title=&#34;é—®é¢˜&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å‘äººå‘˜å¯ä»¥é€‰æ‹©ä½¿ç”¨ JWT è¿›è¡Œ S2S èº«ä»½éªŒè¯ï¼Œä½†è¿™ä¼šâ€œå‰Šå¼±â€API ç½‘å…³çš„é¢„æœŸåŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨æ›¾æœŸæœ› API ç½‘å…³å¤„ç†çš„æ‰€æœ‰å®‰å…¨æ€§å¤æ‚æ€§å’Œè„†å¼±æ€§å¿…é¡»åœ¨æ¯ä¸ª S2S é€šä¿¡çš„å¾®æœåŠ¡ä¸­é‡æ–°åˆ›å»ºå’Œå¤åˆ¶ã€‚è¿™æ˜¯ä¸€ä¸ªé‡å¤§é—®é¢˜ï¼Œå› ä¸ºä½¿ç”¨ JWT è¿›è¡Œ S2S èº«ä»½éªŒè¯ä¼šå¼•å…¥å¤æ‚æ€§å’Œå¯¹ç»†èŠ‚çš„ä¸¥æ ¼è¦æ±‚ã€‚ï¼ˆæœ‰å…³æ­¤ä¸»é¢˜å’Œä¸‹é¢çš„åœºæ™¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è§‚çœ‹ Hoot ç¬¬ 59 é›†ï¼šâ€œ&lt;a href=&#34;https://youtu.be/Q2KfNUBfnjo&#34; title=&#34;JWT ä¸ Service-to-Service èº«ä»½éªŒè¯çš„æ¯”è¾ƒ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;JWT ä¸ Service-to-Service èº«ä»½éªŒè¯çš„æ¯”è¾ƒ&lt;/a&gt;â€ã€‚æ‰€æœ‰æ¼”ç¤ºéƒ½å¯ä»¥åœ¨æˆ‘ä»¬çš„&lt;a href=&#34;https://github.com/peterj/jwts-for-services/tree/main&#34; title=&#34;GitHub ä»“åº“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub ä»“åº“&lt;/a&gt;ä¸­æ‰¾åˆ°ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;è™½ç„¶æœ‰ä¸€äº›å‡ºè‰²çš„å¤„ç† JWT çš„æ¡†æ¶å’Œåº“ï¼Œè€Œ JWT ç¡®å®æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ï¼Œä½†å°† JWT ç”¨äº S2S æµé‡çš„èº«ä»½éªŒè¯æ˜¯å¤æ‚ä¸”ç¹é‡çš„ï¼Œå¹¶ä¸”éœ€è¦å¼€å‘äººå‘˜éå¸¸å‡†ç¡®åœ°å®Œæˆå·¥ä½œã€‚è¿™ç§å¤æ‚æ€§ï¼ˆæˆ–ç¼ºä¹æ„è¯†ï¼‰å¯èƒ½ä¼šé™ä½æ€»ä½“å®‰å…¨æ€§ï¼Œå¦‚æœå¼€å‘äººå‘˜é‡‡å–æ·å¾„æˆ–å¿½è§†å…³é”®å±æ€§ï¼Œå¯èƒ½ä¼šé™ä½æ€»ä½“å®‰å…¨æ€§ã€‚å¼€å‘äººå‘˜è¿˜éœ€è¦ä»¥ç‰¹å®šäºè¯­è¨€å’Œæ¡†æ¶çš„æ–¹å¼æ‰§è¡Œæ­¤æ“ä½œï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ Java è§£å†³æ­¤é—®é¢˜ä¸ä½¿ç”¨ Go æˆ– Node.js ä¸åŒï¼‰ã€‚åœ¨æ‰€æœ‰ä»£ç åº“ä¸­ç»´æŠ¤ã€æ‰“è¡¥ä¸å’Œå®¡æ ¸æ¯ä¸ªå®ç°éƒ½éœ€è¦ä»˜å‡ºæˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚ä½•ä½¿ç”¨-jwt-è¿›è¡Œ-s2s-é€šä¿¡èº«ä»½éªŒè¯&#34;&gt;å¦‚ä½•ä½¿ç”¨ JWT è¿›è¡Œ S2S é€šä¿¡èº«ä»½éªŒè¯&lt;/h2&gt;
&lt;p&gt;æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ›å»º JWT ä»¥è¿›è¡Œ S2S é€šä¿¡èº«ä»½éªŒè¯ï¼šä½¿ç”¨èº«ä»½æä¾›è€…ï¼ˆIdPï¼‰ï¼ˆä¹Ÿç§°ä¸ºå®‰å…¨ä»¤ç‰ŒæœåŠ¡æˆ– STSï¼‰æˆ–å…è®¸å„ä¸ªæœåŠ¡è‡ªè¡Œç­¾ç½² JWTã€‚ï¼ˆå¦‚æœæ‚¨å¯¹ JWT æ¦‚å¿µä¸ç†Ÿæ‚‰æˆ–éœ€è¦å¤ä¹ ï¼Œè¯·æŸ¥çœ‹ Auth0 æä¾›çš„&lt;a href=&#34;https://auth0.com/docs/secure/tokens/json-web-tokens&#34; title=&#34;JWT æ¦‚è¿°&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;JWT æ¦‚è¿°&lt;/a&gt;ã€‚ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;é€‰é¡¹-1ä½¿ç”¨-sts-å‘æ”¾ä»¤ç‰Œ&#34;&gt;é€‰é¡¹ 1ï¼šä½¿ç”¨ STS å‘æ”¾ä»¤ç‰Œ&lt;/h3&gt;
&lt;p&gt;ç¬¬ä¸€ç§æ–¹æ³•æ¶‰åŠä½¿ç”¨å®‰å…¨ä»¤ç‰ŒæœåŠ¡ï¼ˆSTSï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä¿¡ä»»çš„èº«ä»½æˆ–ä»¤ç‰Œæä¾›è€…ï¼Œä¾‹å¦‚&lt;a href=&#34;https://www.keycloak.org/&#34; title=&#34;Keycloak&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Keycloak&lt;/a&gt;ã€&lt;a href=&#34;https://www.okta.com/&#34; title=&#34;Okta&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Okta&lt;/a&gt;æˆ–&lt;a href=&#34;https://auth0.com/&#34; title=&#34;Auth0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Auth0&lt;/a&gt;ï¼Œç”¨äºå‘æ”¾ä»£è¡¨ç‰¹å®šæœåŠ¡çš„ä»¤ç‰Œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤æ–¹æ³•ä¸­ï¼ŒæœåŠ¡ä½¿ç”¨é•¿æœŸå‡­æ®ï¼ˆä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç æˆ– OAuth2.0 å®¢æˆ·ç«¯å‡­æ®ï¼‰ä¸ STS äº¤æ¢ JWTï¼Œè¡¨æ˜â€œæˆ‘æ˜¯ Service Aâ€ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šé•¿æœŸå‡­æ®åº”å®‰å…¨å­˜å‚¨å¹¶æœ‰é™ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åœ¨å¯åŠ¨æ—¶ä½¿ç”¨å®ƒä¸€æ¬¡æ¥å¼•å¯¼èº«ä»½ï¼Œå¹¶ä¸”ä»¥åä¸å†ä½¿ç”¨ã€‚æ­¤å¤–ï¼Œè¿™äº›å‡­æ®åº”ä»…å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;STS ä½¿ç”¨å…¶ç§é’¥ç­¾ç½² JWTï¼Œå¯ä»¥ä½¿ç”¨å…¶å…¬é’¥éªŒè¯ JWTã€‚ç„¶åï¼ŒService A å°† JWT é™„åŠ åˆ°å‘é€ç»™ Service B çš„è¯·æ±‚ä¸­ã€‚ä»è¿™é‡Œï¼ŒService B å¯ä»¥é€šè¿‡ä½¿ç”¨ STS çš„å…¬é’¥éªŒè¯ JWT çš„ç­¾åæ¥éªŒè¯ JWT æ˜¯ç”± STS ç­¾å‘çš„ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/authentication_hu_56c4e88210ec575a.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/authentication.png&#34; data-img=&#34;/trans/jwts-authenticate-services-api-gateways/authentication.png&#34; data-width=&#34;1024&#34; data-height=&#34;634&#34; alt=&#34;image&#34; data-caption=&#34;æ˜¾ç¤ºæœåŠ¡å¦‚ä½•ç›¸äº’éªŒè¯çš„ç¤ºæ„å›¾&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;æ˜¾ç¤ºæœåŠ¡å¦‚ä½•ç›¸äº’éªŒè¯çš„ç¤ºæ„å›¾&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä¸ºäº†ä½¿æ­¤å·¥ä½œæ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æµé‡å¿…é¡»åŠ å¯†ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡ B å¿…é¡»æ£€æŸ¥ JWT çš„&lt;code&gt;aud&lt;/code&gt;å£°æ˜ã€è¿‡æœŸæ—¶é—´ã€é¢å‘æ—¶é—´ä»¥åŠä¸æ—©äºæ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;å½“ STS ç­¾å‘çš„ JWT ç­¾åå¯†é’¥è½®æ¢æ—¶ï¼ŒæœåŠ¡ B å¿…é¡»å‡†å¤‡å¥½æ›´æ–° STS çš„å…¬é’¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŠ å¯†æµé‡è‡³å…³é‡è¦ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ JWT æ—¶ï¼Œå®ƒä»¬ä»£è¡¨äº†ä¸€ä¸ªâ€œæ‰¿è½½ä»¤ç‰Œâ€ï¼Œå› æ­¤æ‹¥æœ‰ä»¤ç‰Œçš„ä»»ä½•äººéƒ½å¯ä»¥å†’å…… Service Aã€‚åœ¨ Service A å’Œ Service B ä¹‹é—´åŠ å¯†æµé‡ï¼ˆä¾‹å¦‚ä½¿ç”¨å•å‘æœåŠ¡å™¨ TLSï¼‰æœ‰åŠ©äºå‡è½»è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;Service B è¿˜å¿…é¡»æ£€æŸ¥ JWT çš„è¿‡æœŸæ—¶é—´ï¼ˆ&lt;code&gt;exp&lt;/code&gt;ï¼‰ã€é¢å‘æ—¶é—´ï¼ˆ&lt;code&gt;iat&lt;/code&gt;ï¼‰ã€ä¸æ—©äºæ—¶é—´ï¼ˆ&lt;code&gt;nbf&lt;/code&gt;ï¼‰ä»¥åŠç‰¹åˆ«æ˜¯&lt;code&gt;aud&lt;/code&gt;å£°æ˜ï¼Œä»¥éªŒè¯ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆï¼ˆæœªè¿‡æœŸï¼Œä½äºå…¶æ—¶é—´çª—å£å†…å¹¶ç”¨äº Service B çš„ä½¿ç”¨ï¼‰ã€‚JWT ä½¿ç”¨è¿™ä¸ªçº¦å®šæ¥é˜²èŒƒé‡æ”¾æ”»å‡»ï¼Œå…¶ä¸­æ”»å‡»è€…å†’å…… Service Bï¼Œä» Service A è·å–ä»¤ç‰Œï¼Œç„¶åå†’å…… Service A æ¥è°ƒç”¨ Service Cã€‚æœ‰æ•ˆçš„ Service C ä¼šæ£€æŸ¥&lt;code&gt;aud&lt;/code&gt;å£°æ˜ï¼Œçœ‹åˆ°ä»£è¡¨ Service A çš„ JWT æ˜¯ä¸º Service B è€Œè®¾è®¡çš„ï¼Œç„¶åæ‹’ç»å®ƒã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡è°ƒç”¨æœåŠ¡ A éƒ½å¿…é¡»ä½¿ç”¨ä¸åŒçš„ JWTï¼Œå› ä¸º&lt;code&gt;aud&lt;/code&gt;å£°æ˜ä¼šä¸åŒã€‚å°è¯•ä½¿ç”¨æ²¡æœ‰&lt;code&gt;aud&lt;/code&gt;å£°æ˜çš„ JWT æˆ–ä½¿ç”¨é€šé…ç¬¦&lt;code&gt;aud&lt;/code&gt;å£°æ˜ä¼šå¢åŠ  JWT è¢«ç ´åçš„é£é™©ã€‚é¿å…è¿™æ ·åšã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¸¸å¸¸è¢«å¿½ç•¥çš„æ˜¯è½®æ¢ STS çš„å…¬é’¥ã€‚åœ¨è®¡åˆ’çš„å¯†é’¥è½®æ¢æˆ–è®¡åˆ’çš„æ’¤é”€ STS ç”¨äºç­¾ç½² JWT çš„å¯†é’¥æ—¶ï¼ŒService Bï¼ˆæˆ–ä»»ä½•ä¾èµ– STS è¿›è¡ŒéªŒè¯çš„æœåŠ¡ï¼‰å¿…é¡»èƒ½å¤Ÿå¤„ç†æ›´æ–°çš„ç­¾åå…¬é’¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€‰é¡¹-2è®©æœåŠ¡è‡ªè¡Œç­¾ç½²å…¶ä»¤ç‰Œ&#34;&gt;é€‰é¡¹ 2ï¼šè®©æœåŠ¡è‡ªè¡Œç­¾ç½²å…¶ä»¤ç‰Œ&lt;/h3&gt;
&lt;p&gt;ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨æœåŠ¡ç‰¹å®šçš„å¯†é’¥æ¥ç­¾ç½² JWTã€‚å¯ä»¥ä½¿ç”¨å¯¹ç§°å¯†é’¥æˆ–éå¯¹ç§°å¯†é’¥ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/authentication-service-specific-keys_hu_f23eb26eb1712e85.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/authentication-service-specific-keys.png&#34; data-img=&#34;/trans/jwts-authenticate-services-api-gateways/authentication-service-specific-keys.png&#34; data-width=&#34;1024&#34; data-height=&#34;698&#34; alt=&#34;image&#34; data-caption=&#34;ä½¿ç”¨ç‰¹å®šäºæœåŠ¡çš„å¯†é’¥è¿›è¡Œ S2S èº«ä»½éªŒè¯çš„ç¤ºæ„å›¾&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;ä½¿ç”¨ç‰¹å®šäºæœåŠ¡çš„å¯†é’¥è¿›è¡Œ S2S èº«ä»½éªŒè¯çš„ç¤ºæ„å›¾&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒService A ä½¿ç”¨è‡ªå·±çš„å¯†é’¥æ¥ç­¾ç½²å‘é€ç»™ Service Bï¼ˆæˆ–ä»»ä½•å…¶ä»–æœåŠ¡ï¼‰çš„ JWTã€‚Service B å°†éœ€è¦ Service A çš„å…¬é’¥ï¼ˆæˆ–å¯¹ç§°å¯†é’¥ï¼Œç”±äºå¯†é’¥äº¤æ¢å’Œå†’å……é—®é¢˜æ›´åŠ å±é™©ï¼‰æ¥éªŒè¯ Service A å‘é€çš„ JWTã€‚å®é™…ä¸Šï¼ŒService B å°†éœ€è¦æ¯ä¸ªè°ƒç”¨å®ƒçš„æœåŠ¡çš„å…¬é’¥ï¼Œè¿™äº›æœåŠ¡ä½¿ç”¨ JWT ä½œä¸ºèº«ä»½éªŒè¯ä¸»ä½“ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ STS ç­¾å‘çš„ JWT ç¤ºä¾‹ä¸€æ ·ï¼ŒæœåŠ¡ä¹‹é—´çš„æµé‡å¿…é¡»åŠ å¯†ï¼ŒService B è¿˜å¿…é¡»æ£€æŸ¥&lt;code&gt;aud&lt;/code&gt;å£°æ˜ï¼Œå¹¶ä¸”æ‚¨éœ€è¦ä¸€ç§ç­¾ç½²å…¬é’¥è½®æ¢çš„æ–¹æ³•ã€‚æ‚¨è¿˜å¿…é¡»ä¸ºæ¯ä¸ªè°ƒç”¨çš„æœåŠ¡ä½¿ç”¨ä¸åŒçš„ JWTã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/different-jwt-dependent-services_hu_e22be7b73c31a8fb.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/jwts-authenticate-services-api-gateways/different-jwt-dependent-services.png&#34; data-img=&#34;/trans/jwts-authenticate-services-api-gateways/different-jwt-dependent-services.png&#34; data-width=&#34;1024&#34; data-height=&#34;854&#34; alt=&#34;image&#34; data-caption=&#34;æœåŠ¡ B æ£€æŸ¥ aud å£°æ˜&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;æœåŠ¡ B æ£€æŸ¥ aud å£°æ˜&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;å¼€å‘äººå‘˜å¿…é¡»é‡‡å–æªæ–½å¹¶è·Ÿè¸ªè®¸å¤šå†…å®¹ï¼Œä»¥ç¡®ä¿ä¸€åˆ‡æ­£ç¡®ã€‚è¯ä¹¦è¿˜å¿…é¡»è‡³å°‘åˆ†å‘ç»™ä¸€åŠçš„æœåŠ¡ï¼ˆæ¥æ”¶ç«¯çš„æœåŠ¡ï¼‰ä»¥æä¾›è‡³å°‘å•å‘ TLSã€‚æ­¤å¤–ï¼Œæ•´ä¸ªè¿‡ç¨‹çš„å…³é”®æ˜¯å¯†é’¥ç®¡ç†ã€è½®æ¢å’Œå®‰å…¨ä¿ç®¡å¯†é’¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;jwt-å¯èƒ½å‡ºç°é—®é¢˜çš„åœ°æ–¹&#34;&gt;JWT å¯èƒ½å‡ºç°é—®é¢˜çš„åœ°æ–¹&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»ä»‹ç»äº† JWT å¯ç”¨äºè¡¨ç¤ºæœåŠ¡èº«ä»½çš„ä¸€äº›æ–¹å¼ï¼Œå¹¶æå‡ºäº†å…³æ³¨çš„é¢†åŸŸã€‚åœ¨æœåŠ¡æ¶æ„ä¸­ï¼Œæœ‰å‡ ä¸ªéœ€è¦å¯†åˆ‡å…³æ³¨çš„é¢†åŸŸï¼Œä»¥é¿å…å®‰å…¨æ¼æ´ã€‚å¦‚æœè¿™äº›ä¸æ˜¯ç‰¢ä¸å¯ç ´çš„ï¼Œæ‚¨å°†ä¸ºæ”»å‡»è€…æä¾›æœºä¼šæ¥ç ´åæ‚¨çš„ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦/mTLSï¼ˆä¾‹å¦‚æœåŠ¡ç½‘æ ¼ï¼‰å’Œ JWT è¿›è¡Œèº«ä»½éªŒè¯ä¹‹é—´æœ€é‡è¦çš„åŒºåˆ«ä¹‹ä¸€æ˜¯ï¼šJWT é€šè¿‡ç½‘ç»œå‘é€æ•æ„Ÿçš„æ‰¿è½½ä»¤ç‰Œææ–™ï¼Œè€Œ mTLS ä¸ä¼šã€‚ä½¿ç”¨ mTLS æ—¶ï¼Œåªä¼šå‘é€å…¬é’¥ï¼Œè€Œä¸ä¼šå‘é€ç§é’¥ï¼Œä¼šåå•†ä¼šè¯å¯†é’¥ã€‚å¦‚æœ JWT æ³„éœ²ï¼ŒJWT æ˜¯ç§å¯†ææ–™ï¼Œå¯ä»¥è¢«é‡æ”¾ã€‚å¯¹äºè¯ä¹¦ï¼Œåªæœ‰å…¬å…±è¯ä¹¦è¢«å…±äº«ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºé˜²æ­¢é‡æ’­æ‰¿è½½ä»¤ç‰Œï¼Œæ‚¨å¿…é¡»é€šè¿‡è®¾ç½®çŸ­æš‚çš„åˆ°æœŸæ—¶é—´ï¼Œç†æƒ³æƒ…å†µä¸‹åªæœ‰å‡ åˆ†é’Ÿï¼Œæ¥é™åˆ¶å…¶æš´éœ²ã€‚è¿™ä¼šå¢åŠ æœåŠ¡åˆ·æ–°å…¶ JWT ä»¥è¿›è¡Œè¯·æ±‚çš„è´£ä»»ã€‚è®¾ç½®æ•°å°æ—¶ã€æ•°å¤©æˆ–æ•°æœˆçš„åˆ°æœŸæ—¶é—´å‘ç”Ÿå¾—å¤ªé¢‘ç¹ã€‚è¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªé‡å¤§çš„å®‰å…¨æ¼æ´æ˜¯ï¼Œåœ¨ä½¿ç”¨ STS è·å– JWT ææ–™æ—¶ï¼Œæ‚¨ä¼šå¤šæ¬¡é€šè¿‡ç½‘ç»œå‘é€é•¿æœŸå‡­æ®ï¼ˆä¾‹å¦‚å®¢æˆ·ç«¯å‡­è¯æµç¨‹ï¼‰ã€‚è¿™äº›é•¿æœŸå‡­æ®éå¸¸æ•æ„Ÿï¼Œåº”è°¨æ…ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¯åŠ¨æ—¶ä½¿ç”¨ï¼‰ï¼Œè€Œä¸åº”è¿ç»­ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œä½¿ç”¨é€šé…ç¬¦&lt;code&gt;aud&lt;/code&gt;å£°æ˜æˆ–å®Œå…¨çœç•¥&lt;code&gt;aud&lt;/code&gt;å£°æ˜ä¹Ÿæ˜¯ä¸€ä¸ªé‡å¤§é—®é¢˜ã€‚æœªèƒ½åœ¨æœåŠ¡ä¹‹é—´ä¸€è‡´ä½¿ç”¨è¿™äº›çº¦å®šä»¥è¿›è¡Œèº«ä»½éªŒè¯ä¼šå¯¼è‡´ä¸¥é‡é—®é¢˜ã€‚ç¡®ä¿ä¸º&lt;em&gt;æ¯ä¸ª&lt;/em&gt;è°ƒç”¨çš„æœåŠ¡åˆ›å»ºå…·æœ‰æ­£ç¡®&lt;code&gt;aud&lt;/code&gt;å£°æ˜çš„ JWTã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¯†é’¥è½®æ¢ä¸çŸ­æš‚åˆ°æœŸæ—¶é—´å’Œ aud å£°æ˜æ£€æŸ¥åŒæ ·é‡è¦ã€‚åœ¨å‘ç”Ÿè¿è§„äº‹ä»¶æ—¶ï¼Œä½¿å¯†é’¥æ— æ•ˆæ˜¯æœ€åçš„åŠªåŠ›ï¼Œåº”å°½å¿«ä¸”é«˜æ•ˆåœ°å¤„ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;jwt-çš„å¤æ‚æ€§æ˜¯æœåŠ¡ç½‘æ ¼ç®€åŒ–äº‹ç‰©çš„åœ°æ–¹&#34;&gt;JWT çš„å¤æ‚æ€§æ˜¯æœåŠ¡ç½‘æ ¼ç®€åŒ–äº‹ç‰©çš„åœ°æ–¹&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼ç®€åŒ–äº†æœåŠ¡ä¹‹é—´çš„èº«ä»½éªŒè¯ï¼Œå¹¶å…è®¸å¼€å‘äººå‘˜ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ˜¯æ­£ç¡®åœ°å¤„ç† JWT å’Œç§˜å¯†ææ–™ï¼ˆå¸Œæœ›å¦‚æ­¤ï¼‰ã€‚å°±åƒ API ç½‘å…³åº”ç”¨äºå¤„ç†åŒ—/å—å’Œå…¥å£æµé‡çš„å®‰å…¨æ€§ä¸€æ ·ï¼ŒæœåŠ¡ç½‘æ ¼åº”ç”¨äºå¤„ç†ä¸œ/è¥¿å’Œ S2S æµé‡çš„å®‰å…¨æ€§ã€‚ä¿æŒæœåŠ¡å’Œ API ä¸“æ³¨äºå®ƒä»¬å¯ä»¥æä¾›çš„ä¸åŒ iating ä¸šåŠ¡ä»·å€¼ï¼Œè€Œä¸æ˜¯æ¨¡æ¿ï¼ˆä½†æå…¶é‡è¦çš„ï¼‰çš„å®‰å…¨æ€§ä»£ç ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>å°† AI åº”ç”¨äº WebAssembly è¿˜ä¸ºæ—¶è¿‡æ—©å—ï¼Ÿ</title>
      <link>https://jimmysong.io/trans/is-it-too-early-to-leverage-ai-for-webassembly/</link>
      <pubDate>Thu, 07 Sep 2023 21:03:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/is-it-too-early-to-leverage-ai-for-webassembly/</guid>
      <description>
        
        
        &lt;p&gt;æ‘˜è¦ï¼šFermyon Technologies è®¤ä¸ºï¼Œå°† AI åº”ç”¨äº WebAssembly å¹¶ä¸ä¸ºæ—¶è¿‡æ—©ã€‚WebAssembly ä¸ºåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ¨ç†æä¾›äº†åšå®çš„åŸºç¡€ï¼Œè€Œä¸”åœ¨è®¸å¤šä¸åŒçš„ç¯å¢ƒä¸­ï¼Œå¦‚æµè§ˆå™¨å’Œç‰©è”ç½‘è®¾å¤‡ç­‰ï¼Œé€šè¿‡å°†è¿™äº›å·¥ä½œè´Ÿè½½ç§»åŠ¨åˆ°ç»ˆç«¯ç”¨æˆ·è®¾å¤‡ä¸Šï¼Œå¯ä»¥æ¶ˆé™¤å»¶è¿Ÿå¹¶é¿å…å°†æ•°æ®å‘é€åˆ°é›†ä¸­å¼æœåŠ¡å™¨ï¼ŒåŒæ—¶èƒ½å¤Ÿåœ¨è¾¹ç¼˜å‘ç°çš„å¤šç§å¼‚æ„è®¾å¤‡ä¸Šè¿è¡Œã€‚Fermyon Serverless AI é€šè¿‡æä¾›è¶…è¿‡ 100 å€äºå…¶ä»–æŒ‰éœ€ AI åŸºç¡€è®¾æ–½æœåŠ¡çš„äºšç§’å†·å¯åŠ¨æ—¶é—´æ¥è§£å†³äº†ä¼ä¸šçº§ AI åº”ç”¨ç¨‹åºæˆæœ¬é«˜çš„é—®é¢˜ã€‚è¿™æ˜¯ä¸€ç§å…±ç”Ÿå…³ç³»ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;äººå·¥æ™ºèƒ½åŠå…¶åœ¨ ITã€è½¯ä»¶å¼€å‘å’Œè¿è¥æ–¹é¢çš„åº”ç”¨åˆšå¼€å§‹å‘æŒ¥ä½œç”¨ï¼Œé¢„ç¤ºç€äººç±»è§’è‰²å°†å¦‚ä½•åœ¨è¿‘æœŸå’Œé•¿æœŸå†…æ¼”å˜ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾ƒå°çš„è§„æ¨¡ä¸Šï¼ŒWebAssembly ä»£è¡¨ç€ä¸€ç§æ­£åœ¨å¼•èµ·é‡å¤§å…³æ³¨çš„æŠ€æœ¯ï¼ŒåŒæ—¶è¯æ˜äº†å…¶å¯è¡Œæ€§ï¼Œä½†æˆåŠŸçš„å•†ä¸šæ¨¡å‹å°šæœªå®ç°ï¼Œä¸»è¦æ˜¯ç”±äºæœ€ç»ˆç«¯ç‚¹çš„ç¼ºä¹æ ‡å‡†åŒ–ã€‚ä¸æ­¤åŒæ—¶ï¼Œè‡³å°‘æœ‰ä¸€å®¶ä¾›åº”å•† Fermyon è®¤ä¸ºï¼Œåœ¨è¿™ä¸ªé˜¶æ®µåº”ç”¨ AI äº WebAssembly å¹¶ä¸ä¸ºæ—¶è¿‡æ—©ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼ŒAI å¦‚ä½•æ½œåœ¨åœ°å¸®åŠ© Wasm çš„å¼€å‘å’Œé‡‡ç”¨ï¼Œè¿™æ˜¯å¦ä¸ºæ—¶è¿‡æ—©ï¼Ÿæ­£å¦‚ VMware CTO åŠå…¬å®¤çš„é«˜çº§å·¥ç¨‹å¸ˆ Angel M De Miguel Meana æ‰€æŒ‡å‡ºçš„é‚£æ ·ï¼Œè‡ªä» ChatGPT æ¨å‡ºä»¥æ¥ï¼ŒAI ç”Ÿæ€ç³»ç»Ÿå·²ç»å‘ç”Ÿäº†å·¨å¤§çš„å˜åŒ–ï¼ŒWebAssembly ä¸ºåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ¨ç†æä¾›äº†åšå®çš„åŸºç¡€ï¼Œè€Œä¸”åœ¨è®¸å¤šä¸åŒçš„ç¯å¢ƒä¸­ï¼Œå¦‚æµè§ˆå™¨å’Œç‰©è”ç½‘è®¾å¤‡ç­‰ï¼Œé€šè¿‡å°†è¿™äº›å·¥ä½œè´Ÿè½½ç§»åŠ¨åˆ°ç»ˆç«¯ç”¨æˆ·è®¾å¤‡ä¸Šï¼Œå¯ä»¥æ¶ˆé™¤å»¶è¿Ÿå¹¶é¿å…å°†æ•°æ®å‘é€åˆ°é›†ä¸­å¼æœåŠ¡å™¨ï¼ŒåŒæ—¶èƒ½å¤Ÿåœ¨è¾¹ç¼˜å‘ç°çš„å¤šç§å¼‚æ„è®¾å¤‡ä¸Šè¿è¡Œã€‚ç”±äº Wasm ç”Ÿæ€ç³»ç»Ÿä»åœ¨å…´èµ·ï¼Œå› æ­¤åœ¨æ—©æœŸé˜¶æ®µé›†æˆ AI å°†æœ‰åŠ©äºæ¨åŠ¨æ–°çš„å’Œç°æœ‰çš„ä¸ AI ç›¸å…³çš„æ ‡å‡†ã€‚è¿™æ˜¯ä¸€ç§å…±ç”Ÿå…³ç³»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®Œç¾çš„åŒ¹é…&#34;&gt;å®Œç¾çš„åŒ¹é…&lt;/h2&gt;
&lt;p&gt;Fermyon Technologies çš„è”åˆåˆ›å§‹äººå…¼é¦–å¸­æ‰§è¡Œå®˜ Matt Butcher å‘Šè¯‰ The New Stackï¼šâ€œæˆ‘ä»¬æˆç«‹ Fermyon çš„ç›®æ ‡æ˜¯æ‰“é€ ä¸‹ä¸€ä»£æ— æœåŠ¡å™¨å¹³å°ã€‚AI æ˜¾ç„¶æ˜¯è¿™ä¸€ä¸‹ä¸€ä»£çš„ä¸€éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„è¡Œä¸šä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°é©å‘½æ€§çš„æŠ€æœ¯ä¸€èµ·æˆé•¿ï¼šJava å’Œ Webã€äº‘å’Œå¾®æœåŠ¡ã€Docker å’Œ Kubernetesã€‚WebAssembly å’Œ AI æ˜¯ä¸€å¯¹å®Œç¾çš„ç»„åˆã€‚æˆ‘çœ‹åˆ°å®ƒä»¬ä¸€èµ·æˆé•¿ï¼ˆå¹¶å˜è€ï¼‰ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œçƒ˜ç„™â€AI æ¨¡å‹ï¼Œå¦‚ LLMï¼ˆå¤§å‹è¯­è¨€æ¨¡å‹ï¼‰æˆ–è½¬æ¢å™¨ï¼Œåˆ° WebAssembly è¿è¡Œæ—¶ä¸­ï¼Œæ˜¯åŠ é€Ÿé‡‡ç”¨ WebAssembly çš„é€»è¾‘ä¸‹ä¸€æ­¥ï¼ŒEnterprise Management Associates (EMA) çš„åˆ†æå¸ˆ Torsten Volk å‘Šè¯‰ The New Stackã€‚ä¸è°ƒç”¨è¯¸å¦‚é€šè¿‡ API çš„æ•°æ®åº“æœåŠ¡ç±»ä¼¼ï¼Œç¼–è¯‘ WebAssembly åº”ç”¨ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰å¯ä»¥å°†å…¶ API è¯·æ±‚å‘é€åˆ° WebAssembly è¿è¡Œæ—¶ï¼Œè¯¥è¿è¡Œæ—¶å°†è¯¥è°ƒç”¨ä¸­ç»§åˆ° AI æ¨¡å‹å¹¶å°†æ¨¡å‹å“åº”è¿”å›ç»™å‘èµ·è€…ï¼ŒVolk è¯´ã€‚&lt;/p&gt;
&lt;p&gt;â€œä¸€æ—¦æˆ‘ä»¬æœ‰ä¸€ä¸ªæä¾›å¼€å‘äººå‘˜ä¸€ä¸ªæ ‡å‡† API çš„é€šç”¨ç»„ä»¶æ¨¡å‹ï¼ˆCCMï¼‰ï¼Œè®¿é—®æ•°æ®åº“ã€AI æ¨¡å‹ã€GPUã€æ¶ˆæ¯ä¼ é€’ã€èº«ä»½éªŒè¯ç­‰ï¼Œè¿™äº› API è¯·æ±‚å°†å˜å¾—éå¸¸å¼ºå¤§ã€‚CCM å°†è®©å¼€å‘äººå‘˜ç¼–å†™ç›¸åŒçš„ä»£ç ï¼Œåœ¨æ•°æ®ä¸­å¿ƒã€äº‘ç”šè‡³è¾¹ç¼˜ä½ç½®çš„ä»»ä½•ç±»å‹çš„æœåŠ¡å™¨ä¸Šä¸ AI æ¨¡å‹ï¼ˆä¾‹å¦‚ GPT æˆ– Llamaï¼‰è¿›è¡Œé€šä¿¡ï¼Œåªè¦è¯¥æœåŠ¡å™¨æ‹¥æœ‰è¶³å¤Ÿçš„ç¡¬ä»¶èµ„æºå¯ç”¨ï¼Œâ€Volk è¯´ã€‚â€œè¿™ä¸€åˆ‡éƒ½å½’ç»“ä¸ºå…³é”®é—®é¢˜ï¼Œå³äº§ä¸šå‚ä¸è€…ä½•æ—¶ä¼šå°± CCM è¾¾æˆä¸€è‡´ã€‚åŒæ—¶ï¼ŒWebAssembly äº‘ï¼ˆå¦‚ Fermyonï¼‰å¯ä»¥åˆ©ç”¨ WebAssembly ä½¿ AI æ¨¡å‹åœ¨å…¶è‡ªå·±çš„äº‘åŸºç¡€è®¾æ–½ä¸­å…·æœ‰å¯ç§»æ¤æ€§å’Œå¯æ‰©å±•æ€§ï¼Œæ— éœ€ CCMï¼Œå¹¶å°†ä¸€äº›èŠ‚çœæˆæœ¬ä¼ é€’ç»™å®¢æˆ·ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³é—®é¢˜&#34;&gt;è§£å†³é—®é¢˜&lt;/h2&gt;
&lt;p&gt;åŒæ—¶ï¼ŒFermyon è®¤ä¸ºï¼Œåœ¨è¿™ä¸ªé˜¶æ®µåº”ç”¨ AI äº WebAssembly å¹¶ä¸ä¸ºæ—¶è¿‡æ—©ã€‚æ­£å¦‚ Butcher æ‰€æŒ‡å‡ºçš„é‚£æ ·ï¼Œè´Ÿè´£åœ¨ LLMï¼ˆå¦‚ LLaMA2ï¼‰ä¸Šæ„å»ºå’Œè¿è¡Œä¼ä¸š AI åº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜é¢ä¸´ç€ 100 å€è®¡ç®—æˆæœ¬çš„æŒ‘æˆ˜ï¼Œå³æ¯å°æ—¶ 32 ç¾å…ƒåŠä»¥ä¸Šçš„ GPU è®¿é—®è´¹ç”¨ã€‚æˆ–è€…ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨æŒ‰éœ€æœåŠ¡ï¼Œä½†æ˜¯å¯åŠ¨æ—¶é—´å´éå¸¸æ…¢ã€‚è¿™ä½¿å¾—ä»¥å®æƒ çš„æ–¹å¼æä¾›ä¼ä¸šçº§ AI åº”ç”¨ç¨‹åºå˜å¾—ä¸åˆ‡å®é™…ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon Serverless AI é€šè¿‡æä¾›è¶…è¿‡ 100 å€äºå…¶ä»–æŒ‰éœ€ AI åŸºç¡€è®¾æ–½æœåŠ¡çš„äºšç§’å†·å¯åŠ¨æ—¶é—´æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ŒButcher è¯´ã€‚è¿™ä¸€â€œçªç ´â€å¾—ç›Šäºé©±åŠ¨ Fermyon Cloud çš„æœåŠ¡å™¨ WebAssembly æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯è¢«æ¶æ„ä¸ºäºšæ¯«ç§’å†·å¯åŠ¨å’Œé«˜å®¹é‡æ—¶é—´åˆ†ç‰‡çš„è®¡ç®—å®ä¾‹ï¼Œå·²è¢«è¯æ˜å¯ä»¥å°†è®¡ç®—å¯†åº¦æé«˜ 30 å€ã€‚â€œå°†æ­¤è¿è¡Œæ—¶é…ç½®æ–‡ä»¶æ‰©å±•åˆ° GPU å°†ä½¿ Fermyon Cloud æˆä¸ºæœ€å¿«çš„ AI æ¨ç†åŸºç¡€è®¾æ–½æœåŠ¡ï¼Œâ€Butcher è¯´ã€‚&lt;/p&gt;
&lt;p&gt;Volk è¯´ï¼Œè¿™æ ·çš„æ¨ç†æœåŠ¡â€œéå¸¸æœ‰è¶£â€ï¼Œå› ä¸ºå…¸å‹çš„ WebAssembly åº”ç”¨ç¨‹åºä»…åŒ…å«å‡ å…†å­—èŠ‚ï¼Œè€Œ AI æ¨¡å‹çš„å¤§å°è¦å¤§å¾—å¤šã€‚è¿™æ„å‘³ç€å®ƒä»¬ä¸ä¼šåƒä¼ ç»Ÿçš„ WebAssembly åº”ç”¨ç¨‹åºé‚£æ ·å¯åŠ¨å¾—é‚£ä¹ˆå¿«ã€‚â€œæˆ‘è®¤ä¸º Fermyon å·²ç»æƒ³å‡ºäº†å¦‚ä½•ä½¿ç”¨æ—¶é—´åˆ†ç‰‡ä¸º WebAssembly åº”ç”¨ç¨‹åºæä¾› GPU è®¿é—®çš„æ–¹æ³•ï¼Œä»¥ä¾¿æ‰€æœ‰è¿™äº›åº”ç”¨ç¨‹åºéƒ½å¯ä»¥é€šè¿‡å…¶ WebAssembly è¿è¡Œæ—¶ä¿ç•™ä¸€äº›æ—¶é—´ç‰‡æ¥è·å–æ‰€éœ€çš„ GPU èµ„æºâ€ï¼ŒVolk è¯´ã€‚â€œè¿™æ„å‘³ç€å¾ˆå¤šåº”ç”¨ç¨‹åºå¯ä»¥å…±äº«ä¸€å°éƒ¨åˆ†æ˜‚è´µçš„ GPUï¼Œä»¥æŒ‰éœ€ä¸ºå…¶ç”¨æˆ·æä¾›æœåŠ¡ã€‚è¿™æœ‰ç‚¹åƒåˆ†æ—¶å…±äº«ï¼Œä½†ä¸éœ€è¦å¼ºåˆ¶å‚åŠ åˆé¤æ—¶é—´çš„æ¼”ç¤ºã€‚â€&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Spin å…¥é—¨ã€‚&lt;/p&gt;
&lt;p&gt;!https://prod-files-secure.s3.us-west-2.amazonaws.com/86575c70-5cc9-4b3e-bee7-d1bb14ba20e3/6bf78916-e34c-4051-86a7-52145cdc372a/4a27b287-capture-decran-2023-09-05-192118.png&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œç”¨æˆ·å¦‚ä½•ä¸ Serverless AI äº¤äº’ï¼ŸFermyon çš„ Serverless AI æ²¡æœ‰ REST API æˆ–å¤–éƒ¨æœåŠ¡ï¼Œå®ƒä»…æ„å»ºåœ¨ Fermyon çš„ Spin æœ¬åœ°å’Œ Fermyon Cloud ä¸­ï¼ŒButcher è§£é‡Šè¯´ã€‚â€œåœ¨æ‚¨çš„ä»£ç çš„ä»»ä½•ä½ç½®ï¼Œæ‚¨éƒ½å¯ä»¥å°†æç¤ºä¼ é€’åˆ° Serverless AI å¹¶è·å¾—å“åº”ã€‚åœ¨è¿™ä¸ªç¬¬ä¸€ä¸ªæµ‹è¯•ç‰ˆä¸­ï¼Œæˆ‘ä»¬åŒ…æ‹¬ LLaMa2 çš„èŠå¤©æ¨¡å‹å’Œæœ€è¿‘å®£å¸ƒçš„ Code Llama ä»£ç ç”Ÿæˆæ¨¡å‹ï¼Œâ€Butcher è¯´ã€‚â€œå› æ­¤ï¼Œæ— è®ºæ‚¨æ˜¯åœ¨æ€»ç»“æ–‡æœ¬ã€å®ç°è‡ªå·±çš„èŠå¤©æœºå™¨äººè¿˜æ˜¯ç¼–å†™åç«¯ä»£ç ç”Ÿæˆå™¨ï¼ŒServerless AI éƒ½å¯ä»¥æ»¡è¶³æ‚¨çš„éœ€æ±‚ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿ AI å˜å¾—ç®€å•ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥ç«‹å³å¼€å§‹åˆ©ç”¨å®ƒæ¥æ„å»ºæ–°çš„ä»¤äººç©ç›®çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;é‡è¦æ„ä¹‰&#34;&gt;é‡è¦æ„ä¹‰&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ WebAssembly æ¥è¿è¡Œå·¥ä½œè´Ÿè½½ï¼Œå¯ä»¥ä½¿ç”¨ Fermyon Serverless AI å°†â€œGPU çš„ä¸€å°éƒ¨åˆ†â€åˆ†é…ç»™ç”¨æˆ·åº”ç”¨ç¨‹åºï¼Œä»¥â€œåŠæ—¶â€æ‰§è¡Œ AI æ“ä½œï¼ŒFermyon CTO å’Œè”åˆåˆ›å§‹äºº Radu Matei åœ¨ä¸€ç¯‡åšå®¢æ–‡ç« ä¸­å†™é“ã€‚ â€œå½“æ“ä½œå®Œæˆæ—¶ï¼Œæˆ‘ä»¬å°†è¯¥ GPU çš„ä¸€å°éƒ¨åˆ†åˆ†é…ç»™é˜Ÿåˆ—ä¸­çš„å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œâ€Matei å†™é“ã€‚â€œç”±äº Fermyon Cloud ä¸­çš„å¯åŠ¨æ—¶é—´ä¸ºæ¯«ç§’çº§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨åˆ†é…ç»™ GPU çš„ç”¨æˆ·åº”ç”¨ç¨‹åºä¹‹é—´å¿«é€Ÿåˆ‡æ¢ã€‚å¦‚æœæ‰€æœ‰ GPU åˆ†æ•°éƒ½åœ¨å¿™äºè®¡ç®—æ•°æ®ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªå¯ç”¨çš„åº”ç”¨ç¨‹åºä¹‹å‰å°†ä¼ å…¥çš„åº”ç”¨ç¨‹åºæ’é˜Ÿã€‚â€&lt;/p&gt;
&lt;p&gt;è¿™æœ‰ä¸¤ä¸ªé‡å¤§çš„å½±å“ï¼ŒMatei å†™é“ã€‚é¦–å…ˆï¼Œç”¨æˆ·ä¸å¿…ç­‰å¾…è™šæ‹Ÿæœºæˆ–å®¹å™¨å¯åŠ¨å¹¶é™„åŠ åˆ° GPU ä¸Šã€‚æ­¤å¤–ï¼Œâ€œæˆ‘ä»¬å¯ä»¥å®ç°æ›´é«˜çš„èµ„æºåˆ©ç”¨ç‡å’Œæ•ˆç‡ï¼Œâ€Matei å†™é“ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon ä¼ è¾¾çš„ Serverless AI çš„å…·ä½“ç‰¹ç‚¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿™æ˜¯ä¸€æ¬¾å¼€å‘äººå‘˜å·¥å…·å’Œæ‰˜ç®¡æœåŠ¡ï¼Œä¸“ä¸ºä½¿ç”¨å¼€æº LLM è¿›è¡Œ AI æ¨ç†çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºè€Œè®¾è®¡ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºæˆ‘ä»¬çš„æ ¸å¿ƒ WebAssembly æŠ€æœ¯ï¼Œæˆ‘ä»¬çš„å†·å¯åŠ¨æ—¶é—´æ¯”ç«äº‰å¯¹æ‰‹å¿« 100 å€ï¼Œä»å‡ åˆ†é’Ÿç¼©çŸ­åˆ°ä¸åˆ°ä¸€ç§’ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ç›¸åŒçš„æ—¶é—´å†…ï¼ˆå¹¶ä¸”ä½¿ç”¨ç›¸åŒçš„ç¡¬ä»¶ï¼‰æ‰§è¡Œæ•°ç™¾ä¸ªåº”ç”¨ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œè€Œä»Šå¤©çš„æœåŠ¡ç”¨äºè¿è¡Œä¸€ä¸ªã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ä¸ºä½¿ç”¨ Spin æ„å»ºå’Œè¿è¡Œ AI åº”ç”¨ç¨‹åºæä¾›äº†æœ¬åœ°å¼€å‘ä½“éªŒï¼Œç„¶åå°†å…¶éƒ¨ç½²åˆ° Fermyon Cloud ä¸­ï¼Œä»¥é«˜æ€§èƒ½çš„æ–¹å¼ä»¥å…¶ä»–è§£å†³æ–¹æ¡ˆçš„ä¸€å°éƒ¨åˆ†æˆæœ¬æä¾›æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;Fermyon Cloud ä½¿ç”¨ AI çº§åˆ«çš„ GPU å¤„ç†æ¯ä¸ªè¯·æ±‚ã€‚ç”±äºæˆ‘ä»¬çš„å¿«é€Ÿå¯åŠ¨å’Œé«˜æ•ˆçš„æ—¶é—´å…±äº«ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°ç™¾ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´å…±äº«å•ä¸ª GPUã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬æ­£åœ¨æ¨å‡ºå…è´¹çš„ç§äººæµ‹è¯•ç‰ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¤§å¸Œæœ›&#34;&gt;å¤§å¸Œæœ›&lt;/h2&gt;
&lt;p&gt;ç„¶è€Œï¼Œåœ¨ Wasm å’Œ AI åŒæ—¶è¾¾åˆ°æ½œåŠ›ä¹‹å‰ï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚åœ¨ WasmCon 2023 ä¸Šï¼ŒSecond State çš„ CEO å…¼è”åˆåˆ›å§‹äºº Michael Yuan å’Œ Wasm çš„è¿è¡Œæ—¶é¡¹ç›®ä»¥åŠ WasmEdge çš„è®¨è®ºäº†ä¸€äº›æ­£åœ¨è¿›è¡Œçš„å·¥ä½œã€‚ä»–åœ¨ä¸ De Miguel Meana çš„è°ˆè¯ä¸­æ¶µç›–äº†è¿™ä¸ªè¯é¢˜ï¼Œâ€œå¼€å§‹ä½¿ç”¨ AI å’Œ WebAssemblyâ€åœ¨ WasmCon 2023 ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;â€œåœ¨è¿™ä¸ªé¢†åŸŸï¼ˆAI å’Œ Wasmï¼‰éœ€è¦åšå¾ˆå¤šç”Ÿæ€ç³»ç»Ÿå·¥ä½œã€‚ä¾‹å¦‚ï¼Œä»…æ‹¥æœ‰æ¨ç†æ˜¯ä¸å¤Ÿçš„ï¼Œâ€Yuan è¯´ã€‚â€œç°åœ¨çš„ç™¾ä¸‡ç¾å…ƒé—®é¢˜æ˜¯ï¼Œå½“æ‚¨æ‹¥æœ‰å›¾åƒå’Œæ–‡æœ¬æ—¶ï¼Œå¦‚ä½•å°†å…¶è½¬æ¢ä¸ºä¸€ç³»åˆ—æ•°å­—ï¼Œç„¶ååœ¨æ¨ç†ä¹‹åå¦‚ä½•å°†è¿™äº›æ•°å­—è½¬æ¢å›å¯ç”¨çš„æ ¼å¼ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;é¢„å¤„ç†å’Œåå¤„ç†æ˜¯ Python ä»Šå¤©æœ€å¤§çš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œè¿™å¾—ç›Šäºä¸ºè¿™äº›ä»»åŠ¡æä¾›çš„ä¼—å¤šåº“ï¼ŒYuan è¯´ã€‚å°†è¿™äº›é¢„å¤„ç†å’Œåå¤„ç†å‡½æ•°åˆå¹¶åˆ° Rust å‡½æ•°ä¸­å°†æ˜¯æœ‰ç›Šçš„ï¼Œä½†éœ€è¦ç¤¾åŒºæ›´å¤šçš„åŠªåŠ›æ¥æ”¯æŒå…¶ä»–æ¨¡å—ã€‚â€œè¿™ä¸ªç”Ÿæ€ç³»ç»Ÿæœ‰å¾ˆå¤§çš„å¢é•¿æ½œåŠ›ï¼Œâ€Yuan è¯´ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>Docker å¤šå¹³å°æ„å»ºæŒ‡å—ï¼šæ„å»º WebAssembly é•œåƒ</title>
      <link>https://jimmysong.io/blog/docker-multi-platform-image-building/</link>
      <pubDate>Tue, 25 Apr 2023 19:09:28 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/docker-multi-platform-image-building/</guid>
      <description>
        
        
        &lt;p&gt;Docker å¤šå¹³å°æ„å»ºæ˜¯ä¸€ç§ç”¨äºæ„å»º Docker é•œåƒä»¥åœ¨å¤šç§ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œçš„æŠ€æœ¯ã€‚å®ƒå¯ä»¥è®©ç”¨æˆ·åœ¨ä¸€ä¸ª Dockerfile ä¸­å®šä¹‰ä¸€ä¸ªé€šç”¨çš„æ„å»ºè¿‡ç¨‹ï¼Œç„¶åä½¿ç”¨ Docker CLI å‘½ä»¤å°†å…¶æ„å»ºä¸ºå¤šä¸ªä¸åŒå¹³å°çš„é•œåƒã€‚è¿™äº›é•œåƒå¯ä»¥åœ¨ä¸åŒçš„è®¡ç®—æœºã€äº‘å¹³å°å’Œå®¹å™¨ç¼–æ’ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä»è€Œä¸ºç”¨æˆ·æä¾›æ›´å¹¿æ³›çš„éƒ¨ç½²é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¤šå¹³å°æ„å»ºä¸­ï¼Œç”¨æˆ·éœ€è¦ä½¿ç”¨ Docker Buildx æ’ä»¶æ¥æ„å»ºé•œåƒã€‚Docker Buildx å¯ä»¥æ„å»ºå¹¶è¾“å‡ºå¤šä¸ªä¸åŒå¹³å°çš„é•œåƒï¼ŒåŒ…æ‹¬ x86ã€ARMã€IBM Power ç­‰ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨è¯¥æ’ä»¶åˆ›å»ºå¤šç§å¹³å°çš„æ„å»ºç¯å¢ƒï¼Œå¹¶ä½¿ç”¨è¿™äº›ç¯å¢ƒæ„å»ºé•œåƒã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤šå¹³å°æ„å»ºéœ€è¦åœ¨æ”¯æŒå¤šå¹³å°çš„ Docker ä¸»æœºä¸Šè¿›è¡Œã€‚åœ¨è¿™ç§ä¸»æœºä¸Šï¼ŒDocker å¯ä»¥ä½¿ç”¨ QEMU ç­‰æ¨¡æ‹Ÿå™¨æ¥æ¨¡æ‹Ÿå…¶ä»–å¹³å°çš„ç¯å¢ƒï¼Œä»è€Œå®ç°æ„å»ºå¤šç§å¹³å°çš„é•œåƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;what-is-docker-buildx&#34;&gt;ä»€ä¹ˆæ˜¯ docker buildx?&lt;/h2&gt;
&lt;p&gt;Docker Buildx æ˜¯ Docker çš„ä¸€ä¸ªæ’ä»¶ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•ã€é«˜æ•ˆçš„æ–¹å¼æ¥æ„å»ºå’Œæ‰“åŒ… Docker é•œåƒã€‚å®ƒèƒ½å¤Ÿåœ¨å¤šä¸ªå¹³å°ä¸Šæ„å»ºå’Œè¾“å‡º Docker é•œåƒï¼ŒåŒ…æ‹¬ Linuxã€Windowsã€macOS ç­‰ï¼Œæ”¯æŒ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿç­‰å¤šç§å‚æ•°çš„è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;Docker Buildx åœ¨æ„å»ºé•œåƒæ—¶ä½¿ç”¨äº† &lt;a href=&#34;https://docs.docker.com/build/buildkit/&#34; title=&#34;BuildKit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BuildKit&lt;/a&gt;ï¼Œè¿™æ˜¯ Docker å®˜æ–¹æ¨å‡ºçš„ä¸€ä¸ªåŸºäº Go è¯­è¨€å®ç°çš„é«˜æ€§èƒ½æ„å»ºå¼•æ“ã€‚BuildKit æä¾›äº†æ›´å¿«çš„æ„å»ºé€Ÿåº¦ã€æ›´å°çš„é•œåƒä½“ç§¯ã€æ›´å¥½çš„ç¼“å­˜ç®¡ç†ç­‰ä¼˜åŠ¿ï¼Œä¹Ÿå¯ä»¥åœ¨ Docker Buildx ä¹‹å¤–ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker Buildxï¼Œå¯ä»¥å°†ä¸åŒå¹³å°ä¸Šçš„ Docker é•œåƒæ„å»ºåˆå¹¶åˆ°ä¸€ä¸ª manifest ä¸­ï¼Œä½¿å¾—ç”¨æˆ·åªéœ€è¦ä¸‹è½½ä¸€ä¸ª manifestï¼Œå°±å¯ä»¥è·å–å¤šä¸ªå¹³å°çš„é•œåƒã€‚è¿™ä¸ºè·¨å¹³å°å¼€å‘å’Œåˆ†å‘åº”ç”¨ç¨‹åºæä¾›äº†å¾ˆå¤§çš„ä¾¿åˆ©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;docker-buildx-principles&#34;&gt;Docker buildx å®ç°å¤šå¹³å°æ„å»ºçš„åŸç†&lt;/h2&gt;
&lt;p&gt;Docker &lt;a href=&#34;https://github.com/docker/buildx&#34; title=&#34;buildx&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;buildx&lt;/a&gt; å®ç°å¤šå¹³å°é•œåƒæ„å»ºçš„åŸç†æ˜¯åŸºäº Docker çš„å¤šæ¶æ„æ”¯æŒã€‚Docker å¯ä»¥åœ¨ä¸€ä¸ªä¸»æœºä¸Šè¿è¡Œå¤šä¸ªå®¹å™¨ï¼Œæ¯ä¸ªå®¹å™¨è¿è¡Œåœ¨è‡ªå·±çš„éš”ç¦»ç¯å¢ƒä¸­ï¼Œç›¸äº’ç‹¬ç«‹ã€‚è€Œ Docker é•œåƒåˆ™æ˜¯ç”¨äºåˆ›å»ºå®¹å™¨çš„åŸºç¡€æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Docker ä¸­ï¼Œä¸åŒçš„ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„ base imageï¼ˆåŸºç¡€é•œåƒï¼‰è¿›è¡Œæ„å»ºã€‚è€Œ Docker buildx å¯ä»¥è‡ªåŠ¨è¯†åˆ«å½“å‰ä¸»æœºçš„æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œå¹¶é€‰æ‹©åˆé€‚çš„ base image è¿›è¡Œæ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒDocker buildx ä¼šä½¿ç”¨ BuildKit å¼•æ“è¿›è¡Œæ„å»ºï¼Œæ”¯æŒå¤šå¹³å°çš„äº¤å‰ç¼–è¯‘å’Œé•œåƒæ‰“åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ„å»ºå®Œæˆåï¼ŒDocker buildx ä¼šå°†ä¸åŒå¹³å°ä¸Šçš„é•œåƒæ‰“åŒ…æˆä¸€ä¸ª manifest æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰å¹³å°çš„é•œåƒä¿¡æ¯ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ Docker CLI å‘½ä»¤æˆ–è€… Docker registry æ¥å£æ¥æ“ä½œ manifest æ–‡ä»¶ï¼Œè·å–ä¸åŒå¹³å°ä¸Šçš„é•œåƒã€‚å¯¹äºä¸æ”¯æŒå¤šæ¶æ„çš„ Docker ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡å®‰è£… Docker CLI çš„ experimental ç‰ˆæœ¬æ¥ä½¿ç”¨ Docker buildxã€‚&lt;/p&gt;
&lt;p&gt;Docker buildx åˆ©ç”¨äº† Docker çš„å¤šæ¶æ„æ”¯æŒå’Œ BuildKit å¼•æ“ï¼Œå®ç°äº†è·¨å¹³å°çš„ Docker é•œåƒæ„å»ºå’Œåˆ†å‘ã€‚&lt;/p&gt;
&lt;h2 id=&#34;docker-buildkit&#34;&gt;Docker BuildKit å¼•æ“ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.docker.com/build/buildkit/&#34; title=&#34;BuildKit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BuildKit&lt;/a&gt; æ˜¯ Docker å®˜æ–¹æ¨å‡ºçš„ä¸€ä¸ªé«˜æ€§èƒ½çš„æ„å»ºå¼•æ“ï¼Œå®ƒå¯ä»¥ç”¨äºæ„å»º Docker é•œåƒã€æ„å»ºåº”ç”¨ç¨‹åºä»¥åŠæ‰§è¡Œå…¶ä»–æ„å»ºä»»åŠ¡ã€‚BuildKit å¼•æ“é‡‡ç”¨äº†åˆ†å¸ƒå¼çš„æ¶æ„ï¼Œå¯ä»¥å¹¶è¡Œåœ°æ‰§è¡Œå¤šä¸ªæ„å»ºä»»åŠ¡ï¼Œæé«˜æ„å»ºæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;BuildKit å¼•æ“çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é«˜æ€§èƒ½ï¼šBuildKit å¼•æ“é‡‡ç”¨äº†é«˜æ•ˆçš„ç¼“å­˜ç®¡ç†æœºåˆ¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°æ‰§è¡Œå¢é‡æ„å»ºï¼Œå‡å°‘æ„å»ºæ—¶é—´ã€‚åŒæ—¶ï¼Œå®ƒè¿˜èƒ½å¤Ÿè‡ªåŠ¨ä¼˜åŒ–æ„å»ºè¿‡ç¨‹ï¼Œé€‰æ‹©æœ€ä½³çš„æ„å»ºè·¯å¾„å’Œç­–ç•¥ï¼Œè¿›ä¸€æ­¥æé«˜æ„å»ºæ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;å¤šå¹³å°æ”¯æŒï¼šBuildKit å¼•æ“æ”¯æŒå¤šç§ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œèƒ½å¤Ÿåœ¨ä¸åŒå¹³å°ä¸Šæ„å»ºå’Œè¾“å‡º Docker é•œåƒã€‚åœ¨ Docker buildx ä¸­ï¼ŒBuildKit å¼•æ“å¯ä»¥è‡ªåŠ¨è¯†åˆ«å½“å‰ä¸»æœºçš„æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œå¹¶é€‰æ‹©åˆé€‚çš„æ„å»ºæ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;æ¨¡å—åŒ–è®¾è®¡ï¼šBuildKit å¼•æ“é‡‡ç”¨äº†æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åŠ è½½å’Œå¸è½½ä¸åŒçš„æ¨¡å—ã€‚è¿™ä½¿å¾— BuildKit å¼•æ“æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ï¼Œå¯ä»¥æ”¯æŒå„ç§ä¸åŒçš„æ„å»ºä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§ï¼šBuildKit å¼•æ“é‡‡ç”¨äº†å®‰å…¨çš„æ„å»ºæ–¹å¼ï¼Œå¯ä»¥è‡ªåŠ¨æ‰§è¡Œä¸€ç³»åˆ—çš„å®‰å…¨æ£€æŸ¥ï¼Œç¡®ä¿æ„å»ºè¿‡ç¨‹ä¸­ä¸ä¼šå¼•å…¥æ¼æ´æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚åŒæ—¶ï¼ŒBuildKit å¼•æ“è¿˜æ”¯æŒç­¾åå’ŒåŠ å¯†ç­‰å®‰å…¨åŠŸèƒ½ï¼Œä¿æŠ¤ç”¨æˆ·çš„æ„å»ºæ•°æ®å’Œé•œåƒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;platforms&#34;&gt;Docker buildx æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Docker buildx æ”¯æŒçš„å¹³å°ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Linuxï¼šåŒ…æ‹¬å¤šç§ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œå¦‚ x86_64ã€ARMã€IBM Powerã€IBM Z ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;Windowsï¼šåŒ…æ‹¬å¤šç§ CPU æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œå¦‚ x86_64ã€ARM64 ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;macOSï¼šæ”¯æŒ Intelã€Apple M1 æ¶æ„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é™¤äº†ä»¥ä¸Šå¹³å°å¤–ï¼ŒDocker buildx è¿˜æ”¯æŒæ„å»ºå’Œè¾“å‡ºå¤šç§å…¶ä»–å¹³å°çš„ Docker é•œåƒï¼ŒåŒ…æ‹¬ FreeBSDã€Solaris ç­‰ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‡å®šå¯¹åº”çš„ &lt;code&gt;platform&lt;/code&gt; å‚æ•°æ¥æ„å»ºå’Œè¾“å‡ºä¸åŒå¹³å°çš„ Docker é•œåƒï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --platform linux/amd64,linux/arm64 .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªå‘½ä»¤å°†ä¼šæ„å»ºä¸€ä¸ªåŒæ—¶æ”¯æŒ x86_64 å’Œ ARM64 æ¶æ„çš„ Docker é•œåƒã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šä¸åŒçš„ buildx æ„å»ºé…ç½®æ¥æ”¯æŒæ›´å¤šçš„å¹³å°ï¼Œä¾‹å¦‚ä½¿ç”¨ qemu-user-static ç­‰æ¨¡æ‹Ÿå™¨æ¥æ”¯æŒå…¶ä»–çš„ CPU æ¶æ„ã€‚æ€»ä¹‹ï¼ŒDocker buildx çš„å¤šå¹³å°æ”¯æŒéå¸¸å¼ºå¤§ï¼Œä¸ºè·¨å¹³å°å¼€å‘å’Œåˆ†å‘åº”ç”¨ç¨‹åºæä¾›äº†ä¾¿åˆ©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;arch&#34;&gt;Docker buildx å¼•æ“çš„æ¶æ„ä¸ç»„æˆ&lt;/h2&gt;
&lt;p&gt;Docker buildx å¼•æ“çš„æ¶æ„æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ„å»ºç³»ç»Ÿï¼Œé€šè¿‡å¤šé˜¶æ®µã€å¤šç»„ä»¶çš„è®¾è®¡ï¼Œå®ç°äº†é«˜æ€§èƒ½ã€å¤šå¹³å°æ”¯æŒã€å®‰å…¨æ€§ç­‰ä¼˜ç‚¹ï¼Œä¸º Docker é•œåƒæ„å»ºå’Œåº”ç”¨ç¨‹åºæ„å»ºæä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚å®ƒç”±ä»¥ä¸‹å‡ ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CLIï¼šæä¾›äº†å‘½ä»¤è¡Œæ¥å£ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ‰§è¡Œæ„å»ºä»»åŠ¡ã€ç®¡ç†æ„å»ºé…ç½®ç­‰æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;BuildKit å¼•æ“ï¼šä½œä¸º Docker buildx çš„æ„å»ºå¼•æ“ï¼Œå®ƒè´Ÿè´£æ‰§è¡Œæ„å»ºä»»åŠ¡ï¼Œç”Ÿæˆ Docker é•œåƒç­‰ã€‚BuildKit å¼•æ“å…·æœ‰é«˜æ€§èƒ½ã€å¤šå¹³å°æ”¯æŒã€å®‰å…¨æ€§ç­‰ä¼˜ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºå™¨ï¼ˆBuilderï¼‰ï¼šæ„å»ºå™¨æ˜¯ä¸€ä¸ª Docker å®¹å™¨ï¼Œå®ƒåŒ…å«äº†æ„å»ºæ‰€éœ€è¦çš„ç¯å¢ƒå’Œå·¥å…·ï¼Œå¯ä»¥æ‰§è¡Œæ„å»ºä»»åŠ¡ã€‚åœ¨ Docker buildx ä¸­ï¼Œå¯ä»¥é…ç½®å¤šä¸ªæ„å»ºå™¨ï¼Œä»¥æ”¯æŒå¤šä¸ªå¹³å°å’Œå¤šä¸ªæ„å»ºç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡Œå™¨ï¼ˆSchedulerï¼‰ï¼šå¹¶è¡Œå™¨æ˜¯è´Ÿè´£åè°ƒå’Œç®¡ç†å¤šä¸ªæ„å»ºå™¨çš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨é€‰æ‹©æœ€ä½³çš„æ„å»ºå™¨æ‰§è¡Œæ„å»ºä»»åŠ¡ï¼Œå¹¶å°†ä»»åŠ¡åˆ†é…ç»™åˆé€‚çš„æ„å»ºå™¨ã€‚å¹¶è¡Œå™¨è¿˜å¯ä»¥æ‰§è¡Œæ„å»ºä»»åŠ¡çš„å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ„å»ºæ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;ç¼“å­˜ç®¡ç†å™¨ï¼ˆCache Managerï¼‰ï¼šç¼“å­˜ç®¡ç†å™¨æ˜¯è´Ÿè´£ç®¡ç†æ„å»ºè¿‡ç¨‹ä¸­çš„ç¼“å­˜æ•°æ®ï¼Œå¯ä»¥å¿«é€Ÿæ‰§è¡Œå¢é‡æ„å»ºï¼Œå‡å°‘æ„å»ºæ—¶é—´ã€‚åœ¨ Docker buildx ä¸­ï¼Œç¼“å­˜ç®¡ç†å™¨å¯ä»¥è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ç¼“å­˜æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æœ¬åœ°ç¼“å­˜å’Œè¿œç¨‹ç¼“å­˜ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å‡ºå™¨ï¼ˆExporterï¼‰ï¼šè¾“å‡ºå™¨è´Ÿè´£å°†æ„å»ºç”Ÿæˆçš„ Docker é•œåƒè¾“å‡ºåˆ°æŒ‡å®šçš„ä»“åº“æˆ–è€…æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚åœ¨ Docker buildx ä¸­ï¼Œè¾“å‡ºå™¨å¯ä»¥è‡ªåŠ¨è¯†åˆ«å½“å‰å¹³å°å’Œç›®æ ‡å¹³å°ï¼Œé€‰æ‹©åˆé€‚çš„é•œåƒæ ¼å¼å’Œè¾“å‡ºè·¯å¾„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;command&#34;&gt;docker buildx å‘½ä»¤çš„ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ docker buildx å‘½ä»¤å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œ Docker é•œåƒçš„æ„å»ºå’Œè¾“å‡ºã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„ docker buildx å‘½ä»¤åŠå…¶ç”¨æ³•ï¼š&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹å½“å‰çš„ buildx æ„å»ºå™¨åˆ—è¡¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx ls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ›å»ºæ–°çš„ buildx æ„å»ºå™¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx create --name mybuilder
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ‡æ¢åˆ°æŒ‡å®šåç§°çš„ buildx æ„å»ºå™¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx use mybuilder
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®¾ç½® buildx æ„å»ºå™¨çš„å¹³å°æ”¯æŒ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx inspect --bootstrap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx inspect --platform
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --platform linux/amd64,linux/arm64 .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ„å»º Docker é•œåƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --tag myimage .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡º Docker é•œåƒåˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --output&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;local,dest&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./output .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡º Docker é•œåƒåˆ° Docker Hub æˆ–å…¶ä»–è¿œç¨‹ä»“åº“&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --tag myrepo/myimage --push .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ é™¤æŒ‡å®šåç§°çš„ buildx æ„å»ºå™¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx rm mybuilder
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é™¤äº†ä»¥ä¸Šå‘½ä»¤å¤–ï¼Œdocker buildx è¿˜æ”¯æŒè®¸å¤šå…¶ä»–çš„å‚æ•°å’Œé€‰é¡¹ï¼Œä¾‹å¦‚è®¾ç½®æ„å»ºç¼“å­˜ã€å¹¶è¡Œå¤„ç†ã€æ„å»ºæ ‡ç­¾ç­‰ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£æˆ–è€…ä½¿ç”¨ &amp;ndash;help é€‰é¡¹æ¥äº†è§£æ›´å¤šè¯¦æƒ…ã€‚&lt;/p&gt;
&lt;h2 id=&#34;builder&#34;&gt;ç†è§£ buildx æ„å»ºå™¨&lt;/h2&gt;
&lt;p&gt;åœ¨ Docker ä¸­ï¼Œæ„å»ºå™¨ï¼ˆBuilderï¼‰æ˜¯æŒ‡ä¸€ä¸ª Docker å®¹å™¨ï¼Œå®ƒåŒ…å«äº†æ„å»ºæ‰€éœ€è¦çš„ç¯å¢ƒå’Œå·¥å…·ï¼Œå¯ä»¥æ‰§è¡Œæ„å»ºä»»åŠ¡ã€‚Docker buildx æ„å»ºå™¨æ˜¯æŒ‡ä½¿ç”¨ BuildKit å¼•æ“çš„å¤šå¹³å°æ„å»ºå™¨ï¼Œå¯ä»¥é€šè¿‡ Docker CLI å‘½ä»¤è¿›è¡Œç®¡ç†å’Œæ“ä½œã€‚åœ¨ä½¿ç”¨ Docker buildx æ„å»ºå™¨æ—¶ï¼Œç”¨æˆ·å¯ä»¥é…ç½®å¤šä¸ªæ„å»ºå™¨ï¼Œä»¥æ”¯æŒå¤šä¸ªå¹³å°å’Œå¤šä¸ªæ„å»ºç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·å¯ä»¥é€šè¿‡åˆ›å»ºã€åˆ‡æ¢ã€æŸ¥çœ‹å’Œåˆ é™¤æ„å»ºå™¨ï¼Œæ¥ç®¡ç†å’Œç»´æŠ¤ Docker buildx çš„æ„å»ºç¯å¢ƒã€‚æ„å»ºå™¨çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªå¹²å‡€ã€ç‹¬ç«‹çš„æ„å»ºç¯å¢ƒï¼Œé¿å…æ„å»ºè¿‡ç¨‹ä¸­çš„ä¾èµ–å†²çªå’Œç¯å¢ƒæ±¡æŸ“ã€‚æ­¤å¤–ï¼Œæ„å»ºå™¨è¿˜å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œç‰ˆæœ¬ç®¡ç†å’Œå…±äº«ï¼Œä»¥ä¾¿å¤šä¸ªç”¨æˆ·æˆ–è€…å›¢é˜ŸååŒæ„å»º Docker é•œåƒã€‚&lt;/p&gt;
&lt;p&gt;Docker buildx æ„å»ºå™¨è¿˜æ”¯æŒå¤šå¹³å°æ„å»ºï¼Œç”¨æˆ·å¯ä»¥åœ¨åŒä¸€ä¸ªæ„å»ºå™¨ä¸­è®¾ç½®å¤šä¸ªå¹³å°ï¼Œä»¥ä¾¿ç”Ÿæˆè·¨å¹³å°çš„ Docker é•œåƒã€‚é€šè¿‡ Docker buildx æ„å»ºå™¨ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å®ç° Docker é•œåƒçš„å¤šå¹³å°æ„å»ºï¼Œæé«˜æ„å»ºæ•ˆç‡å’Œåº”ç”¨ç¨‹åºçš„å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;where-is-my-images&#34;&gt;ä¸ºä»€ä¹ˆæœ¬åœ°çœ‹ä¸åˆ° Docker buildx æ„å»ºçš„é•œåƒï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™é€šå¸¸æ˜¯å› ä¸ºä½ å½“å‰ä½¿ç”¨çš„ Docker context ä¸æ”¯æŒç¼–è¯‘å‡ºæ¥çš„é•œåƒæ¶æ„ã€‚ä¾‹å¦‚ &lt;a href=&#34;https://orbstack.dev/&#34; title=&#34;Orbstack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Orbstack&lt;/a&gt;ï¼Œè™½ç„¶å®ƒæ”¯æŒç¼–è¯‘è·¨å¹³å°çš„é•œåƒï¼Œä½†æ˜¯æ‰§è¡Œ &lt;code&gt;docker buildx&lt;/code&gt; æ„å»ºå‡ºæ¥çš„é•œåƒä¸ä¼šç›´æ¥ä¿å­˜åœ¨æœ¬åœ°çš„ Docker é•œåƒä»“åº“ä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨æ„å»ºå™¨ï¼ˆBuilderï¼‰çš„ç¼“å­˜ä¸­ã€‚è¿™æ˜¯å› ä¸º Docker buildx é‡‡ç”¨äº†åˆ†å±‚æ„å»ºçš„æ–¹å¼ï¼Œæ„å»ºå‡ºçš„æ¯ä¸€å±‚é•œåƒéƒ½å¯ä»¥è¢«é‡ç”¨ï¼Œä»¥å‡å°‘æ„å»ºæ—¶é—´å’Œç£ç›˜ç©ºé—´çš„å ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä½ åº”è¯¥ä½¿ç”¨ &lt;code&gt;docker context&lt;/code&gt; å‘½ä»¤åˆ‡æ¢ä¼š Docker é»˜è®¤çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå†æ‰§è¡Œæ„å»ºï¼Œè¿™æ ·æ„å»ºå‡ºæ¥çš„è·¨å¹³å°é•œåƒå°±å¯ä»¥åœ¨æœ¬åœ°çœ‹è§äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;local-storage&#34;&gt;å¦‚ä½•å°†å¤šå¹³å°é•œåƒä¿å­˜åˆ°æœ¬åœ°ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¦å°† Docker buildx æ„å»ºçš„å¤šå¹³å°é•œåƒä¿å­˜åˆ°æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;--output&lt;/code&gt; é€‰é¡¹æŒ‡å®šè¾“å‡ºç±»å‹ä¸º &lt;code&gt;type=local&lt;/code&gt;ï¼Œå¹¶æŒ‡å®šè¾“å‡ºç›®å½•ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --platform linux/amd64,linux/arm64 --output &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;local,dest&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./output .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°å‘½ä»¤å°†æ„å»ºåŒ…å« &lt;code&gt;linux/amd64&lt;/code&gt; å’Œ &lt;code&gt;linux/arm64&lt;/code&gt; ä¸¤ç§å¹³å°çš„é•œåƒï¼Œå¹¶å°†è¾“å‡ºç±»å‹è®¾ç½®ä¸ºæœ¬åœ°ï¼ˆ&lt;code&gt;type=local&lt;/code&gt;ï¼‰ï¼Œè¾“å‡ºç›®å½•ä¸º &lt;code&gt;./output&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ„å»ºå®Œæˆåï¼Œè¾“å‡ºç›®å½•ä¸­ä¼šç”Ÿæˆå¤šä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•åˆ†åˆ«å¯¹åº”ä¸€ä¸ªå¹³å°ï¼Œå…¶ä¸­åŒ…å«è¯¥å¹³å°ä¸‹çš„é•œåƒæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåªæƒ³ä¿å­˜å…¶ä¸­ä¸€ä¸ªå¹³å°çš„é•œåƒï¼Œå¯ä»¥åœ¨ &lt;code&gt;--output&lt;/code&gt; é€‰é¡¹ä¸­æŒ‡å®šè¦ä¿å­˜çš„å¹³å°ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker buildx build --platform linux/amd64,linux/arm64 --output &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;local,dest&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./output/linux/amd64 .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°å‘½ä»¤å°†åªä¿å­˜ &lt;code&gt;linux/amd64&lt;/code&gt; å¹³å°çš„é•œåƒï¼Œè¾“å‡ºåˆ° &lt;code&gt;./output/linux/amd64&lt;/code&gt; ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;code&gt;--output&lt;/code&gt; é€‰é¡¹åªæ”¯æŒéƒ¨åˆ†è¾“å‡ºç±»å‹ï¼Œå¦‚æœè¦å°†é•œåƒä¿å­˜åˆ°å…¶ä»–ç±»å‹çš„è¾“å‡ºï¼ˆä¾‹å¦‚ tar åŒ…ã€OCI å­˜å‚¨ã€Docker registry ç­‰ï¼‰ï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–çš„è¾“å‡ºæ’ä»¶å’Œé€‰é¡¹ã€‚å…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://docs.docker.com/build/building/multi-platform/&#34; title=&#34;Docker å®˜æ–¹æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm&#34;&gt;å¦‚ä½•ä½¿ç”¨æ„å»º Wasm é•œåƒï¼Ÿ&lt;/h2&gt;
&lt;p&gt;WebAssembly æ˜¯ä¸€ç§ä¸­é—´ä»£ç æ ¼å¼ï¼Œéœ€è¦ä½¿ç”¨ç¼–è¯‘å™¨å°†æºä»£ç ç¼–è¯‘ä¸º WebAssembly æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå†å°†å…¶æ‰“åŒ…æˆé•œåƒã€‚ä»¥ä¸‹æ˜¯æ„å»º WebAssembly é•œåƒçš„ä¸€èˆ¬æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç¼–å†™ WebAssembly æºä»£ç ï¼Œå¹¶ä½¿ç”¨ç¼–è¯‘å™¨å°†å…¶ç¼–è¯‘ä¸º WebAssembly æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä¾‹å¦‚ä½¿ç”¨ Rust ç¼–å†™ä»£ç ï¼Œå¹¶ä½¿ç”¨ Cargo ç¼–è¯‘å‡º &lt;code&gt;.wasm&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼–å†™ Dockerfile å°† Wasm äºŒè¿›åˆ¶æ–‡ä»¶æ·»åŠ åˆ°ç©ºé•œåƒä¸­ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Dockerfile&#34; data-lang=&#34;Dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# syntax=docker/dockerfile:1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; ./target/wasm32-wasi/debug/hello-wasm.wasm /hello.wasm&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hello.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;docker buildx&lt;/code&gt; å‘½ä»¤æ„å»ºé•œåƒï¼Œä¾‹å¦‚ &lt;code&gt;docker buildx build --platform wasi/wasm32 -t jimmysong/hello-wasm .&lt;/code&gt;  å°†åœ¨æœ¬åœ°æ„å»ºã€‚è‹¥ä½ æƒ³å°†è¯¥é•œåƒåŒæ—¶åŒæ—¶æ¨é€åˆ° Docker Hubï¼Œå¯ä»¥åœ¨å‘½ä»¤ä¸­åŠ ä¸Š &lt;code&gt;--push&lt;/code&gt;æ ‡å¿—ã€‚åŸºäº WebAssembly å¹³å°çš„é•œåƒå¹¶ä¸Šä¼ åˆ° Docker Hubã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;notice&#34;&gt;æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;p&gt;é™¤äº†æ„å»ºå¤šå¹³å°é•œåƒã€å¯¼å‡ºå’ŒåŠ è½½é•œåƒå¤–ï¼Œè¿˜æœ‰ä¸€äº› Docker buildx å‘½ä»¤çš„å¸¸ç”¨æ“ä½œåŠæ³¨æ„äº‹é¡¹ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;-progress&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-progress&lt;/code&gt; é€‰é¡¹æŒ‡å®šæ„å»ºè¿‡ç¨‹çš„è¾“å‡ºæ ¼å¼ï¼ŒåŒ…æ‹¬ &lt;code&gt;auto&lt;/code&gt;ã€&lt;code&gt;plain&lt;/code&gt;ã€&lt;code&gt;tty&lt;/code&gt; ä¸‰ç§æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-no-cache&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-no-cache&lt;/code&gt; é€‰é¡¹ç¦ç”¨æ„å»ºè¿‡ç¨‹ä¸­çš„ç¼“å­˜æœºåˆ¶ï¼Œå¼ºåˆ¶é‡æ–°æ„å»ºé•œåƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-push&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-push&lt;/code&gt; é€‰é¡¹å°†æ„å»ºçš„é•œåƒæ¨é€åˆ° Docker registry ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-tag&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-tag&lt;/code&gt; é€‰é¡¹ä¸ºæ„å»ºçš„é•œåƒæŒ‡å®šæ ‡ç­¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-file&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-file&lt;/code&gt; é€‰é¡¹æŒ‡å®š Dockerfile æ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-build-arg&lt;/code&gt; é€‰é¡¹ï¼šå¯ä»¥ä½¿ç”¨ &lt;code&gt;-build-arg&lt;/code&gt; é€‰é¡¹ä¼ é€’æ„å»ºå‚æ•°ç»™ Dockerfile ä¸­çš„æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºä¸Šä¸‹æ–‡çš„æ³¨æ„äº‹é¡¹ï¼šæ„å»ºä¸Šä¸‹æ–‡æŒ‡çš„æ˜¯ Dockerfile æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œä»¥åŠæ„å»ºè¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°çš„å…¶ä»–æ–‡ä»¶ã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­éœ€è¦å°½é‡å‡å°‘æ„å»ºä¸Šä¸‹æ–‡çš„å¤§å°ï¼Œé¿å…æ„å»ºè¿‡ç¨‹ä¸­ä¼ è¾“å¤§é‡ä¸å¿…è¦çš„æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;.dockerignore&lt;/code&gt; æ–‡ä»¶æ’é™¤ä¸éœ€è¦ä¼ è¾“çš„æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒDocker buildx æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°çš„å‘½ä»¤ï¼Œä¸åŒç‰ˆæœ¬çš„ Docker Engine å¯èƒ½ä¼šå­˜åœ¨å·®å¼‚ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæ“ä½œã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ä¸ºä»€ä¹ˆ Docker è¦å¢åŠ  WebAssembly è¿è¡Œæ—¶ï¼Ÿ</title>
      <link>https://jimmysong.io/blog/why-docker-support-wasm/</link>
      <pubDate>Fri, 07 Apr 2023 18:45:40 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/why-docker-support-wasm/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨ &lt;a href=&#34;https://jimmysong.io/blog/docker-four-milestones/&#34; title=&#34;Docker å‘å±•å²ï¼šå››ä¸ªé‡å¤§ä¸¾æªï¼Œå½±å“æ·±è¿œï¼&#34;&gt;Docker å‘å±•å²ï¼šå››ä¸ªé‡å¤§ä¸¾æªï¼Œå½±å“æ·±è¿œï¼&lt;/a&gt; è¿™ç¯‡æ–‡ç« ä¸­æˆ‘æåˆ°äº† Docker ä»ä¸€å¼€å§‹å¼•é¢†å®¹å™¨è¿è¡Œæ—¶ï¼Œå†åˆ°åœ¨å®¹å™¨ç¼–æ’è¿™ä¸€ç»´åº¦ä¸Šè½åäº Kubernetesã€‚ä¸ºäº†åœ¨ä¿ä½å®¹å™¨è¿è¡Œæ—¶çš„ç»Ÿæ²»åœ°ä½ï¼ŒDocker å…¬å¸æå‡ºäº† OCI å¹¶é€šè¿‡ &lt;a href=&#34;https://github.com/deislabs/containerd-wasm-shims&#34; title=&#34;containerd-wasm-shim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd-wasm-shim&lt;/a&gt; æ”¯æŒæ›´å¤šçš„ WebAssembly è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ Docker åœ¨å®‰å…¨ã€ç¨³å®šæ€§ã€æ€§èƒ½åŠå¯ç§»æ¤æ€§æ–¹é¢çš„å±€é™æ€§ï¼ŒKubernetes ç¤¾åŒºå¼€å‘äº†å…·æœ‰ä¸åŒå®ç°å’ŒåŠŸèƒ½çš„å…¶ä»–å®¹å™¨è¿è¡Œæ—¶ï¼Œå¹¶ä¸ºå…¶åˆ¶å®šäº†å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆCRIï¼‰è§„èŒƒã€‚ç›®å‰å®ç°è¯¥è§„èŒƒçš„å®¹å™¨è¿è¡Œæ—¶æœ‰ containerdã€cri-oã€‚è¿˜æœ‰ katacontainersã€gvisor ç­‰æœªå®ç° CRI ä½†æ˜¯å¯ä»¥é€šè¿‡æ·»åŠ è™šæ‹ŸåŒ–å±‚åœ¨ Kubernetes ä¸Šè¿è¡Œçš„å…¶ä»–å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;å¼€æ”¾å®¹å™¨å€¡è®® (OCI) æ—¨åœ¨å®šä¹‰å®¹å™¨é•œåƒæ ¼å¼å’Œè¿è¡Œæ—¶çš„è¡Œä¸šæ ‡å‡†ï¼ŒDocker æèµ äº†å…¶è¿è¡Œæ—¶ runc ä½œä¸ºè¯¥æ ‡å‡†çš„ç¬¬ä¸€ä¸ªå®ç°ã€‚æœ€è¿‘ï¼ŒWASM ç¤¾åŒºå¯¹ OCI å·¥å…·é“¾è¡¨ç°å‡ºäº†å…´è¶£ï¼ŒDocker ç°åœ¨æ”¯æŒ WebAssembly æ¨¡å—ä½œä¸ºå…¶å·¥ä»¶ä¹‹ä¸€ã€‚ç°åœ¨ Docker Hub å·²ç»æ”¯æŒé™¤äº†é•œåƒä»¥å¤–çš„ï¼ŒHelmã€Volume å’Œ WebAssembly ç­‰å¸¸ç”¨å·¥ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker æ„å»ºåŒ…å« WebAssembly æ¨¡å—çš„é•œåƒï¼Œå¹¶ä¿å­˜åœ¨ Docker Hub ä¸­ã€‚é€šè¿‡ &lt;a href=&#34;https://github.com/deislabs/containerd-wasm-shims&#34; title=&#34;containerd-wasm-shim&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd-wasm-shim&lt;/a&gt;ï¼Œå¯ä»¥è®©å®ƒä»¬åœ¨ Kubernetes ä¸­è¿è¡Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/why-docker-support-wasm/oci.svg&#34; data-img=&#34;/blog/why-docker-support-wasm/oci.svg&#34; alt=&#34;image&#34; data-caption=&#34;åœ¨ Kubernetes ä¸­è¿è¡Œ WebAssembly æ¨¡å—&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;åœ¨ Kubernetes ä¸­è¿è¡Œ WebAssembly æ¨¡å—&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;Containerd æ˜¯ä¸€ç§ç¬¦åˆ CRIï¼ˆContainer Runtime Interfaceï¼‰è§„èŒƒçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ç”± Docker å…¬å¸å¼€æºå¹¶è´¡çŒ®ç»™ CNCF çš„ã€‚åªè¦æ”¯æŒ CRI è§„èŒƒçš„è¿è¡Œæ—¶éƒ½å¯ä»¥åœ¨ Kubernetes ä¸­è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å…³äºä»¥ä¸Šæåˆ°çš„åè¯ containerdã€CRIã€OCI ç­‰çš„å…³ç³»ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ &lt;a href=&#34;https://zhuanlan.zhihu.com/p/490585683&#34; title=&#34;Dockerï¼Œcontainerdï¼ŒCRIï¼ŒCRI-Oï¼ŒOCIï¼Œrunc åˆ†ä¸æ¸…ï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dockerï¼Œcontainerdï¼ŒCRIï¼ŒCRI-Oï¼ŒOCIï¼Œrunc åˆ†ä¸æ¸…ï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;advantages&#34;&gt;åœ¨ Docker ä¸­è¿è¡Œ WebAssembly åº”ç”¨ç›¸å¯¹ Linux é•œåƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ Docker è¿è¡Œ WebAssembly åº”ç”¨ç›¸å¯¹è¿è¡Œ Linux é•œåƒæœ‰ä»¥ä¸‹ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ›´é«˜çš„æ€§èƒ½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;WebAssembly åº”ç”¨çš„å¯åŠ¨æ—¶é—´æ›´çŸ­ï¼Œå› ä¸ºå®ƒä¸éœ€è¦å¯åŠ¨æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼Œè€Œ Linux å®¹å™¨éœ€è¦ã€‚WebAssembly æ¨¡å—çš„å†·å¯åŠ¨æ—¶é—´æ¯” Docker å®¹å™¨å¿« 100 å€ã€‚WebAssembly æ¨¡å—çš„å†…å­˜å ç”¨æ›´å°ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ ¼å¼ï¼Œå¯ä»¥é«˜æ•ˆåœ°å‹ç¼©ä»£ç å’Œä¾èµ–ï¼Œè€Œ Docker å®¹å™¨éœ€è¦æ‰“åŒ…æ•´ä¸ªé•œåƒã€‚WebAssembly æ¨¡å—çš„å¤§å°ä¸€èˆ¬åœ¨ 1MB ä»¥å†…ï¼Œè€Œ Docker é•œåƒçš„å¤§å°å¯ä»¥è¾¾åˆ° 100 æˆ– 200 MBã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ›´é«˜çš„å¯ç§»æ¤æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;WebAssembly åº”ç”¨æ˜¯ä¸€ä¸ªæ¶æ„ä¸­ç«‹çš„æ ¼å¼ï¼Œåªè¦æœ‰ç›¸åº”çš„è¿è¡Œæ—¶ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œï¼Œè€Œä¸éœ€è¦è€ƒè™‘ä¸åŒæ¶æ„ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚Docker å®¹å™¨éœ€è¦é’ˆå¯¹ä¸åŒçš„æ¶æ„æ„å»ºä¸åŒçš„é•œåƒï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›æ½œåœ¨çš„å®‰å…¨é£é™©æˆ–æ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ›´å¥½çš„å®‰å…¨æ€§å’Œéš”ç¦»æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;WebAssembly åº”ç”¨å¯ä»¥æä¾›ä»£ç çº§åˆ«çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢æ¶æ„ä»£ç è®¿é—®ç³»ç»Ÿèµ„æºï¼Œå…·ä½“æ¥è¯´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WebAssembly åº”ç”¨æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªæ²™ç®±ç¯å¢ƒä¸­çš„äºŒè¿›åˆ¶å­—èŠ‚ç ï¼Œä¸éœ€è¦è®¿é—®ä¸»æœºç³»ç»Ÿçš„èµ„æºï¼Œä¹Ÿä¸ä¼šå—åˆ°ä¸»æœºç³»ç»Ÿçš„å½±å“ã€‚Docker å®¹å™¨è™½ç„¶ä¹Ÿæ˜¯è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒä¸­ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦åœ¨ä¸»æœºç³»ç»Ÿä¸Šè¿è¡Œï¼Œå¯èƒ½ä¼šå—åˆ°ä¸»æœºç³»ç»Ÿçš„æ”»å‡»æˆ–å¹²æ‰°ã€‚&lt;/li&gt;
&lt;li&gt;WebAssembly åº”ç”¨æ˜¯é€šè¿‡ WebAssembly System Interface (WASI) æ¥ä¸å¤–éƒ¨äº¤äº’çš„ï¼ŒWASI æ˜¯ä¸€ç§æ ‡å‡†åŒ–çš„ API é›†åˆï¼Œå¯ä»¥æä¾›ä¸€äº›åŸºæœ¬çš„ç³»ç»ŸåŠŸèƒ½ï¼Œæ¯”å¦‚æ–‡ä»¶æ“ä½œã€ç½‘ç»œè®¿é—®ã€ç¯å¢ƒå˜é‡ç­‰ã€‚WASI å¯ä»¥é™åˆ¶ WebAssembly åº”ç”¨çš„æƒé™å’Œèƒ½åŠ›ï¼Œé˜²æ­¢å®ƒä»¬åšä¸€äº›å±é™©çš„æ“ä½œã€‚Docker å®¹å™¨è™½ç„¶ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ä¸€äº›å®‰å…¨é€‰é¡¹æ¥é™åˆ¶å®¹å™¨çš„æƒé™å’Œèƒ½åŠ›ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦ä¾èµ–ä¸»æœºç³»ç»Ÿæä¾›çš„åŠŸèƒ½å’ŒæœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;WebAssembly åº”ç”¨æ˜¯ä¸€ä¸ªæ¶æ„ä¸­ç«‹çš„æ ¼å¼ï¼Œåªè¦æœ‰ç›¸åº”çš„è¿è¡Œæ—¶ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œï¼Œè€Œä¸éœ€è¦è€ƒè™‘ä¸åŒæ¶æ„ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚Docker å®¹å™¨éœ€è¦é’ˆå¯¹ä¸åŒçš„æ¶æ„æ„å»ºä¸åŒçš„é•œåƒï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›æ½œåœ¨çš„å®‰å…¨é£é™©æˆ–æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› ä¸ºæœ‰ä»¥ä¸Šä¼˜åŠ¿ï¼ŒWebAssembly åœ¨ä¸€äº›åœºæ™¯ä¸‹æ¯” Docker å®¹å™¨æ›´æœ‰ä¼˜åŠ¿ï¼Œä¾‹å¦‚è¾¹ç¼˜è®¡ç®—ã€äº‘åŸç”Ÿåº”ç”¨å’Œå¾®æœåŠ¡ã€‚å½“ç„¶ï¼ŒWebAssembly åº”ç”¨ä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ï¼Œæ¯”å¦‚ä¸æ”¯æŒå¤šçº¿ç¨‹ã€åƒåœ¾å›æ”¶å’ŒäºŒè¿›åˆ¶æ‰“åŒ…ç­‰ã€‚å› æ­¤ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åœºæ™¯éƒ½é€‚åˆä½¿ç”¨ WebAssembly åº”ç”¨ã€‚ä½ å¯ä»¥æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚å’Œåå¥½æ¥é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;how-to-run-wasm-with-docker&#34;&gt;å¦‚ä½•åœ¨ Docker ä¸­è¿è¡Œ WebAssembly åº”ç”¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨ Docker ä¸­è¿è¡Œ WebAssembly åº”ç”¨çš„æ–¹å¼ä¸æ™®é€šçš„ Linux é•œåƒæ²¡æœ‰å¤ªå¤§çš„ä¸åŒï¼Œåªæ˜¯åœ¨è¿è¡Œæ—¶éœ€è¦æŒ‡å®šä¸‹å¹³å°å’Œè¿è¡Œæ—¶ã€‚ä¸‹é¢çš„ä¾‹å­æ¥è‡ª &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; title=&#34;Docker å®˜æ–¹æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ï¼Œä»¥åœ¨ Docker Desktop ä¸­ä¸ºä¾‹è¿è¡Œ WebAssembly åº”ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -dp 8080:8080 --name&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm-example --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 --platform&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasi/wasm32 michaelirwin244/wasm-example
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--runtime=io.containerd.wasmedge.v1&lt;/code&gt; æŒ‡å®šä½¿ç”¨ WasmEdge è¿è¡Œæ—¶ï¼Œæ›¿ä»£é»˜è®¤çš„ Linux å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--platform=wasi/wasm32&lt;/code&gt; æŒ‡å®šé•œåƒçš„æ¶æ„ã€‚é€šè¿‡åˆ©ç”¨ Wasm æ¶æ„ï¼Œæ— éœ€ä¸ºä¸åŒçš„æœºå™¨æ¶æ„æ„å»ºå•ç‹¬çš„é•œåƒã€‚Wasm è¿è¡Œæ—¶è´Ÿè´£å°† Wasm äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤çš„æœ€åä¸€æ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›®å‰ Docker æ”¯æŒå››ç§ WebAssembly è¿è¡Œæ—¶ï¼Œåˆ†åˆ«ä¸ºï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;è¿è¡Œæ—¶åç§°&lt;/th&gt;
          &lt;th&gt;API åç§°&lt;/th&gt;
          &lt;th&gt;å¼€å‘è€…&lt;/th&gt;
          &lt;th&gt;åŸºé‡‘ä¼šæ‰˜ç®¡&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;a href=&#34;https://github.com/fermyon/spin&#34; title=&#34;spin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;spin&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;io.containerd.spin.v1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Fermyon&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;a href=&#34;https://github.com/deislabs/spiderlightning&#34; title=&#34;SpiderLightning&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SpiderLightning&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;io.containerd.slight.v1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;DeisLabs&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;a href=&#34;https://github.com/WasmEdge/WasmEdge&#34; title=&#34;WasmEdge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;io.containerd.wasmedge.v1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;SecondState&lt;/td&gt;
          &lt;td&gt;CNCF æ²™ç®±é¡¹ç›®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;a href=&#34;https://github.com/bytecodealliance/wasmtime&#34; title=&#34;Wasmtime&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasmtime&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;io.containerd.wasmtime.v1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Mozillaã€Fastlyã€Intelã€Red Hat ç­‰å…¬å¸&lt;/td&gt;
          &lt;td&gt;å­—èŠ‚ç è”ç›Ÿé¡¹ç›®&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ WebAssembly åº”ç”¨çš„è¿è¡Œæƒ…å†µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl http://localhost:8080/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ å°†çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Hello world from Rust running with Wasm! Send POST data to /echo to have it echoed back to you
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜å¯ä»¥å‘&lt;code&gt;/echo&lt;/code&gt;ç«¯ç‚¹å‘é€ POST æµ‹è¯•è¯·æ±‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl localhost:8080/echo -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;message&amp;#34;:&amp;#34;Hello&amp;#34;}&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Content-type: application/json&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ å°†çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;summary&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† Docker ä¸ºä»€ä¹ˆè¦å¢åŠ å¯¹ WebAssembly çš„æ”¯æŒï¼Œä»¥åŠåœ¨ Docker ä¸­è¿è¡Œ WebAssembly åº”ç”¨çš„ä¼˜åŠ¿å’Œæ–¹æ³•ã€‚WebAssembly åº”ç”¨ç›¸å¯¹äº Linux é•œåƒæœ‰æ›´é«˜çš„æ€§èƒ½ã€å¯ç§»æ¤æ€§å’Œå®‰å…¨æ€§ï¼Œé€‚ç”¨äºè¾¹ç¼˜è®¡ç®—ã€äº‘åŸç”Ÿåº”ç”¨å’Œå¾®æœåŠ¡ç­‰åœºæ™¯ã€‚Docker æ”¯æŒå››ç§ WebAssembly è¿è¡Œæ—¶ï¼Œåˆ†åˆ«ä¸º spinã€spiderlightningã€WasmEdge å’Œ wasmtimeã€‚åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­æˆ‘å°†ä»‹ç»å¦‚ä½•å¼€å‘ä¸€ä¸ª WebAssembly åº”ç”¨ï¼Œæ•¬è¯·æœŸå¾…ã€‚&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/announcing-docker-hub-oci-artifacts-support/&#34; title=&#34;Announcing Docker Hub OCI Artifacts Support&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Announcing Docker Hub OCI Artifacts Support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/490585683&#34; title=&#34;Dockerï¼Œcontainerdï¼ŒCRIï¼ŒCRI-Oï¼ŒOCIï¼Œrunc åˆ†ä¸æ¸…ï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dockerï¼Œcontainerdï¼ŒCRIï¼ŒCRI-Oï¼ŒOCIï¼Œrunc åˆ†ä¸æ¸…ï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/build-share-run-webassembly-apps-docker/&#34; title=&#34;Build, Share, and Run WebAssembly Apps Using Docker&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Build, Share, and Run WebAssembly Apps Using Docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/why-containers-and-webassembly-work-well-together/&#34; title=&#34;Why Containers and WebAssembly Work Well Together&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Why Containers and WebAssembly Work Well Together&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/@guglielmino/docker-webassembly-a-quick-intro-730c38e8390c&#34; title=&#34;Docker &amp;#43; WebAssembly: a quick intro&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker + WebAssembly: a quick intro&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>Docker å‘å±•å²ï¼šå››ä¸ªé‡å¤§ä¸¾æªï¼Œå½±å“æ·±è¿œï¼</title>
      <link>https://jimmysong.io/blog/docker-four-milestones/</link>
      <pubDate>Thu, 06 Apr 2023 21:25:40 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/docker-four-milestones/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨ 2017 å¹´çš„å®¹å™¨ç¼–æ’å¤§æˆ˜ä¸­ï¼ŒDocker å…¬å¸å¤±è´¥åæ²‰å¯‚äº†å‡ å¹´ï¼Œä½†è¿‘å¹´æ¥åˆå¼€å§‹é¢‘ç¹è¡ŒåŠ¨ï¼Œä¾‹å¦‚è…¾é€€å¼€æºç»„ç»‡è´¦å·ï¼Œæ”¯æŒ WebAssembly ç­‰ã€‚æœ¬æ–‡å°†å›é¡¾ Docker å…¬å¸å‘å±•è¿‡ç¨‹ä¸­çš„å››ä¸ªé‡å¤§ä¸¾æªï¼Œè¿™äº›æªæ–½æ·±æ·±åœ°å½±å“äº† Docker å…¬å¸çš„å‘å±•ï¼Œä¹Ÿå¯¹ Docker ç”šè‡³ Kubernetes ç¤¾åŒºäº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;what-are-we-talking-about-docker&#34;&gt;å½“æˆ‘ä»¬åœ¨è°ˆè®º Docker æ—¶æˆ‘ä»¬åœ¨è°ˆè®ºä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆç¡®å®š Docker è¿™ä¸ªè¯çš„å«ä¹‰ã€‚å½“äººä»¬åœ¨è°ˆè®º Docker æ—¶å¯èƒ½æŒ‡çš„æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Docker å…¬å¸&lt;/li&gt;
&lt;li&gt;Docker è½¯ä»¶æ ˆ&lt;/li&gt;
&lt;li&gt;Docker å‘½ä»¤è¡Œå·¥å…·&lt;/li&gt;
&lt;li&gt;Docker å®¹å™¨è¿è¡Œæ—¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆåŒä¸€ä¸ªè¯ä¼šæœ‰è¿™ä¹ˆå¤šä¸åŒçš„æ„æ€å‘¢ï¼Ÿè¿™éƒ½æ˜¯æœ‰å†å²åŸå› çš„ã€‚Docker è½¯ä»¶äº 2013 å¹´å‘å¸ƒï¼Œèµ·åˆå®šä½ä¸ºå¼€å‘è€…å·¥å…·ã€‚ä½œä¸ºæœ€æ—©å‘å¸ƒçš„å®¹å™¨å·¥å…·ï¼Œå®ƒè¿…é€Ÿèµ°çº¢ï¼Œå¹¶æˆä¸ºå®¹å™¨æŠ€æœ¯çš„ä»£åè¯ã€‚ä½†å®ƒæœ€åˆåªæ˜¯åœ¨å•æœºä¸Šè¿è¡Œï¼Œæœ‰å¤ªå¤šè€¦åˆçš„æ¥å£è®¾è®¡ã€‚åæ¥å®¹å™¨é›†ç¾¤å‡ºç°ï¼Œæ‰éœ€è¦ç”¨åˆ°å®¹å™¨ç¼–æ’è°ƒåº¦å·¥å…·ã€‚å› ä¸º Kubernetes å…·æœ‰ä¸°å¯Œçš„åŠŸèƒ½å’Œæ‰©å±•æ€§ï¼ŒDocker å…¬å¸æ¨å‡ºçš„ Swarm åœ¨è¿™åœºå®¹å™¨ç¼–æ’å¤§æˆ˜ä¸­è´¥ä¸‹é˜µæ¥ã€‚å½’æ ¹ç»“åº•ï¼ŒDocker é¢å‘å¼€å‘è€…ï¼Œè€Œå®¹å™¨è¿è¡Œæ—¶åˆ™é¢å‘æœºå™¨ï¼Œåªéœ€è¦å¯¹åº”çš„æ¥å£å³å¯ï¼Œä¸éœ€è¦é‚£ä¹ˆä¸°å¯Œçš„ç®¡ç†å·¥å…·ã€‚å¦‚ä»Šï¼ŒDocker ä»ç„¶æ˜¯æœ€å—å¼€å‘è€…å–œçˆ±çš„å®¹å™¨å·¥å…·ä¹‹ä¸€ï¼Œå…¶ Docker Hub æ˜¯å…¨çƒæœ€å¤§çš„é•œåƒä»“åº“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;rename-docker-to-moby&#34;&gt;å°† Docker é¡¹ç›®æ”¹åä¸º Moby&lt;/h2&gt;
&lt;p&gt;2017 å¹´ 4 æœˆï¼ŒDocker å…¬å¸å°† Docker é¡¹ç›®é‡å‘½åä¸º Mobyï¼Œè¯¦è§ &lt;a href=&#34;https://www.docker.com/blog/introducing-the-moby-project/&#34; title=&#34;Introducing Moby Project: a new open-source project to advance the software containerization movement&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Introducing Moby Project: a new open-source project to advance the software containerization movement&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/moby/moby&#34; title=&#34;Moby Project&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Moby Project&lt;/a&gt; æ˜¯ Docker å…¬å¸ä¸ºäº†åº”å¯¹å®¹å™¨æŠ€æœ¯åœ¨å„ä¸ªé¢†åŸŸå’Œç”¨ä¾‹ä¸­æ™®åŠçš„è¶‹åŠ¿è€Œå‘èµ·çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚&lt;/li&gt;
&lt;li&gt;Moby Project æ˜¯ Docker å…¬å¸ä½œä¸ºä¸€ä¸ªå¼€æ”¾çš„ç ”å‘å®éªŒå®¤ï¼Œä¸æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿåˆä½œï¼Œå®éªŒï¼Œå¼€å‘æ–°çš„ç»„ä»¶ï¼Œå¹¶åä½œæ„å»ºå®¹å™¨æŠ€æœ¯çš„æœªæ¥ã€‚&lt;/li&gt;
&lt;li&gt;Moby Project ä¸æ˜¯ Docker äº§å“çš„æ›¿ä»£å“ï¼Œè€Œæ˜¯ Docker äº§å“çš„åŸºç¡€ã€‚&lt;/li&gt;
&lt;li&gt;Moby Project åŒ…æ‹¬ä¸‰ä¸ªå±‚æ¬¡ï¼šç»„ä»¶å±‚ï¼Œæ¡†æ¶å±‚å’Œè£…é…å±‚ã€‚
&lt;ul&gt;
&lt;li&gt;ç»„ä»¶å±‚åŒ…æ‹¬ä¸€äº›å¯å¤ç”¨çš„å¼€æºç»„ä»¶ï¼Œå¦‚ runc, containerd, LinuxKit, InfraKit ç­‰ï¼Œå¯ä»¥ç”¨äºæ„å»ºå„ç§ç±»å‹çš„å®¹å™¨ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;æ¡†æ¶å±‚æä¾›äº†ä¸€äº›å·¥å…·å’Œåº“ï¼Œç”¨äºå°†ç»„ä»¶ç»„è£…æˆç³»ç»Ÿï¼Œå¹¶ç®¡ç†å…¶ç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;li&gt;è£…é…å±‚æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„å¹³å°ï¼Œç”¨äºåˆ†äº«å’Œåä½œæ„å»ºåŸºäº Moby æ¡†æ¶çš„ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Moby Project æ˜¯ä¸€ä¸ªæ–°çš„å¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨æ¨åŠ¨è½¯ä»¶å®¹å™¨åŒ–è¿åŠ¨çš„å‘å±•ï¼Œå¸®åŠ©ç”Ÿæ€ç³»ç»Ÿè®©å®¹å™¨æŠ€æœ¯èµ°å‘ä¸»æµã€‚å®ƒæä¾›äº†ä¸€ä¸ªç»„ä»¶åº“ï¼Œä¸€ä¸ªç”¨äºå°†ç»„ä»¶ç»„è£…æˆå®šåˆ¶çš„åŸºäºå®¹å™¨çš„ç³»ç»Ÿçš„æ¡†æ¶ï¼Œä»¥åŠä¸€ä¸ªè®©æ‰€æœ‰å®¹å™¨çˆ±å¥½è€…å¯ä»¥å®éªŒå’Œäº¤æµæƒ³æ³•çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;Moby Project å’Œ Docker çš„åŒºåˆ«å’Œè”ç³»æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Moby Project æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ŒDocker æ˜¯ä¸€ä¸ªå•†ä¸šäº§å“ã€‚&lt;/li&gt;
&lt;li&gt;Moby Project æ˜¯ Docker äº§å“çš„åŸºç¡€ï¼ŒDocker äº§å“æ˜¯ Moby Project çš„ä¸€ä¸ªå®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;Moby Project æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¡†æ¶ï¼Œå¯ä»¥ç”¨äºæ„å»ºå„ç§ç±»å‹å’Œç”¨ä¾‹çš„å®¹å™¨ç³»ç»Ÿï¼ŒDocker æ˜¯ä¸€ä¸ªé’ˆå¯¹ç‰¹å®šç”¨ä¾‹çš„å®¹å™¨ç³»ç»Ÿï¼Œå³æ„å»ºï¼Œè¿è¡Œå’Œå…±äº«åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;Moby Project æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”å‘å®éªŒå®¤ï¼Œç”¨äºå®éªŒå’Œåä½œå¼€å‘æ–°çš„å®¹å™¨æŠ€æœ¯ï¼ŒDocker æ˜¯ä¸€ä¸ªæˆç†Ÿçš„äº§å“ï¼Œç”¨äºæä¾›ç¨³å®šå’Œå¯é çš„å®¹å™¨æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;support-kubernetes&#34;&gt;æ”¯æŒ Kubernetes è°ƒåº¦&lt;/h2&gt;
&lt;p&gt;Docker å…¬å¸åœ¨ 2017 å¹´ 12 æœˆå‘å¸ƒçš„ Docker 17.12 ç‰ˆæœ¬ä¸­å¼€å§‹æ”¯æŒ Kubernetesã€‚åœ¨æ­¤ä¹‹å‰ï¼ŒDocker å…¬å¸ä¸€ç›´åœ¨å‘å±•è‡ªå·±çš„å®¹å™¨ç¼–æ’å’Œè°ƒåº¦å·¥å…· Docker Swarmã€‚ç„¶è€Œï¼ŒKubernetes åœ¨å®¹å™¨ç¼–æ’å’Œè°ƒåº¦æ–¹é¢å…·æœ‰æ›´å¹¿æ³›çš„æ”¯æŒå’Œç¤¾åŒºè´¡çŒ®ï¼Œå·²ç»æˆä¸ºäº†ä¸šç•Œæ ‡å‡†ã€‚å› æ­¤ï¼ŒDocker å…¬å¸å†³å®šå°† Kubernetes é›†æˆåˆ° Docker å¹³å°ä¸­ï¼Œä»¥æä¾›æ›´å¹¿æ³›çš„é€‰æ‹©å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚Docker å…¬å¸åœ¨ Docker Desktop å’Œ Docker Enterprise ä¸­æä¾›äº† Kubernetes çš„é›†æˆæ”¯æŒï¼Œä½¿å¾— Kubernetes å’Œ Docker å®¹å™¨å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°éƒ¨ç½²å’Œç®¡ç†ã€‚åŒæ—¶ï¼ŒDocker å…¬å¸ä¹Ÿå¼€å‘äº†ä¸€äº›å·¥å…·ï¼Œå¦‚ Kompose å’Œ Docker Composeï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥å°† Docker Compose é…ç½®æ–‡ä»¶è½¬æ¢ä¸º Kubernetes YAML æ–‡ä»¶ï¼Œä»¥ä¾¿æ›´åŠ æ–¹ä¾¿åœ°å°†åº”ç”¨ç¨‹åºä» Docker Swarm è¿ç§»åˆ° Kubernetesã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-not-support-docker&#34;&gt;Kubernetes ä¸å†æ”¯æŒ Docker è¿è¡Œæ—¶&lt;/h2&gt;
&lt;p&gt;Kubernetes ä» v1.20 èµ·ä¸å†æ”¯æŒ Docker è¿è¡Œæ—¶å¹¶åœ¨ 2022 å¹´ 4 æœˆå‘å¸ƒçš„ v1.24 ä¸­è¢«å®Œå…¨ç§»é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™æ„å‘³ç€åœ¨ Kubernetes ä¸­åªèƒ½ä½¿ç”¨ containerd æˆ– CRI-O å®¹å™¨è¿è¡Œæ—¶ï¼Œä¸è¿‡ä½ ä¾ç„¶å¯ä»¥ä½¿ç”¨ Docker é•œåƒï¼Œåªæ˜¯æ— éœ€ä½¿ç”¨ docker å‘½ä»¤æˆ– Docker å®ˆæŠ¤ç¨‹åºã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          &lt;img src=&#34;https://jimmysong.io/blog/docker-four-milestones/cri.svg&#34; data-img=&#34;/blog/docker-four-milestones/cri.svg&#34; alt=&#34;image&#34; data-caption=&#34;Kubernetes v1.24 æ­£å¼ç§»é™¤ Docker è¿è¡Œæ—¶&#34;&gt;
        
      
    
  
  
  &lt;figcaption&gt;Kubernetes v1.24 æ­£å¼ç§»é™¤ Docker è¿è¡Œæ—¶&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;Kubernetes v1.24 æ­£å¼ç§»é™¤ Docker è¿è¡Œæ—¶&lt;/p&gt;
&lt;h2 id=&#34;deprecate-open-source-organization&#34;&gt;è…¾é€€å¼€æºç»„ç»‡è´¦å·&lt;/h2&gt;
&lt;p&gt;2023 å¹´ 3 æœˆï¼Œæ® &lt;a href=&#34;https://blog.alexellis.io/docker-is-deleting-open-source-images/&#34; title=&#34;Alex Ellis çš„åšå®¢&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Alex Ellis çš„åšå®¢&lt;/a&gt; ä»‹ç»ï¼ŒDocker å…¬å¸å†³å®šåˆ é™¤ä¸€äº›å¼€æºç»„ç»‡çš„è´¦æˆ·å’Œé•œåƒï¼Œé™¤éä»–ä»¬å‡çº§åˆ°ä»˜è´¹çš„å›¢é˜Ÿè®¡åˆ’ï¼Œè¿™å¯¹å¼€æºç¤¾åŒºé€ æˆäº†å¾ˆå¤§çš„å›°æ‰°å’Œä¸å®‰ã€‚å¾ˆå¤š Docker å¿ å®æ‹¥æŠ¤è€…å’Œè´¡çŒ®è€…å¯¹ Docker çš„è¿™ä¸€ä¸¾åŠ¨è¡¨ç¤ºäº†ä¸æ»¡å’Œå¤±æœ›ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€äº‹ä»¶æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Docker å…¬å¸ç»™æ‰€æœ‰åˆ›å»ºè¿‡ç»„ç»‡çš„ Docker Hub ç”¨æˆ·å‘äº†ä¸€å°é‚®ä»¶ï¼Œå‘ŠçŸ¥ä»–ä»¬å¦‚æœä¸å‡çº§åˆ°ä»˜è´¹çš„å›¢é˜Ÿè®¡åˆ’ï¼Œä»–ä»¬çš„è´¦æˆ·å’Œé•œåƒéƒ½å°†è¢«åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸€ä¸¾åŠ¨åªå½±å“å¼€æºç¤¾åŒºç»å¸¸ä½¿ç”¨çš„ç»„ç»‡è´¦æˆ·ï¼Œä¸ªäººè´¦æˆ·æ²¡æœ‰å˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;ä»˜è´¹çš„å›¢é˜Ÿè®¡åˆ’æ¯å¹´éœ€è¦ 420 ç¾å…ƒï¼Œå¾ˆå¤šå¼€æºé¡¹ç›®æ²¡æœ‰è¶³å¤Ÿçš„èµ„é‡‘æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;Docker å…¬å¸çš„å¼€æºé¡¹ç›®è®¡åˆ’ï¼ˆDSOSï¼‰è¦æ±‚éå¸¸è‹›åˆ»ï¼Œä¸å¼€æºé¡¹ç›®çš„å¯æŒç»­æ€§ç›¸æ‚–ã€‚&lt;/li&gt;
&lt;li&gt;Docker å…¬å¸çš„æ²Ÿé€šæ–¹å¼éå¸¸è„±èŠ‚ï¼Œå¼•èµ·äº†å¼€æºç¤¾åŒºçš„åæ„Ÿå’Œæ‹…å¿§ã€‚&lt;/li&gt;
&lt;li&gt;æ–‡ç« ä½œè€…å»ºè®®å¼€æºé¡¹ç›®ä½¿ç”¨å…¶ä»–çš„å®¹å™¨é•œåƒä»“åº“ï¼Œå¦‚ GitHub Container Registryã€&lt;a href=&#34;http://quay.io/&#34; title=&#34;Quay.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Quay.io&lt;/a&gt;ã€å„å¤§äº‘å‚å•†çš„é•œåƒä»“åº“ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;å¼€æºç¤¾åŒºè¿˜æä¾›äº†ä¸€äº›è¿ç§»é•œåƒå’Œé‡å‘½åé•œåƒçš„æ–¹æ³•å’Œå·¥å…·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;support-webassembly-runtime&#34;&gt;å¢åŠ å¯¹ WebAssembly è¿è¡Œæ—¶çš„æ”¯æŒ&lt;/h2&gt;
&lt;p&gt;2022 å¹´ 10 æœˆï¼ŒDocker å…¬å¸å‘å¸ƒäº† Docker+Wasm æŠ€æœ¯é¢„è§ˆï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ„å»ºï¼Œå¯ä»¥è®©å¼€å‘è€…æ›´å®¹æ˜“åœ°ä½¿ç”¨ Docker è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½ã€‚ä½œä¸ºè¿™æ¬¡å‘å¸ƒçš„ä¸€éƒ¨åˆ†ï¼ŒDocker è¿˜å®£å¸ƒå°†åŠ å…¥ Bytecode Alliance ä½œä¸ºä¸€ä¸ªæŠ•ç¥¨æˆå‘˜ã€‚&lt;/p&gt;
&lt;p&gt;Wasm æ˜¯ä¸€ç§æ–°æŠ€æœ¯ï¼Œå¯è®©ä½ åœ¨æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œ 40 å¤šç§è¯­è¨€çš„åº”ç”¨ç¨‹åºä»£ç ï¼ŒåŒ…æ‹¬ Rustï¼ŒCï¼ŒC++ï¼ŒJavaScript å’Œ Golangã€‚æœ€åˆï¼ŒWasm çš„ç”¨ä¾‹æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œæœ¬åœ°ä»£ç ï¼Œå¦‚ Figmaï¼ŒAutoCAD å’Œ Photoshop ç­‰ã€‚ç°åœ¨ï¼Œä¸€äº›å…¬å¸å¦‚ Vercelï¼ŒFastlyï¼ŒShopify å’Œ Cloudflare ç­‰æ”¯æŒä½¿ç”¨ Wasm åœ¨è¾¹ç¼˜å’Œäº‘ç«¯è¿è¡Œä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;Docker+Wasm æŠ€æœ¯é¢„è§ˆåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Docker çš„ç›®æ ‡æ˜¯å¸®åŠ©å¼€å‘è€…é€šè¿‡å…‹æœåº”ç”¨å¼€å‘çš„å¤æ‚æ€§æ¥å®ç°ä»–ä»¬çš„æƒ³æ³•ã€‚&lt;/li&gt;
&lt;li&gt;Docker å°† Wasm è§†ä¸ºä¸ Linux å®¹å™¨ç›¸è¾…ç›¸æˆçš„æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®ç”¨ä¾‹é€‰æ‹©ä½¿ç”¨å“ªç§æŠ€æœ¯ï¼ˆæˆ–ä¸¤è€…éƒ½ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Docker æƒ³è¦å¸®åŠ©å¼€å‘è€…æ›´å®¹æ˜“åœ°ä½¿ç”¨ç†Ÿæ‚‰çš„ç»éªŒå’Œå·¥å…·æ¥å¼€å‘ï¼Œæ„å»ºå’Œè¿è¡Œ Wasm åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;è¦è·å–æŠ€æœ¯é¢„è§ˆï¼Œéœ€è¦ä¸‹è½½å¹¶å®‰è£…é€‚åˆä½ ç³»ç»Ÿçš„ç‰ˆæœ¬ï¼Œç„¶åå¯ç”¨ containerd é•œåƒå­˜å‚¨ï¼ˆè®¾ç½® &amp;gt; å¼€å‘ä¸­çš„åŠŸèƒ½ &amp;gt; ä½¿ç”¨ containerd æ‹‰å–å’Œå­˜å‚¨é•œåƒï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸ªé¢„è§ˆæ”¯æŒä½¿ç”¨ WasmEdge è¿è¡Œæ—¶å¼•æ“è¿è¡Œ Wasm å®¹å™¨ï¼Œå¹¶å¯ä»¥é€šè¿‡å®¹å™¨ä»“åº“å¦‚ DockerHub ç­‰åˆ†äº«ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2023 å¹´ 3 æœˆ Docker å…¬å¸åˆå‘å¸ƒäº† Docker+Wasm æŠ€æœ¯é¢„è§ˆ 2ï¼ŒåŒ…æ‹¬äº†ä¸‰ä¸ªæ–°çš„ Wasm è¿è¡Œæ—¶å¼•æ“ï¼šFermyon çš„ spinï¼ŒDeislabs çš„ slightï¼Œå’Œ Bytecode Alliance çš„ wasmtimeã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ç‰ˆæœ¬çš„ä¸»è¦æ›´æ–°æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Docker+Wasm æŠ€æœ¯é¢„è§ˆ 2 æ˜¯åœ¨ Docker Desktop 4.15 ç‰ˆæœ¬ä¸­å‘å¸ƒçš„ï¼Œæ—¨åœ¨è®©å¼€å‘è€…æ›´å®¹æ˜“åœ°è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½ï¼Œå¹¶æ‰©å±•è¿è¡Œæ—¶æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;Docker+Wasm æŠ€æœ¯é¢„è§ˆ 2 æ”¯æŒå››ç§ Wasm è¿è¡Œæ—¶å¼•æ“ï¼ŒåŒ…æ‹¬ä¹‹å‰å·²ç»æ”¯æŒçš„ WasmEdgeï¼Œä»¥åŠæ–°å¢åŠ çš„ spinï¼Œslightï¼Œå’Œ wasmtimeã€‚&lt;/li&gt;
&lt;li&gt;è¿™å››ç§ Wasm è¿è¡Œæ—¶å¼•æ“éƒ½åŸºäº runwasi åº“ï¼Œè¿™æ˜¯ä¸€ä¸ª Rust åº“ï¼Œå¯ä»¥è®©å®¹å™¨ç®¡ç†å™¨ containerd è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½ï¼Œå¹¶åˆ›å»ºä¸€ç§æ–°çš„å®¹å™¨ç±»å‹ã€‚&lt;/li&gt;
&lt;li&gt;runwasi åº“åŸºäº WASI æ ‡å‡†ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸º WebAssembly æä¾›é€šç”¨å¹³å°æ¥å£çš„æ¨¡å—åŒ–ç³»ç»Ÿæ¥å£ã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªç¨‹åºç¼–è¯‘æˆç›®æ ‡æ˜¯ WASIï¼Œå®ƒå°±å¯ä»¥åœ¨ä»»ä½•ç¬¦åˆ WASI çš„è¿è¡Œæ—¶ä¸Šè¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;Wasm å®¹å™¨é€šå¸¸åªåŒ…å«ä¸€ä¸ªç¼–è¯‘å¥½çš„ Wasm å­—èŠ‚ç æ–‡ä»¶ï¼Œä¸éœ€è¦ä»»ä½•é¢å¤–çš„äºŒè¿›åˆ¶åº“ï¼Œè¿™ä½¿å¾—å®ƒæ¯” Linux å®¹å™¨æ›´å°ã€‚è¿™ä¹Ÿæ„å‘³ç€ Wasm å®¹å™¨é€šå¸¸å¯åŠ¨æ›´å¿«ï¼Œæ›´å¯ç§»æ¤ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äº Wasm å®¹å™¨ç›´æ¥è¢« containerd æ”¯æŒï¼Œåœ¨ Docker Desktop æœ€æ–°ç‰ˆæœ¬ä¸­å°è¯• Docker+Wasm æŠ€æœ¯é¢„è§ˆ 2 åªéœ€è¦å¯ç”¨â€œä½¿ç”¨ containerdâ€é€‰é¡¹ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒWasm å®¹å™¨å¯ä»¥ä¸ Linux å®¹å™¨ä¸€èµ·ä½¿ç”¨ Docker Compose æˆ–å…¶ä»–ç¼–æ’å¹³å°å¦‚ Kubernetes è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;æ­¤å¤–ï¼ŒDocker Desktop è¿˜èƒ½å¤Ÿå°†ä¸€ä¸ª Wasm åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ª OCI å®¹å™¨ï¼Œå¹¶åœ¨å…¶ä¸­åµŒå…¥ä¸€ä¸ª Wasm è¿è¡Œæ—¶ï¼Œä»¥ä¾¿é€šè¿‡å®¹å™¨ä»“åº“å¦‚ DockerHub ç­‰åˆ†äº«ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;summary&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† Docker å‘å±•è¿‡ç¨‹ä¸­çš„å››ä¸ªé‡å¤§ä¸¾æªï¼šMoby Projectã€æ”¯æŒ Kubernetesã€åˆ é™¤å¼€æºç»„ç»‡è´¦å·å’Œå¢åŠ å¯¹ WebAssembly è¿è¡Œæ—¶çš„æ”¯æŒã€‚å…¶ä¸­ï¼ŒMoby Project æ—¨åœ¨æ¨åŠ¨å®¹å™¨æŠ€æœ¯èµ°å‘ä¸»æµï¼Œæ”¯æŒ Kubernetes çš„ä¸¾æªæä¾›äº†æ›´å¹¿æ³›çš„é€‰æ‹©å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œåˆ é™¤å¼€æºç»„ç»‡è´¦å·çš„ä¸¾æªå¼•èµ·äº†å¼€æºç¤¾åŒºçš„ä¸æ»¡å’Œå¤±æœ›ï¼Œå¢åŠ å¯¹ WebAssembly è¿è¡Œæ—¶çš„æ”¯æŒçš„ä¸¾æªåˆ™æ‰©å±•äº† Docker çš„åº”ç”¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/introducing-the-moby-project/&#34; title=&#34;Introducing Moby Project: a new open-source project to advance the software containerization movement&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Introducing Moby Project: a new open-source project to advance the software containerization movement&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/docker-windows-desktop-now-kubernetes/&#34; title=&#34;Docker for Windows Desktopâ€¦ Now With Kubernetes!&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker for Windows Desktopâ€¦ Now With Kubernetes!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/docker-wasm-technical-preview/&#34; title=&#34;Introducing the Docker&amp;#43;Wasm Technical Preview&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Introducing the Docker+Wasm Technical Preview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.docker.com/blog/announcing-dockerwasm-technical-preview-2/&#34; title=&#34;Announcing Docker&amp;#43;Wasm Technical Preview 2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Announcing Docker+Wasm Technical Preview 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.alexellis.io/docker-is-deleting-open-source-images/&#34; title=&#34;Docker is deleting Open Source organisations - what you need to know&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker is deleting Open Source organisations - what you need to know&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/zh-cn/blog/2020/12/02/dont-panic-kubernetes-and-docker/&#34; title=&#34;åˆ«æ…Œï¼šKubernetes å’Œ Docker&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åˆ«æ…Œï¼šKubernetes å’Œ Docker&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>å¦‚ä½•åœ¨äº§å“ä¸­å¼•å…¥ eBPF ä»¥å¢åŠ å¯è§‚æµ‹æ€§</title>
      <link>https://jimmysong.io/trans/how-to-add-bpf-observability/</link>
      <pubDate>Thu, 27 Jan 2022 09:24:17 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/how-to-add-bpf-observability/</guid>
      <description>
        
        
        &lt;h2 id=&#34;ç¼–è€…æŒ‰&#34;&gt;ç¼–è€…æŒ‰&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://www.brendangregg.com/blog/2021-07-03/how-to-add-bpf-observability.html&#34; title=&#34;How To Add eBPF Observability To Your Product&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How To Add eBPF Observability To Your Product&lt;/a&gt;ï¼ŒåŸæ–‡å‘å¸ƒäº 2021 å¹´ 7 æœˆ 3 æ—¥ã€‚æœ¬æ–‡ä½œè€… Brendan Gregg æ˜¯ eBPF é¢†åŸŸçš„ä¸“å®¶ï¼Œå‡ºç‰ˆè¿‡å¤šæœ¬ç›¸å…³ä¹¦ç±ï¼Œæœ¬æ–‡æ˜¯ä»–ç»™æƒ³è¦åœ¨äº§å“ä¸­å¼•å…¥ eBPF å¢åŠ å¯è§‚æµ‹æ€§äººå‘˜çš„å¿ å‘Šã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ­£æ–‡&#34;&gt;æ­£æ–‡&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æœ‰ä¸€åœºå†›å¤‡ç«èµ›ï¼Œå³å¢åŠ  eBPF çš„å†›å¤‡ç«èµ›ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»‹ç»å¦‚ä½•å¿«é€Ÿåšåˆ°è¿™ä¸€ç‚¹ã€‚è¿™ä¹Ÿé€‚ç”¨äºäººä»¬å°†å…¶æ·»åŠ åˆ°è‡ªå·±çš„å†…éƒ¨ç›‘æµ‹ç³»ç»Ÿä¸­ã€‚&lt;/p&gt;
&lt;p&gt;äººä»¬å–œæ¬¢åœ¨ä»–ä»¬å»ºç«‹äº†åŸå‹æˆ–æ„å»ºäº†äº§å“ä¹‹åå‘æˆ‘å±•ç¤ºä»–ä»¬çš„ BPF å¯è§‚æµ‹æ€§äº§å“ï¼Œä½†æˆ‘å¸¸å¸¸åœ¨ä»–ä»¬å¼€å§‹ä¹‹å‰ç»™å‡ºå»ºè®®ã€‚ä½œä¸º BPF å¯è§‚æµ‹æ€§çš„é¢†å¯¼è€…ï¼Œè¿™æ˜¯æˆ‘åœ¨æœ€è¿‘çš„è°ˆè¯ä¸­ä¸€ç›´åŒ…å«çš„å»ºè®®ï¼Œç°åœ¨æˆ‘æŠŠå®ƒçº³å…¥è¿™ç¯‡æ–‡ç« ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘çŸ¥é“ä½ å¾ˆå¿™ã€‚ä½ ç”šè‡³å¯èƒ½ä¸å–œæ¬¢ BPFã€‚ä¸ºäº†åŠ¡å®èµ·è§ï¼Œæˆ‘å°†æè¿°å¦‚ä½•èŠ±æœ€å°‘çš„ç²¾åŠ›æ¥è·å¾—æœ€å¤§çš„ä»·å€¼ã€‚æŠŠè¿™çœ‹æˆæ˜¯â€œç¬¬ä¸€ç‰ˆâ€ã€‚ä¸€ä¸ªç›¸å½“æœ‰ç”¨çš„å‡ºå‘ç‚¹ã€‚æ— è®ºä½ æ˜¯å¦éµå¾ªè¿™ä¸ªå»ºè®®ï¼Œè‡³å°‘è¯·ä½ ç†è§£å®ƒï¼Œä»¥é¿å…ä»¥åçš„é—æ†¾å’Œç—›è‹¦ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨ä½¿ç”¨å¼€æºç›‘æ§å¹³å°ï¼Œé¦–å…ˆæ£€æŸ¥å®ƒæ˜¯å¦å·²ç»æœ‰ä¸€ä¸ª BPF ä»£ç†ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾å®ƒæ²¡æœ‰ï¼Œè€Œä¸”ä½ å°†é¦–æ¬¡æ·»åŠ ä¸€äº›ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-è¿è¡Œç¬¬ä¸€ä¸ªå·¥å…·&#34;&gt;1. è¿è¡Œç¬¬ä¸€ä¸ªå·¥å…·&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå®‰è£… &lt;a href=&#34;https://github.com/iovisor/bcc&#34; title=&#34;bcc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bcc&lt;/a&gt; æˆ– &lt;a href=&#34;https://github.com/iovisor/bpftrace&#34; title=&#34;bpftrace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bpftrace&lt;/a&gt; å·¥å…·ã€‚ä¾‹å¦‚ï¼ŒUbuntu ä¸Šçš„ bccã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# apt-get install bpfcc-tools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åå°è¯•è¿è¡Œä¸€ä¸ªå·¥å…·ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ execsnoop (8) æŸ¥çœ‹å¸¦æœ‰æ—¶é—´æˆ³çš„è¿›ç¨‹æ‰§è¡Œæƒ…å†µã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# execsnoop-bpfcc -T&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;TIME     PCOMM            PID    PPID   RET ARGS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 service          &lt;span class=&#34;m&#34;&gt;828567&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6009&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/sbin/service --status-all
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 basename         &lt;span class=&#34;m&#34;&gt;828568&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828567&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 basename         &lt;span class=&#34;m&#34;&gt;828569&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828567&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/bin/basename /usr/sbin/service
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 env              &lt;span class=&#34;m&#34;&gt;828570&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828567&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/bin/env -i &lt;span class=&#34;nv&#34;&gt;LANG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;en_AU.UTF-8 &lt;span class=&#34;nv&#34;&gt;LANGUAGE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;en_AU:en &lt;span class=&#34;nv&#34;&gt;LC_CTYPE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_NUMERIC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_TIME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_COLLATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_MONETARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_MESSAGES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_PAPER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_NAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_ADDRESS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_TELEPHONE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_MEASUREMENT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_IDENTIFICATION&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LC_ALL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/opt/local/bin:/opt/local/sbin:/usr/local/git/bin:/home/bgregg/.local/bin:/home/bgregg/bin:/opt/local/bin:/opt/local/sbin:/ &lt;span class=&#34;nv&#34;&gt;TERM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;xterm-256color /etc/init.d/acpid 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 acpid            &lt;span class=&#34;m&#34;&gt;828570&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828567&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /etc/init.d/acpid status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 run-parts        &lt;span class=&#34;m&#34;&gt;828571&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828570&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/bin/run-parts --lsbsysinit --list /lib/lsb/init-functions.d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 systemctl        &lt;span class=&#34;m&#34;&gt;828572&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828570&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/bin/systemctl -p LoadState --value show acpid.service
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;19:36:15 readlink         &lt;span class=&#34;m&#34;&gt;828573&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;828570&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; /usr/bin/readlink -f /etc/init.d/acpid
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è™½ç„¶å¾ˆåŸºæœ¬ï¼Œä½†æˆ‘ä»…ç”¨è¿™ä¸ªå·¥å…·å°±è§£å†³äº†å¾ˆå¤š perf é—®é¢˜ï¼ŒåŒ…æ‹¬é’ˆå¯¹é…ç½®é”™è¯¯çš„ç³»ç»Ÿï¼Œå…¶ä¸­ä¸€ä¸ª shell è„šæœ¬æ­£åœ¨å¾ªç¯å¯åŠ¨å¤±è´¥çš„è¿›ç¨‹ï¼Œä»¥åŠå½“ä¸€äº›å°ç¨‹åºå´©æºƒå¹¶æ¯éš”å‡ åˆ†é’Ÿå°±é‡å¯ä½†è¿˜æ²¡æœ‰è¢«æ³¨æ„åˆ°æ—¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-ä¸ºä½ çš„äº§å“æ·»åŠ ä¸€ä¸ªå·¥å…·&#34;&gt;2. ä¸ºä½ çš„äº§å“æ·»åŠ ä¸€ä¸ªå·¥å…·&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æƒ³è±¡ä¸€ä¸‹å°† execsnoop (8) æ·»åŠ åˆ°ä½ çš„äº§å“ä¸­ã€‚ä½ å¯èƒ½å·²ç»åœ¨ä½ æ‰€æœ‰çš„å®¢æˆ·ç³»ç»Ÿä¸Šè¿è¡Œäº†ä»£ç†ã€‚ä»–ä»¬æ˜¯å¦æœ‰åŠæ³•è¿è¡Œä¸€ä¸ªå‘½ä»¤å¹¶è¿”å›æ–‡æœ¬è¾“å‡ºï¼Ÿæˆ–è€…è¿è¡Œä¸€ä¸ªå‘½ä»¤å¹¶å°†è¾“å‡ºå‘é€åˆ°å…¶ä»–åœ°æ–¹è¿›è¡Œèšåˆï¼ˆS3ã€Hiveã€Druid ç­‰ï¼‰ï¼Ÿæœ‰å¾ˆå¤šé€‰æ‹©ï¼Œè¿™å®é™…ä¸Šæ˜¯ä½ è‡ªå·±åŸºäºç°æœ‰ç³»ç»Ÿå’Œå®¢æˆ·ç¯å¢ƒçš„åå¥½ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ æŠŠç¬¬ä¸€ä¸ªå·¥å…·æ·»åŠ åˆ°ä½ çš„äº§å“ä¸­æ—¶ï¼Œè®©å®ƒåœ¨çŸ­æ—¶é—´å†…è¿è¡Œï¼Œæ¯”å¦‚ 10 åˆ° 60 ç§’ã€‚æˆ‘åˆšåˆšæ³¨æ„åˆ° execsnoop (8) è¿˜æ²¡æœ‰æŒç»­æ—¶é—´é€‰é¡¹ï¼Œæ‰€ä»¥åœ¨è¿™æœŸé—´ä½ å¯ä»¥ç”¨ &lt;code&gt;watch -s2 60 execsnoop-bpfcc&lt;/code&gt; æ¥åŒ…è£…å®ƒã€‚å¦‚æœä½ æƒ³ 24 å°æ—¶è¿è¡Œè¿™äº›å·¥å…·ï¼Œé¦–å…ˆè¦ç ”ç©¶å¼€é”€ä»¥äº†è§£æˆæœ¬ã€‚ä½é¢‘ç‡çš„äº‹ä»¶ï¼Œå¦‚è¿›ç¨‹çš„æ‰§è¡Œï¼Œæ•æ‰èµ·æ¥åº”è¯¥æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ä½¿ç”¨ bccï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://github.com/iovisor/bpftrace&#34; title=&#34;bpftrace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bpftrace&lt;/a&gt; ç‰ˆæœ¬ã€‚è¿™äº›é€šå¸¸æ²¡æœ‰å°è£…é€‰é¡¹ï¼ˆ-vã€-l ç­‰ï¼‰ï¼Œä½†æœ‰ä¸€ä¸ª json è¾“å‡ºæ¨¡å¼ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# bpftrace -f json execsnoop.bt &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;attached_probes&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;probes&amp;#34;&lt;/span&gt;: 2&lt;span class=&#34;o&#34;&gt;}}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;printf&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;TIME(ms)   PID   ARGS\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;printf&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;2737       849176 &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;join&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;ls -F&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;printf&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;5641       849178 &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;join&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;date&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ·»åŠ è¿™ç§æ¨¡å¼æ˜¯ä¸ºäº†ä½¿ BPF çš„å¯è§‚æµ‹æ€§äº§å“å¯ä»¥å»ºç«‹åœ¨ bpftrace ä¹‹ä¸Šã€‚&lt;/p&gt;
&lt;h2 id=&#34;3-ä¸è¦æ‹…å¿ƒä¾èµ–æ€§é—®é¢˜&#34;&gt;3. ä¸è¦æ‹…å¿ƒä¾èµ–æ€§é—®é¢˜&lt;/h2&gt;
&lt;p&gt;æˆ‘å»ºè®®ä½ åœ¨å®¢æˆ·ç³»ç»Ÿä¸Šå®‰è£… bcc æˆ– bpftraceï¼Œå®ƒä»¬ç›®å‰æœ‰ llvm ä¾èµ–ã€‚è¿™å¯èƒ½ä¼šå¢åŠ åˆ°å‡ å MBï¼Œè¿™å¯¹ä¸€äº›èµ„æºæœ‰é™çš„ç¯å¢ƒï¼ˆåµŒå…¥å¼ï¼‰æ˜¯ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸€ç›´åœ¨åšå¤§é‡çš„å·¥ä½œï¼Œä»¥ä¾¿åœ¨æœªæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ &lt;a href=&#34;https://www.brendangregg.com/blog/2020-11-04/bpf-co-re-btf-libbpf.html&#34; title=&#34;BTF and CO-RE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BTF and CO-RE&lt;/a&gt;ï¼ˆè€Œä¸æ˜¯ Pythonï¼‰ï¼Œæœ€ç»ˆå°†æ„å‘³ç€ä½ å¯ä»¥å®‰è£… 100KB çš„æ— ä¾èµ–æ€§çš„å·¥å…·äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚bpftrace ä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼çš„è®¡åˆ’ï¼Œä½¿ç”¨è¾ƒæ–°çš„å†…æ ¸ç‰¹æ€§ç”Ÿæˆä¸€ä¸ªå°çš„æ— ä¾èµ–æ€§çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¡®å®éœ€è¦è‡³å°‘ Linux 5.8 æ‰èƒ½å¾ˆå¥½åœ°å·¥ä½œï¼Œè€Œä½ çš„å®¢æˆ·å¯èƒ½å‡ å¹´éƒ½ä¸ä¼šè¿è¡Œè¿™ä¸ªç³»ç»Ÿã€‚åœ¨è¿™æœŸé—´ï¼Œæˆ‘å»ºè®®æš‚æ—¶ä¸è¦æ‹…å¿ƒ llvm çš„ä¾èµ–å…³ç³»ï¼Œå› ä¸ºå®ƒä»¥åä¼šè¢«ä¿®å¤ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ Linux å‘è¡Œç‰ˆéƒ½å¯ç”¨äº† &lt;code&gt;CONFIG_DEBUG_INFO_BTF=y&lt;/code&gt;ï¼Œè¿™å¯¹äº BTF å’Œ CO-RE çš„æœªæ¥æ˜¯å¿…è¦çš„ã€‚ä¸»è¦çš„å‘è¡Œç‰ˆå·²ç»è®¾ç½®äº†å®ƒï¼Œæ¯”å¦‚åœ¨ Ubuntu 20.10ã€Fedora 30 å’Œ RHEL 8.2ã€‚ä½†å¦‚æœä½ çŸ¥é“ä½ çš„ä¸€äº›å®¢æˆ·æ­£åœ¨è¿è¡Œä¸€äº›ä¸å¸¸è§çš„ä¸œè¥¿ï¼Œè¯·æ£€æŸ¥å¹¶é¼“åŠ±ä»–ä»¬æˆ–å‘è¡Œå•†è®¾ç½® &lt;code&gt;CONFIG_DEBUG_INFO_BTF=y&lt;/code&gt; å’Œ &lt;code&gt;CONFIG_DEBUG_INFO_BTF_MODULES=y&lt;/code&gt;ï¼Œä»¥é¿å…æœªæ¥çš„ç—›è‹¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;4-ç¬¬-1-ç‰ˆä»ªè¡¨æ¿&#34;&gt;4. ç¬¬ 1 ç‰ˆä»ªè¡¨æ¿&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä½ çš„äº§å“ä¸­æœ‰äº†ä¸€ä¸ª BPF å¯è§‚æµ‹æ€§å·¥å…·ï¼Œæ˜¯æ—¶å€™å¢åŠ æ›´å¤šçš„å·¥å…·äº†ã€‚ä¸‹é¢æ˜¯ä½ å¯ä»¥è¿è¡Œçš„åå¤§å·¥å…·ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªé€šç”¨çš„ BPF å¯è§‚æµ‹æ€§ä»ªè¡¨ç›˜æ¥å±•ç¤ºï¼ŒåŒæ—¶è¿˜æœ‰å»ºè®®çš„å¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ç¼–å·&lt;/th&gt;
          &lt;th&gt;å·¥å…·&lt;/th&gt;
          &lt;th&gt;å±•ç¤º&lt;/th&gt;
          &lt;th&gt;å¯è§†åŒ–&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;1.&lt;/td&gt;
          &lt;td&gt;execsnoop&lt;/td&gt;
          &lt;td&gt;æ–°è¿›ç¨‹ï¼ˆé€šè¿‡ exec (2)ï¼‰&lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2.&lt;/td&gt;
          &lt;td&gt;opensnoop&lt;/td&gt;
          &lt;td&gt;æ‰“å¼€çš„æ–‡ä»¶&lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3.&lt;/td&gt;
          &lt;td&gt;ext4slower&lt;/td&gt;
          &lt;td&gt;æ…¢é€Ÿæ–‡ä»¶ç³»ç»Ÿ I/O&lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;4.&lt;/td&gt;
          &lt;td&gt;biolatency&lt;/td&gt;
          &lt;td&gt;ç£ç›˜ I/O å»¶è¿ŸæŸ±çŠ¶å›¾&lt;/td&gt;
          &lt;td&gt;çƒ­åŠ›å›¾&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;5.&lt;/td&gt;
          &lt;td&gt;biosnoop&lt;/td&gt;
          &lt;td&gt;æ¯ä¸ªäº‹ä»¶çš„ç£ç›˜ I/O ç»†èŠ‚&lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼ï¼Œåç§»çƒ­å›¾&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;6.&lt;/td&gt;
          &lt;td&gt;cachestat&lt;/td&gt;
          &lt;td&gt;æ–‡ä»¶ç³»ç»Ÿé«˜é€Ÿç¼“å­˜ç»Ÿè®¡&lt;/td&gt;
          &lt;td&gt;çº¿çŠ¶å›¾&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;7.&lt;/td&gt;
          &lt;td&gt;tcplife&lt;/td&gt;
          &lt;td&gt;TCP è¿æ¥&lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼ï¼Œåˆ†å¸ƒå¼å›¾è¡¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;8.&lt;/td&gt;
          &lt;td&gt;tcpretrans&lt;/td&gt;
          &lt;td&gt;TCP é‡ä¼ &lt;/td&gt;
          &lt;td&gt;è¡¨æ ¼&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;9.&lt;/td&gt;
          &lt;td&gt;runqlat&lt;/td&gt;
          &lt;td&gt;CPU è°ƒåº¦å™¨çš„å»¶è¿Ÿ&lt;/td&gt;
          &lt;td&gt;çƒ­åŠ›å›¾&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;10.&lt;/td&gt;
          &lt;td&gt;profile&lt;/td&gt;
          &lt;td&gt;CPU å †æ ˆè·Ÿè¸ªæ ·æœ¬&lt;/td&gt;
          &lt;td&gt;ç«ç„°å›¾&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™æ˜¯åœ¨æˆ‘çš„ &lt;a href=&#34;https://github.com/iovisor/bcc/blob/master/docs/tutorial.md&#34; title=&#34;bcc Tutorial&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bcc Tutorial&lt;/a&gt; çš„ï¼Œè€Œä¸”å¾ˆå¤šä¹Ÿå­˜åœ¨äº bpftrace ä¸­ã€‚æˆ‘é€‰æ‹©è¿™äº›æ˜¯ä¸ºäº†ç”¨æœ€å°‘çš„å·¥å…·æ‰¾åˆ°æœ€å¤§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œrunqlat å’Œ profile ä¼šæœ‰æ˜æ˜¾çš„å¼€é”€ï¼Œæ‰€ä»¥æˆ‘åªè¿è¡Œè¿™äº›å·¥å…· 10 åˆ° 60 ç§’ï¼Œç„¶åç”Ÿæˆä¸€ä»½æŠ¥å‘Šã€‚æœ‰äº›å·¥å…·çš„å¼€é”€å¾ˆä½ï¼Œå¦‚æœéœ€è¦çš„è¯å¯ä»¥ 24 å°æ—¶è¿è¡Œï¼ˆä¾‹å¦‚ execsnoopã€biolatencyã€tcplifeã€tcpretransï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ bcc å’Œ bpftrace èµ„æºåº“ä¸­ï¼Œå·²ç»æœ‰ä»¥æ‰‹å†Œå’Œå®ä¾‹æ–‡ä»¶å½¢å¼å­˜åœ¨çš„æ–‡æ¡£ï¼Œä½ å¯ä»¥é“¾æ¥åˆ°è¿™äº›æ–‡æ¡£ï¼Œä»¥å¸®åŠ©ä½ çš„å®¢æˆ·äº†è§£å·¥å…·çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼Œåœ¨ &lt;a href=&#34;https://github.com/iovisor/bcc/blob/master/tools/execsnoop_example.txt&#34; title=&#34;bcc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bcc&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/iovisor/bpftrace/blob/master/tools/execsnoop_example.txt&#34; title=&#34;bpftrace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bpftrace&lt;/a&gt; æœ‰ execsnoop (8) çš„ç¤ºä¾‹æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæˆè¿™äº›åï¼Œä½ å°±æœ‰äº†ç¬¬ä¸€ç‰ˆçš„ä»ªè¡¨æ¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;bcc-ä¸-bpftrace&#34;&gt;bcc ä¸ bpftrace&lt;/h2&gt;
&lt;p&gt;bcc å·¥å…·æ˜¯æœ€å®¹æ˜“ä½¿ç”¨çš„ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æœ‰å¾ˆå¤šå‘½ä»¤è¡Œé€‰é¡¹ã€‚bpftrace å·¥å…·æ›´å®¹æ˜“ç¼–è¾‘å’Œå®šåˆ¶ï¼Œè€Œä¸” bpftrace æœ‰ä¸€ä¸ª json è¾“å‡ºæ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯è¿½è¸ªçš„æ–°æ‰‹ï¼Œå°±ç”¨ bcc å§ã€‚å¦‚æœä½ æƒ³åšä¸€äº›é»‘å®¢å’Œå®šåˆ¶çš„å·¥å…·ï¼Œå°±ç”¨ bpftraceã€‚æœ€åï¼Œå®ƒä»¬éƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¡ˆä¾‹ç ”ç©¶netflix&#34;&gt;æ¡ˆä¾‹ç ”ç©¶ï¼šNetflix&lt;/h2&gt;
&lt;p&gt;Netflix æ­£åœ¨å»ºç«‹ä¸€ä¸ªæ–°çš„ GUIï¼Œåœ¨è¿™äº›å·¥å…·çš„ bpftrace ç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼Œåšè¿™ä¸ªå·¥å…·ä»ªè¡¨ç›˜å’Œæ›´å¤šçš„å·¥ä½œã€‚æ¶æ„å¦‚å›¾ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/how-to-add-bpf-observability/008i3skNly1gys3a6aaa2j31310u0tcj_hu_4130f5c06888eb71.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/how-to-add-bpf-observability/008i3skNly1gys3a6aaa2j31310u0tcj.jpg&#34; data-img=&#34;/trans/how-to-add-bpf-observability/008i3skNly1gys3a6aaa2j31310u0tcj.jpg&#34; data-width=&#34;1000&#34; data-height=&#34;769&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;è™½ç„¶ bpftrace äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…åœ¨æ‰€æœ‰ç›®æ ‡ç³»ç»Ÿä¸Šï¼Œä½† bpftrace å·¥å…·ï¼ˆæ–‡æœ¬æ–‡ä»¶ï¼‰å´åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Šï¼Œå¹¶åœ¨éœ€è¦æ—¶è¢«æ¨é€å‡ºå»ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸€ä¸ªåœ°æ–¹æ›´æ–°å·¥å…·æ¥ç¡®ä¿æˆ‘ä»¬ä¸€ç›´åœ¨è¿è¡Œæœ€æ–°ç‰ˆæœ¬çš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç›®å‰æˆ‘ä»¬ FlameCommander ç”¨æˆ·ç•Œé¢çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä¹Ÿåœ¨äº‘ç«¯è¿è¡Œç«ç„°å›¾ã€‚æˆ‘ä»¬ä»¥å‰çš„ BPF GUI æ˜¯ &lt;a href=&#34;https://github.com/Netflix/vector&#34; title=&#34;Vector&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vector&lt;/a&gt; çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨äº† bccï¼Œä½†æˆ‘ä»¬åæ¥åºŸå¼ƒäº†å®ƒã€‚æˆ‘ä»¬å¯èƒ½ä¼šåœ¨æŸä¸ªæ—¶å€™å¼€æºæ–°çš„ GUIï¼Œå¹¶åœ¨ Netflix æŠ€æœ¯åšå®¢ä¸Šå‘è¡¨ç›¸å…³æ–‡ç« ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¡ˆä¾‹ç ”ç©¶facebook&#34;&gt;æ¡ˆä¾‹ç ”ç©¶ï¼šFacebook&lt;/h2&gt;
&lt;p&gt;Facebook æ˜¯ BPF çš„é«˜çº§ç”¨æˆ·ï¼Œä½†ä»–ä»¬å¦‚ä½•åœ¨æ•´ä¸ªé›†ç¾¤ä¸­è¿è¡Œå·¥å…·çš„æ·±å±‚ç»†èŠ‚å¹¶æ²¡æœ‰å®Œå…¨å…¬å¼€ã€‚æ ¹æ® bcc çš„æ´»åŠ¨ï¼Œä»¥åŠä»–ä»¬å¯¹ BTF å’Œ CO-RE æŠ€æœ¯çš„å¼€å‘ï¼Œæˆ‘ååˆ†æ€€ç–‘ä»–ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯åŸºäº bcc çš„ libbpf-tool ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç§»æ¤çš„é™·é˜±&#34;&gt;ç§»æ¤çš„é™·é˜±&lt;/h2&gt;
&lt;p&gt;BPF è¿½è¸ªå·¥å…·å°±åƒåº”ç”¨ç¨‹åºå’Œå†…æ ¸çš„è¡¥ä¸ã€‚å®ƒä»¬éœ€è¦ä¸æ–­çš„æ›´æ–°ä»¥ä¿æŒåœ¨ä¸åŒçš„è½¯ä»¶ç‰ˆæœ¬ä¸­å·¥ä½œã€‚æŠŠå®ƒä»¬ç§»æ¤åˆ°ä¸åŒçš„è¯­è¨€ï¼Œç„¶åä¸ç»´æŠ¤å®ƒä»¬ï¼Œå¯èƒ½å°±åƒè¯•å›¾æŠŠ Linux 4.15 çš„è¡¥ä¸åº”ç”¨äº Linux 5.12ã€‚å¦‚æœä½ è¿æ°”å¥½ï¼Œå®ƒå°±ä¼šå·¥ä½œï¼å¦‚æœä½ ä¸èµ°è¿ï¼Œè¡¥ä¸å°±ä¼šåº”ç”¨ï¼Œä½†ä¼šä»¥ä¸€ç§å¾®å¦™çš„æ–¹å¼ç ´åä¸€äº›ä¸œè¥¿ï¼Œç›´åˆ°åæ¥ä½ æ‰æ³¨æ„åˆ°ã€‚è¿™å–å†³äºå·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œæˆ‘åœ¨ 2014 å¹´ä¼‘å‡æ—¶å†™äº† cachestat (8)ï¼Œç”¨äº Netflix cloudï¼Œå½“æ—¶æ˜¯ Linux 3.2 å’Œ 3.13 çš„æ··åˆç‰ˆæœ¬ã€‚BPF åœ¨è¿™äº›ç‰ˆæœ¬ä¸Šå¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº† Linux 3.2 ä¸Šçš„åŸºæœ¬ Ftrace åŠŸèƒ½ã€‚æˆ‘æŠŠè¿™ç§æ–¹æ³•æè¿°ä¸º &lt;a href=&#34;https://www.brendangregg.com/blog/2014-12-31/linux-page-cache-hit-ratio.html&#34; title=&#34;brittle&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;brittle&lt;/a&gt;ï¼Œ &lt;a href=&#34;https://github.com/brendangregg/perf-tools/blob/master/fs/cachestat&#34; title=&#34;sandcastle&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sandcastle&lt;/a&gt; éœ€è¦éšç€å†…æ ¸çš„å˜åŒ–è€Œè¿›è¡Œç»´æŠ¤ã€‚åæ¥ï¼Œå®ƒè¢«ç§»æ¤åˆ°äº†å¸¦æœ‰ kprobes çš„ BPF ä¸Šï¼Œç°åœ¨å·²ç»è¢«é‡å†™å¹¶åŒ…å«åœ¨å•†ä¸šå¯è§‚æµ‹æ€§äº§å“ä¸­ã€‚æˆ‘å¬è¯´å®ƒåœ¨è¾ƒæ–°çš„å†…æ ¸ä¸Šæœ‰é—®é¢˜ï¼Œæ‰“å°çš„è¾“å‡ºæ²¡æœ‰æ„ä¹‰ã€‚å®ƒçœŸçš„éœ€è¦ä¸€æ¬¡å¤§ä¿®ã€‚å½“æˆ‘ï¼ˆæˆ–æŸäººï¼‰åšäº†è¿™ä¸ªå·¥ä½œï¼Œä»»ä½•ä» bcc ä¸Šæ‹‰å–æ›´æ–°çš„äººéƒ½ä¼šè‡ªåŠ¨å¾—åˆ°å›ºå®šçš„ç‰ˆæœ¬ï¼Œä¸éœ€è¦è´¹åŠ›ã€‚é‚£äº›é‡å†™çš„äººå°†éœ€è¦é‡å†™è‡ªå·±çš„ç‰ˆæœ¬ã€‚æˆ‘æ‹…å¿ƒä»–ä»¬ä¸ä¼šè¿™æ ·åšï¼Œè€Œå®¢æˆ·å°†åœ¨å¤šå¹´æ¥ä¸€ç›´è¿è¡Œä¸€ä¸ªé”™è¯¯çš„ cachestat (8) ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œå¦‚æœåœ¨æˆ‘å†™ cachestat (8) çš„æ—¶å€™ï¼ŒBPF åœ¨æˆ‘çš„ç›®æ ‡ç¯å¢ƒä¸­æ˜¯å¯ç”¨çš„ï¼Œæˆ‘çš„ç¼–ç æ–¹å¼å°±ä¼šå®Œå…¨ä¸åŒã€‚äººä»¬æ­£åœ¨ç§»æ¤ä¸º Linux 3.2 ç¼–å†™çš„ä¸œè¥¿ï¼Œå¹¶åœ¨ Linux 5.x ä¸Šè¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»¥å‰çš„ä¸€ç¯‡åšæ–‡ &lt;a href=&#34;https://www.brendangregg.com/blog/2021-06-04/an-unbelievable-demo.html&#34; title=&#34;An Unbelievable Demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;An Unbelievable Demo&lt;/a&gt; ä¸­ï¼Œè°ˆåˆ°äº†å¾ˆå¤šå¹´å‰å‘ç”Ÿçš„ç±»ä¼¼æƒ…å†µï¼Œå³åœ¨æ²¡æœ‰æ›´æ–°çš„æƒ…å†µä¸‹ä½¿ç”¨æ—§çš„è¿½è¸ªå·¥å…·ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ‰€æè¿°çš„é—®é¢˜æ˜¯é’ˆå¯¹ BPF è½¯ä»¶å’Œå†…æ ¸è¿½è¸ªçš„ã€‚ä½œä¸ºä¸€ä¸ªä¸åŒçš„ä¾‹å­ï¼Œæˆ‘çš„ç«ç„°å›¾è½¯ä»¶å·²ç»è¢«é‡å†™äº†åå‡ æ¬¡ï¼Œç”±äºå®ƒæ˜¯ä¸€ä¸ªç®€å•è€Œå®Œå¤‡çš„ç®—æ³•ï¼Œæˆ‘ä¸è®¤ä¸ºè¿™æœ‰ä»€ä¹ˆå¤§é—®é¢˜ã€‚æˆ‘æ›´å–œæ¬¢äººä»¬å¸®åŠ©æ›´æ–° &lt;a href=&#34;https://github.com/spiermar/d3-flame-graph&#34; title=&#34;d3 version&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;d3 version&lt;/a&gt; ä½†å¦‚æœäººä»¬è‡ªå·±åšï¼Œé‚£ä¹Ÿæ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ã€‚ä½ å¯ä»¥ç»™å®ƒç¼–ç ï¼Œå®ƒå°†æ°¸è¿œå·¥ä½œã€‚åŸºäº uprobe å’Œ kprobe çš„ BPF å·¥å…·å°±ä¸æ˜¯è¿™æ ·äº†ï¼Œå› ä¸ºå®ƒä»¬ç¡®å®éœ€è¦ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åƒç³»ç»Ÿç®¡ç†å‘˜ä¸€æ ·æ€è€ƒè€Œä¸æ˜¯åƒç¨‹åºå‘˜ä¸€æ ·æ€è€ƒ&#34;&gt;åƒç³»ç»Ÿç®¡ç†å‘˜ä¸€æ ·æ€è€ƒï¼Œè€Œä¸æ˜¯åƒç¨‹åºå‘˜ä¸€æ ·æ€è€ƒ&lt;/h2&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œé¦–å…ˆæ£€æŸ¥ä½ çš„ç›‘æ§ç³»ç»Ÿæ˜¯å¦å·²ç»æœ‰ä¸€ä¸ª BPF ä»£ç†ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±åœ¨ç°æœ‰çš„åŸºç¡€ä¸Šæ„å»ºä¸€ä¸ª &lt;a href=&#34;https://github.com/iovisor/bcc&#34; title=&#34;bcc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bcc&lt;/a&gt; æˆ– &lt;a href=&#34;https://github.com/iovisor/bpftrace&#34; title=&#34;bpftrace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;bpftrace&lt;/a&gt; å·¥å…·ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹é‡å†™ä¸€åˆ‡ã€‚è¿™æ˜¯åƒä¸€ä¸ªå®‰è£…å’Œç»´æŠ¤è½¯ä»¶çš„ç³»ç»Ÿç®¡ç†å‘˜é‚£æ ·æ€è€ƒï¼Œè€Œä¸æ˜¯åƒä¸€ä¸ªç¼–ç æ‰€æœ‰ä¸œè¥¿çš„ç¨‹åºå‘˜é‚£æ ·æ€è€ƒã€‚å®‰è£… bcc æˆ– bpftrace å·¥å…·ï¼ŒæŠŠå®ƒä»¬æ·»åŠ åˆ°ä½ çš„å¯è§‚æµ‹æ€§äº§å“ä¸­ï¼Œå¹¶æ ¹æ®éœ€è¦æ‹‰å–åŒ…çš„æ›´æ–°ã€‚è¿™å°†æ˜¯ä¸€ä¸ªå¿«é€Ÿè€Œæœ‰ç”¨çš„ç‰ˆæœ¬ã€‚BPF å¯åŠ¨å’Œè¿è¡Œäº†ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘çœ‹åˆ°äººä»¬åè€Œåƒç¨‹åºå‘˜ä¸€æ ·æ€è€ƒï¼Œè§‰å¾—ä»–ä»¬å¿…é¡»ä»æ·±å…¥å­¦ä¹  bcc å’Œ BPF ç¼–ç¨‹ã€‚ç„¶åï¼Œåœ¨å‘ç°æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ C è¯­è¨€æˆ– Python å†™çš„ä¹‹åï¼Œæœ‰äº›äººå°±ç”¨ä¸åŒçš„è¯­è¨€é‡å†™äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå­¦å¥½ bcc å’Œ BPF éœ€è¦å‡ å‘¨æ—¶é—´ï¼›å­¦ä¹ ç³»ç»Ÿè·Ÿè¸ªçš„å¾®å¦™ä¹‹å¤„å’Œé™·é˜±å¯èƒ½éœ€è¦å‡ ä¸ªæœˆæˆ–å‡ å¹´ã€‚ä¸ºäº†è®©ä½ äº†è§£ä½ æ‰€é¢ä¸´çš„æƒ…å†µï¼Œè¯·çœ‹æˆ‘çš„ &lt;a href=&#34;https://www.brendangregg.com/blog/2021-06-15/bpf-internals.html&#34; title=&#34;BPF Internals&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BPF Internals&lt;/a&gt; è®²åº§ã€‚å¦‚æœä½ çœŸçš„æƒ³åšè¿™ä¸ªï¼Œå¹¶ä¸”æœ‰æ—¶é—´ï¼Œä½ å½“ç„¶å¯ä»¥ï¼ˆä½ å¯èƒ½ä¼šåœ¨ Tracing ä¼šè®®ä¸Šé‡åˆ°æˆ‘ã€‚åœ¨ Linux Plumberâ€™s æˆ–è¿½ Tracing ä¼šä¸Šè§ï¼ï¼‰ä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨æŸä¸ªæœŸé™å†…è¦å¢åŠ  BPF çš„å¯è§‚æµ‹æ€§ï¼Œé‚£å°±è¯•ç€åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜é‚£æ ·æ€è€ƒï¼Œå¹¶åœ¨ç°æœ‰çš„å·¥å…·åŸºç¡€ä¸Šè¿›è¡Œæ„å»ºã€‚è¿™æ˜¯å¿«é€Ÿçš„æ–¹æ³•ã€‚ä»¥åå†åƒç¨‹åºå‘˜é‚£æ ·æ€è€ƒï¼Œå¦‚æœä½ æœ‰æ—¶é—´çš„è¯ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒï¼ŒBPF è½¯ä»¶ï¼Œç‰¹åˆ«æ˜¯æŸäº›åŸºäº kprobe çš„å·¥å…·ï¼Œéœ€è¦æŒç»­çš„ç»´æŠ¤ã€‚ä¸€ä¸ªå·¥å…·å¯èƒ½åœ¨ Linux 5.3 ä¸Šå·¥ä½œï¼Œä½†åœ¨ 5.4 ä¸Šå°±ä¼šåæ‰ï¼Œå› ä¸ºä¸€ä¸ªè¢«è¿½è¸ªçš„å‡½æ•°è¢«é‡æ–°å‘½åæˆ–å¢åŠ äº†ä¸€ä¸ªæ–°çš„ä»£ç è·¯å¾„ã€‚BPF åº“å’Œæ¡†æ¶ä¹Ÿåœ¨å˜åŒ–å’Œå‘å±•ï¼Œæœ€è¿‘çš„ä¸€æ¬¡æ˜¯ BTF å’Œ CO-RE æ”¯æŒã€‚è¿™æ˜¯æˆ‘å¸Œæœ›äººä»¬åœ¨é€‰æ‹©é‡å†™å®ƒä»¬ä¹‹å‰è¦è€ƒè™‘çš„é—®é¢˜ã€‚ä½ æ˜¯å¦ä¹Ÿæœ‰è®¡åˆ’é‡å†™æ‰€æœ‰çš„æ›´æ–°ï¼Œæˆ–è€…ä½ æœ€ç»ˆä¼šè¢«å›°åœ¨ä¸€ä¸ªæ—§çš„åº“çš„ç«¯å£ä¸Šï¼Ÿæ‹‰å–æ‰€æœ‰çš„æ›´æ–°æ¯”ç»´æŠ¤ä½ è‡ªå·±çš„ç‰ˆæœ¬æ›´å®¹æ˜“ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ¯”æˆ‘ä»¬åœ¨ bcc å’Œ bpftrace ä¸­ä½¿ç”¨çš„æ›´å¥½çš„ BPF åº“æˆ–æ¡†æ¶çš„å¥½ä¸»æ„å‘¢ï¼Ÿå’Œæˆ‘ä»¬è°ˆè°ˆï¼Œè¯•è¯•ï¼Œåˆ›æ–°ä¸€ä¸‹ã€‚æˆ‘ä»¬æ­£å¤„äº BPF æ—¶ä»£çš„å¼€ç«¯ï¼Œè¿˜æœ‰å¾ˆå¤šä¸œè¥¿éœ€è¦æ¢ç´¢ã€‚ä½†è¯·å…ˆäº†è§£ç°æœ‰çš„æƒ…å†µä»¥åŠä½ æ‰€æ‰¿æ‹…çš„ç»´æŠ¤è´Ÿæ‹…ã€‚ä½ çš„ç²¾åŠ›å¯èƒ½ä¼šè¢«ç”¨æ¥åœ¨ç°æœ‰çš„åŸºç¡€ä¸Šåˆ›é€ æ–°çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯ç§»æ¤æ—§çš„ä¸œè¥¿ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>äº‘ç«¯ IDE æ˜¯è½¯ä»¶å·¥ç¨‹çš„æœªæ¥å—ï¼Ÿ</title>
      <link>https://jimmysong.io/trans/are-cloud-based-ides-the-future-of-software-engineering/</link>
      <pubDate>Mon, 10 Jan 2022 19:55:44 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/are-cloud-based-ides-the-future-of-software-engineering/</guid>
      <description>
        
        
        &lt;p&gt;&lt;strong&gt;ç¼–è€…æŒ‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å¯¹æ¯”äº†äº‘ç«¯ IDE çš„ä¼˜ç¼ºç‚¹ï¼Œå°±åƒäº‘ç«¯ Office ä¸€æ ·ï¼Œäº‘ç«¯ IDE è¿Ÿæ—©ä¹Ÿä¼šå˜å¾—æµè¡Œèµ·æ¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä¼ ç»Ÿä¸Šï¼Œ&lt;a href=&#34;https://thenewstack.io/category/development/&#34; title=&#34;è½¯ä»¶å¼€å‘&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è½¯ä»¶å¼€å‘&lt;/a&gt;æ˜¯ï¼ˆè€Œä¸”åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä»ç„¶æ˜¯ï¼‰åœ¨ä¸ªäººæœºå™¨ä¸Šä½¿ç”¨é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰å·¥å…·ï¼Œå¦‚ VSCodeã€JetBrainsã€Eclipse ç­‰å®Œæˆã€‚è™½ç„¶è¿™ç§ &amp;ldquo;ç¦»çº¿&amp;rdquo; å¼€å‘çš„æ¨¡å¼åœ¨æ—©æœŸè¿ä½œå¾—éå¸¸å¥½ï¼Œä½†äººä»¬å¾ˆå¿«å°±æ³¨æ„åˆ°ï¼Œè¿™ç§æ–¹æ³•å¹¶éå®Œç¾ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåˆä½œèµ·æ¥å¾ˆéº»çƒ¦ï¼Œå› ä¸ºå†™å¥½çš„ä»£ç å¿…é¡»ä¸Šä¼ åˆ°ç½‘ä¸Šä¾›è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è¿™æ ·å†™å‡ºæ¥çš„ä»£ç çš„å¯ç§»æ¤æ€§ä¹Ÿå¹¶ä¸æ€»æ˜¯æœ‰ä¿è¯ï¼Œå› ä¸ºæœ‰å„ç§å„æ ·çš„æ“ä½œç³»ç»Ÿå’Œå…¶ä»–é™åˆ¶æ¡ä»¶ï¼Œéœ€è¦å®ƒæ¥å®ç°æœ€ä½³çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚å¼€å‘è€…å’ŒæŠ€æœ¯è®°è€… &lt;a href=&#34;https://char.gd/blog/author/owen&#34; title=&#34;Owen Williams&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Owen Williams&lt;/a&gt; å»å¹´ &lt;a href=&#34;https://char.gd/blog/2020/github-codespaces-means-your-computer-doesnt-matter-anymore&#34; title=&#34;åœ¨ä»–çš„åšå®¢ Charged ä¸Š&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ä»–çš„åšå®¢ Charged ä¸Š&lt;/a&gt;å†™é“ï¼šâ€œåœ¨è®¾å¤‡ä¹‹é—´åŒæ­¥ä½ çš„æ–‡æ¡£å’Œç…§ç‰‡æ˜¯å¾®ä¸è¶³é“çš„â€¦â€¦ è¿™æ ·ä½ å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æŠŠå®ƒä»¬è°ƒå‡ºæ¥ï¼Œä½†å¼€å‘è€…å·¥å…·ä»ç„¶åœç•™åœ¨è¿‡å» â€”â€” æ¯å°ç¬”è®°æœ¬ç”µè„‘æˆ– PC éƒ½è¦å•ç‹¬é…ç½®ï¼Œä½¿ä½ çš„ç¯å¢ƒè®¾ç½®å¾—æ°åˆ°å¥½å¤„ã€‚â€&lt;/p&gt;
&lt;p&gt;éšç€å¤§æµè¡ŒæœŸé—´è¶Šæ¥è¶Šå¤šçš„åˆ†å¸ƒå¼å›¢é˜Ÿå’Œæ›´å¤šçš„æ•æ·å·¥ä½œæ–¹å¼ï¼Œå¼•å…¥èƒ½å¤Ÿè®©å¼€å‘äººå‘˜åœ¨ä»»ä½•åœ°æ–¹ä¿æŒç”Ÿäº§åŠ›çš„å·¥å…·å˜å¾—è‡³å…³é‡è¦ã€‚è¿™ä¸ºä»€ä¹ˆä¼šæœ‰ &lt;a href=&#34;https://thenewstack.io/gitpod-open-sources-a-holistic-ide/&#34; title=&#34;Gitpod&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gitpod&lt;/a&gt;ã€&lt;a href=&#34;https://thenewstack.io/this-week-in-programming-github-codespaces-portable-dev-environment/&#34; title=&#34;GitHub Codespaces&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub Codespaces&lt;/a&gt;ã€Replit ç­‰åŸºäºäº‘ç«¯ IDE å‡ºç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº‘ç«¯-ide-çš„ä¼˜ç‚¹&#34;&gt;äº‘ç«¯ IDE çš„ä¼˜ç‚¹&lt;/h2&gt;
&lt;p&gt;è¿™äº›æ–°çš„ IDE å·¥å…·å…·æœ‰å¤§é‡çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ GitHub é›†æˆï¼Œæ”¯æŒå¤šè¯­è¨€çš„ç¼–å†™å’Œç¼–è¯‘ï¼Œæä¾›äº†ä¸€ä¸ªæ•´ä½“çš„ç¯å¢ƒï¼Œä»¥æé«˜å¼€å‘äººå‘˜çš„ç”Ÿäº§åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»–ä»¬çš„å…¶ä»–ä¼˜åŠ¿ä¸­ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨äº‘ç«¯-ide-æ— éœ€æ‹…å¿ƒé…ç½®&#34;&gt;ä½¿ç”¨äº‘ç«¯ IDE æ— éœ€æ‹…å¿ƒé…ç½®&lt;/h3&gt;
&lt;p&gt;ç”±äºå¼€å‘ç¯å¢ƒå®Œå…¨åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œå› æ­¤ä¸å†éœ€è¦æ¢³ç†å®‰è£…é¡µé¢å’Œå¼„æ¸…æ¥šéœ€è¦å®‰è£…å“ªä¸ªè½¯ä»¶åŒ…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¡¬ä»¶çš„é€‰æ‹©å¹¶ä¸é‡è¦&#34;&gt;ç¡¬ä»¶çš„é€‰æ‹©å¹¶ä¸é‡è¦&lt;/h3&gt;
&lt;p&gt;åŸºäºäº‘çš„é›†æˆå¼€å‘ç¯å¢ƒæ¶ˆé™¤äº†ï¼ˆå¥½å§ï¼Œå‡ ä¹æ˜¯ï¼ï¼‰å¼€å§‹è¿›è¡Œç½‘ç»œå¼€å‘çš„éšœç¢ã€‚åœ¨ä»»ä½•æ”¯æŒç°ä»£ç½‘ç»œæµè§ˆå™¨éƒ½å¯ä»¥è¿è¡Œï¼Œä½ ç”šè‡³ä¸éœ€è¦åœ¨ä¸åŒçš„æœºå™¨ä¸Šä»å¤´å¼€å§‹é‡æ–°é…ç½®ä¸€åˆ‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ä»»ä½•åœ°æ–¹å·¥ä½œå’Œåä½œéƒ½å¾ˆå®¹æ˜“&#34;&gt;åœ¨ä»»ä½•åœ°æ–¹å·¥ä½œå’Œåä½œéƒ½å¾ˆå®¹æ˜“&lt;/h3&gt;
&lt;p&gt;è¿™äº›å·¥å…·å…·æœ‰é«˜åº¦å¯å®šåˆ¶çš„å·¥ä½œç©ºé—´ï¼Œå¯ä»¥åœ¨å›¢é˜Ÿ / ä¸ªäººå±‚é¢ä¸Šè¿›è¡Œä¼˜åŒ–ï¼Œå®ƒä»¬ä¸ä»…ä¿ƒè¿›äº†æ›´å¥½çš„åˆä½œï¼Œè€Œä¸”å®Œå…¨æ¶ˆé™¤äº†â€œåœ¨æˆ‘çš„æœºå™¨ä¸Šå¯ä»¥è¿è¡Œ &amp;quot; è¿™ç§å¤ªè¿‡æ™®éçš„æƒ…å†µã€‚é‰´äºè¿™äº›ä¸»è¦çš„ä¼˜ç‚¹ï¼Œå¾ˆæ˜æ˜¾åŸºäºäº‘çš„ IDE å·²ç»è·å¾—äº†å‘å±•åŠ¿å¤´ã€‚&lt;/p&gt;
&lt;p&gt;ä½†äº‘ç«¯ IDE ä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº‘ç«¯-ide-çš„ç¼ºç‚¹&#34;&gt;äº‘ç«¯ IDE çš„ç¼ºç‚¹&lt;/h2&gt;
&lt;p&gt;åŸºäºäº‘çš„ IDE çš„è®¸å¤šç¼ºç‚¹éƒ½ä¸æ‰©å±•é—®é¢˜æœ‰å…³ï¼Œå› ä¸ºè¿™äº›å·¥å…·ä»ç„¶å¤„äºæˆç†Ÿçš„æ—©æœŸé˜¶æ®µã€‚ä»¥ä¸‹æ˜¯æ—©æœŸé‡‡ç”¨è€…å¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›å…³é”®é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ€§èƒ½å¯èƒ½æ˜¯ä¸å¹³è¡¡çš„&#34;&gt;æ€§èƒ½å¯èƒ½æ˜¯ä¸å¹³è¡¡çš„&lt;/h3&gt;
&lt;p&gt;ç”±äºäº‘ä¸Šçš„èµ„æºæ˜¯ç”±éœ€æ±‚ä¸ç¨³å®šçš„æ¶ˆè´¹è€…å…±äº«çš„ï¼Œå› æ­¤è‚¯å®šæœ‰æœºä¼šå‡ºç°æ€§èƒ½ä¸ä¸€è‡´çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨å¯¹ç½‘ç»œå»¶è¿Ÿã€å®¹é‡æˆ–æ•´ä½“äº§å“çš„æ•…éšœé€ æˆé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œæ›´æ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ•…éšœçš„æ¥æºå¯èƒ½å¾ˆéš¾è¯†åˆ«å’Œè§£å†³&#34;&gt;æ•…éšœçš„æ¥æºå¯èƒ½å¾ˆéš¾è¯†åˆ«å’Œè§£å†³&lt;/h3&gt;
&lt;p&gt;å½“ä½ ä¸çŸ¥é“æ ¹æœ¬åŸå› æ—¶ï¼Œå¾ˆéš¾ä¿®å¤ä¸€ä¸ªé—®é¢˜ï¼Œæ€»çš„æ¥è¯´ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ­¤ç±»äº§å“çš„æ—©æœŸé‡‡ç”¨è€…æœ‰ä¸€ä¸ªä»¤äººæ²®ä¸§çš„ä½“éªŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤§é¡¹ç›®å¯èƒ½æ›´é€‚åˆä½¿ç”¨ç¦»çº¿-ide&#34;&gt;å¤§é¡¹ç›®å¯èƒ½æ›´é€‚åˆä½¿ç”¨ç¦»çº¿ IDE&lt;/h3&gt;
&lt;p&gt;åˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå·²ç»è§‚å¯Ÿåˆ°ä¸€äº›åˆæœŸé—®é¢˜ï¼Œç”¨æˆ·&lt;a href=&#34;https://github.com/gitpod-io/gitpod/issues/5992&#34; title=&#34;æŠ±æ€¨å¹³å‡è´Ÿè½½è¿‡é«˜&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ±æ€¨å¹³å‡è´Ÿè½½è¿‡é«˜&lt;/a&gt;ã€‚å¯¹äºå¤§å‹å¼€å‘é¡¹ç›®ï¼Œæ‰€éœ€çš„æ•°æ®ä¼ è¾“å’Œå¤„ç†é‡å°†æ˜¯å·¨å¤§çš„ã€‚è™½ç„¶å®ƒå¯èƒ½ä¸ä¼šæ‰¼æ€åŸºäºäº‘çš„ IDE çš„èµ„æºï¼Œä½†ç”±äºå…¶å®ç”¨æ€§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¦»çº¿æ›¿ä»£æ–¹æ¡ˆè‚¯å®šæ˜¯æ›´ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¾›åº”å•†é”å®šä¼šé™åˆ¶å·¥å…·çš„å¯ç”¨æ€§&#34;&gt;ä¾›åº”å•†é”å®šä¼šé™åˆ¶å·¥å…·çš„å¯ç”¨æ€§&lt;/h3&gt;
&lt;p&gt;å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„æ–¹é¢æ˜¯å½“æ¶‰åŠåˆ°åŸºäºäº‘ç«¯ IDE æ—¶ï¼Œå·¥å…·åŒ…çš„å¯ç”¨æ€§ã€‚å¤§é‡çš„å·¥å…·å¯ä»¥åœ¨æœ¬åœ°ä¸ IDE é…å¯¹ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå¯¹äºåŸºäºäº‘ç«¯ IDEï¼Œå¼€å‘è€…è¢«é™åˆ¶åœ¨ä¾›åº”å•†æä¾›çš„é›†æˆé€‰æ‹©ä¸Šï¼Œè¿™å¯¹äºé‚£äº›éœ€è¦æ›´å¹¿æ³›å·¥å…·åŒ…çš„äººæ¥è¯´å¯èƒ½æ˜¯é™åˆ¶æ€§çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;äº‘ç«¯-ide-éœ€è¦-wifi&#34;&gt;äº‘ç«¯ IDE éœ€è¦ WiFi&lt;/h3&gt;
&lt;p&gt;æœ€åä¸€ç‚¹å¾€å¾€è¢«å¿½ç•¥ï¼ŒåŸºäºäº‘çš„ IDE åœ¨ä¸çœŸæ­£å¼ºå¤§çš„æ¡Œé¢ IDE ç›¸åª²ç¾ä¹‹å‰è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œè¿™äº› IDE å…è®¸é™ä½å¯¹ WiFi ç­‰å¤–éƒ¨å› ç´ çš„ä¾èµ–æ€§ã€‚å³ä½¿æ­£åœ¨å®æ–½å„ç§å˜é€šåŠæ³•ï¼Œå…¶å¯é æ€§æ°´å¹³ä¹Ÿè¿œè¿œä¸èƒ½ä¸æ¡Œé¢ IDE æä¾›çš„ç¦»çº¿ä½“éªŒç›¸æ¯”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€ä»£é›†æˆå¼€å‘ç¯å¢ƒ&#34;&gt;ä¸‹ä¸€ä»£é›†æˆå¼€å‘ç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;è™½ç„¶åŸºäºæ¡Œé¢çš„é›†æˆå¼€å‘ç¯å¢ƒä»æ˜¯éå¸¸è§„èŒƒçš„ï¼Œå¹¶å°†ç»§ç»­æµè¡Œï¼Œä½†åŸºäºäº‘çš„é›†æˆå¼€å‘ç¯å¢ƒæ­£åœ¨å‘å±•åŠ¿å¤´æ­£çŒ›ã€‚è¿™äº›å·¥å…·ä¹Ÿåœ¨è¿…é€Ÿå‘å±•ï¼Œå¹¶å¯èƒ½è¶Šæ¥è¶Šå¤šåœ°ä¸åŸºäºæ¡Œé¢çš„ IDE ä¸€èµ·ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç±»æ¯”è¿™ä¸€åˆ‡å¯èƒ½çš„èµ°å‘ï¼Œè¯·è€ƒè™‘å¾®è½¯ Office çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ç¬”è®°æœ¬ç”µè„‘ / è®¡ç®—æœºåˆšé—®ä¸–æ—¶ï¼Œæˆ‘ä»¬åªæœ‰å¾®è½¯ Office ä½œä¸ºä»»ä½•å½¢å¼çš„åˆä½œçš„é»˜è®¤å¥—ä»¶ã€‚å®ƒçš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯ç¦»çº¿çš„ã€‚ä½†æ˜¯ï¼Œéšç€ Zoho Office å’Œ Google Workspace ç­‰åŸºäºæµè§ˆå™¨çš„åä½œå·¥å…·å°†å¾ˆå¤§ä¸€éƒ¨åˆ†å·¥ä½œå¸¦åˆ°äº†ç½‘ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨çœ‹åˆ°å®ƒä»¬æ¯” MS Office æ›´é‡è¦çš„ä½¿ç”¨æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;é›†æˆå¼€å‘ç¯å¢ƒä¹Ÿä¼šèµ°åŒæ ·çš„è·¯ã€‚æ¡Œé¢ IDE ä»å°†è¢«ä½¿ç”¨ï¼ˆå°±åƒç°åœ¨ä½¿ç”¨çš„å¾®è½¯ Office ä¸€æ ·ï¼‰ï¼Œä½†åŸºäºäº‘çš„ IDE å°†çœ‹åˆ°ä¸€äº›éå¸¸æœ‰è¶£çš„ç”¨ä¾‹å‡ºç°ï¼Œå¹¶å¯èƒ½å¯¹è¿™äº›ç‰¹å®šç”¨ä¾‹å˜å¾—æ›´åŠ é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼ŒJetBrains å·²ç»å‘å¸ƒäº†å…¶ä¸‹ä¸€ä»£ IDEâ€”â€”Fleet çš„æ—©æœŸé¢„è§ˆã€‚ç”±äºæ›´åŠ å…³æ³¨åˆ†å¸ƒå¼å’Œåä½œå¼å¼€å‘ä»¥åŠé™ä½å…¥é—¨é—¨æ§›ï¼ŒJetBrains çš„è§£å†³æ–¹æ¡ˆæ‰¿è¯º Fleet ä¸ä¼šå–ä»£è¯¥å…¬å¸ç°æœ‰çš„å·¥å…·ï¼Œè€Œæ˜¯æ—¨åœ¨å¢åŠ è¿›ä¸€æ­¥çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;Gitpod çš„ç¤¾åŒºç»ç† &lt;a href=&#34;https://www.linkedin.com/in/pnarvas/&#34; title=&#34;Pauline Narvas&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Pauline Narvas&lt;/a&gt; å‘Šè¯‰ The New Stackï¼Œå¥¹å¯¹æœªæ¥çš„è¿œç¨‹ã€äº‘ã€å¼€å‘ç¯å¢ƒæœ‰å¯èƒ½æ”¹å–„å¼€å‘è€…çš„æ—¥å¸¸ç”Ÿæ´»æ„Ÿåˆ°éå¸¸å…´å¥‹ã€‚&lt;/p&gt;
&lt;p&gt;å¥¹è¯´ï¼šâ€œä¾‹å¦‚ï¼Œæœ‰äº†æ ‡å‡†åŒ–çš„å¼€å‘è€…ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åŠ å…¥æ–°çš„å·¥ç¨‹å¸ˆï¼Œä½ å¯ä»¥å®¡æŸ¥åŒäº‹çš„ä»£ç ï¼Œæå‡º Pull requestï¼Œç”šè‡³ä¸ºå¼€æºåšå‡ºè´¡çŒ®ï¼Œâ€œå¥¹è¡¥å……è¯´ï¼Œâ€œä¸å†æœ‰â€™å®ƒåœ¨æˆ‘çš„æœºå™¨ä¸Šå·¥ä½œâ€™çš„ç—›è‹¦ï¼Œä¹Ÿä¸å†æœ‰å› ä¸ºä¾èµ–å…³ç³»ä¸å·¥ä½œè€Œç ´åé¢„è§ˆç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;â€œå¼€å‘äººå‘˜ç”šè‡³ä¸éœ€è¦ä¸€å°é«˜è§„æ ¼çš„æœºå™¨ä¹Ÿèƒ½å¼€å§‹å·¥ä½œï¼Œâ€œNarvas è¯´ã€‚â€œåªè¦æœ‰ä¸€ä¸ªå¯ä»¥è”ç½‘çš„æµè§ˆå™¨ä½ å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç¼–ç ï¼&amp;quot;ã€‚è¿™çœŸçš„æ˜¯è½¯ä»¶å·¥ç¨‹çš„æœªæ¥ï¼Œæˆ‘è¿«ä¸åŠå¾…åœ°æƒ³çœ‹çœ‹äº”å¹´åçš„æ™¯è±¡ã€‚â€&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>å¾®æœåŠ¡çš„æœªæ¥â€”â€”æ›´å¤šå±‚æŠ½è±¡</title>
      <link>https://jimmysong.io/trans/the-future-of-microservices/</link>
      <pubDate>Fri, 13 Aug 2021 17:05:42 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/the-future-of-microservices/</guid>
      <description>
        
        
        &lt;p&gt;&lt;a href=&#34;https://thenewstack.io/category/microservices/&#34; title=&#34;å¾®æœåŠ¡&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡&lt;/a&gt;æ˜¯åœ¨ 10 å¹´å‰å‡ºç°çš„ï¼Œæ˜¯è½¯ä»¶èåˆè¿›åŒ–çš„ä¾‹å­ä¹‹ä¸€ã€‚è™½ç„¶è¿™ä¸ªè¯å¯ä»¥å½’åŠŸäºè½¯ä»¶å’¨è¯¢å…¬å¸ &lt;a href=&#34;https://www.thoughtworks.com/&#34; title=&#34;ThoughtWorks&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ThoughtWorks&lt;/a&gt; çš„ &lt;a href=&#34;https://twitter.com/boicy&#34; title=&#34;James Lewis&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;James Lewis&lt;/a&gt; å’Œ Martin Fowlerï¼Œ&lt;a href=&#34;https://www.linkedin.com/in/adriancockcroft/&#34; title=&#34;Adrian Cockcroft&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Adrian Cockcroft&lt;/a&gt; ä¹Ÿæ›¾æå‡ºç±»ä¼¼çš„æƒ³æ³•ã€‚ä½†å½“æ—¶åœ¨ Netflix å’Œè®¸å¤šç¡…è°·çš„å…¶ä»–å…¬å¸ï¼Œå¦‚äºšé©¬é€Šã€Google å’Œ eBay ç­‰å…¬å¸å¤§è‡´åœ¨ç›¸åŒçš„æ—¶é—´å†…ç‹¬ç«‹æ­å»ºäº†æˆ–å¤šæˆ–å°‘ç›¸åŒçš„æ¶æ„æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªè¯è¯ç”Ÿåçš„åå¹´é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº† Kubernetesã€æœåŠ¡ç½‘æ ¼å’Œæ— æœåŠ¡å™¨çš„å…´èµ·ï¼Œæˆ‘ä»¬ä¹Ÿå¼€å§‹çœ‹åˆ°å¾®æœåŠ¡è¢«åº”ç”¨åˆ°äº†å‰ç«¯ã€‚é™¤äº†å¯ä»¥æ¨ªå‘æ‰©å±•ï¼Œå¾®æœåŠ¡è¿˜å¯ä»¥è®©å¼€å‘äººå‘˜æ›´å¿«åœ°éƒ¨ç½²ä»£ç ï¼Œæœ‰åˆ©äºç»„ä»¶çš„å¯æ›¿æ¢æ€§è€Œä¸æ˜¯å¯ç»´æŠ¤æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ— è®ºå¥½åï¼Œå¯¹è®¸å¤šäººæ¥è¯´ï¼Œå¾®æœåŠ¡å·²ç»æˆä¸ºé»˜è®¤çš„æ¶æ„é€‰æ‹©ã€‚å¯¹äºæ‹¥æœ‰è‡ªä¸»å›¢é˜Ÿå’Œæ¾æ•£è€¦åˆç³»ç»Ÿçš„ç»„ç»‡æ¥è¯´ï¼Œå¾®æœåŠ¡å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œï¼Œä½†å®ƒä»¬å¸¦æ¥äº†æ‰€æœ‰åˆ†å¸ƒå¼ç³»ç»Ÿéƒ½æ— æ³•é€ƒé¿çš„å¤æ‚æ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘åšå†³è®¤ä¸ºå…¬å…±äº‘æ¯”ç§æœ‰äº‘å’Œæ•°æ®ä¸­å¿ƒæ›´å¥½ï¼Œè¿™äº›å¥½å¤„æ˜¯ä¸€ç›®äº†ç„¶çš„ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ˜¯ææƒ§è®©äººä»¬ç•ç¼©ä¸å‰ã€‚â€œç‹¬ç«‹æŠ€æœ¯é¡¾é—® &lt;a href=&#34;https://www.linkedin.com/in/samnewman/&#34; title=&#34;Sam Newman&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sam Newman&lt;/a&gt; å‘Šè¯‰ The New Stackï¼Œä»–çš„ &lt;a href=&#34;https://samnewman.io/books/building_microservices_2nd_edition/&#34; title=&#34;Building Microservices&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Building Microservices&lt;/a&gt; ä¸€ä¹¦çš„ç¬¬äºŒç‰ˆå°†åœ¨ä»Šå¹´ 8 æœˆå‡ºç‰ˆã€‚â€œä½†æ˜¯å¯¹äºå¾®æœåŠ¡ï¼Œäº‹æƒ…å°†æ¯”è¿™å¤æ‚å¾—å¤šçš„å¤šã€‚â€&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œåœ¨è¿›å…¥å¾®æœåŠ¡æ—¶ä»£çš„åå¹´é‡Œï¼Œæ€è€ƒä¸€ä¸‹æˆ‘ä»¬å·²ç»èµ°åˆ°äº†å“ªä¸€æ­¥ï¼Œä»¥åŠæˆ‘ä»¬è¿˜éœ€è¦è§£å†³å“ªäº›é—®é¢˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›˜ç‚¹éƒ¨ç½²å’Œè¿è¡Œæ—¶é—´&#34;&gt;ç›˜ç‚¹ï¼šéƒ¨ç½²å’Œè¿è¡Œæ—¶é—´&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æœ‰å„ç§å„æ ·æˆç†Ÿçš„ã€è®¾è®¡è‰¯å¥½çš„å¾®æœåŠ¡æ¡†æ¶ï¼Œæ¶µç›–äº†å¤§å¤šæ•°è¯­è¨€çš„åŸºç¡€çŸ¥è¯†ï¼Œåœ¨ JVM ä¸Šæœ‰å¤§é‡çš„é€‰æ‹©ï¼ŒåŒ…æ‹¬ &lt;a href=&#34;https://spring.io/projects/spring-boot&#34; title=&#34;Spring Boot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Spring Boot&lt;/a&gt;ã€&lt;a href=&#34;https://www.dropwizard.io/en/latest/&#34; title=&#34;Dropwizard&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dropwizard&lt;/a&gt;ã€&lt;a href=&#34;https://helidon.io/#/&#34; title=&#34;Helidon&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helidon&lt;/a&gt;ã€&lt;a href=&#34;https://www.lagomframework.com/&#34; title=&#34;Lagom&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Lagom&lt;/a&gt;ã€&lt;a href=&#34;https://micronaut.io/&#34; title=&#34;Micronaut&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Micronaut&lt;/a&gt; å’Œ &lt;a href=&#34;https://quarkus.io/&#34; title=&#34;Quarkus&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Quarkus&lt;/a&gt;ï¼ŒåŒæ—¶è¿˜æœ‰ &lt;a href=&#34;https://github.com/go-kit/kit&#34; title=&#34;Go kit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Go kit&lt;/a&gt;ï¼ˆGoï¼‰ã€&lt;a href=&#34;https://flask.palletsprojects.com/en/2.0.x/&#34; title=&#34;Flask&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Flask&lt;/a&gt; å’Œ &lt;a href=&#34;https://falconframework.org/&#34; title=&#34;Falcon&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Falcon&lt;/a&gt;ï¼ˆPythonï¼‰ã€&lt;a href=&#34;https://nodejs.org/en/&#34; title=&#34;Node.js&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Node.js&lt;/a&gt;ï¼ˆJavaScriptï¼‰ç­‰é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·åœ°ï¼Œå¥½çš„ç›‘æ§å·¥å…·ä¹Ÿæ¯”æ¯”çš†æ˜¯ã€‚&lt;a href=&#34;https://thenewstack.io/getting-started-with-opentelemetry-for-java/&#34; title=&#34;OpenTelemetry&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry&lt;/a&gt; çš„å‡ºç°å°¤å…¶é‡è¦ã€‚å®ƒç”± OpenTracing å’Œ OpenCensus åˆå¹¶è€Œæˆï¼Œæ‹¥æœ‰å¹¿æ³›çš„ä¾›åº”å•†å’Œè¯­è¨€æ”¯æŒï¼Œä¸ºåˆ†å¸ƒå¼é¥æµ‹æ•°æ®æä¾›æ ‡å‡†åŒ–ã€‚è¿™æ„å‘³ç€å¼€å‘äººå‘˜åªéœ€è¦å¯¹ä»–ä»¬çš„ä»£ç è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œç„¶åå°±å¯ä»¥äº¤æ¢å’Œæ”¹å˜ç›‘æ§å·¥å…·ï¼Œæ¯”è¾ƒç›¸äº’ç«äº‰çš„è§£å†³æ–¹æ¡ˆï¼Œç”šè‡³åœ¨ç”Ÿäº§ä¸­ä¸ºä¸åŒçš„éœ€æ±‚è¿è¡Œå¤šä¸ªä¸åŒçš„ç›‘æ§è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå½“æˆ‘ä»¬çœ‹å‘éƒ¨ç½²å’Œè¿è¡Œæ—¶ï¼Œæƒ…å†µå°±å˜å¾—æœ‰ç‚¹æ¨¡ç³Šäº†ã€‚Kubernetes å·²ç»æˆ–å¤šæˆ–å°‘åœ°æˆä¸ºå¾®æœåŠ¡çš„ä»£åè¯ï¼Œå®ƒçš„å¤æ‚æ€§ä¸æ–­å¢åŠ ï¼Œä¿ƒä½¿äº‘åŸç”Ÿå’¨è¯¢å…¬å¸ &lt;a href=&#34;https://www.container-solutions.com/&#34; title=&#34;Container Solutions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Container Solutions&lt;/a&gt; çš„é¦–å¸­ç§‘å­¦å®¶ &lt;a href=&#34;https://twitter.com/adrianmouat&#34; title=&#34;Adrian Mouat&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Adrian Mouat&lt;/a&gt; &lt;a href=&#34;https://blog.container-solutions.com/10-predictions-for-the-future-of-computing&#34; title=&#34;çŒœæµ‹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çŒœæµ‹&lt;/a&gt;æˆ‘ä»¬å°†çœ‹åˆ°å®ƒçš„ç«äº‰å¯¹æ‰‹å‡ºç°ã€‚&lt;/p&gt;
&lt;p&gt;â€œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§å¤æ‚æ€§ä¸ä»…ä»…æ˜¯éšè—åœ¨å¼•æ“ç›–ä¸‹ã€‚â€œMouat è¯´ï¼šâ€œå®ƒæ­£åœ¨æº¢å‡ºåˆ°ç•Œé¢ä¸Šï¼Œå½±å“åˆ°ç”¨æˆ·ã€‚â€œé»‘è¿› kubectl è¿è¡Œå¹¶å¾—åˆ°ä¸€ä¸ªæ¼”ç¤ºå¹¶è¿è¡Œä»ç„¶ç›¸å½“å®¹æ˜“ã€‚ä½†æ˜¯ï¼Œè¿è¡Œç”Ÿäº§åº”ç”¨ç¨‹åºå¹¶å¼„æ¸…æ¥šå¦‚ä½•å®‰å…¨åœ°æš´éœ²å®ƒä»¬éœ€è¦äº†è§£å¤§é‡ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™ä¸å¯é¿å…åœ°å¯¼è‡´ YAML æ–‡ä»¶æ¯”å¤§å¤šæ•°å¾®æœåŠ¡æºä»£ç è¿˜è¦é•¿ã€‚â€&lt;/p&gt;
&lt;p&gt;Newman æ€»ç»“äº†ä¸€ä¸ªåŸºæœ¬æŒ‘æˆ˜ï¼šâ€œKubernetes å¯¹å¼€å‘è€…å¹¶ä¸å‹å¥½ã€‚æˆ‘ä»¬ä»ç„¶æ²¡æœ‰ä¸€ä¸ªå¥½çš„ã€å¯é çš„ã€ç±»ä¼¼ &lt;a href=&#34;https://www.heroku.com/&#34; title=&#34;Heroku&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Heroku&lt;/a&gt; çš„æŠ½è±¡ï¼Œåœ¨ Kubernetes ä¹‹ä¸Šè¢«å¹¿æ³›ä½¿ç”¨ï¼Œè¿™è®©æˆ‘æ„Ÿåˆ°éœ‡æƒŠã€‚â€&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.spotify.com/&#34; title=&#34;Spotify&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Spotify&lt;/a&gt; çš„å·¥ç¨‹æ€»ç›‘ &lt;a href=&#34;https://www.linkedin.com/in/pia-nilsson-02b47b1/&#34; title=&#34;Pia Nilsson&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Pia Nilsson&lt;/a&gt; æ›¾ &lt;a href=&#34;https://engineering.atspotify.com/2021/05/18/a-product-story-the-lessons-of-backstage-and-spotifys-autonomous-culture/&#34; title=&#34;è°ˆåˆ°&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è°ˆåˆ°&lt;/a&gt;ï¼Œè¿™å®¶å¿«é€Ÿæ‰©å¼ çš„å…¬å¸çš„æ–°å·¥ç¨‹å¸ˆå¹³å‡éœ€è¦ 60 å¤©æ‰èƒ½åˆå¹¶ä»–ä»¬çš„ç¬¬ 10 ä¸ª pull requestã€‚ä½œä¸ºå›åº”ï¼Œè¯¥å…¬å¸å»ºç«‹äº†ä¸€ä¸ª&lt;a href=&#34;https://thenewstack.io/design-a-better-kubernetes-experience-for-developers/&#34; title=&#34;å¼€å‘è€…é—¨æˆ·ç½‘ç«™&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å‘è€…é—¨æˆ·ç½‘ç«™&lt;/a&gt; &lt;a href=&#34;https://engineering.atspotify.com/2020/09/24/cloud-native-computing-foundation-accepts-backstage-as-a-sandbox-project/&#34; title=&#34;Backstage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Backstage&lt;/a&gt;ï¼Œç°åœ¨æ˜¯ &lt;a href=&#34;https://cncf.io/?utm_content=inline-mention&#34; title=&#34;äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š&lt;/a&gt;çš„ä¸€ä¸ª&lt;a href=&#34;https://backstage.io/&#34; title=&#34;æ²™ç›’é¡¹ç›®&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ²™ç›’é¡¹ç›®&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://about.netflix.com/&#34; title=&#34;Netflix&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Netflix&lt;/a&gt; éå¸¸é‡è§† DevExâ€”â€” è¯¥å…¬å¸ä¸ºå¼€å‘è€…é“ºè®¾çš„â€œé“è·¯â€â€”â€” åˆ©ç”¨å®ƒæ¥å¸®åŠ© &lt;a href=&#34;https://www.infoq.com/presentations/devex-netflix-graphql/&#34; title=&#34;åŠ é€Ÿ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ é€Ÿ&lt;/a&gt; &lt;a href=&#34;https://graphql.org/&#34; title=&#34;GraphQL&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GraphQL&lt;/a&gt; ç­‰æ–°æŠ€æœ¯çš„ &lt;a href=&#34;https://www.infoq.com/presentations/devex-netflix-graphql/&#34; title=&#34;é‡‡ç”¨&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‡‡ç”¨&lt;/a&gt;ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å†…éƒ¨å»ºè®¾å’Œé€šè¿‡ &lt;a href=&#34;https://humanitec.com/&#34; title=&#34;Humanitec&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Humanitec&lt;/a&gt; ç­‰ä¾›åº”å•†å»ºè®¾çš„ &lt;a href=&#34;https://info.container-solutions.com/the-rise-of-the-internal-developer-platform&#34; title=&#34;å¼€å‘è€…å¹³å°&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å‘è€…å¹³å°&lt;/a&gt;çš„å´›èµ·ã€‚ &lt;a href=&#34;https://www.getambassador.io/&#34; title=&#34;Ambassador Labs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambassador Labs&lt;/a&gt; æœ‰ä¸€ä¸ªç›¸å…³çš„ &lt;a href=&#34;https://www.getambassador.io/developer-control-plane/&#34; title=&#34;å¼€å‘è€…æ§åˆ¶å¹³é¢&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å‘è€…æ§åˆ¶å¹³é¢&lt;/a&gt;çš„æ¦‚å¿µ â€”â€” å®ƒçš„ç½‘ç«™å£°ç§°ï¼Œâ€œä½¿å¼€å‘è€…èƒ½å¤Ÿæ§åˆ¶å’Œé…ç½®æ•´ä¸ªäº‘å¼€å‘å¾ªç¯ï¼Œä»¥ä¾¿æ›´å¿«åœ°å‘å¸ƒè½¯ä»¶â€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œKubernetes å¯¹å¼€å‘è€…å¹¶ä¸å‹å¥½ã€‚æˆ‘ä»¬ä»ç„¶æ²¡æœ‰ä¸€ä¸ªå¥½çš„ã€å¯é çš„ã€ç±»ä¼¼ &lt;a href=&#34;https://www.heroku.com/&#34; title=&#34;Heroku&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Heroku&lt;/a&gt; çš„æŠ½è±¡ï¼Œåœ¨ Kubernetes ä¹‹ä¸Šè¢«å¹¿æ³›ä½¿ç”¨ï¼Œè¿™è®©æˆ‘æ„Ÿåˆ°éœ‡æƒŠã€‚â€ â€”â€”Sam Newmanï¼ŒBuilding Microservices ä½œè€…&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ambassador Labs çš„å¼€å‘è€…å…³ç³»æ€»ç›‘ &lt;a href=&#34;https://www.linkedin.com/in/danielbryantuk&#34; title=&#34;Daniel Bryant&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Daniel Bryant&lt;/a&gt; å‘Šè¯‰ The New Stackï¼šâ€œå¦‚æœä½ çœ‹çœ‹ &lt;a href=&#34;https://www.airbnb.com/&#34; title=&#34;Airbnb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Airbnb&lt;/a&gt;ã€&lt;a href=&#34;https://www.shopify.com/&#34; title=&#34;Shopify&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Shopify&lt;/a&gt; å’Œ &lt;a href=&#34;https://tech.lunar.app/&#34; title=&#34;Lunar&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Lunar&lt;/a&gt; ç­‰å…¬å¸æ­£åœ¨åšä»€ä¹ˆï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä¸€ä¸ªæ˜æ˜¾çš„å…±åŒç‚¹ã€‚ä»–ä»¬æ­£åœ¨ä¸ºä»–ä»¬çš„å¼€å‘è€…åˆ›å»ºä¸€ä¸ªç±»ä¼¼äº Heroku çš„ CLIï¼Œè¿™æ ·ï¼Œåƒâ€™åˆ›å»ºæ–°çš„å¾®æœåŠ¡â€™è¿™æ ·çš„å‘½ä»¤å°±ä¼šäº§ç”Ÿä¸€äº›æ”¯æ¶ï¼Œæ’å…¥ CIï¼Œæ’å…¥ç®¡é“ï¼Œæ’å…¥å¯è§‚æµ‹æ€§ã€‚é—®é¢˜æ˜¯ï¼Œä½ å‘å¼€å‘è€…å±•ç¤ºçš„æŠ½è±¡æ˜¯ä»€ä¹ˆï¼Œä»¥ä¾¿ä»–ä»¬è·å¾—æ‰€éœ€çš„å¯è§æ€§ï¼ŒåŒæ—¶ä¹Ÿä½¿ä»–ä»¬æ‰€éœ€çš„è¦æ±‚å˜å¾—æ¸…æ™°ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;Bryant ç‰¹ç»§ç»­è¯´ï¼šâ€œå¼€å‘è€…éœ€è¦æŒ‡å®šæŸäº›æ“ä½œç‰¹æ€§ï¼šè¿™æ˜¯ä¸€ä¸ªå†…å­˜å¤§çš„æœåŠ¡ï¼›è¿™ä¸ªæœåŠ¡éœ€è¦ä½å»¶è¿Ÿï¼›è¿™ä¸ªæœåŠ¡éœ€è¦éå¸¸æ¥è¿‘é‚£ä¸ªæœåŠ¡ã€‚ç›®å‰ï¼Œä½ é€šè¿‡å¯åŠ¨ Kubernetes å’Œç¼–å†™å¤§é‡çš„ YAML æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚é‚£é‡Œçš„æŠ½è±¡å¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œç‰¹åˆ«æ˜¯å½“ä½ å¼•å…¥å…¶ä»–éƒ¨ç½²æœºåˆ¶æ—¶ï¼Œå¦‚&lt;a href=&#34;https://thenewstack.io/category/serverless/&#34; title=&#34;æ— æœåŠ¡å™¨&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ— æœåŠ¡å™¨&lt;/a&gt;å’Œ&lt;a href=&#34;https://thenewstack.io/how-low-code-can-help-enterprise-software-development/&#34; title=&#34;ä½ä»£ç  / æ— ä»£ç &#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½ä»£ç  / æ— ä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘æƒ³çŸ¥é“è°èƒ½é€šè¿‡å¹³å°æš´éœ²å‡ºæ­£ç¡®çš„æŠ½è±¡æ¦‚å¿µï¼Œç„¶åè®©å·¥ç¨‹å¸ˆå†³å®šå¦‚ä½•æ‰“åŒ…ä»–ä»¬çš„ä»£ç  â€”â€” ä½†ä»–ä»¬æ‰“åŒ…çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œè€Œå¹³å°æš´éœ²å‡ºä¸€äº›ä¼ ç»Ÿä¸Šå±äºè¿ç»´çš„å±æ€§ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;å¼€æ”¾åº”ç”¨æ¨¡å‹oam&#34;&gt;å¼€æ”¾åº”ç”¨æ¨¡å‹ï¼ˆOAMï¼‰&lt;/h2&gt;
&lt;p&gt;å…¶ä»–å‡ ä¸ªå…³äº Kubernetes çš„å€¡è®®ä¹Ÿå€¼å¾—è·Ÿè¸ªã€‚ç”±&lt;a href=&#34;https://thenewstack.io/open-application-model-build-the-next-generation-of-cloud-native-applications/&#34; title=&#34;å¾®è½¯å’Œé˜¿é‡Œäº‘&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®è½¯å’Œé˜¿é‡Œäº‘&lt;/a&gt;è”åˆåˆ›å»ºçš„&lt;a href=&#34;https://oam.dev/&#34; title=&#34;å¼€æ”¾åº”ç”¨æ¨¡å‹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€æ”¾åº”ç”¨æ¨¡å‹&lt;/a&gt;ï¼ˆOAMï¼‰æ˜¯ä¸€ä¸ªæè¿°åº”ç”¨çš„è§„èŒƒï¼Œå°†åº”ç”¨å®šä¹‰ä¸é›†ç¾¤çš„æ“ä½œç»†èŠ‚åˆ†å¼€ã€‚å› æ­¤ï¼Œå®ƒä½¿åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜èƒ½å¤Ÿä¸“æ³¨äºå…¶åº”ç”¨ç¨‹åºçš„å…³é”®è¦ç´ ï¼Œè€Œä¸æ˜¯å…¶éƒ¨ç½²åœ°ç‚¹çš„æ“ä½œç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://crossplane.io/&#34; title=&#34;Crossplane&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Crossplane&lt;/a&gt; æ˜¯ &lt;a href=&#34;https://thenewstack.io/oam-the-kubernetes-application-model-bridging-development-and-deployment/&#34; title=&#34;OAM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OAM&lt;/a&gt; çš„ Kubernetes ç‰¹å®šå®ç°ã€‚å®ƒå¯ä»¥è¢«ä¼ä¸šç”¨æ¥åœ¨å„ç§åŸºç¡€è®¾æ–½å’Œäº‘ä¾›åº”å•†ä¹‹é—´å»ºç«‹å’Œè¿ç»´ä¸€ä¸ªå†…éƒ¨å¹³å°å³æœåŠ¡ï¼ˆPaaSï¼‰ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤šäº‘ç¯å¢ƒä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨é‚£äº›å…¼å¹¶å’Œæ”¶è´­è¶Šæ¥è¶Šå¸¸è§çš„å¤§å‹ä¼ä¸šä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ OAM è¯•å›¾å°†éƒ¨ç½²ç»†èŠ‚çš„è´£ä»»ä»ç¼–å†™æœåŠ¡ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½†æœåŠ¡ç½‘æ ¼æ—¨åœ¨é€šè¿‡ä¸€ä¸ªä¸“é—¨çš„åŸºç¡€è®¾æ–½å±‚å°†æœåŠ¡é—´é€šä¿¡çš„è´£ä»»ä»ä¸ªäººå¼€å‘è€…é‚£é‡Œè½¬ç§»å‡ºæ¥ï¼Œè¯¥å±‚ä¾§é‡äºä½¿ç”¨ä»£ç†ç®¡ç†æœåŠ¡é—´çš„é€šä¿¡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒä»¬ä¹Ÿæœ‰å¤æ‚æ€§çš„é—®é¢˜ï¼Œè€Œä¸”è¿˜å¯èƒ½å¼•å…¥ç›¸å½“å¤§çš„æ€§èƒ½å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œè®¸å¤šåœ¨ç”Ÿäº§ä¸­æˆåŠŸå®æ–½æœåŠ¡ç½‘æ ¼çš„æ¡ˆä¾‹éƒ½æ˜¯åœ¨é‚£äº›éå¸¸ç²¾é€šæŠ€æœ¯çš„åˆåˆ›å…¬å¸ã€‚åœ¨ &lt;a href=&#34;https://www.infoq.com/podcasts/monolith-microservices/?&#34; title=&#34;2020 å¹´ä¸ InfoQ çš„ Wes Reisz çš„æ’­å®¢ä¸­&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2020 å¹´ä¸ InfoQ çš„ Wes Reisz çš„æ’­å®¢ä¸­&lt;/a&gt;ï¼ŒNewman å»ºè®®åœ¨é€‰æ‹©ä¹‹å‰ç­‰å¾… 6 ä¸ªæœˆï¼Œä»–å‘Šè¯‰ The New Stackï¼Œä»–ä»ç„¶ç»™å‡ºåŒæ ·çš„å»ºè®®ã€‚&lt;/p&gt;
&lt;p&gt;â€œå°±è¯¥æŠ€æœ¯æ ˆçš„æƒé‡ã€ç®¡ç†ã€å½±å“ä»¥åŠæ€§èƒ½å¸¦æ¥çš„å½±å“è€Œè¨€ï¼Œå®ƒä»¬çš„ç°å®æƒ…å†µæ˜¯éå¸¸å¯æ€•çš„ï¼Œâ€œNewman è¯´ã€‚â€œå¯¹æœ‰ä¸€äº›ç»„ç»‡è¯´ï¼Œå¦‚æœæ²¡æœ‰å®ƒä»¬ï¼Œæœ‰äº›äº‹æƒ…æ˜¯ä¸å¯èƒ½å®Œæˆçš„ï¼Œ&lt;a href=&#34;https://monzo.com/blog/2019/04/03/deploying-envoy-proxy&#34; title=&#34;Monzo å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Monzo å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­&lt;/a&gt; â€”â€” åœ¨ä¸€ä¸ªç»„ç»‡ä¸­ï¼Œä½ æœ‰ä¸€ä¸ªå¼‚æ„çš„æŠ€æœ¯æ ˆï¼Œä½ éœ€è¦åšå¤§è§„æ¨¡çš„åŒå‘ TLSï¼Œæˆ‘å¯ä»¥çœ‹åˆ°å®ƒçš„ä»·å€¼ã€‚ä½†åœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒä»ç„¶æ˜¯â€œæ¦‚å¿µå¾ˆå¥½ï¼Œæ‰§è¡Œä¸åŠ›â€ã€‚æˆ‘æƒ³ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨å¾ˆé•¿æ—¶é—´å†…ä»è¿™æ ·è¯´ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;éšè—æœåŠ¡ç½‘æ ¼&#34;&gt;éšè—æœåŠ¡ç½‘æ ¼&lt;/h2&gt;
&lt;p&gt;æœ‰ä¸€ä»¶äº‹å¯èƒ½ä¼šå‘ç”Ÿï¼Œè‡³å°‘å¯¹ä¼ä¸šå®¢æˆ·æ¥è¯´ï¼Œæ€§èƒ½é—®é¢˜å¾€å¾€ä¸æ˜¯é‚£ä¹ˆå°–é”ï¼Œé‚£å°±æ˜¯æœåŠ¡ç½‘æ ¼è¢«æ¨åˆ°å¹³å°çš„æ›´æ·±å¤„ï¼Œå¹¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯¹å¼€å‘è€…éšè—ã€‚ä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://www.openshift.com/try?utm_content=inline-mention&#34; title=&#34;çº¢å¸½ OpenShift&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çº¢å¸½ OpenShift&lt;/a&gt; &lt;a href=&#34;https://www.openshift.com/blog/istio-on-openshift-in-2020&#34; title=&#34;å°† Istio æ•´åˆåˆ°å¹³å°å±‚&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† Istio æ•´åˆåˆ°å¹³å°å±‚&lt;/a&gt;ï¼Œè¿˜æœ‰å¤šä¸ªç±»ä¼¼çš„è®¡åˆ’ï¼Œå°†æœåŠ¡ç½‘æ ¼ä¸å…¬æœ‰äº‘å¹³å°æ›´ç´§å¯†åœ°æ•´åˆåœ¨ä¸€èµ·ï¼Œå¦‚ &lt;a href=&#34;https://aws.amazon.com/app-mesh/?aws-app-mesh-blogs.sort-by=item.additionalFields.createdDate&amp;amp;aws-app-mesh-blogs.sort-order=desc&amp;amp;whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;amp;whats-new-cards.sort-order=desc&#34; title=&#34;AWS App Mesh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS App Mesh&lt;/a&gt; å’Œ &lt;a href=&#34;https://cloud.google.com/traffic-director&#34; title=&#34;Google Cloud Platform Traffic Director&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google Cloud Platform Traffic Director&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºæœåŠ¡ç½‘æ ¼çš„å·¥ä½œè¿˜åœ¨ç»§ç»­ï¼Œä»¥å‡å°‘å…¶æ‰€å¸¦æ¥çš„ç½‘ç»œå¼€é”€ã€‚&lt;a href=&#34;https://cilium.io/&#34; title=&#34;Cilium&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium&lt;/a&gt; å›¢é˜Ÿçš„å·¥ä½œå¾ˆæœ‰å¸Œæœ›ï¼Œå®ƒåˆ©ç”¨ Linux å†…æ ¸ä¸­çš„ &lt;a href=&#34;https://ebpf.io/&#34; title=&#34;eBPF&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt; åŠŸèƒ½æ¥å®ç°å®ƒæ‰€è¯´çš„â€œéå¸¸æœ‰æ•ˆçš„ç½‘ç»œã€ç­–ç•¥æ‰§è¡Œå’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½â€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘è®¤ä¸ºç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºå…¶ä»–äººæä¾›é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰ã€‚å› ä¸ºå³ä½¿æ˜¯æ™®é€šçš„å¼€å‘è€…è€Œä¸æ˜¯æ¶æ„å¸ˆï¼Œä¹Ÿéœ€è¦å¯¹å¦‚ä½•ç¡®å®šå®ä½“çš„èŒƒå›´å’Œè¾¹ç•Œæœ‰ä¸€å®šçš„äº†è§£ï¼Œè¿™å…¶ä¸­æœ‰å¾ˆå¤šæ˜¯å›åˆ°äº†è‰¯å¥½çš„ API è®¾è®¡ä¸Šã€‚â€”â€”Daniel Bryantï¼Œå¼€å‘è€…å…³ç³»æ€»ç›‘ï¼ŒAmbassador Labs&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä½†å¦ä¸€ç§å¯èƒ½æ€§æ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½å®Œå…¨è½¬å‘ä¸åŒçš„è¿è¡Œæ—¶ã€‚&lt;a href=&#34;https://leadingedgeforum.com/&#34; title=&#34;Leading Edge Forum&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Leading Edge Forum&lt;/a&gt; çš„é¡¾é—® &lt;a href=&#34;https://www.linkedin.com/in/simonwardley/&#34; title=&#34;Simon Wardley&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Simon Wardley&lt;/a&gt; &lt;a href=&#34;https://acloudguru.com/blog/engineering/simon-wardley-is-a-big-fan-of-containers-despite-what-you-might-think&#34; title=&#34;è®¤ä¸º&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®¤ä¸º&lt;/a&gt;ï¼Œå‡½æ•°å³æœåŠ¡ï¼ˆFaasï¼‰/ æ— æœåŠ¡å™¨å°†æœ€ç»ˆå–ä»£ Kubernetesï¼Œæˆä¸ºåˆ†å¸ƒå¼åº”ç”¨äº‹å®ä¸Šçš„æ ‡å‡†è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ä¸€äº›çœŸå®çš„ç”Ÿäº§å®ä¾‹ï¼Œæ¯”å¦‚ &lt;a href=&#34;https://www.bbc.com/&#34; title=&#34;BBC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BBC&lt;/a&gt;ï¼Œå®ƒçš„å¤§éƒ¨åˆ†åœ¨çº¿æ¶æ„å·²ç»ä»ä¹‹å‰çš„ LAMP å †æ ˆ &lt;a href=&#34;https://www.infoq.com/podcasts/bbc-aws-lambda-react-cicd/&#34; title=&#34;ç›´æ¥è½¬å‘äº† AWS ä¸Šçš„ Lambda&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç›´æ¥è½¬å‘äº† AWS ä¸Šçš„ Lambda&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘è®¤ä¸º FaaS æ˜¯ä¸€ä¸ªç®¡ç†éƒ¨ç½²çš„ä¼Ÿå¤§æŠ½è±¡ï¼Œâ€œNewman è¯´ã€‚â€œä½œä¸ºä¸€ä¸ªå¯¹å¼€å‘è€…å‹å¥½çš„éƒ¨ç½²è½¯ä»¶çš„æŠ½è±¡ï¼Œå®ƒæ˜¯è‡ª Heroku ä»¥æ¥æˆ‘ä»¬æ‹¥æœ‰çš„æœ€å¥½çš„ä¸œè¥¿ã€‚æˆ‘ç¡®å®è®¤ä¸ºç›®å‰çš„å®ç°æ–¹å¼å¾ˆå·®ï¼Œä½†ä»–ä»¬ä¼šæ”¹è¿›ã€‚ä½†ä»–ä»¬åªå¤„ç†äº†åœ¨ä¸€æ¬¡åœ¨ä¸€ä¸ªåœ°æ–¹æ‰§è¡Œä¸€ä»¶ä»»åŠ¡ã€‚è¿™å¹¶æ²¡æœ‰è§£å†³æ›´å¤§çš„ç½‘ç»œç³»ç»Ÿçš„æŠ½è±¡é—®é¢˜â€ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼ŒNewman å¼•ç”¨äº†&lt;a href=&#34;https://azure.microsoft.com/&#34; title=&#34;å¾®è½¯ Azure&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®è½¯ Azure&lt;/a&gt; çš„ &lt;a href=&#34;https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#34; title=&#34;Durable Functions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Durable Functions&lt;/a&gt;ï¼Œå®ƒé€šè¿‡å“åº”å¼æ‰©å±•æä¾›äº†ç±»ä¼¼äºè¿ç»­æ€§çš„ä¸œè¥¿ï¼Œå…è®¸å¼€å‘è€…åœ¨æ— æœåŠ¡å™¨ç¯å¢ƒä¸­å»ºç«‹æœ‰çŠ¶æ€çš„å·¥ä½œæµå’Œå‡½æ•°ã€‚ä½†æ˜¯ï¼Œè™½ç„¶éƒ¨ç½²æŠ½è±¡å¯èƒ½ä¼šæœ‰æ‰€æ”¹å–„ï¼Œä½†å¦‚æœæƒ³è±¡ä½ å¯ä»¥å®Œå…¨æŠ½è±¡å‡ºç¼–å†™åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œé‚£å°±å¤ªå¤©çœŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;â€œä½ ä¸èƒ½å‡è®¾ä½ è¯´çš„ä¸œè¥¿å°±åœ¨é‚£é‡Œï¼Œâ€œNewman è¯´ã€‚â€œä½ ä¸èƒ½å‡è®¾æ•°æ®ä¼šç¥å¥‡åœ°ä»ä¸€ä¸ªæ—¶é—´ç‚¹ç¬æ—¶ä¼ é€åˆ°å¦ä¸€ä¸ªæ—¶é—´ç‚¹ã€‚å› ä¸ºå®ƒä¸æ˜¯è¿™æ ·çš„ã€‚è€Œä¸”ï¼Œå†å¤šçš„æŠ½è±¡ä¹Ÿæ— æ³•è§£å†³è¿™ä¸ªåŸºæœ¬é—®é¢˜ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;è‡ªä¸»å›¢é˜Ÿçš„æ¶æ„&#34;&gt;è‡ªä¸»å›¢é˜Ÿçš„æ¶æ„&lt;/h2&gt;
&lt;p&gt;å¦ä¸€ä¸ªä»ç„¶å…·æœ‰æŒ‘æˆ˜æ€§çš„é¢†åŸŸä¸æ•´ä¸ªç³»ç»Ÿæ¶æ„æœ‰å…³ï¼Œä»¥åŠå›´ç»•å›¢é˜Ÿç»„ç»‡å’Œç»“æ„çš„ç›¸å…³é—®é¢˜ã€‚æ­£å¦‚ &lt;a href=&#34;https://www.ibm.com/cloud?utm_content=logo-sponsorpage&amp;amp;utm_source=thenewstack&amp;amp;utm_medium=website&amp;amp;utm_campaign=platform&#34; title=&#34;IBM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IBM&lt;/a&gt; çš„å…¨çƒå¼€å‘è€… leader &lt;a href=&#34;https://www.linkedin.com/in/holly-k-cummins&#34; title=&#34;Holly Cummins&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Holly Cummins&lt;/a&gt; åœ¨ äº‘åŸç”Ÿæ˜¯å…³äºæ–‡åŒ–è€Œä¸æ˜¯å®¹å™¨ ä¸€æ–‡ä¸­æŒ‡å‡ºçš„ï¼Œâ€œå³ä½¿æœ‰é€‚å½“çš„è‡ªä¸»å›¢é˜Ÿï¼Œç³»ç»Ÿçº§çš„è€ƒè™‘ä¹Ÿä¸ä¼šæ¶ˆå¤±â€ã€‚&lt;/p&gt;
&lt;p&gt;Eric Evans çš„ã€Š&lt;a href=&#34;https://www.amazon.com/gp/product/0321125215/ref=as_li_tl?ie=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;creativeASIN=0321125215&amp;amp;linkCode=as2&amp;amp;tag=martinfowlerc-20&#34; title=&#34;é¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹&lt;/a&gt;æ˜¯å¾®æœåŠ¡è¿åŠ¨çš„åŸºçŸ³ï¼Œä»»ä½•è½¯ä»¶æ¶æ„å¸ˆéƒ½åº”è¯¥é˜…è¯»ï¼ŒBryant è¯´ã€‚ä½†ä»–æ›´è¿›ä¸€æ­¥è¯´ï¼š&lt;/p&gt;
&lt;p&gt;â€œæˆ‘è®¤ä¸ºç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬å…¶ä»–äººæä¾› DDDï¼Œâ€œä»–å‘Šè¯‰ The New Stackã€‚â€œå› ä¸ºå³ä½¿æ˜¯æ™®é€šçš„å¼€å‘è€…è€Œä¸æ˜¯æ¶æ„å¸ˆï¼Œä¹Ÿéœ€è¦å¯¹å¦‚ä½•ç¡®å®šå®ä½“å’Œè¾¹ç•Œçš„èŒƒå›´æœ‰ä¸€å®šçš„äº†è§£ï¼Œå…¶ä¸­å¾ˆå¤šéƒ½è¦å›åˆ°è‰¯å¥½çš„ API è®¾è®¡ã€‚ä¸€æ—¦ä½ ç†è§£äº†è€¦åˆå’Œå†…èšçš„é‡è¦æ€§ï¼Œå…³æ³¨ç‚¹å’Œè¾¹ç•Œçš„åˆ†ç¦»ï¼Œæ— è®ºä½ å¤„ç†çš„æ˜¯ä»€ä¹ˆæŠ½è±¡ï¼ˆæ¨¡å—ã€ç±»ã€æœåŠ¡ã€åº”ç”¨ï¼‰ï¼Œä½ éƒ½ä¼šè‡ªç„¶è€Œç„¶åœ°è·³åˆ°è¿™ä¸ªé½¿è½®ä¸Šã€‚â€&lt;/p&gt;
&lt;p&gt;Newman çš„ Building Microservices ä¸€ä¹¦çš„ç¬¬äºŒç‰ˆå³å°†æ¨å‡ºï¼Œè¯¥ä¹¦ä»‹ç»äº†å¾ˆå¤šè¿™äº›æ¦‚å¿µï¼Œå¹¶è€ƒè™‘åˆ°äº†ä¸‹ä¸€ä»£æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ›´æ–°è¿™æœ¬ä¹¦æ—¶ï¼ŒNewman å‘Šè¯‰ The New Stackï¼Œâ€œæˆ‘æƒ³å¤šè°ˆä¸€ç‚¹è€¦åˆæ€§ã€‚æˆ‘æƒ³å¤šè°ˆä¸€ç‚¹å†…èšåŠ›ã€‚æˆ‘æƒ³æ›´å¤šåœ°è°ˆè®ºä¿¡æ¯éšè—ï¼Œè¿™å¯¹æˆ‘æ¥è¯´æ˜¯ç°åœ¨æœ€é‡è¦çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘è®¤ä¸ºï¼Œå³ä½¿äººä»¬æŒæ¡äº†åˆ†å¸ƒå¼ç³»ç»Ÿæ–¹é¢çš„çŸ¥è¯†ï¼Œä»–ä»¬ä¹Ÿæ²¡æœ‰æŒæ¡ä¸€ä¸ªäº‹å®ï¼Œå³ä»æ ¹æœ¬ä¸Šè¯´ï¼Œå¾®æœåŠ¡åªæ˜¯æ¨¡å—åŒ–æ¶æ„çš„ä¸€ç§å½¢å¼ã€‚ç„¶è€Œï¼Œå¾ˆå¤šåˆ›å»ºå¾®æœåŠ¡çš„äººå¯¹ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–æ¶æ„æˆ–å¦‚ä½•è¿›è¡Œæ¨¡å—åŒ–æ¯«æ— æ¦‚å¿µã€‚â€&lt;/p&gt;
&lt;p&gt;Newman åœ¨æ–°ä¹¦ä¸­è¿˜å¼•å…¥äº†è‡ª 2014 å¹´ç¬¬ä¸€ç‰ˆå‡ºç‰ˆä»¥æ¥å‡ºç°çš„ä¸€äº›ç»„ç»‡æ€ç»´çš„å˜åŒ–ã€‚ä»–ç‰¹åˆ«å¼•ç”¨äº†é©¬ä¿®ãƒ»æ–¯å‡¯å°”é¡¿ï¼ˆMatthew Skeltonï¼‰å’Œæ›¼åŠªåŸƒå°”ãƒ»æ´¾æ–¯ï¼ˆManuel Paisï¼‰å…³äºå¦‚ä½•ç»„ç»‡ä¸šåŠ¡å’ŒæŠ€æœ¯å›¢é˜Ÿä»¥å®ç°å¿«é€ŸæµåŠ¨çš„æå…·å½±å“åŠ›çš„ä½œå“&lt;a href=&#34;https://teamtopologies.com/book&#34; title=&#34;ã€Šå›¢é˜Ÿæ‹“æ‰‘ï¼ˆTeam Topologiesï¼‰ã€‹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ã€Šå›¢é˜Ÿæ‹“æ‰‘ï¼ˆTeam Topologiesï¼‰ã€‹&lt;/a&gt;ï¼Œä»¥åŠå°¼ç§‘å°”ãƒ»ç¦æ–¯æ ¼ä¼¦ï¼ˆNicole Forsgrenï¼‰ã€æ°å…¹ãƒ»æ±‰ä¼¯ï¼ˆJez Humbleï¼‰å’Œå‰æ©ãƒ»é‡‘ï¼ˆGene Kimï¼‰çš„&lt;a href=&#34;https://itrevolution.com/accelerate-book/&#34; title=&#34;ã€ŠåŠ é€Ÿï¼ˆAccelerateï¼‰ã€‹&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ã€ŠåŠ é€Ÿï¼ˆAccelerateï¼‰ã€‹&lt;/a&gt;ä¸€ä¹¦ï¼Œè¯¥ä¹¦æ¢è®¨äº†ç²¾ç›Šç®¡ç†å’Œ DevOps åŸåˆ™èƒŒåçš„ç§‘å­¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®è®¢è¿‡ç¨‹ä¸ä»…æ­ç¤ºäº†æœ‰å¤šå°‘å…³äºå¾®æœåŠ¡çš„æ–°çŸ¥è¯†å¯ä»¥åˆ†äº«ï¼Œè€Œä¸”è¿™äº›çŸ¥è¯†æ˜¯å¦‚ä½•ä¸æ–­ç§¯ç´¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;â€œè¿™æœ¬ä¹¦å¯ä»¥è®©ä½ å¹¿æ³›äº†è§£ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ä»¥åŠå®ƒå¯¹è½¯ä»¶å¼€å‘çš„å½±å“ï¼Œâ€œNewman è¯´ã€‚â€œæˆ‘å‘ç°æˆ‘åœ¨å‘äººä»¬æ¨èï¼Œå“¦ï¼Œä½ åº”è¯¥è¯»é‚£æœ¬ä¹¦çš„ç¬¬å››ç« ã€‚ç°åœ¨æˆ‘ä¼šè¯´è¿™ä¸ªï¼Œè€Œä¸æ˜¯é‚£ä¸ªã€‚æˆ‘ä¸æƒ³åœ¨æ¨èè‡ªå·±çš„ä¹¦ä¸Šä¸€ç›´å«ç³Šå…¶è¾ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å†™äº†ç¬¬äºŒç‰ˆï¼šå› ä¸ºæˆ‘å¸Œæœ›å®ƒæ˜¯å¥½çš„ã€å‡†ç¡®çš„ã€‚â€&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ç­–ç•¥å³ä»£ç â€”â€”Open Policy Agentï¼ˆå¼€æ”¾ç­–ç•¥ä»£ç† OPAï¼‰ç®€ä»‹</title>
      <link>https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/</link>
      <pubDate>Tue, 29 Jun 2021 10:10:46 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/</guid>
      <description>
        
        
        &lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-opa&#34;&gt;ä»€ä¹ˆæ˜¯ OPAï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå§‹äº 2016 å¹´çš„é¡¹ç›®ï¼Œæ—¨åœ¨ç»Ÿä¸€ä¸åŒæŠ€æœ¯å’Œç³»ç»Ÿçš„ç­–ç•¥æ‰§è¡Œã€‚ä»Šå¤©ï¼ŒOPA è¢«ç§‘æŠ€è¡Œä¸šå†…çš„å·¨å¤´ä»¬æ‰€ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼ŒNetflix ä½¿ç”¨ OPA æ¥æ§åˆ¶å¯¹å…¶å†…éƒ¨ API èµ„æºçš„è®¿é—®ã€‚Chef ç”¨å®ƒæ¥ä¸ºä»–ä»¬çš„ç»ˆç«¯ç”¨æˆ·äº§å“æä¾› IAM åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œè®¸å¤šå…¶ä»–å…¬å¸ï¼Œå¦‚ Cloudflareã€Pinterest ç­‰ï¼Œéƒ½ä½¿ç”¨ OPA åœ¨ä»–ä»¬çš„å¹³å°ä¸Šæ‰§è¡Œç­–ç•¥ï¼ˆå¦‚ Kubernetes é›†ç¾¤ï¼‰ã€‚ç›®å‰ï¼ŒOPA å·²ä» CNCF ä¸­æ¯•ä¸šã€‚&lt;/p&gt;
&lt;h2 id=&#34;opa-æœ‰ä»€ä¹ˆç”¨&#34;&gt;OPA æœ‰ä»€ä¹ˆç”¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½æƒ³çŸ¥é“ OPA æ˜¯æ€æ ·è¯ç”Ÿçš„ï¼Ÿå®ƒè¯•å›¾è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿäº‹å®ä¸Šï¼ŒAPI å’Œå¾®æœåŠ¡çš„ç­–ç•¥æ‰§è¡Œå°±å¦‚åŒå¾®æœåŠ¡æœ¬èº«ä¸€æ ·å¤è€ã€‚æ²¡æœ‰ä¸€ä¸ªç”Ÿäº§çº§åˆ«çš„åº”ç”¨ç¨‹åºä¸æ‰§è¡Œè®¿é—®æ§åˆ¶ã€æˆæƒå’Œç­–ç•¥ã€‚ä¸ºäº†ç†è§£ OPA çš„ä½œç”¨ï¼Œè€ƒè™‘ä»¥ä¸‹ç”¨ä¾‹ï¼šä½ çš„å…¬å¸é€šè¿‡ä¸€ä¸ªåœ¨çº¿é—¨æˆ·é”€å”®ç¬”è®°æœ¬ç”µè„‘ã€‚åƒæ‰€æœ‰å…¶ä»–ç±»ä¼¼çš„åº”ç”¨ç¨‹åºä¸€æ ·ï¼Œè¯¥é—¨æˆ·ç”±ä¸€ä¸ªé¦–é¡µç»„æˆï¼Œå®¢æˆ·åœ¨è¿™é‡Œçœ‹åˆ°æœ€æ–°çš„äº§å“ï¼Œä¹Ÿè®¸è¿˜æœ‰ä¸€äº›é™æ—¶ä¿ƒé”€æ´»åŠ¨ã€‚å¦‚æœå®¢æˆ·æƒ³ä¹°ä¸œè¥¿ï¼Œä»–ä»¬éœ€è¦ç™»å½•æˆ–åˆ›å»ºä¸€ä¸ªè´¦æˆ·ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä¿¡ç”¨å¡æˆ–å…¶ä»–æ–¹æ³•ä»˜æ¬¾ã€‚ä¸ºäº†ç¡®ä¿å®¢æˆ·ä¼šåå¤è®¿é—®ï¼Œéœ€è¦æ”¯æŒå®¢æˆ·è®¢é˜…ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«ç‰¹åˆ«æŠ˜æ‰£ä¿¡æ¯ã€‚å¦å¤–ï¼Œä»–ä»¬å¯ä»¥é€‰æ‹©åœ¨æ–°äº§å“å…¬å¸ƒåç«‹å³æ¥æ”¶æµè§ˆå™¨é€šçŸ¥ã€‚ä¸€ä¸ªéå¸¸å…¸å‹çš„ç½‘ä¸Šè´­ç‰©åº”ç”¨ç¨‹åºï¼Œå¯¹å—ï¼Ÿç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ä¸€å¼ å›¾æ¥æè¿°ä¸€ä¸‹è¿™ä¸ªå·¥ä½œæµç¨‹æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œä»¥ä½¿è¿™ä¸ªè¿‡ç¨‹å¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryvk70h04j30wm0u0x2v_hu_bf5fc4f16226ae58.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryvk70h04j30wm0u0x2v.jpg&#34; data-img=&#34;/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryvk70h04j30wm0u0x2v.jpg&#34; data-width=&#34;1000&#34; data-height=&#34;920&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;ä¸Šå›¾æ˜¾ç¤ºäº†æˆ‘ä»¬ç³»ç»Ÿå†…éƒ¨å¯èƒ½çš„æ ·å­ã€‚æˆ‘ä»¬æœ‰ä¸€äº›å¾®æœåŠ¡ï¼Œå®ƒä»¬ç›¸äº’æ²Ÿé€šï¼Œä¸ºæˆ‘ä»¬çš„å®¢æˆ·æä¾›æœåŠ¡ã€‚ç°åœ¨ï¼Œæ˜¾ç„¶ï¼ŒBob ä¸åº”è¯¥çœ‹åˆ°ç³»ç»Ÿçš„ä»»ä½•å†…éƒ¨è¿ä½œã€‚ä¾‹å¦‚ï¼Œä»–ä¸èƒ½æŸ¥çœ‹ï¼ˆæˆ–ç”šè‡³ä¸çŸ¥é“ï¼‰å½’æ¡£ä»˜æ¬¾çš„ S3 Bucketï¼Œæˆ–é€šçŸ¥ API å¯ä»¥ä¸å“ªäº›æœåŠ¡è”ç»œã€‚ä½†æ˜¯ï¼ŒJohn å‘¢ï¼Ÿä»–æ˜¯åº”ç”¨å¼€å‘è€…ï¼Œä»–éœ€è¦è®¿é—®æ‰€æœ‰çš„å¾®æœåŠ¡ï¼Œä»¥ä¾¿åœ¨é—®é¢˜å‘ç”Ÿæ—¶èƒ½å¤Ÿè¿›è¡Œæ•…éšœæ’é™¤å’Œè°ƒè¯•ã€‚è¦æ˜¯ä»–ä¸å°å¿ƒï¼ˆæˆ–æ•…æ„ï¼‰å¯¹æ•°æ®åº“æœåŠ¡è¿›è¡Œäº†ä¸€ä¸ª API è°ƒç”¨ï¼ŒæŠŠå®¢æˆ·çš„é€è´§åœ°å€æ”¹åˆ°äº†åˆ«çš„åœ°æ–¹ï¼Œæ€ä¹ˆåŠï¼Ÿæ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœä»–å¯¹å®¢æˆ·çš„ä¿¡ç”¨å¡å·ç æœ‰è¯»å–æƒé™æ€ä¹ˆåŠï¼Ÿä¸ºäº†è§£å†³è¿™äº›é£é™©ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå¾®æœåŠ¡çš„ä¹‹å‰æ”¾ç½®äº†ä¸€ä¸ªæˆæƒæ§åˆ¶ã€‚è¯¥æ§ä»¶æ£€æŸ¥è®¤è¯ç”¨æˆ·æ˜¯å¦æœ‰å¿…è¦çš„æƒé™æ¥æ‰§è¡Œè¯·æ±‚çš„æ“ä½œã€‚è¿™æ ·çš„æˆæƒç³»ç»Ÿå¯ä»¥æ˜¯å†…éƒ¨çš„ã€è‡ªåˆ¶çš„ç¨‹åºï¼Œä¹Ÿå¯ä»¥æ˜¯ AWS IAM æä¾›çš„å¤–éƒ¨ç¨‹åºã€‚è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„æ„å»ºå’Œå®‰å…¨ã€‚ä½†æ˜¯ï¼Œçœ‹çœ‹ä½¿ç”¨å‡ ç§ä¸åŒçš„æˆæƒç³»ç»Ÿçš„ç¼ºç‚¹ï¼Œç‰¹åˆ«æ˜¯éšç€åº”ç”¨ç¨‹åºçš„å¢é•¿è€Œå¸¦æ¥çš„éº»çƒ¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ç°æœ‰çš„ç­–ç•¥ï¼Œæˆ–å¼•å…¥æ–°çš„ç­–ç•¥ï¼Œæ˜¯ä¸€åœºå™©æ¢¦ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œä½ éœ€è¦è®¿é—®å¤šå°‘åœ°æ–¹æ‰èƒ½è®© Alice æ‹¥æœ‰å¯¹æ‰€æœ‰å­˜å‚¨ç›¸å…³ç³»ç»Ÿçš„è¯»å–æƒé™ã€‚è¿™æ„å‘³ç€ S3ã€MySQLã€MongoDBï¼Œä¹Ÿè®¸è¿˜æœ‰ä¸€ä¸ªå¤–éƒ¨ APIï¼Œä»…æ­¤è€Œå·²ã€‚&lt;/li&gt;
&lt;li&gt;å¼€å‘è€…æ²¡æœ‰åŠæ³•åœ¨ä»–ä»¬è‡ªå·±çš„ç³»ç»Ÿä¸Šæ‰§è¡Œç­–ç•¥ã€‚ä»–ä»¬æ˜¾ç„¶å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ç¡¬ç¼–ç ä»–ä»¬çš„æˆæƒé€»è¾‘ï¼Œä½†è¿™ä½¿äº‹æƒ…å˜å¾—é”™ç»¼å¤æ‚ï¼šè¯•å›¾åœ¨ä¸åŒçš„å¾®æœåŠ¡ä¸­ç»Ÿä¸€ç­–ç•¥æ˜¯éå¸¸å¤æ‚çš„ã€‚&lt;/li&gt;
&lt;li&gt;è¡¥å……å‰ä¸€ç‚¹ï¼Œä¸ºæœ¬åœ°æœåŠ¡å¼•å…¥ä¸€ä¸ªæ–°çš„ç­–ç•¥å¯èƒ½éœ€è¦æ”¹å˜ä»£ç ï¼Œä»è€Œå¼•å…¥æ‰€æœ‰å¾®æœåŠ¡çš„æ–°ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ æƒ³å°†ç­–ç•¥ä¸ç°æœ‰çš„ç”¨æˆ·æ•°æ®åº“é›†æˆï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿä¾‹å¦‚ï¼Œä¸äººåŠ›èµ„æºæ•°æ®åº“æ•´åˆã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬éœ€è¦å°†ç­–ç•¥å¯è§†åŒ–ï¼Œä»¥ç¡®ä¿å®ƒæ­£åœ¨åšå®ƒåº”è¯¥åšçš„äº‹æƒ…ã€‚éšç€ä½ çš„ç­–ç•¥å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œè¿™ä¸€ç‚¹å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;ç°ä»£ç³»ç»Ÿç”±å¤šç§æŠ€æœ¯å’ŒæœåŠ¡ç»„æˆï¼Œè¿™äº›æŠ€æœ¯å’ŒæœåŠ¡æ˜¯ç”¨ä¸åŒçš„è¯­è¨€ç¼–å†™çš„ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æœ‰è¿è¡Œåœ¨ Kubernetes ä¸Šçš„ç³»ç»Ÿæ ¸å¿ƒï¼Œä»¥åŠä¸€å †ä¸å±äºé›†ç¾¤çš„ç”¨ Javaã€Ruby å’Œ PHP ç¼–å†™çš„ä¼ ç»Ÿ APIã€‚æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„æˆæƒæœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»¥ Kubernetes ä¸ºä¾‹æ¥çœ‹çœ‹ã€‚å¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½è¢«æˆæƒè®¿é—®æ•´ä¸ªé›†ç¾¤ï¼Œå¾ˆå¤šè®¨åŒçš„äº‹æƒ…å°±ä¼šå‘ç”Ÿï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»™æ‰€æœ‰çš„ pod æä¾›æ— é™çš„è¯·æ±‚å’Œé™åˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´éšæœºçš„ pod è¢«ä»èŠ‚ç‚¹ä¸Šé©±é€ã€‚&lt;/li&gt;
&lt;li&gt;æ‹‰å–å’Œä½¿ç”¨æœªç»æµ‹è¯•çš„ã€æ‚ä¹±æ— ç« çš„é•œåƒï¼Œå¯èƒ½åŒ…å«å®‰å…¨æ¼æ´æˆ–æ¶æ„å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ²¡æœ‰ TLS çš„ Ingress æ§åˆ¶å™¨ï¼Œå…è®¸æœªåŠ å¯†çš„ã€ä¸å®‰å…¨çš„æµé‡è¿›å…¥åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºæ•´ä½“çš„å¤æ‚æ€§ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–ä¸å¯é¢„è§çš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;ä½ è‚¯å®šå¯ä»¥ä½¿ç”¨ RBAC å’Œ Pod å®‰å…¨ç­–ç•¥æ¥å¯¹é›†ç¾¤è¿›è¡Œç»†ç²’åº¦çš„æ§åˆ¶ã€‚ä½†åŒæ ·ï¼Œè¿™åªé€‚ç”¨äºé›†ç¾¤ã€‚åœ¨ Kubernetes é›†ç¾¤ä¹‹å¤–ï¼ŒKubernetes RBAC æ˜¯æ²¡æœ‰ç”¨çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å°±æ˜¯å¼€æ”¾ç­–ç•¥ä»£ç†ï¼ˆOPAï¼‰å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¼•å…¥ OPA æ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•æ¥æ‰§è¡Œå †æ ˆä¸­çš„å®‰å…¨ç­–ç•¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;opa-å¦‚ä½•å·¥ä½œ&#34;&gt;OPA å¦‚ä½•å·¥ä½œï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†ç­–ç•¥æ‰§è¡Œå’Œ OPA è¯•å›¾è§£å†³çš„é—®é¢˜ï¼Œç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ä½ æ­£åœ¨å®ç°æˆ‘ä»¬ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„æ”¯ä»˜æœåŠ¡ã€‚è¿™ä¸ªæœåŠ¡è´Ÿè´£å¤„ç†å®¢æˆ·çš„ä»˜æ¬¾ã€‚å®ƒæš´éœ²äº†ä¸€ä¸ª APIï¼Œæ¥å—å®¢æˆ·çš„ä»˜æ¬¾ã€‚å®ƒè¿˜å…è®¸ç”¨æˆ·æŸ¥è¯¢ç‰¹å®šå®¢æˆ·çš„ä»˜æ¬¾æƒ…å†µã€‚å› æ­¤ï¼Œä¸ºäº†è·å¾—ä¸€ä¸ªåŒ…å« Jane æ‰€åšè´­ä¹°çš„æ•°ç»„ï¼Œå¥¹æ˜¯å…¬å¸çš„ä¸€ä¸ªå®¢æˆ·ï¼Œä½ å‘ API å‘é€ä¸€ä¸ª GET è¯·æ±‚ï¼Œè·¯å¾„ä¸º &lt;code&gt;/payment/jane&lt;/code&gt;ã€‚ä½ åœ¨æˆæƒå¤´ä¸­æä¾›ä½ çš„è¯ä¹¦ä¿¡æ¯å¹¶å‘é€è¯·æ±‚ã€‚å“åº”å°†æ˜¯ä¸€ä¸ª JSON æ•°ç»„ï¼ŒåŒ…å«ä½ æ‰€è¦æ±‚çš„æ•°æ®ã€‚ç„¶è€Œï¼Œç”±äºä½ ä¸å¸Œæœ›æ‰€æœ‰æœ‰ç½‘ç»œè®¿é—®æƒé™çš„äººéƒ½èƒ½å¤Ÿè®¿é—®æ”¯ä»˜ APIï¼Œçœ‹åˆ°è¿™æ ·çš„æ•æ„Ÿæ•°æ®ï¼Œä½ éœ€è¦æ‰§è¡Œä¸€ä¸ªæˆæƒç­–ç•¥ã€‚OPA ä»¥å¦‚ä¸‹æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ”¯ä»˜ API å‘ OPA æŸ¥è¯¢ä¸€ä¸ª decisionã€‚å®ƒä¼´éšç€è¿™ä¸ªæŸ¥è¯¢çš„ä¸€äº›å±æ€§ï¼Œå¦‚è¯·æ±‚ä¸­ä½¿ç”¨çš„ HTTP æ–¹æ³•ï¼Œè·¯å¾„ï¼Œç”¨æˆ·ï¼Œç­‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;OPA æ ¹æ®å·²ç»æä¾›ç»™å®ƒçš„æ•°æ®æ¥éªŒè¯è¿™äº›å±æ€§ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨éªŒè¯ä¹‹åï¼ŒOPA å‘è¯·æ±‚çš„ API å‘é€ä¸€ä¸ª decisionï¼Œè¦ä¹ˆå…è®¸ï¼Œè¦ä¹ˆæ‹’ç»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒOPA å°†æˆ‘ä»¬çš„ç­–ç•¥å†³ç­–ä¸æ‰§è¡Œè§£è€¦ã€‚OPA çš„å·¥ä½œæµç¨‹å¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥æè¿°ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryw7x0q6gj30u00xt7td_hu_6c844d24f4846602.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryw7x0q6gj30u00xt7td.jpg&#34; data-img=&#34;/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryw7x0q6gj30u00xt7td.jpg&#34; data-width=&#34;887&#34; data-height=&#34;1000&#34; alt=&#34;image&#34; data-caption=&#34;OPAd çš„å·¥ä½œæµç¨‹&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;OPAd çš„å·¥ä½œæµç¨‹&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;OPA æ˜¯ä¸€ä¸ªé€šç”¨çš„ã€ä¸é¢†åŸŸæ— å…³çš„ç­–ç•¥æ‰§è¡Œå·¥å…·ã€‚å®ƒå¯ä»¥ä¸ APIã€Linux SSH å®ˆæŠ¤ç¨‹åºã€åƒ CEPH è¿™æ ·çš„å¯¹è±¡å­˜å‚¨ç­‰é›†æˆã€‚OPA çš„è®¾è®¡è€…æœ‰æ„é¿å…å°†å…¶å»ºç«‹åœ¨ä»»ä½•å…¶ä»–é¡¹ç›®çš„åŸºç¡€ä¸Šã€‚å› æ­¤ï¼Œç­–ç•¥æŸ¥è¯¢å’Œå†³å®šä¸éµå¾ªç‰¹å®šçš„æ ¼å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æœ‰æ•ˆçš„ JSON æ•°æ®ä½œä¸ºè¯·æ±‚å±æ€§ï¼Œåªè¦å®ƒæä¾›æ‰€éœ€çš„æ•°æ®ã€‚åŒæ ·åœ°ï¼Œæ¥è‡ª OPA çš„ç­–ç•¥å†³ç­–ä¹Ÿå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ JSON æ•°æ®ã€‚ä½ é€‰æ‹©ä»€ä¹ˆè¢«è¾“å…¥ï¼Œä»€ä¹ˆè¢«è¾“å‡ºã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€‰æ‹©è®© OPA è¿”å›ä¸€ä¸ª TRUE æˆ– FALSE çš„ JSON å¯¹è±¡ï¼Œä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå¤æ‚çš„æ•°æ®å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;opa-å†…éƒ¨&#34;&gt;OPA å†…éƒ¨&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å……åˆ†ç†è§£ OPA å¹¶å¼€å§‹åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­å®æ–½å®ƒï¼Œä½ å¿…é¡»ç†Ÿæ‚‰å®ƒçš„åŠŸèƒ½å’Œç»„ä»¶ã€‚è®©æˆ‘ä»¬ä»å¦‚ä½•å®šä¹‰ä½ çš„ç­–ç•¥å¼€å§‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç­–ç•¥è¯­è¨€-rego&#34;&gt;ç­–ç•¥è¯­è¨€ Rego&lt;/h3&gt;
&lt;p&gt;Rego æ˜¯ä¸€ç§é«˜çº§çš„å£°æ˜æ€§è¯­è¨€ï¼Œæ˜¯ä¸“é—¨ä¸º OPA å»ºç«‹çš„ã€‚å®ƒä½¿å®šä¹‰ç­–ç•¥å’Œè§£å†³ä»¥ä¸‹é—®é¢˜å˜å¾—éå¸¸å®¹æ˜“ï¼šBob æ˜¯å¦è¢«å…è®¸å¯¹ &lt;code&gt;/api/v1/products&lt;/code&gt; æ‰§è¡Œ GET è¯·æ±‚ï¼Ÿä»–å®é™…ä¸Šè¢«å…è®¸æŸ¥çœ‹å“ªäº›è®°å½•ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;éƒ¨ç½²&#34;&gt;éƒ¨ç½²&lt;/h3&gt;
&lt;p&gt;å½“æ¶‰åŠåˆ°éƒ¨ç½² OPA æ—¶ï¼Œä½ æœ‰å¤šä¸ªé€‰æ‹©ï¼Œè¿™å–å†³äºä½ çš„å…·ä½“åœºæ™¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œä¸º Go åº“&lt;/strong&gt;ï¼šå¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ˜¯ç”¨ Golang å†™çš„ï¼Œä½ å¯ä»¥æŠŠ OPA ä½œä¸ºåº”ç”¨ç¨‹åºä¸­çš„ç¬¬ä¸‰æ–¹åº“æ¥å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œä¸ºå®ˆæŠ¤ç¨‹åº&lt;/strong&gt;ï¼šå¦‚æœä½ ä¸ä½¿ç”¨ Goï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒå…¶ä»–æœåŠ¡ä¸€æ ·ï¼ŒæŠŠ OPA ä½œä¸ºä¸€ä¸ªå®ˆæŠ¤ç¨‹åºæ¥éƒ¨ç½²ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®ä½ ä½¿ç”¨ä¸€ä¸ª sidecar å®¹å™¨æˆ–åœ¨ä¸»æœºä¸Šè¿è¡Œã€‚åŸå› æ˜¯ï¼Œè¿™ç§è®¾è®¡å¯ä»¥æé«˜æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æŠŠ OPA éƒ¨ç½²åœ¨ Kubernetes çš„ä¸€ä¸ªå•ç‹¬çš„ pod ä¸­ï¼Œè€Œè¿™ä¸ª pod æ°å¥½ä½äºä¸€ä¸ªå•ç‹¬çš„èŠ‚ç‚¹ä¸Šï¼Œè€Œä½ çš„åº”ç”¨ pod æ­£åœ¨é‚£é‡Œè¿è¡Œã€‚ç°åœ¨ï¼Œæ¯å½“ä½ çš„æœåŠ¡éœ€è¦å’¨è¯¢ OPA çš„ç­–ç•¥å†³ç­–æ—¶ï¼Œå®ƒå¿…é¡»é€šè¿‡ç½‘ç»œè¿›è¡Œè°ƒç”¨ï¼Œä»¥è¾¾åˆ° OPA è¿è¡Œçš„ podã€‚è¿™å¼•å…¥äº†ä¸å¿…è¦çš„å»¶è¿Ÿï¼Œå¹¶å¯èƒ½åœ¨é«˜å³°æœŸå¯¼è‡´åº”ç”¨ç¨‹åºçš„è¿Ÿæ»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1grywfo32k9j30u01drtl3_hu_593fe3b9fef997a8.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1grywfo32k9j30u01drtl3.jpg&#34; data-img=&#34;/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1grywfo32k9j30u01drtl3.jpg&#34; data-width=&#34;603&#34; data-height=&#34;1000&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;h3 id=&#34;å¦‚ä½•ç®¡ç†å’Œæ§åˆ¶-opa&#34;&gt;å¦‚ä½•ç®¡ç†å’Œæ§åˆ¶ OPAï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è¿›ä¸€æ­¥å‡å°‘å»¶è¿Ÿï¼Œè®¾è®¡è€…å†³å®š OPA åº”è¯¥æŠŠæ‰€æœ‰çš„ç­–ç•¥æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚è¿™ç¡®ä¿äº† OPA ä¸ä¼šå»æŸ¥è¯¢å¦ä¸€ä¸ªæœåŠ¡æ¥è¯·æ±‚æ•°æ®ã€‚ä¸ºäº†å¤„ç† OPAï¼Œä½ æœ‰ä¸€ç»„ APIï¼Œç”¨äºä¸åŒçš„ç›®çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ†ç»‘æœåŠ¡ API&lt;/strong&gt;ï¼šç”¨äºå‘ OPA å‘é€ç­–ç•¥æ•°æ®ã€‚OPA ä¸æ–­è½®è¯¢ Bundle æœåŠ¡ APIï¼Œæœç´¢æ–°ç‰ˆæœ¬çš„ç­–ç•¥ã€‚ä¸€æ—¦å‘ç°ï¼Œå®ƒå°±æ‹‰å–å¹¶åº”ç”¨æ–°çš„ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŠ¶æ€æœåŠ¡ API&lt;/strong&gt;ï¼šç”¨äºç¡®å®šæœåŠ¡çš„çŠ¶æ€ã€‚å®ƒå‘Šè¯‰ä½ å½“å‰åœ¨ OPA ä¸Šæ¿€æ´»çš„ç­–ç•¥ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†³ç­–æ—¥å¿—æœåŠ¡ API&lt;/strong&gt;ï¼šæ¯å½“ OPA åšå‡ºä¸€ä¸ªç­–ç•¥å†³ç­–ï¼Œå®ƒéƒ½ä¼šè®°å½•ä¸‹æ¥ã€‚åæ¥ï¼Œå®ƒæŠŠè¿™äº›æ—¥å¿—çš„æ‰¹æ¬¡å‘é€åˆ°æ—¥å¿—æœåŠ¡ APIã€‚è¿™å¯¹äºå®¡è®¡å’Œæ•…éšœæ’é™¤ç‰¹åˆ«æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å»ºã€æµ‹è¯•å’Œè°ƒè¯•ç­–ç•¥çš„å·¥å…·&lt;/strong&gt; ï¼šä¸€ç»„å‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å¯ä»¥ä½¿ç”¨ï¼Œå¦‚ opa testã€opa runã€opa check ç­‰ã€‚è¿˜æœ‰ä¸€ä¸ª &lt;a href=&#34;https://marketplace.visualstudio.com/items?itemName=tsandall.opa&#34; title=&#34;VS Code æ’ä»¶&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VS Code æ’ä»¶&lt;/a&gt;ï¼Œå¯ä»¥æ–¹ä¾¿å¼€å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åˆè¯•-opa-ç­–ç•¥&#34;&gt;åˆè¯• OPA ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä½ åº”è¯¥å¯¹ OPA è¯ç”Ÿçš„åŸå› ï¼Œå®ƒè¯•å›¾è§£å†³çš„é—®é¢˜ï¼Œä»¥åŠå®ƒçš„è®¾è®¡å’Œç®¡ç†æ–¹å¼æœ‰äº†ç›¸å½“æ¸…æ™°çš„è®¤è¯†ã€‚ç°åœ¨æ˜¯è¯•æ°´çš„æ—¶å€™äº†ï¼Œçœ‹çœ‹ç”¨ Rego è¯­è¨€åˆ›å»ºä¸€ä¸ªç­–ç•¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚ç¬¬ä¸€æ­¥æ˜¯ç”¨ç®€å•çš„è‹±è¯­å®šä¹‰ä½ çš„ç­–ç•¥ã€‚æ¯”å¦‚è¯´ï¼šâ€œå®¢æˆ·åº”è¯¥èƒ½å¤ŸæŸ¥çœ‹è‡ªå·±çš„ä»˜æ¬¾ã€‚è´¢åŠ¡éƒ¨é—¨çš„å·¥ä½œäººå‘˜åº”è¯¥èƒ½å¤ŸæŸ¥çœ‹ä»»ä½•å®¢æˆ·çš„ä»˜æ¬¾ã€‚â€&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥æ˜¯å°†ç­–ç•¥è½¬æ¢ä¸º Rego ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://play.openpolicyagent.org/&#34; title=&#34;Rego playground&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Rego playground&lt;/a&gt; æ¥åšè¿™ä»¶äº‹ã€‚å› æ­¤ï¼Œåœ¨ä¸»é¢æ¿ä¸­ï¼Œæ¸…é™¤é‚£é‡Œå·²ç»æ·»åŠ çš„ä»£ç ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;package play

# Customers should be able to view their own payments
allow = true {
	input.method = &amp;#34;GET&amp;#34;
      input.path = [&amp;#34;payments&amp;#34;, customer_id]
      input.user = customer_id
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è®©æˆ‘ä»¬é€è¡Œå›é¡¾è¿™ä¸ªç‰‡æ®µã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»»ä½•ä»¥å“ˆå¸Œç¬¦å·ï¼ˆ#ï¼‰å¼€å¤´çš„è¡Œéƒ½æ˜¯æ³¨é‡Šã€‚æŠŠä½ çš„ç­–ç•¥åº”è¯¥åšçš„äº‹æƒ…å†™æˆè¿è´¯çš„ã€å¯ä¾›äººç±»é˜…è¯»çš„æ³¨é‡Šï¼Œæ€»æ˜¯ä¸€ä¸ªå¥½çš„åšæ³•ã€‚&lt;/li&gt;
&lt;li&gt;allow = true æ„å‘³ç€å¦‚æœä»¥ä¸‹çš„â€œè¯„ä¼°â€œä¸ºçœŸï¼Œå†³ç­–å°†è¢«å…è®¸ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å…¥æ–¹æ³•æ˜¯ GETã€‚ä»»ä½•å…¶ä»– HTTP æ–¹æ³•ï¼ˆPOSTã€PUT ç­‰ï¼‰éƒ½ä¼šè¿åç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;è·¯å¾„æ˜¯ &lt;code&gt;/payments/customer_id&lt;/code&gt;ã€‚æ³¨æ„ï¼Œcustomer_id æ²¡æœ‰åŠ å¼•å·ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå˜é‡ï¼Œéœ€è¦åœ¨è°ƒç”¨æ—¶è¢«æ›¿æ¢ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·ä¹Ÿåº”è¯¥æ˜¯ customer_idã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æŠŠè¿™æ®µä»£ç ç¿»è¯‘æˆæ™®é€šè‹±è¯­ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒè¿™æ ·ã€‚&lt;/p&gt;
&lt;p&gt;â€œå¦‚æœè¯·æ±‚ä½¿ç”¨çš„æ–¹æ³•æ˜¯ GETï¼Œè·¯å¾„æ˜¯ &lt;code&gt;/payments/customer_id&lt;/code&gt;ï¼Œå¹¶ä¸”ç”¨æˆ·æ˜¯åŒä¸€ä¸ª customer_idï¼Œåˆ™å…è®¸è¯¥è¯·æ±‚ã€‚è¿™å®é™…ä¸Šå…è®¸å®¢æˆ·æŸ¥çœ‹è‡ªå·±çš„æ”¯ä»˜æ•°æ®ã€‚â€&lt;/p&gt;
&lt;p&gt;Rego playground è¿˜å…è®¸ä½ è¯„ä¼°ä½ çš„ä»£ç ï¼Œå¹¶ç¡®ä¿è¯¥ç­–ç•¥å°†æŒ‰é¢„æœŸå·¥ä½œã€‚åœ¨ INPUT é¢æ¿ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä»¥ä¸‹ä»£ç æ¥ä¼ªé€ ä¸€ä¸ªåˆæ³•è¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;method&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;path&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;payments&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;bob&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;bob&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„ï¼ŒINPUT ä½¿ç”¨çš„æ˜¯ä»»æ„çš„ JSONã€‚åœ¨æä¾›è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰ç‰¹å®šçš„è§„åˆ™å¯ä»¥éµå¾ªã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ OPA å°†å¦‚ä½•é€šè¿‡æŒ‰ä¸‹ Evaluate æŒ‰é’®æ¥å“åº”è¿™ä¸ªå†³ç­–è¯·æ±‚ã€‚OUTPUT é¢æ¿åº”è¯¥æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;allow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹é¢æ˜¯æ‰§è¡Œä¸Šè¿°æ­¥éª¤åçš„ playground æˆªå›¾ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryelon0ufj318g0epabz_hu_109fb3fe724ecd96.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryelon0ufj318g0epabz.jpg&#34; data-img=&#34;/trans/introducing-policy-as-code-the-open-policy-agent-opa/008i3skNly1gryelon0ufj318g0epabz.jpg&#34; data-width=&#34;1000&#34; data-height=&#34;331&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯•ç€æŠŠè¯·æ±‚ä¸­çš„ç”¨æˆ·æ”¹ä¸º aliceï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªå®¢æˆ·æ­£è¯•å›¾æŸ¥çœ‹å¦ä¸€ä¸ªå®¢æˆ·çš„ä»˜æ¬¾ã€‚å¦‚æœæˆ‘ä»¬æŒ‰ Evaluate é”®ï¼Œä½ ä¼šå‘ç°è¾“å‡ºæ˜¾ç¤ºä¸€ä¸ªç©ºçš„ JSON å¯¹è±¡ {}ã€‚åŸå› æ˜¯ï¼ŒOPA ä¸çŸ¥é“å½“ç­–ç•¥ä¸åŒ¹é…æ—¶åº”è¯¥å‘é€ä»€ä¹ˆã€‚è¦æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œåœ¨ç­–ç•¥çš„ä¸»ä½“å‰æ·»åŠ ä»¥ä¸‹è¯­å¥ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;default allow = false
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å› æ­¤ï¼Œæ•´ä¸ªç­–ç•¥åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;package play

# Customers should be able to view their own payments
default allow = false
allow = true {
	input.method = &amp;#34;GET&amp;#34;
      input.path = [&amp;#34;payments&amp;#34;, customer_id]
      input.user = customer_id
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœä½ æŒ‰ä¸‹ Evaluateï¼Œä½ ä¼šçœ‹åˆ°é¢„æœŸçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;allow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„ï¼Œè¿™ä¸ª playground éå¸¸å¼ºå¤§ï¼Œä½ å¯ä»¥é€‰æ‹©ç­–ç•¥çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ç‹¬ç«‹äºç­–ç•¥çš„å…¶ä»–éƒ¨åˆ†è¿›è¡Œè¯„ä¼°ã€‚å½“ä½ æœ‰ä¸€ä¸ªå¤æ‚çš„ç­–ç•¥ï¼Œå½“å®ƒä¸åº”è¯¥è¢«è¯„ä¼°ä¸ºå‡æ—¶ï¼Œè¿™å¯èƒ½æ˜¯è¶…çº§æœ‰ç”¨çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€‰æ‹©ç­–ç•¥çš„éƒ¨åˆ†å†…å®¹ï¼Œçœ‹çœ‹åˆ°åº•å“ªé‡Œå‡ºç°äº†ç¼ºé™·ã€‚&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»æ‰§è¡Œäº†ç­–ç•¥çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬ç»§ç»­ç¬¬äºŒéƒ¨åˆ†ï¼šè´¢åŠ¡éƒ¨é—¨çš„å·¥ä½œäººå‘˜åº”è¯¥èƒ½å¤ŸæŸ¥çœ‹ä»»ä½•å®¢æˆ·çš„ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ç­–ç•¥åé¢æ·»åŠ ä»¥ä¸‹å‡ è¡Œã€‚&lt;/p&gt;
&lt;p&gt;è´¢åŠ¡éƒ¨é—¨çš„å·¥ä½œäººå‘˜å¯ä»¥æŸ¥çœ‹ä»»ä½•å®¢æˆ·çš„ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;allow = true {
    input.method = &amp;#34;GET&amp;#34;
    input.path = [&amp;#34;payments&amp;#34;, customer_id]
    finance[input.user]
}

finance = {&amp;#34;john&amp;#34;,&amp;#34;mary&amp;#34;,&amp;#34;peter&amp;#34;,&amp;#34;vivian&amp;#34;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªç­–ç•¥çš„å¤§éƒ¨åˆ†å†…å®¹ä¸ä¹‹å‰çš„ç›¸ä¼¼ï¼Œé™¤äº†ç¬¬ 4 è¡Œã€‚æˆ‘ä»¬ä¸æ˜¯è¯„ä¼°ç”¨æˆ· ID æ˜¯å¦ä¸å®¢æˆ· ID ç›¸åŒï¼Œè€Œæ˜¯è¯„ä¼°ç”¨æˆ·æ˜¯å¦æ˜¯è´¢åŠ¡ JSON å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚Rego æœ‰å¾ˆå¤šå†…ç½®ç»“æ„ï¼Œå…è®¸ä½ åšå¾ˆå¤šæœ‰ç”¨çš„äº‹æƒ…ï¼ŒåŒ…æ‹¬æŸ¥æ‰¾ã€‚æœ€åï¼Œæˆ‘ä»¬å®šä¹‰è´¢åŠ¡å¯¹è±¡å¹¶æ·»åŠ åœ¨è¯¥ç»„ä¸­å·¥ä½œçš„å‘˜å·¥çš„ç”¨æˆ·åã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œè¿™ä¸ª JSON å¯¹è±¡å°†ä½œä¸º INPUT è¯·æ±‚çš„ä¸€éƒ¨åˆ†æˆ–ä½œä¸ºä¸€ä¸ªæ ‡è®°ä¼ é€’ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å°†ç”¨æˆ·å’Œå®¢æˆ·è®¾ç½®ä¸ºç›¸åŒçš„åå­—ï¼ˆä¾‹å¦‚ï¼ŒBobï¼‰æ¥æµ‹è¯•è¯¥ç­–ç•¥ã€‚è¯¥ç­–ç•¥åº”è¯¥è¿”å› trueã€‚å°†ç”¨æˆ·æ”¹ä¸º johnï¼ˆä»–æ˜¯è´¢åŠ¡éƒ¨é—¨çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œå¹¶æµ‹è¯•è¯¥ç­–ç•¥ã€‚åŒæ ·ï¼Œå®ƒåº”è¯¥è¿”å›çœŸã€‚æœ€åï¼Œå°†ç”¨æˆ·æ”¹ä¸ºä¸åœ¨è´¢åŠ¡éƒ¨é—¨å·¥ä½œçš„ä»»ä½•åå­—ï¼ˆæ¯”æ–¹è¯´ï¼Œjaneï¼‰ï¼Œè¯¥ç­–ç•¥åº”è¯¥è¿”å›é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://www.openpolicyagent.org/docs/latest/policy-language/&#34; title=&#34;å®˜æ–¹æ–‡æ¡£&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ï¼Œé˜…è¯»æ›´å¤šå…³äº Rego è¯­è¨€å’Œä½ èƒ½ç”¨å®ƒåšä»€ä¹ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;å°†-opa-ä¸å…¶ä»–ç³»ç»Ÿé›†æˆ&#34;&gt;å°† OPA ä¸å…¶ä»–ç³»ç»Ÿé›†æˆ&lt;/h2&gt;
&lt;p&gt;å¦‚å‰æ‰€è¿°ï¼ŒOPA å¯ä»¥ä¸å½“ä»Šçš„è®¸å¤šå¹³å°é›†æˆã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ OPA å¯ä»¥ä¸ºä½ åšä»€ä¹ˆçš„å‡ ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿å…¥å£ä¸»æœºååªç”±å‰ç«¯å›¢é˜Ÿæ”¹å˜ã€‚&lt;/li&gt;
&lt;li&gt;æ‹’ç»æ‹‰å–ä»»ä½•é•œåƒï¼Œé™¤äº†æ¥è‡ªä¼ä¸š Docker æ³¨å†Œä¸­å¿ƒçš„é•œåƒã€‚&lt;/li&gt;
&lt;li&gt;å¯¹é›†ç¾¤ä¸Šåˆ›å»ºçš„ä»»ä½• pod å¼ºåˆ¶ä½¿ç”¨è¯·æ±‚å’Œé™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;API æˆæƒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥å°† OPA ä¸ Envoyã€Istio å’Œå…¶ä»–å¹³å°ä¸€èµ·ä½¿ç”¨ï¼Œå¼ºåˆ¶æ‰§è¡Œ IAM æ§åˆ¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è½»æ¾æ§åˆ¶å®‰å…¨äººå‘˜å¯¹æ•æ„Ÿæ•°æ®çš„è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Linux PAM&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯æ’æ‹”è®¤è¯æ¨¡å—ï¼ˆPAMï¼‰é•¿æœŸä»¥æ¥ä¸€ç›´è¢«ç”¨äº Linuxï¼Œä¸ºåŒ…æ‹¬ SSH å’Œ sudo åœ¨å†…çš„å¤šç§æœåŠ¡æä¾›ç»†ç²’åº¦çš„æ§åˆ¶ã€‚OPA æœ‰ä¸€ä¸ª PAM æ’ä»¶ï¼Œä½¿å…¶èƒ½å¤Ÿä¸ PAM é›†æˆå¹¶æ‰§è¡Œç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é™åˆ¶ SSH å¯¹ä½ çš„ç”Ÿäº§æœºå™¨çš„è®¿é—®ï¼Œé™¤éåœ¨éå·¥ä½œæ—¶é—´ï¼Œæˆ–è€…é™¤éç”¨æˆ·æœ‰ä¸€ä¸ªæ”¯æŒå·¥å•ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰è®¸å¤šå…¶ä»–äº§å“å¯ä»¥ä¸ OPA é›†æˆï¼Œæä¾›æ— ç©·çš„å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼ŒKafkaã€ElasticSearchã€SQLite å’Œ CEPHï¼Œä»…ä¸¾å‡ ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¦‚è¦æ€»ç»“&#34;&gt;æ¦‚è¦æ€»ç»“&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æˆæƒçš„éœ€æ±‚å’Œè½¯ä»¶æœ¬èº«ä¸€æ ·å¤è€ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºç¼ºä¹ä¸€ä¸ªå¯ä»¥åœ¨ä¸åŒç³»ç»Ÿå’Œå¹³å°ä¹‹é—´ä½¿ç”¨çš„ä¸­å¤®æˆæƒç³»ç»Ÿï¼Œå¯¼è‡´äº†è®¸å¤šé—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒAPI å¯èƒ½æœ‰è‡ªå·±çš„æˆæƒé€»è¾‘å†…ç½®äºä»£ç ä¸­ï¼Œå…¶ä»–å¾®æœåŠ¡å¯èƒ½ä¾èµ–äºä¸€ä¸ªæˆ–å¤šä¸ªå¤–éƒ¨æˆæƒç³»ç»Ÿã€‚è¿™ä½¿å¾—æ¨å‡ºæ–°çš„ç­–ç•¥ï¼Œæ£€æŸ¥ç°æœ‰ç­–ç•¥çš„ç‰ˆæœ¬ï¼Œç”šè‡³å¼•å…¥å°çš„å˜åŒ–éƒ½æ˜¯éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§çš„æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;OPA å°±åƒä¸€ä¸ªæœåŠ¡é¡¾é—®ï¼Œä¸ºéœ€è¦çš„æœåŠ¡åšå‡ºæˆæƒå†³ç­–ã€‚æœåŠ¡å‘ OPA æå‡ºå†³ç­–æŸ¥è¯¢ï¼Œç„¶å OPA æ ¹æ®å·²ç»å­˜å‚¨åœ¨å…¶ä¸­çš„ç­–ç•¥å®¡æŸ¥æŸ¥è¯¢ï¼Œå¹¶ä½œå‡ºå†³ç­–å›åº”ã€‚&lt;/li&gt;
&lt;li&gt;OPA çš„è®¾è®¡æ˜¯é€šç”¨çš„ï¼Œä¸å¹³å°æ— å…³ã€‚å› æ­¤ï¼Œåœ¨å‘é€æŸ¥è¯¢æˆ–å®šä¹‰è¾“å‡ºçš„æ ·å­æ—¶ï¼Œä½ ä¸éœ€è¦éµå¾ªä»»ä½•è§„åˆ™ã€‚è¯·æ±‚å’Œå“åº”æ˜¯ä»¥ JSON æ ¼å¼å‘é€çš„ã€‚&lt;/li&gt;
&lt;li&gt;ç­–ç•¥å¯ä»¥ç”¨ Rego ç¼–å†™ï¼Œè¿™æ˜¯ä¸€ç§ä¸“é—¨ä¸º OPA è®¾è®¡çš„è¯­è¨€ã€‚ç±»ä¼¼äº JavaScriptï¼ŒOPA ä½¿å…¶éå¸¸å®¹æ˜“å°†çº¯è‹±è¯­è§„åˆ™è½¬æ¢ä¸ºæœ‰æ•ˆçš„ OPA ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;Rego playground å·¥å…·æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨å®æ–½ç­–ç•¥ä¹‹å‰å°è¯•ä½ çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;OPA å¯ä»¥ä½œä¸º Go åº“éƒ¨ç½²ï¼Œæˆä¸ºåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºç‹¬ç«‹çš„å®ˆæŠ¤ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºç­–ç•¥å†³ç­–å‘ç”Ÿåœ¨æ¯ä¸ª API è¯·æ±‚ä¸­ï¼Œå¼ºçƒˆå»ºè®®å°† OPA å®ˆæŠ¤ç¨‹åºå°½å¯èƒ½ç´§å¯†åœ°æ”¾åœ¨åº”ç”¨ç¨‹åºä¸­ã€‚ä¾‹å¦‚ï¼Œä½œä¸º Kubernetes pod ä¸­çš„ä¸€ä¸ª sidecar å®¹å™¨ï¼Œæˆ–è€…ä½œä¸ºä¸€ä¸ªè¿è¡Œåœ¨èŠ‚ç‚¹ä¸Šçš„å®ˆæŠ¤ç¨‹åºã€‚è¿™ç§åšæ³•æœ‰åŠ©äºå‡å°‘å»¶è¿Ÿå’Œå‡å°‘ç½‘ç»œæµé‡ã€‚&lt;/li&gt;
&lt;li&gt;OPA ä½¿ç”¨äº†è®¸å¤š APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ³¨å…¥æ–°ç­–ç•¥ï¼Œæ£€æŸ¥ç°æœ‰ç­–ç•¥çš„ç‰ˆæœ¬å’ŒçŠ¶æ€ï¼Œæˆ–æ”¶é›†å®¡è®¡å’Œæ—¥å¿—æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çœ‹äº†ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œå³å¦‚ä½•ä½¿ç”¨ Rego è¯­è¨€æ¥æ‰§è¡Œä¸€ä¸ªç­–ç•¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†é€šè¿‡ Rego è¯­è¨€å’Œ playground å·¥å…·æ¥æ‰§è¡Œä¸€ä¸ªå¤æ‚çš„ç­–ç•¥å¹¶å¯¹å…¶è¿›è¡Œæµ‹è¯•æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚&lt;/li&gt;
&lt;li&gt;OPA å¯ä»¥ä¸è®¸å¤šç°ä»£çš„ç³»ç»Ÿå’Œå¹³å°é›†æˆï¼Œå¦‚ Kubernetesã€Kafkaã€SQLiteã€CEPH å’Œ Terraformã€‚é€šè¿‡ PAM æ’ä»¶ï¼Œå®ƒè¿˜å¯ä»¥ä¸ Linux PAM é›†æˆï¼Œå¯¹ä½¿ç”¨ PAM çš„ Linux å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¦‚ sshd å’Œ sudoï¼‰å®æ–½é«˜çº§ç­–ç•¥æ§åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>RBAC vs ABACï¼Œä¸¤è€…æœ‰ä½•å¼‚åŒï¼Ÿ</title>
      <link>https://jimmysong.io/trans/rbac-vs-abac/</link>
      <pubDate>Fri, 25 Dec 2020 10:03:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/rbac-vs-abac/</guid>
      <description>
        
        
        &lt;p&gt;åœ¨ä»»ä½•å…¬å¸ï¼Œç½‘ç»œç”¨æˆ·å¿…é¡»ç»è¿‡è®¤è¯å’Œæˆæƒï¼Œæ‰èƒ½è®¿é—®ç³»ç»Ÿä¸­å¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´çš„éƒ¨åˆ†ã€‚è·å¾—æˆæƒçš„è¿‡ç¨‹ç§°ä¸ºè®¿é—®æ§åˆ¶ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å°†è®¨è®ºç®¡ç†ç³»ç»Ÿè®¿é—®æ§åˆ¶çš„ä¸¤ç§ä¸»è¦æ–¹æ³• â€”â€” åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰å’ŒåŸºäºå±æ€§çš„å­˜å–æ§åˆ¶ï¼ˆABACï¼‰å®ƒä»¬çš„å·®å¼‚ï¼Œä»¥åŠä½¿ç”¨è®¿é—®æƒé™ç®¡ç†å·¥å…·çš„é‡è¦æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è®¤è¯å’Œæˆæƒ&#34;&gt;è®¤è¯å’Œæˆæƒ&lt;/h2&gt;
&lt;p&gt;å®‰å…¨çš„ä¸¤ä¸ªåŸºæœ¬æ–¹é¢æ˜¯è®¤è¯å’Œæˆæƒã€‚åœ¨æ‚¨è¾“å…¥å‡­è¯ç™»å½•ç”µè„‘æˆ–ç™»å½•åº”ç”¨ç¨‹åºæˆ–è½¯ä»¶åï¼Œè®¾å¤‡æˆ–åº”ç”¨ç¨‹åºä¼šè¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»¥ç¡®å®šæ‚¨çš„æˆæƒçº§åˆ«ã€‚æˆæƒå¯èƒ½åŒ…æ‹¬æ‚¨å¯ä»¥ä½¿ç”¨å“ªäº›è´¦æˆ·ï¼Œæ‚¨å¯ä»¥è®¿é—®å“ªäº›èµ„æºï¼Œä»¥åŠå…è®¸æ‚¨æ‰§è¡Œå“ªäº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶rbacä¸åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶abac&#34;&gt;åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ä¸åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰&lt;/h2&gt;
&lt;p&gt;åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰å’ŒåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰æ˜¯æ§åˆ¶è®¤è¯è¿‡ç¨‹å’Œæˆæƒç”¨æˆ·çš„ä¸¤ç§æ–¹æ³•ã€‚RBAC å’Œ ABAC ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ RBAC åŸºäºç”¨æˆ·è§’è‰²æä¾›å¯¹èµ„æºæˆ–ä¿¡æ¯çš„è®¿é—®ï¼Œè€Œ ABAC åŸºäºç”¨æˆ·ã€ç¯å¢ƒæˆ–èµ„æºå±æ€§æä¾›è®¿é—®æƒé™ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œå½“è€ƒè™‘ RBAC ä¸ ABAC æ—¶ï¼ŒRBAC æ§åˆ¶æ•´ä¸ªç»„ç»‡çš„å¹¿æ³›è®¿é—®ï¼Œè€Œ ABAC åˆ™é‡‡å–ç»†ç²’åº¦çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-rbac&#34;&gt;ä»€ä¹ˆæ˜¯ RBACï¼Ÿ&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/rbac-vs-abac/0081Kckwly1gm04pyv4mtj30sg0ewgmd_hu_2ee186e6ec31f635.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/rbac-vs-abac/0081Kckwly1gm04pyv4mtj30sg0ewgmd.jpg&#34; data-img=&#34;/trans/rbac-vs-abac/0081Kckwly1gm04pyv4mtj30sg0ewgmd.jpg&#34; data-width=&#34;1000&#34; data-height=&#34;523&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;RBAC æ˜¯åŸºäºè§’è‰²çš„ï¼Œæ‰€ä»¥æ ¹æ®ä½ åœ¨ç»„ç»‡ä¸­çš„è§’è‰²è€Œæ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚è¿™æ˜¯ç”±ç®¡ç†å‘˜å†³å®šçš„ï¼Œç®¡ç†å‘˜ä¼šè®¾ç½®ä¸€ä¸ªè§’è‰²åº”è¯¥æ‹¥æœ‰çš„è®¿é—®æƒé™ï¼Œä»¥åŠç”¨æˆ·ä¸è§’è‰²çš„å¯¹åº”å…³ç³»ã€‚ä¾‹å¦‚ï¼Œæœ‰çš„ç”¨æˆ·å¯èƒ½è¢«åˆ†é…åˆ°ä¸€ä¸ªè§’è‰²ï¼Œå¯ä»¥ç¼–è¾‘ç‰¹å®šçš„æ–‡ä»¶ï¼Œè€Œå…¶ä»–ç”¨æˆ·å¯èƒ½è¢«é™åˆ¶åœ¨ä¸€ä¸ªè§’è‰²ä¸­ï¼Œåªèƒ½è¯»å–è¯¥æ–‡ä»¶è€Œä¸èƒ½ç¼–è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·ä¸è§’è‰²æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œè¿™ä½¿å¾—ç”¨æˆ·æ‹¥æœ‰å¯ä»¥è®¿é—®è®¸å¤šä¸åŒçš„æ–‡ä»¶æˆ–èƒ½åŠ›ã€‚æ¯”å¦‚è¯´æœ‰ä¸€ä¸ªå›¢é˜Ÿåœ¨åšä¸€ä¸ªå¤§å‹é¡¹ç›®ã€‚é¡¹ç›®ç»ç†å¯ä»¥è®¿é—®å’Œç¼–è¾‘æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè€Œå¼€å‘å›¢é˜Ÿå¯èƒ½åªè¢«å…è®¸è®¿é—®ä»£ç æ–‡ä»¶ï¼Œè€Œæ— æ³•çœ‹åˆ°æˆ–ç¼–è¾‘é¡¹ç›®çš„è´¢åŠ¡å’Œå‘˜å·¥ä¿¡æ¯ã€‚äººåŠ›èµ„æºæˆ–ç®¡ç†å›¢é˜Ÿå¯ä»¥è®¿é—®æ‰€æœ‰çš„å‘˜å·¥å’Œè´¢åŠ¡ä¿¡æ¯ï¼Œè€Œä¸èƒ½è®¿é—®ç¼–ç¨‹æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç»„ç»‡å¯èƒ½ä¼šå°† RBAC ç”¨äºè¿™æ ·çš„é¡¹ç›®ï¼Œå› ä¸ºæœ‰äº† RBACï¼Œä¸éœ€è¦åœ¨æ¯æ¬¡ä¸€æœ‰äººç¦»èŒæˆ–æ›´æ¢å²—ä½æ—¶éƒ½è¿›è¡Œæ›´æ”¹ï¼šä»–ä»¬å¯ä»¥ç®€å•åœ°ä»è§’è‰²ç»„ä¸­åˆ é™¤æˆ–åˆ†é…ä¸€ä¸ªæ–°çš„è§’è‰²ã€‚è¿™ä¹Ÿæ„å‘³ç€æ–°å‘˜å·¥å¯ä»¥æ ¹æ®ä»–ä»¬æ‰€å±¥è¡Œçš„ç»„ç»‡è§’è‰²ï¼Œç›¸å¯¹å¿«é€Ÿåœ°è¢«æˆäºˆè®¿é—®æƒé™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-abac&#34;&gt;ä»€ä¹ˆæ˜¯ ABACï¼Ÿ&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/trans/rbac-vs-abac/0081Kckwly1gm04qu9t1ej30sg0ewq3m_hu_ea2e9a452b2fb2bf.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/trans/rbac-vs-abac/0081Kckwly1gm04qu9t1ej30sg0ewq3m.jpg&#34; data-img=&#34;/trans/rbac-vs-abac/0081Kckwly1gm04qu9t1ej30sg0ewq3m.jpg&#34; data-width=&#34;1000&#34; data-height=&#34;523&#34; alt=&#34;image&#34; data-caption=&#34;&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
&lt;/figure&gt;
&lt;p&gt;åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶åˆ©ç”¨äº†ä¸€ç»„ç§°ä¸ºâ€œå±æ€§â€œçš„ç‰¹å¾ã€‚è¿™åŒ…æ‹¬&lt;strong&gt;ç”¨æˆ·å±æ€§&lt;/strong&gt;ã€&lt;strong&gt;ç¯å¢ƒå±æ€§&lt;/strong&gt;å’Œ&lt;strong&gt;èµ„æºå±æ€§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·å±æ€§åŒ…æ‹¬ç”¨æˆ·çš„å§“åã€è§’è‰²ã€ç»„ç»‡ã€ID å’Œå®‰å…¨è®¸å¯ç­‰å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;ç¯å¢ƒå±æ€§åŒ…æ‹¬è®¿é—®æ—¶é—´ã€æ•°æ®çš„ä½ç½®å’Œå½“å‰ç»„ç»‡çš„å¨èƒç­‰çº§ã€‚&lt;/li&gt;
&lt;li&gt;èµ„æºå±æ€§åŒ…æ‹¬è¯¸å¦‚åˆ›å»ºæ—¥æœŸã€èµ„æºæ‰€æœ‰è€…ã€æ–‡ä»¶åå’Œæ•°æ®æ•æ„Ÿæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åŸºæœ¬ä¸Šï¼ŒABAC æ¯” RBAC æœ‰æ›´å¤šå¯èƒ½çš„æ§åˆ¶å˜é‡ã€‚ABAC çš„å®æ–½æ˜¯ä¸ºäº†é™ä½å› æœªç»æˆæƒçš„è®¿é—®è€Œäº§ç”Ÿçš„é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨æ›´ç»†ç²’åº¦åœ°æ§åˆ¶å®‰å…¨å’Œè®¿é—®ã€‚ä¾‹å¦‚ï¼ŒABAC å¯ä»¥å¯¹ä»–ä»¬çš„è®¿é—®è¿›è¡Œè¿›ä¸€æ­¥çš„é™åˆ¶ï¼Œæ¯”å¦‚åªå…è®¸åœ¨ç‰¹å®šçš„æ—¶é—´æˆ–ä¸ç›¸å…³å‘˜å·¥ç›¸å…³çš„æŸäº›åˆ†æ”¯æœºæ„è¿›è¡Œè®¿é—®ï¼Œè€Œä¸æ˜¯è®©äººåŠ›èµ„æºéƒ¨é—¨çš„äººå‘˜æ€»æ˜¯èƒ½å¤Ÿè®¿é—®å‘˜å·¥å’Œå·¥èµ„ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥å‡å°‘å®‰å…¨é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©ä»¥åçš„å®¡è®¡è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;rbac-ä¸-abac-çš„æ¯”è¾ƒ&#34;&gt;RBAC ä¸ ABAC çš„æ¯”è¾ƒ&lt;/h3&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ RBAC å°±è¶³å¤Ÿäº†ï¼Œåº”è¯¥åœ¨è®¾ç½® ABAC ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨å®ƒã€‚è¿™ä¸¤ä¸ªè®¿é—®æ§åˆ¶è¿‡ç¨‹éƒ½æ˜¯è¿‡æ»¤å™¨ï¼ŒABAC æ˜¯ä¸¤ä¸ªè¿‡ç¨‹ä¸­æ¯”è¾ƒå¤æ‚çš„ï¼Œéœ€è¦æ›´å¤šçš„å¤„ç†èƒ½åŠ›å’Œæ—¶é—´ã€‚å¦‚æœä½ ä¸éœ€è¦ï¼Œå°±æ²¡æœ‰å¿…è¦ä½¿ç”¨è¿™ç§æ›´å¼ºå¤§çš„è¿‡æ»¤å™¨ â€”â€” è¿™ä¼šäº§ç”Ÿç›¸åº”çš„èµ„æºæˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;æ— è®ºå“ªç§æ–¹å¼ï¼Œä½¿ç”¨æœ€å°‘æ•°é‡çš„ RBAC å’Œ ABAC è¿‡æ»¤å™¨æ¥æ„å»ºä½ çš„è®¿é—®å’Œå®‰å…¨ç¯å¢ƒæ˜¯å¾ˆé‡è¦çš„ã€‚å®ƒå¯ä»¥å¸®åŠ©ä»”ç»†è§„åˆ’ä½ çš„ç›®å½•æ•°æ®å’Œè®¿é—®æ–¹æ³•ï¼Œä»¥ç¡®ä¿ä½ æ²¡æœ‰ä½¿ç”¨ä¸å¿…è¦çš„è¿‡æ»¤å™¨æˆ–ä½¿äº‹æƒ…è¿‡äºå¤æ‚ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒRBAC å’Œ ABAC å¯ä»¥åˆ†çº§åœ°ä¸€èµ·ä½¿ç”¨ï¼Œå¹¿æ³›çš„è®¿é—®ç”± RBAC åè®®æ‰§è¡Œï¼Œæ›´å¤æ‚çš„è®¿é—®ç”± ABAC ç®¡ç†ã€‚è¿™æ„å‘³ç€ç³»ç»Ÿå°†é¦–å…ˆä½¿ç”¨ RBAC æ¥ç¡®å®šè°å¯ä»¥è®¿é—®ä¸€ä¸ªèµ„æºï¼Œç„¶åç”± ABAC æ¥ç¡®å®šä»–ä»¬å¯ä»¥å¯¹èµ„æºåšä»€ä¹ˆä»¥åŠä½•æ—¶å¯ä»¥è®¿é—®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨è®¿é—®ç®¡ç†å·¥å…·&#34;&gt;ä½¿ç”¨è®¿é—®ç®¡ç†å·¥å…·&lt;/h2&gt;
&lt;p&gt;æ— è®ºä½ æ˜¯ä½¿ç”¨ RBAC è¿˜æ˜¯ ABACï¼Œæˆ–è€…æ˜¯ä¸¤è€…çš„ç»“åˆï¼Œæˆ‘éƒ½å¼ºçƒˆå»ºè®®ä½¿ç”¨è®¿é—®æƒé™ç®¡ç†å·¥å…·ã€‚ä¸€ä¸ªå¥½çš„å·¥å…·å¯ä»¥ç®€åŒ–è®¾ç½®å¹¶å‡å°‘è®¾ç½®å’Œç®¡ç†è¿‡æ»¤å™¨æ‰€æ¶‰åŠçš„ç®¡ç†è´¹ç”¨ã€‚å½“æ¶‰åŠåˆ°å®‰å…¨é—®é¢˜æ—¶ï¼Œè®¤çœŸè§„åˆ’å’Œç›‘æ§æ‚¨çš„è®¿é—®æ§åˆ¶æµç¨‹æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½¿ç”¨å¼ºå¤§çš„è®¿é—®ç®¡ç†å·¥å…·æ¥å¸®åŠ©æ‚¨è®¾ç½®è®¿é—®æ§åˆ¶ï¼Œå¹¶å®šæœŸå®¡æŸ¥æ‚¨çš„è®¾ç½®ï¼Œä»¥ç¡®ä¿å®ƒä»ç„¶ç¬¦åˆæ‚¨çš„ç»„ç»‡éœ€æ±‚ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰å­˜åœ¨çš„é—®é¢˜</title>
      <link>https://jimmysong.io/trans/problem-with-rbac/</link>
      <pubDate>Fri, 25 Dec 2020 10:03:00 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/trans/problem-with-rbac/</guid>
      <description>
        
        
        &lt;p&gt;ç›´åˆ°æœ€è¿‘ï¼Œæœ€æµè¡Œçš„æˆæƒæ–¹æ³•æ˜¯åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ã€‚è¿™ç§è§£å†³æ–¹æ¡ˆæ¶‰åŠåˆ°åˆ›å»ºä¸€å¥—è§’è‰²ï¼Œå®šä¹‰ç»„ç»‡å†…æ‰€æœ‰çš„å·¥ä½œæè¿°å’ŒåŠŸèƒ½ï¼Œç„¶åç»™ç”¨æˆ·åˆ†é…è§’è‰²ï¼Œå†³å®šä»–ä»¬å¯ä»¥è®¿é—®çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶ã€ç½‘ç»œã€åº”ç”¨ç¨‹åºã€ç½‘é¡µä¸Šçš„ä¸€ä¸ªå­—æ®µï¼‰ï¼Œä»¥åŠä»–ä»¬å¯ä»¥æ‰§è¡Œçš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½¿ç”¨ RBAC æ—¶ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ§åˆ¶ç”¨æˆ·å¯ä»¥å¯¹ç‰¹å®šçš„ IT èµ„æºåšä»€ä¹ˆï¼Œä»¥åŠä»–ä»¬å¯ä»¥è®¿é—®å“ªäº›åŒºåŸŸã€‚å®ƒçš„å®ç°å¾ˆç®€å•ï¼Œå› ä¸ºåªæœ‰ä¸‰ä¸ªåŸºæœ¬åŸåˆ™éœ€è¦ç‰¢è®°ï¼Œè§’è‰²æ˜¯åŸºäºâ€œè§’è‰²åˆ†é…â€ã€â€œè§’è‰²æˆæƒâ€œå’Œâ€œæƒé™æˆæƒâ€œçš„ã€‚ç„¶è€Œï¼ŒRBAC å¹¶éæ²¡æœ‰é—®é¢˜å’Œå±€é™æ€§ã€‚å…¶ä¸­ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨çš„è¿‡ç¨‹ï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦è¿›è¡Œè‰°è‹¦çš„ç®¡ç†ï¼Œå¹¶ä¸”ç»å¸¸æ¶‰åŠå¤§é‡çš„äººå·¥å¹²é¢„ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå‡è®¾ä½ çš„ç»„ç»‡ç»“æ„å›¾å·²ç»å’Œä½ çš„å‘˜å·¥åå•ä»¥åŠä»–ä»¬çš„å¤´è¡”ä¸€èµ·æœ€ç»ˆç¡®å®šï¼Œä½ å·²ç»å‡†å¤‡å¥½æ¨å‡ºä½ çš„ RBAC è®¡åˆ’ã€‚ä½ å·²ç»æŠŠæ‰€æœ‰çš„è§’è‰²æ‘†åœ¨ä½ é¢å‰ï¼Œä½ å¾ˆè‡ªä¿¡ï¼Œä»–ä»¬éƒ½æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œå¹¶ä¸”æœ‰æ­£ç¡®çš„æ±‡æŠ¥çº¿å’Œæ§åˆ¶èŒƒå›´ã€‚çªç„¶é—´ï¼Œå¸‚åœºéƒ¨å‰¯æ€»è£æåˆ°ï¼Œä»–ä»¬éƒ¨é—¨é‡Œæœ‰ä¸€äº›äººéœ€è¦è®¿é—®æŸäº›èµ„æºã€å…±äº«æ–‡ä»¶å¤¹å’Œä¸“é—¨çš„åº”ç”¨ç¨‹åºï¼Œè€Œè¿™äº›èµ„æºå’Œåº”ç”¨ç¨‹åºåªæœ‰å…¶ä»–éƒ¨é—¨çš„è§’è‰²æ‰èƒ½ä½¿ç”¨ã€‚ä½ ä¸èƒ½å¯¹å‰¯æ€»è£è¯´â€œä¸â€ï¼Œæ‰€ä»¥ä½ æ£€æŸ¥å·²æœ‰çš„æ˜ å°„ï¼Œå¹¶è¯•å›¾æ‰¾åˆ°ä¸€ç»„é¢å¤–çš„ç¬¦åˆè¦æ±‚çš„è§’è‰²ã€‚ä½†è¿™å¹¶ä¸å®¹æ˜“ï¼Œå› ä¸ºæ²¡æœ‰å®Œå…¨åŒ¹é…çš„è§’è‰²ã€‚é‚£ä¹ˆä½ è¦åšä»€ä¹ˆå‘¢ï¼Ÿåˆ›å»ºä¸€ä¸ªé¢å¤–çš„è§’è‰²ï¼Œç„¶åæŠŠå®ƒåº”ç”¨åˆ°æ‰€æœ‰æœ‰ç±»ä¼¼éœ€æ±‚çš„å‘˜å·¥èº«ä¸Šå°±è¡Œäº†ï¼Ÿé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½æ˜¯ä½ å”¯ä¸€çš„é€‰æ‹©ï¼Œå› ä¸ºæ ¹æ®å†…éƒ¨å®‰å…¨æ”¿ç­–ï¼Œæ‹†åˆ†ç°æœ‰è§’è‰²å¯èƒ½æ˜¯ä¸¥æ ¼ç¦æ­¢çš„ï¼Œå› ä¸ºè¿™æ ·åšä¼šå‰Šå¼± RBAC æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;RBAC åœ¨ç®¡ç†ç”¨æˆ·èº«ä»½å’Œè®¿é—®æƒé™ä¸Šå­˜åœ¨æ ¹æœ¬æ€§ç¼ºé™·ã€‚å…¶å›ºæœ‰çš„å¼±ç‚¹åœ¨äºå®ƒçš„ç¬¨é‡æ€§ã€å¯¹äººå·¥è¾“å…¥çš„ä¾èµ–æ€§ä»¥åŠéœ€è¦æŒç»­ç»´æŠ¤ã€‚åŠ¨æ€çš„ç»„ç»‡éœ€è¦åŠ¨æ€çš„è®¿é—®æ§åˆ¶ã€‚æ‰€æœ‰è¿™äº›å› ç´ ç»“åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€ä¸ªä¸å®‰å…¨çš„ IAM ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;â€œå¤§å¤šæ•°åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶é¡¹ç›®å¤±è´¥çš„åŸå› æ˜¯ç¼ºä¹åŸºç¡€ï¼Œâ€œPeaceHealth çš„ Christopher Paidhrin è¯´ã€‚â€œæ¯ä¸ªç»„ç»‡éƒ½éœ€è¦è¯„ä¼°ä»–ä»¬æ˜¯å¦ä¸ºåŸºäºè§’è‰²çš„è®¿é—®åšå¥½äº†å‡†å¤‡ã€‚æœ‰æ•ˆçš„åŸºäºè§’è‰²çš„è®¿é—®ç®¡ç†éœ€è¦åšå¾ˆå¤šå·¥ä½œï¼Œåœ¨èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†ä¹‹å‰ï¼Œè¿˜æœ‰å¾ˆå¤šå·¥ä½œéœ€è¦è¿›å…¥åˆ†æè¿‡ç¨‹â€ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹ RBAC çš„ä¸»è¦æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜-1è§’è‰²çˆ†ç‚¸&#34;&gt;é—®é¢˜ 1ï¼šè§’è‰²çˆ†ç‚¸&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¥é”€å‰¯æ€»è£çš„è®¿é—®è¯·æ±‚åœºæ™¯å¬èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Œé‚£æ˜¯å› ä¸ºå®ƒç»å¸¸å‘ç”Ÿã€‚å½“æ‚¨çš„è®¿é—®æ§åˆ¶æ‰€éœ€çš„é¢—ç²’åº¦è¿‡äºè¯¦ç»†æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè§’è‰²çˆ†ç‚¸ã€‚è§’è‰²çˆ†ç‚¸å¾ˆéš¾ç®¡ç†ï¼Œæˆæœ¬å¾ˆé«˜ï¼Œå¹¶ä¸”ä½¿è®¿é—®æ§åˆ¶å˜å¾—æ··ä¹±å’Œå¤æ‚ï¼Œé™ä½äº†è®¿é—®æ§åˆ¶çš„æœ‰æ•ˆæ€§ã€‚æ­¤å¤–ï¼Œå½“åœ¨ä½ çš„è®¿é—®æ§åˆ¶éƒ¨ç½²ä¸­æ·»åŠ æ›´å¤šçš„è§’è‰²æ—¶ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é—®é¢˜éœ€è¦ä»”ç»†ç›‘æ§ã€‚å…¶ä¸­ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“ä¸€ä¸ªç”¨æˆ·è¢«åˆ†é…äº†å¤ªå¤šçš„è§’è‰²ï¼Œç„¶ååœ¨å…¬å¸å†…éƒ¨æ”¹å˜äº†å·¥ä½œæˆ–èŒè´£æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚IT ç³»ç»Ÿç®¡ç†å‘˜è¦ä¹ˆå¿˜è®°äº†ï¼Œè¦ä¹ˆç”šè‡³æœ‰æ„è¯†åœ°å†³å®šå°†æ—§è§’è‰²ç•™åœ¨åŸåœ°ã€‚è§’è‰²çš„æ•°é‡ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ï¼Œè€Œè¿™äº›æ¼æ´å¾€å¾€éš¾ä»¥å‘ç°å’Œå¼¥è¡¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜-2å®‰å…¨é£é™©æ‰¿å—èƒ½åŠ›&#34;&gt;é—®é¢˜ 2ï¼šå®‰å…¨é£é™©æ‰¿å—èƒ½åŠ›&lt;/h2&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ï¼Œäº†è§£ç³»ç»Ÿçš„é£é™©æ˜¯å¾ˆé‡è¦çš„ã€‚è¿›è¡Œå®‰å…¨é£é™©åˆ†æï¼Œå¹¶åˆ¶å®šç§¯æçš„é£é™©é˜²èŒƒè®¡åˆ’ï¼Œå¯¹ RBAC çš„éƒ¨ç½²è‡³å…³é‡è¦ã€‚RBAC æ˜¯ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„ï¼›æ•°æ®è¢«å½’ç±»ä¸ºä¸ç»„ç»‡ç»“æ„ç›¸å…³çš„æ•°æ®ï¼Œè¿™å°±å¯¼è‡´äº†è®¿é—®æ§åˆ¶è§’è‰²çš„å®šä¹‰ã€‚å¦‚æœä½ çš„ç»„ç»‡å¯¹å®‰å…¨é£é™©æ˜¯è¢«åŠ¨çš„ï¼ŒRBAC å¯èƒ½ä¸æ˜¯ä¿éšœç½‘ç»œæ•°æ®è®¿é—®å®‰å…¨çš„æœ€ä½³æ–¹å¼ã€‚&lt;strong&gt;RBAC è¦æ±‚ä½ åœ¨éƒ¨ç½²å‰å¯¹å…¬å¸çš„å®‰å…¨å¸ƒå±€å’Œæƒé™æˆäºˆæ–¹å¼æœ‰æ·±å…¥çš„äº†è§£ã€‚&lt;/strong&gt; ä¸€æ—¦éƒ¨ç½²åï¼Œå¾ˆéš¾å¯¹ä¸æ–­å˜åŒ–çš„å®‰å…¨å¨èƒå’Œé£é™©åšå‡ºååº”ã€‚å› æ­¤ï¼Œè¦å°å¿ƒè°¨æ…ï¼Œå¹¶å¯¹æ‚¨çš„ RBAC æ”¿ç­–è¿›è¡Œâ€œä¸¤æ¬¡æµ‹é‡ï¼Œä¸€æ¬¡åˆ‡å‰²â€ã€‚åœ¨ä¸€ä¸ªç”±äºæ•°æ®éšç§å’Œä¿æŠ¤æ³•è§„ä¸æ–­å˜åŒ–è€Œå¯¹å®‰å…¨æœ‰æ•ˆæ€§è¿›è¡Œæ›´ä¸¥æ ¼å®¡æŸ¥çš„æ—¶ä»£ï¼Œè¿™ç§å®‰å…¨æ¨¡å¼çš„æ·¡åŒ–å¤§å¤§å¢åŠ äº†æ•°æ®æ³„éœ²çš„é£é™©ï¼Œåœ¨è´¢åŠ¡å’Œå£°èª‰ä¸Šéƒ½ä¼šäº§ç”Ÿé‡å¤§åæœã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜-3å¯æ‰©å±•æ€§å’ŒåŠ¨æ€æ€§&#34;&gt;é—®é¢˜ 3ï¼šå¯æ‰©å±•æ€§å’ŒåŠ¨æ€æ€§&lt;/h2&gt;
&lt;p&gt;æ˜¯çš„ï¼Œåœ¨ RBAC éƒ¨ç½²ä¹‹åˆï¼Œä½ æ¸…æ¥šåœ°çŸ¥é“ä½ éœ€è¦å®šä¹‰å“ªäº›è§’è‰²ï¼Œä»¥åŠéœ€è¦å°†å®ƒä»¬åˆ†é…ç»™è°ã€‚ä½†æ˜¯ï¼Œç°åœ¨å·²ç»è¿‡äº†ä¸€å¹´ï¼Œç»„ç»‡å·²ç»æˆé•¿äº†ã€‚æ›´å¤šçš„äººåŠ å…¥äº†å…¬å¸ï¼Œåœ¨åŒ†åŒ†å¿™å¿™çš„å…¥èŒè¿‡ç¨‹ä¸­ï¼Œç»„ç»‡ç»“æ„å›¾å’Œå·¥ä½œå®šä¹‰æ²¡æœ‰å¾—åˆ°æ›´æ–°æˆ–æ˜ç¡®å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ RBAC éš¾ä»¥ç»´æŠ¤å’Œç®¡ç†çš„åœ°æ–¹ã€‚è¿™äº›â€œæ­»è§’â€œé™åˆ¶äº†ä½ çš„éƒ¨ç½²çš„å¯æ‰©å±•æ€§ï¼Œå¯èƒ½éœ€è¦é‡æ–°è®¾è®¡æ‰èƒ½å›åˆ°æ­£è½¨ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œç”±äºæ½œåœ¨çš„æ—¶é—´å‹åŠ›ï¼Œä½ å¯èƒ½éœ€è¦å®æ–½ä¸€ä¸ªâ€œå˜é€šâ€œçš„è§£å†³æ–¹æ¡ˆï¼Œä»é•¿è¿œæ¥çœ‹ï¼Œå®ƒå¯èƒ½ä¼šåŠ©é•¿é—®é¢˜ï¼Œè€Œä¸æ˜¯çº æ­£å®ƒã€‚å‡ ä¹å°±åƒä¸€ä¸ª IAM whac-a-mole æ¸¸æˆï¼Œä½ è¦ä¸æ–­è§£å†³æ–°çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ›´å¤šçš„æ—¶å€™æ˜¯æ¯ä¸¤åˆ°ä¸‰å¹´ä¸€æ¬¡çš„é‡å¤§è¿”å·¥å‘¨æœŸï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæ˜¯ä¸ºäº†å¼¥è¡¥è§’è‰²åˆ†ç±»å­¦ç¼ºä¹å¢é‡ç®¡ç†ï¼Œä»¥ç¬¦åˆç»„ç»‡ç»“æ„çš„å˜åŒ–éœ€æ±‚ï¼Œè€Œç»„ç»‡ç»“æ„ä»ç„¶æ˜¯åŠ¨æ€çš„ã€ååº”æ€§çš„ï¼Œå› ä¸ºå®ƒå¿…é¡»å¯¹å®¢æˆ·çš„éœ€æ±‚å’Œæ•°å­—ä¸–ç•Œä¸­æ›´æ•æ·çš„ä¸šåŠ¡æ¨¡å¼åšå‡ºååº”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜-4æˆæœ¬é«˜å®æ–½éš¾&#34;&gt;é—®é¢˜ 4ï¼šæˆæœ¬é«˜ã€å®æ–½éš¾&lt;/h2&gt;
&lt;p&gt;æ‚¨çš„å…¬å¸å·²ç»ä½¿ç”¨è®¡ç®—æœºå¹¶æ”¶é›†æ•°æ®å¾ˆé•¿æ—¶é—´äº†ï¼Œä½†ä»æœªçœŸæ­£éœ€è¦ä»»ä½•å½¢å¼çš„è®¿é—®æ§åˆ¶ä½œä¸ºç»„ç»‡å®‰å…¨æ”¿ç­–çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ éœ€è¦å µä½æ¼æ´ï¼Œå¹¶å†³å®šé‡‡ç”¨ RBACï¼Œä½ å¯èƒ½ä¼šå‘ç°éœ€è¦å¤åˆ¶æœåŠ¡å™¨å’Œå…¶ä»–æ”¯æŒ RBAC çš„åŸºç¡€è®¾æ–½ï¼Œæˆæœ¬è¿‡é«˜ï¼Œå¢åŠ äº†å¤æ‚æ€§ã€‚ä½ è¿˜éœ€è¦è€ƒè™‘åœ¨æ·˜æ±°æ—§ç³»ç»Ÿçš„åŒæ—¶å°†ç”¨æˆ·è¿ç§»åˆ°æ–°ç³»ç»Ÿçš„æˆæœ¬å’Œé£é™©ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿ç§»ä¼šé‡åˆ°å„ç§å›°éš¾å’Œä¸å¯é¢„è§çš„æŒ‘æˆ˜ï¼Œå¹¶å¯¼è‡´ä¸¤ä¸ªç³»ç»Ÿä¸­çš„å®‰å…¨æ¼æ´ä»¥åŠå…¶ä»–ä»£ä»·é«˜æ˜‚çš„ç¼ºé™·ï¼Œå¦‚è®¡åˆ’å¤–åœæœºå’Œæ•°æ®ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›†æˆ-rbacå®ç°ç¨³å¥çµæ´»çš„è®¿é—®æ§åˆ¶&#34;&gt;é›†æˆ RBACï¼Œå®ç°ç¨³å¥çµæ´»çš„è®¿é—®æ§åˆ¶&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ ä»æ¥æ²¡æœ‰è®¡åˆ’é‡æ–°åˆ†é…å‘˜å·¥æˆ–ä¸åˆä½œä¼™ä¼´åˆä½œï¼ŒRBAC æœ¬èº«å°±æ˜¯ä¸€ç§ç®¡ç†æ•°æ®å’Œç³»ç»Ÿèµ„æºè®¿é—®çš„å¥½æ–¹æ³•ã€‚ç„¶è€Œï¼Œæ²¡æœ‰ä¸€ä¸ªç»„ç»‡ç»“æ„æ˜¯ä¸€æˆä¸å˜çš„ï¼Œè¿™ä½¿å¾— RBAC æ–¹æ³•åœ¨ä¸€ä¸ªåŠ¨æ€çš„å•†ä¸šç¯å¢ƒä¸­å˜å¾—å¾ˆéº»çƒ¦ã€‚æˆ‘ä»¬ç»å¸¸çœ‹åˆ°å…¬å¸åœ¨ä»–ä»¬çš„äººåŠ›èµ„æºç³»ç»Ÿã€Active Directory å’Œ IGA ä¹‹é—´å»ºç«‹é›†æˆï¼Œä»¥å®ç°åŒæ­¥çš„è§’è‰²åˆ›å»ºå’ŒæŒç»­çš„è§’è‰²ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚è¿™äº›é›†æˆä¸ä»…æ˜‚è´µï¼Œè€Œä¸”è„†å¼±ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œæœ€ç»ˆä¸èƒ½äº§ç”Ÿé¢„æœŸçš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¹¶éæ‰€æœ‰çš„å¸Œæœ›éƒ½è½ç©ºäº†ã€‚å°† RBAC ä¸å…¶ä»–ç±»å‹çš„è®¿é—®æ§åˆ¶æ–¹æ³•é›†æˆï¼Œå¯ä»¥è®©æ‚¨åˆ›å»ºä¸€ä¸ªå¼ºå¤§çš„ã€ç²¾ç»†çš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚&lt;/p&gt;

      </description>
    </item>
                           
    <item>
      <title>ä½¿ç”¨ GitHub Webhook å®ç°é™æ€ç½‘ç«™è‡ªåŠ¨åŒ–éƒ¨ç½²</title>
      <link>https://jimmysong.io/blog/github-webhook-website-auto-deploy/</link>
      <pubDate>Wed, 10 Jul 2019 13:13:15 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/github-webhook-website-auto-deploy/</guid>
      <description>
        
        
        &lt;p&gt;æœ¬æ–‡ä»‹ç»å¦‚ä½•ä¸º &lt;code&gt;servicemesher.com&lt;/code&gt; ç½‘ç«™é…ç½®è‡ªåŠ¨åŒ–éƒ¨ç½²çš„è¯¦ç»†è¯´æ˜ï¼Œé€šè¿‡æœ¬æ–‡ä½ å°†äº†è§£åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ä½¿ç”¨ GitHub Webhook æ¥è‡ªåŠ¨åŒ–å‘å¸ƒæ‚¨çš„ç½‘ç«™&lt;/li&gt;
&lt;li&gt;å¦‚ä½•é…ç½® Nginx ä»£ç†æ ¹æ® URI è¯·æ±‚è½¬å‘åˆ°æœ¬åœ°æœåŠ¡å™¨çš„æŒ‡å®šç«¯å£&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è‡ªåŠ¨å‘å¸ƒè„šæœ¬&#34;&gt;è‡ªåŠ¨å‘å¸ƒè„šæœ¬&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨åä¸º &lt;code&gt;deploy.sh&lt;/code&gt; çš„ Shell è„šæœ¬ç¼–è¯‘ Hugo ç”Ÿæˆ HTML æ–‡ä»¶ï¼Œå¹¶æ”¾åˆ° Nginx é…ç½®çš„ç›®å½•ä¸‹ã€‚è¯¥è„šæœ¬ä½äº &lt;a href=&#34;https://github.com/servicemesher/website&#34; title=&#34;ServiceMesher å®˜ç½‘ GitHub ä»“åº“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ServiceMesher å®˜ç½‘ GitHub ä»“åº“&lt;/a&gt;åŒçº§ç›®å½•ä¸‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ç½‘ç«™çš„ä»£ç ä»“åº“ç›®å½•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;website&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nginx ä¸­é…ç½®çš„ç½‘ç«™çš„ HTML æ ¹ç›®å½•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/home/admin/servicemesher.com&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git pull
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hugo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp -r &lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;/public/* &lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¾èµ–å®‰è£…&#34;&gt;ä¾èµ–å®‰è£…&lt;/h2&gt;
&lt;p&gt;è¯¥ç½‘ç«™éƒ¨ç½²åœ¨é˜¿é‡Œäº‘ä¸Šï¼Œæ“ä½œç³»ç»Ÿä¸º CentOS 7.6.1810ï¼Œå¹¶é…ç½®å¥½äº† &lt;a href=&#34;https://jimmysong.io/posts/free-certificates-with-certbot&#34; title=&#34;HTTPS&#34;&gt;HTTPS&lt;/a&gt;	ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…åç«¯æœåŠ¡é…ç½®æ‰€éœ€çš„ç»„ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;yum install -y npm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®‰è£… NPM åŒ…ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;npm i -S github-webhook-handler
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;npm i -g pm2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ›å»º-webhook-æœåŠ¡åç«¯&#34;&gt;åˆ›å»º webhook æœåŠ¡åç«¯&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ NodeJS åˆ›å»º webhook æœåŠ¡åç«¯ï¼Œåç«¯ä»£ç ä¿å­˜åœ¨ &lt;code&gt;webhook.js&lt;/code&gt;æ–‡ä»¶ä¸­ï¼Œè°ƒç”¨ &lt;code&gt;deploy.sh&lt;/code&gt; æ¥å‘å¸ƒï¼Œå› æ­¤éœ€è¦ä¸ &lt;code&gt;deploy.sh&lt;/code&gt; æ–‡ä»¶åœ¨åŒä¸€çº§ç›®å½•ä¸­ï¼Œç›‘å¬ &lt;code&gt;http://127.0.0.1:6666/webhook&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å½“å‰çš„æ‰€æœ‰æ–‡ä»¶çš„ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ ls -1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;deploy.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node_modules
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;package.json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sofastack.tech
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;webhook.js
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;webhook.js&lt;/code&gt; æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;spawn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;child_process&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;createHandler&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;github-webhook-handler&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ³¨æ„å°† secret ä¿®æ”¹ä½ è‡ªå·±çš„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;createHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/webhook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;secret&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;yourwebhooksecret&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusCode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;no such location&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6666&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;push&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Received a push event for %s to %s&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;repository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;runCommand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./deploy.sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;txt&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;txt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;runCommand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;child&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;resp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Deploy OK&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;child&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;buffer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;){&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;resp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;child&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;end&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;resp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ &lt;code&gt;webhook.js&lt;/code&gt; æ‰€åœ¨ç›®å½•ä¸‹å¯åŠ¨åç«¯æœåŠ¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pm2 start webhook.js
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ pm2 status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”‚ App name â”‚ id â”‚ version â”‚ mode â”‚ pid   â”‚ status â”‚ restart â”‚ uptime â”‚ cpu â”‚ mem       â”‚ user â”‚ watching â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”‚ webhook  â”‚ &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  â”‚ 1.0.0   â”‚ fork â”‚ &lt;span class=&#34;m&#34;&gt;30366&lt;/span&gt; â”‚ online â”‚ &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;       â”‚ 6h     â”‚ 0%  â”‚ 30.8 MB   â”‚ root â”‚ disabled â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; Use &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;pm2 show &amp;lt;id&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;name&amp;gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; to get more details about an app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;pm2 logs webhook&lt;/code&gt; å¯ä»¥æŸ¥çœ‹åç«¯æœåŠ¡æ—¥å¿—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;nginx-é…ç½®&#34;&gt;Nginx é…ç½®&lt;/h2&gt;
&lt;p&gt;åœ¨ nginx é…ç½®ä¸­å¢åŠ è½¬å‘è®¾ç½®ï¼Œå°†å¯¹ç½‘ç«™ &lt;code&gt;/webhook&lt;/code&gt; URI çš„è®¿é—®è½¬å‘åˆ°æœåŠ¡å™¨æœ¬åœ°çš„ 6666 ç«¯å£ï¼Œå³ webhook åç«¯æœåŠ¡å•†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# GitHub auto deploy webhook&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        location /webhook &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            proxy_pass http://127.0.0.1:6666&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;github-webhook-é…ç½®&#34;&gt;GitHub Webhook é…ç½®&lt;/h2&gt;
&lt;p&gt;åœ¨ GitHub ä»“åº“çš„ &lt;code&gt;Settings&lt;/code&gt; - &lt;code&gt;webhooks&lt;/code&gt; è®¾ç½®ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ webhookã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxl5ioq4j312q0u0ac3_hu_5519ae954fff2751.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxl5ioq4j312q0u0ac3.jpg&#34; data-img=&#34;/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxl5ioq4j312q0u0ac3.jpg&#34; data-width=&#34;1394&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;GitHub Webhook é…ç½®&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;GitHub Webhook é…ç½®&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;æ³¨æ„é€‰æ‹© Content Type ä¸º &lt;code&gt;application/json&lt;/code&gt;ï¼Œsecret è®¾ç½®æˆä¸ &lt;code&gt;webhook.js&lt;/code&gt; ä¸­çš„ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œæˆå GitHub å°†è‡ªåŠ¨è°ƒç”¨ Webhook ä»¥éªŒè¯æœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxnir7ckj316a0ke3zd_hu_9cc7dd47a683e17d.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxnir7ckj316a0ke3zd.jpg&#34; data-img=&#34;/blog/github-webhook-website-auto-deploy/006tNc79ly1g4uxnir7ckj316a0ke3zd.jpg&#34; data-width=&#34;1522&#34; data-height=&#34;734&#34; alt=&#34;image&#34; data-caption=&#34;GitHub è‡ªåŠ¨è§¦å‘ Webhook&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;GitHub è‡ªåŠ¨è§¦å‘ Webhook&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;å¦‚æœçœ‹åˆ° 200 å“åº”è¡¨ç¤ºæˆåŠŸè°ƒç”¨ Webhook åç«¯æœåŠ¡ï¼Œè¿™æ ·æ¯æ¬¡æˆ‘ä»¬çš„ä»“åº“åˆå¹¶åå°±ä¼šè§¦å‘ç½‘ç«™è‡ªåŠ¨éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¤š&#34;&gt;æ›´å¤š&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†åŠ å¼º GitHub è‡ªåŠ¨åŒ–ï¼Œè¿˜æœ‰æ›´å¤š GitHub App å¯ä»¥ä½¿ç”¨ï¼Œæ¨èï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/apps/auto-assign&#34; title=&#34;auto-assigin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;auto-assigin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/apps/mergify&#34; title=&#34;mergify&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mergify&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›å·²ç»åœ¨ &lt;code&gt;servicemesher.com&lt;/code&gt; ç½‘ç«™ä¸Šé›†æˆäº†ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è®¿é—® &lt;a href=&#34;https://github.com/servicemesher/website&#34; title=&#34;ServiceMesher å®˜ç½‘çš„ä»£ç ä»“åº“&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ServiceMesher å®˜ç½‘çš„ä»£ç ä»“åº“&lt;/a&gt;æŸ¥çœ‹é…ç½®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://aotu.io/notes/2016/01/07/auto-deploy-website-by-webhooks-of-github/index.html&#34; title=&#34;ä½¿ç”¨ Github çš„ webhooks è¿›è¡Œç½‘ç«™è‡ªåŠ¨åŒ–éƒ¨ç½²&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Github çš„ webhooks è¿›è¡Œç½‘ç«™è‡ªåŠ¨åŒ–éƒ¨ç½²&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>ä½¿ç”¨ Certbot ä¸ºç½‘ç«™è®¾ç½®æ°¸ä¹…å…è´¹çš„ HTTPS è¯ä¹¦</title>
      <link>https://jimmysong.io/blog/free-certificates-with-certbot/</link>
      <pubDate>Fri, 05 Jul 2019 21:10:57 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/free-certificates-with-certbot/</guid>
      <description>
        
        
        &lt;p&gt;æˆ‘çš„åšå®¢ä»ä¸Šçº¿ç¬¬ä¸€å¤©èµ·å°±ä½¿ç”¨äº† HTTPSï¼Œç”¨çš„æ˜¯ &lt;a href=&#34;https://www.cloudflare.com/zh-cn/&#34; title=&#34;Cloudflare&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cloudflare&lt;/a&gt;ï¼Œç›´æ¥åœ¨å…¶åå°é…ç½®å³å¯ã€‚å¦‚æœä½ æ˜¯ç”¨ nginxã€apacheã€haproxy ç­‰æœåŠ¡å™¨æ¥è¿è¡Œè‡ªå·±çš„ç½‘ç«™ï¼Œç»™å¤§å®¶æ¨è &lt;a href=&#34;https://certbot.eff.org/&#34; title=&#34;Certbot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Certbot&lt;/a&gt;ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æ¥é…ç½® SSL è¯ä¹¦å’Œå®šæ—¶æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è®°å½•æˆ‘è‡ªå·±ä¸º &lt;code&gt;servicemesher.com&lt;/code&gt; ç½‘ç«™é…ç½® HTTPS è¯ä¹¦çš„è¿‡ç¨‹ï¼Œå…¨ç¨‹ä¸éœ€è¦ 5 åˆ†é’Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¯å¢ƒ&#34;&gt;ç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;ç½‘ç«™çš„æ‰˜ç®¡ç¯å¢ƒå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OSï¼šCentOS 7.6 é˜¿é‡Œäº‘&lt;/li&gt;
&lt;li&gt;ç½‘ç«™æœåŠ¡å™¨ï¼šNginxï¼Œä½¿ç”¨ yum å®‰è£…ï¼Œç‰ˆæœ¬ 1.12&lt;/li&gt;
&lt;li&gt;æå‰é…ç½®å¥½ Nginxï¼Œç¡®ä¿ä½¿ç”¨ HTTP å…ˆå¯ä»¥è®¿é—®åˆ°ç½‘ç«™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼šè¯·ä½¿ç”¨ &lt;code&gt;yum&lt;/code&gt; å‘½ä»¤å®‰è£… nginxï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ nginx å®‰è£…åœ¨é»˜è®¤çš„ä½ç½®ï¼Œå› ä¸º certbot ä¼šæ£€æµ‹ &lt;code&gt;/etc/nginx/&lt;/code&gt; ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ“ä½œæ­¥éª¤&#34;&gt;æ“ä½œæ­¥éª¤&lt;/h2&gt;
&lt;p&gt;æ‰§è¡Œä¸‹é¢çš„æ­¥éª¤å¯ä»¥ç›´æ¥ä¸ºä½ çš„ç½‘ç«™é…ç½® HTTPS è¯ä¹¦ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;yum -y install yum-utils
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;yum-config-manager --enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;yum install certbot python2-certbot-nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹å›¾æ˜¯åœ¨ Certbot ä¸­é€‰æ‹©æœåŠ¡å™¨å’Œæ“ä½œç³»ç»Ÿçš„é¡µé¢ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/free-certificates-with-certbot/006tNc79ly1g4oqftr4fdj31e20u0gn8_hu_e71688bc94845cc0.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/free-certificates-with-certbot/006tNc79ly1g4oqftr4fdj31e20u0gn8.jpg&#34; data-img=&#34;/blog/free-certificates-with-certbot/006tNc79ly1g4oqftr4fdj31e20u0gn8.jpg&#34; data-width=&#34;1802&#34; data-height=&#34;1080&#34; alt=&#34;image&#34; data-caption=&#34;CertBot é¡µé¢&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;CertBot é¡µé¢&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ ¹æ®æç¤ºä¼šè‡ªåŠ¨é…ç½® nginxã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;certbot --nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Saving debug log to /var/log/letsencrypt/letsencrypt.log
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Plugins selected: Authenticator nginx, Installer nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting new HTTPS connection &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: acme-v02.api.letsencrypt.org
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Which names would you like to activate HTTPS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;?
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1ï¼šservicemesher.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2: www.servicemsher.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¿™é‡Œç›´æ¥å›è½¦é€‰æ‹©æ‰€æœ‰çš„åŸŸå&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Select the appropriate numbers separated by commas and/or spaces, or leave input
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;blank to &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; all options shown &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Enter &lt;span class=&#34;s1&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt; to cancel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;You have an existing certificate that contains a portion of the domains you
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;requested &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ref: /etc/letsencrypt/renewal/servicemesher.com.conf&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;It contains these names: servicemesher.com, www.servicemesher.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;You requested these names &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the new certificate: servicemesher.com,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;prow.servicemesher.com, www.servicemesher.com.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Do you want to expand and replace this existing certificate with the new
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;certificate?
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;xpand/&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;C&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ancel: E
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Renewing an existing certificate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Performing the following challenges:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;http-01 challenge &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; prow.servicemesher.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Waiting &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; verification...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Cleaning up challenges
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Deploying Certificate to VirtualHost /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Deploying Certificate to VirtualHost /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Deploying Certificate to VirtualHost /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1: No redirect - Make no further changes to the webserver configuration.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2: Redirect - Make all requests redirect to secure HTTPS access. Choose this &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;new sites, or &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you&lt;span class=&#34;s1&#34;&gt;&amp;#39;re confident your site works on HTTPS. You can undo this
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;change by editing your web server&amp;#39;&lt;/span&gt;s configuration.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Select the appropriate number &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1-2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;enter&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;press &lt;span class=&#34;s1&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt; to cancel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¿™é‡Œæ˜¯ä¸ºäº†æ‰©å±•è¯ä¹¦æ”¯æŒæ›´å¤šçš„åŸŸåï¼Œæ‰€æœ‰è¾“å…¥ 2 å›è½¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Traffic on port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; already redirecting to ssl in /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Redirecting all traffic on port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; to ssl in /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Traffic on port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; already redirecting to ssl in /etc/nginx/nginx.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Your existing certificate has been successfully renewed, and the new certificate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;has been installed.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åé‡æ–°åŠ è½½é…ç½®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nginx -t&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;nginx -s reload
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®¾ç½®è¯ä¹¦è‡ªåŠ¨æ›´æ–°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0 0,12 * * * root python -c &amp;#39;import random; import time; time.sleep(random.random() * 3600)&amp;#39; &amp;amp;&amp;amp; certbot renew&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sudo tee -a /etc/crontab &amp;gt; /dev/null
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½äº†ç°åœ¨è®¿é—®ä½ çš„ç½‘ç«™å°±å¯ä»¥çœ‹åˆ° https å¤´éƒ¨åŠ äº† HTTPS é”äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csdn.net/xs18952904/article/details/79262646&#34; title=&#34;è®©ç½‘ç«™æ°¸ä¹…æ‹¥æœ‰ HTTPS - ç”³è¯·å…è´¹ SSL è¯ä¹¦å¹¶è‡ªåŠ¨ç»­æœŸ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®©ç½‘ç«™æ°¸ä¹…æ‹¥æœ‰ HTTPS - ç”³è¯·å…è´¹ SSL è¯ä¹¦å¹¶è‡ªåŠ¨ç»­æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;certbot - å…è´¹çš„ https è¯ä¹¦&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
                           
    <item>
      <title>å®¹å™¨æŠ€æœ¯åœ¨å¤§æ•°æ®åœºæ™¯ä¸‹çš„åº”ç”¨â€”â€”YARN on Docker</title>
      <link>https://jimmysong.io/blog/yarn-on-docker/</link>
      <pubDate>Tue, 04 Apr 2017 00:19:04 +0800</pubDate>
      <author>Jimmy Song</author>
      <guid>https://jimmysong.io/blog/yarn-on-docker/</guid>
      <description>
        
        
        &lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;æˆ‘å·²å°±è¯¥è¯é¢˜å·²åœ¨ 2016 å¹´ä¸Šæµ· Qcon ä¸Šå‘è¡¨è¿‡æ¼”è®²ã€‚å¦å¤– InfoQ ç½‘ç«™ä¸Šçš„æ–‡å­—ç‰ˆ&lt;a href=&#34;https://www.infoq.cn/article/YARNOnDocker-forDCCluster/&#34; title=&#34;æ•°æ®ä¸­å¿ƒçš„ YARN on Docker é›†ç¾¤æ–¹æ¡ˆ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°æ®ä¸­å¿ƒçš„ YARN on Docker é›†ç¾¤æ–¹æ¡ˆ&lt;/a&gt;ï¼Œå³æœ¬æ–‡ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®ä»£ç å¼€æºåœ¨ Github ä¸Šï¼š&lt;a href=&#34;https://github.com/rootsongjc/magpie&#34; title=&#34;Magpie&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Magpie&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å½“å‰æ•°æ®ä¸­å¿ƒå­˜åœ¨çš„é—®é¢˜&#34;&gt;å½“å‰æ•°æ®ä¸­å¿ƒå­˜åœ¨çš„é—®é¢˜&lt;/h2&gt;
&lt;p&gt;æ•°æ®ä¸­å¿ƒä¸­çš„åº”ç”¨ä¸€èˆ¬ç‹¬ç«‹éƒ¨ç½²ï¼Œä¸ºäº†ä¿è¯ç¯å¢ƒéš”ç¦»ä¸æ–¹ä¾¿ç®¡ç†ï¼Œä¿è¯åº”ç”¨æœ€å¤§èµ„æºÂ  æ•°æ®ä¸­å¿ƒä¸­æ™®éå­˜åœ¨å¦‚ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸»æœºèµ„æºåˆ©ç”¨ç‡ä½&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²å’Œæ‰©å±•å¤æ‚&lt;/li&gt;
&lt;li&gt;èµ„æºéš”ç¦»æ— æ³•åŠ¨æ€è°ƒæ•´&lt;/li&gt;
&lt;li&gt;æ— æ³•å¿«é€Ÿå“åº”ä¸šåŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸ºä½•ä½¿ç”¨-yarn-on-docker&#34;&gt;ä¸ºä½•ä½¿ç”¨ YARN on Docker&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å½»åº•éš”ç¦»é˜Ÿåˆ—&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºäº†åˆç†åˆ©ç”¨ Hadoop YARN çš„èµ„æºï¼Œé˜Ÿåˆ—é—´ä¼šäº’ç›¸æŠ¢å è®¡ç®—èµ„æºï¼Œé€ æˆé‡è¦ä»»åŠ¡é˜»å¡&lt;/li&gt;
&lt;li&gt;æ ¹æ®éƒ¨é—¨ç”³è¯·çš„æœºå™¨æ•°é‡åˆ’åˆ† YARN é›†ç¾¤æ–¹ä¾¿è´¢åŠ¡ç®¡ç†&lt;/li&gt;
&lt;li&gt;æ›´ç»†ç²’åº¦çš„èµ„æºåˆ†é…Â &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç»Ÿä¸€çš„èµ„æºåˆ†é…&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª NodeManager å’Œå®¹å™¨éƒ½å¯ä»¥é™å®š CPUã€å†…å­˜èµ„æº&lt;/li&gt;
&lt;li&gt;YARN èµ„æºåˆ’åˆ†ç²¾ç¡®åˆ° CPU æ ¸æ•°å’Œå†…å­˜å¤§å°Â &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¼¹æ€§ä¼¸ç¼©æ€§æœåŠ¡&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªå®¹å™¨ä¸­è¿è¡Œä¸€ä¸ª NodeManagerï¼Œå¢å‡ YARN èµ„æºåªéœ€å¢å‡å®¹å™¨ä¸ªæ•°&lt;/li&gt;
&lt;li&gt;å¯ä»¥æŒ‡å®šæ¯ä¸ª NodeManager æ‹¥æœ‰çš„è®¡ç®—èµ„æºå¤šå°‘ï¼ŒæŒ‰éœ€ç”³è¯·èµ„æºÂ &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„&#34;&gt;ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„ï¼ŸÂ &lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Swarm ç»Ÿä¸€é›†ç¾¤èµ„æºè°ƒåº¦&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»Ÿä¸€èµ„æº&lt;/li&gt;
&lt;li&gt;å¢åŠ  Docker è™šæ‹ŸåŒ–å±‚ï¼Œé™ä½è¿ç»´æˆæœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¢åŠ  Hadoop é›†ç¾¤èµ„æºåˆ©ç”¨ç‡&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºæ•°æ®ä¸­å¿ƒï¼šé¿å…äº†é™æ€èµ„æºéš”ç¦»&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºé›†ç¾¤ï¼šåŠ å¼ºé›†ç¾¤å†…éƒ¨èµ„æºéš”ç¦»&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç³»ç»Ÿæ¶æ„&#34;&gt;ç³»ç»Ÿæ¶æ„&lt;/h2&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch_hu_d2139ed276213bf.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_arch.jpg&#34; data-width=&#34;530&#34; data-height=&#34;908&#34; alt=&#34;image&#34; data-caption=&#34;YARN åœ¨ swarm ä¸Šè¿è¡Œçš„æ¶æ„&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;YARN åœ¨ swarm ä¸Šè¿è¡Œçš„æ¶æ„&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;æ¯”å¦‚æ•°æ®ä¸­å¿ƒä¸­è¿è¡Œçš„ Hadoop é›†ç¾¤ï¼Œæˆ‘ä»¬å°† HDFS ä¾ç„¶è¿è¡Œåœ¨ç‰©ç†æœºä¸Šï¼Œå³ DataNode ä¾ç„¶éƒ¨ç½²åœ¨å®ä½“æœºå™¨ä¸Šï¼Œå°† YARN è®¡ç®—å±‚è¿è¡Œåœ¨ Docker å®¹å™¨ä¸­ï¼Œæ•´ä¸ªç³»ç»Ÿä½¿ç”¨äºŒå±‚èµ„æºè°ƒåº¦ï¼ŒSparkã€Flinkã€MapReduce ç­‰åº”ç”¨è¿è¡Œåœ¨ YARN ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;Swarm è°ƒåº¦æœ€åº•å±‚çš„ä¸»æœºç¡¬ä»¶èµ„æºï¼ŒCPU å’Œå†…å­˜å°è£…ä¸º Docker å®¹å™¨ï¼Œå®¹å™¨ä¸­è¿è¡Œ NodeManagerï¼Œæä¾›ç»™ YARN é›†ç¾¤ï¼Œä¸€ä¸ª Swarm é›†ç¾¤ä¸­å¯ä»¥è¿è¡Œå¤šä¸ª YARN é›†ç¾¤ï¼Œå½¢æˆåœˆåœ°å¼çš„ YARN è®¡ç®—é›†ç¾¤ã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch2_hu_b6411f39f6e1d048.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch2.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_arch2.jpg&#34; data-width=&#34;518&#34; data-height=&#34;328&#34; alt=&#34;image&#34; data-caption=&#34;YARN åœ¨ Swarm ä¸Šçš„æ¶æ„ä¹‹èµ„æºåˆ†é…&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;YARN åœ¨ Swarm ä¸Šçš„æ¶æ„ä¹‹èµ„æºåˆ†é…&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å…·ä½“æµç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;swarm node å‘ swarm master æ³¨å†Œä¸»æœºèµ„æºå¹¶åŠ å…¥åˆ° swarm cluster ä¸­&lt;/li&gt;
&lt;li&gt;swarm master å‘ cluster ç”³è¯·èµ„æºè¯·æ±‚å¯åŠ¨å®¹å™¨&lt;/li&gt;
&lt;li&gt;swarm æ ¹æ®è°ƒåº¦ç­–ç•¥é€‰æ‹©åœ¨æŸä¸ª node ä¸Šå¯åŠ¨ docker container&lt;/li&gt;
&lt;li&gt;swarm node çš„ docker daemon æ ¹æ®å®¹å™¨å¯åŠ¨å‚æ•°å¯åŠ¨ç›¸åº”èµ„æºå¤§å°çš„ NodeManager&lt;/li&gt;
&lt;li&gt;NodeManager è‡ªåŠ¨å‘ YARN çš„ ResourceManager æ³¨å†Œèµ„æºä¸€ä¸ª NodeManager èµ„æºæ·»åŠ å®Œæˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Swarm ä¸ºæ•°æ®ä¸­å¿ƒåšå®¹å™¨å³ä¸»æœºèµ„æºè°ƒåº¦ï¼Œæ¯ä¸ª swarmnode çš„èŠ‚ç‚¹ç»“æ„å¦‚å›¾ï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch3_hu_6ce413c50470883.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_arch3.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_arch3.jpg&#34; data-width=&#34;392&#34; data-height=&#34;324&#34; alt=&#34;image&#34; data-caption=&#34;YARN åœ¨ swarm ä¸Šçš„æ¶æ„ä¹‹å•èŠ‚ç‚¹èµ„æºåˆ†é…&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;YARN åœ¨ swarm ä¸Šçš„æ¶æ„ä¹‹å•èŠ‚ç‚¹èµ„æºåˆ†é…&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä¸€ä¸ª Swarm node å°±æ˜¯ä¸€å°ç‰©ç†æœºï¼Œæ¯å°ä¸»æœºä¸Šå¯ä»¥èµ·å¤šä¸ªåŒç±»å‹çš„ docker containerï¼Œæ¯ä¸ª container çš„èµ„æºéƒ½æœ‰é™åˆ¶åŒ…æ‹¬ CPUã€å†…å­˜ NodeManager å®¹å™¨åªéœ€è¦è€ƒè™‘æœ¬èº«è¿›ç¨‹å ç”¨çš„èµ„æºå’Œéœ€è¦ç»™ä¸»æœºé¢„ç•™èµ„æºã€‚å‡å¦‚ä¸»æœºæ˜¯ 24 æ ¸ 64Gï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ç»™ä¸€ä¸ªå®¹å™¨ 5 æ ¸ 12Gï¼ŒNodeManager å ç”¨ 4 æ ¸ 10G çš„èµ„æºæä¾›ç»™ YARNã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes VS Swarm&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…³äºå®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿçš„é€‰å‹ï¼Œç”¨ Kubernetes è¿˜æ˜¯ Swarmï¼Ÿæˆ‘ä»¬ç»“åˆè‡ªå·±çš„ç»éªŒå’Œä¸šåŠ¡éœ€æ±‚ï¼Œå¯¹æ¯”å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_compare_hu_bf4438d297fb67a2.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_compare.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_compare.jpg&#34; data-width=&#34;1002&#34; data-height=&#34;256&#34; alt=&#34;image&#34; data-caption=&#34;Kubernetes vs Swarm&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;Kubernetes vs Swarm&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;åŸºäºä»¥ä¸Šå››ç‚¹ï¼Œæˆ‘ä»¬å½“æ—¶é€‰æ‹©äº† Swarmï¼Œå®ƒåŸºæœ¬æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼ŒæŒæ¡å’Œå¼€å‘æ—¶å¸¸è¾ƒçŸ­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é•œåƒåˆ¶ä½œä¸å‘å¸ƒ&#34;&gt;é•œåƒåˆ¶ä½œä¸å‘å¸ƒ&lt;/h2&gt;
&lt;p&gt;é•œåƒåˆ¶ä½œå’Œå‘å¸ƒæµç¨‹å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_ci_hu_5dfd32c2725645d7.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_ci.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_ci.jpg&#34; data-width=&#34;732&#34; data-height=&#34;352&#34; alt=&#34;image&#34; data-caption=&#34;CI æµç¨‹&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;CI æµç¨‹&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ç”¨æˆ·ä»å®¢æˆ·ç«¯æäº¤ä»£ç åˆ° Gitlab ä¸­ï¼Œéœ€è¦åŒ…å« Dockerfile æ–‡ä»¶ï¼Œé€šè¿‡é›†æˆäº† docker æ’ä»¶çš„ Jenkins çš„è‡ªåŠ¨ç¼–è¯‘å‘å¸ƒæœºåˆ¶ï¼Œè‡ªåŠ¨ build é•œåƒå push åˆ° docker é•œåƒä»“åº“ä¸­ï¼ŒåŒä¸€ä¸ªé¡¹ç›®æ¯æäº¤ä¸€æ¬¡ä»£ç éƒ½ä¼šé‡æ–° build ä¸€æ¬¡é•œåƒï¼Œç”Ÿæˆä¸åŒçš„ tag æ¥æ ‡è¯†é•œåƒï¼ŒSwarm é›†ç¾¤ä½¿ç”¨è¯¥é•œåƒä»“åº“å°±å¯ä»¥ç›´æ¥æ‹‰å–é•œåƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;dockerfile-çš„ç¼–å†™æŠ€å·§&#34;&gt;Dockerfile çš„ç¼–å†™æŠ€å·§&lt;/h3&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_dockerfile_hu_e074729d17689881.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_dockerfile.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_dockerfile.jpg&#34; data-width=&#34;642&#34; data-height=&#34;236&#34; alt=&#34;image&#34; data-caption=&#34;Dockerfile ç¼–å†™æŠ€å·§&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;Dockerfile ç¼–å†™æŠ€å·§&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;Dockerfile ç›¸å½“äº docker é•œåƒçš„ç¼–è¯‘æ‰“åŒ…æµç¨‹è¯´æ˜ï¼Œå…¶ä¸­ä¹Ÿä¸ä¹ä¸€äº›æŠ€å·§ã€‚Â Â  Â Â &lt;/p&gt;
&lt;p&gt;å¾ˆå¤šåº”ç”¨éœ€è¦é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæƒ³ä¸ºæ¯æ¬¡å¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨ä¸åŒçš„é…ç½®å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ç¯å¢ƒå˜é‡çš„æ–¹å¼æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå‰ææ˜¯éœ€è¦å†™ä¸€ä¸ª bash è„šæœ¬ï¼Œè„šæœ¬ä¸­æ¥å¤„ç†é…ç½®æ–‡ä»¶ï¼Œå†å°†è¿™ä¸ªè„šæœ¬ä½œä¸º entrypoint å…¥å£ï¼Œæ¯å½“å®¹å™¨å¯åŠ¨æ—¶å°±ä¼šæ‰§è¡Œè¿™ä¸ªè„šæœ¬ä»è€Œæ›¿æ¢é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ CMD ä¼ é€’å‚æ•°ç»™è¯¥è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å¯åŠ¨å®¹å™¨çš„æ—¶å€™é€šè¿‡ä¼ é€’ç¯å¢ƒå˜é‡çš„æ–¹å¼ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -d 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--net&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;mynet 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-e &lt;span class=&#34;nv&#34;&gt;NAMESERVICE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;nameservice 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-e &lt;span class=&#34;nv&#34;&gt;ACTIVE_NAMENODE_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;namenode29 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;STANDBY_NAMENODE_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;namenode63 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;HA_ZOOKEEPER_QUORUM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;zk1:2181,zk2:2181,zk3:2181 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;YARN_ZK_DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;rmstore &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;YARN_CLUSTER_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;yarnRM &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;YARN_RM1_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;rm1 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;YARN_RM2_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;rm2 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;CPU_CORE_NUM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-e &lt;span class=&#34;nv&#34;&gt;NODEMANAGER_MEMORY_MB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;12288&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;YARN_JOBHISTORY_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;jobhistory &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;ACTIVE_NAMENODE_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;active-namenode &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;STANDBY_NAMENODE_IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;standby-namenode &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;-e &lt;span class=&#34;nv&#34;&gt;HA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;yes &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;docker-registry/library/hadoop-yarn:v0.1 resourcemanager
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åä¼ é€’ Resource Manager æˆ–è€… Node Manager å‚æ•°æŒ‡å®šå¯åŠ¨ç›¸åº”çš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›†ç¾¤ç®¡ç†&#34;&gt;é›†ç¾¤ç®¡ç†&lt;/h2&gt;
&lt;p&gt;æˆ‘å¼€å‘çš„å‘½ä»¤è¡Œå·¥å…·&lt;a href=&#34;https://github.com/rootsongjc/magpie&#34; title=&#34;magpie&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;magpie&lt;/a&gt;ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–å¼€æºå¯è§†åŒ–é¡µé¢æ¥ç®¡ç†é›†ç¾¤ï¼Œæ¯”å¦‚ shipyardã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_shipyard_hu_323837962a875f84.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_shipyard.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_shipyard.jpg&#34; data-width=&#34;982&#34; data-height=&#34;370&#34; alt=&#34;image&#34; data-caption=&#34;Shipyard&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;Shipyard&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;h2 id=&#34;è‡ªå®šä¹‰ç½‘ç»œ&#34;&gt;è‡ªå®šä¹‰ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;Docker å®¹å™¨è·¨ä¸»æœºäº’è®¿ä¸€ç›´æ˜¯ä¸€ä¸ªé—®é¢˜ï¼ŒDocker å®˜æ–¹ä¸ºäº†é¿å…ç½‘ç»œä¸Šå¸¦æ¥çš„è¯¸å¤šéº»çƒ¦ï¼Œæ•…å°†è·¨ä¸»æœºç½‘ç»œå¼€äº†æ¯”è¾ƒå¤§çš„å£å­ï¼Œè€Œç”±ç”¨æˆ·è‡ªå·±å»å®ç°ã€‚æˆ‘ä»¬å¼€å‘å¹¶å¼€æºäº† Shrike è¿™ä¸ª docker ç½‘ç»œæ’ä»¶ï¼Œå¤§å®¶å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½åˆ°ï¼š&lt;a href=&#34;https://github.com/rootsongjc/docker-ipam-plugin&#34; title=&#34;GitHub - docker-ipam-plugin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub - docker-ipam-plugin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰ Docker è·¨ä¸»æœºçš„ç½‘ç»œå®ç°æ–¹æ¡ˆä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œä¸»è¦åŒ…æ‹¬ç«¯å£æ˜ å°„ã€ovsã€fannel ç­‰ã€‚ä½†æ˜¯è¿™äº›æ–¹æ¡ˆéƒ½æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œç«¯å£æ˜ å°„æœåŠ¡å†…çš„å†…ç½‘ IP ä¼šæ˜ å°„æˆå¤–ç½‘çš„ IPï¼Œè¿™æ ·ä¼šç»™å¼€å‘å¸¦æ¥å›°æƒ‘ï¼Œå› ä¸ºä»–ä»¬å¾€å¾€åœ¨è·¨ç½‘ç»œäº¤äº’æ—¶æ˜¯ä¸éœ€è¦å†…ç½‘ IP çš„ï¼Œè€Œ ovs ä¸ fannel åˆ™æ˜¯åœ¨åŸºç¡€ç½‘ç»œåè®®ä¸ŠåˆåŒ…è£…äº†ä¸€å±‚è‡ªå®šä¹‰åè®®ï¼Œè¿™æ ·å½“ç½‘ç»œæµé‡å¤§æ—¶ï¼Œå´åˆæ— ç«¯çš„å¢åŠ äº†ç½‘ç»œè´Ÿè½½ï¼Œæœ€åæˆ‘ä»¬é‡‡å–äº†è‡ªä¸»ç ”å‘æ‰å¹³åŒ–ç½‘ç»œæ’ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´è®©æ‰€æœ‰çš„å®¹å™¨ç»Ÿç»Ÿåœ¨å¤§äºŒå±‚ä¸Šäº’é€šã€‚æ¶æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_network_hu_652f8a2688184b33.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_network.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_network.jpg&#34; data-width=&#34;828&#34; data-height=&#34;434&#34; alt=&#34;image&#34; data-caption=&#34;YARN ç½‘ç»œ&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;YARN ç½‘ç»œ&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª br0 è‡ªå®šä¹‰ç½‘æ¡¥ï¼Œè¿™ä¸ªç½‘æ¡¥å¹¶ä¸æ˜¯é€šè¿‡ç³»ç»Ÿå‘½ä»¤æ‰‹åŠ¨å»ºç«‹çš„åŸå§‹ Linux ç½‘æ¡¥ï¼Œè€Œæ˜¯é€šè¿‡ Docker çš„ cerate network å‘½ä»¤æ¥å»ºç«‹çš„è‡ªå®šä¹‰ç½‘æ¡¥ï¼Œè¿™æ ·é¿å…äº†ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® DefaultGatewayIPv4 å‚æ•°æ¥è®¾ç½®å®¹å™¨çš„é»˜è®¤è·¯ç”±ï¼Œè¿™ä¸ªè§£å†³äº†åŸå§‹ Linux è‡ªå»ºç½‘æ¡¥ä¸èƒ½è§£å†³çš„é—®é¢˜ã€‚ç”¨ Docker åˆ›å»ºç½‘ç»œæ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® subnet å‚æ•°æ¥è®¾ç½®å­ç½‘ IP èŒƒå›´ï¼Œé»˜è®¤æˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªç½‘æ®µç»™è¿™ä¸ªå­ç½‘ï¼Œåé¢å¯ä»¥ç”¨ ipamdriverï¼ˆåœ°å€ç®¡ç†æ’ä»¶ï¼‰æ¥è¿›è¡Œæ§åˆ¶ã€‚è¿˜æœ‰ä¸€ä¸ªå‚æ•° gateway æ˜¯ç”¨æ¥è®¾ç½® br0 è‡ªå®šä¹‰ç½‘æ¡¥åœ°å€çš„ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä½ è¿™å°å®¿ä¸»æœºçš„åœ°å€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker network create 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--opt&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;com.docker.network.bridge.enable_icc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--opt&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;com.docker.network.bridge.enable_ip_masquerade&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--opt&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;com.docker.network.bridge.host_binding_ipv4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0.0.0.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--opt&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;com.docker.network.bridge.name&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;br0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--opt&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;com.docker.network.driver.mtu&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--ipam-driver&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;talkingdata
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--subnet&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;å®¹å™¨IPçš„å­ç½‘èŒƒå›´
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--gateway&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;br0ç½‘æ¡¥ä½¿ç”¨çš„IP,ä¹Ÿå°±æ˜¯å®¿ä¸»æœºçš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--aux-address&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;DefaultGatewayIPv4&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;å®¹å™¨ä½¿ç”¨çš„ç½‘å…³åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mynet
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_ipam_hu_9fe6fcc65395638f.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_ipam.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_ipam.jpg&#34; data-width=&#34;502&#34; data-height=&#34;390&#34; alt=&#34;image&#34; data-caption=&#34;IPAM æ’ä»¶&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;IPAM æ’ä»¶&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;IPAM é©±åŠ¨æ˜¯ä¸“é—¨ç®¡ç† Docker å®¹å™¨ IP çš„ï¼ŒDocker æ¯æ¬¡å¯åœä¸åˆ é™¤å®¹å™¨éƒ½ä¼šè°ƒç”¨è¿™ä¸ªé©±åŠ¨æä¾›çš„ IP ç®¡ç†æ¥å£ï¼Œç„¶å IP æ¥å£ä¼šå¯¹å­˜å‚¨ IP åœ°å€çš„ Etcd æœ‰ä¸€ä¸ªå¢åˆ æ”¹æŸ¥çš„æ“ä½œã€‚æ­¤æ’ä»¶è¿è¡Œæ—¶ä¼šèµ·ä¸€ä¸ª UnixSocket, ç„¶åä¼šåœ¨&lt;code&gt;docker/run/plugins&lt;/code&gt;ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª.sock æ–‡ä»¶ï¼ŒDockerdaemon ä¹‹åä¼šå’Œè¿™ä¸ª sock æ–‡ä»¶è¿›è¡Œæ²Ÿé€šå»è°ƒç”¨æˆ‘ä»¬ä¹‹å‰å®ç°å¥½çš„å‡ ä¸ªæ¥å£è¿›è¡Œ IP ç®¡ç†ï¼Œä»¥æ­¤æ¥è¾¾åˆ° IP ç®¡ç†çš„ç›®çš„ï¼Œé˜²æ­¢ IP å†²çªã€‚Â &lt;/p&gt;
&lt;p&gt;é€šè¿‡ Docker å‘½ä»¤å»åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œèµ·åä¸º&lt;code&gt;mynet&lt;/code&gt;ï¼ŒåŒæ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç½‘æ¡¥ br0ï¼Œä¹‹åé€šè¿‡æ›´æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶ï¼ˆåœ¨&lt;code&gt;/etc/sysconfig/network-scripts/&lt;/code&gt;ä¸‹ ifcfg-br0ã€ifcfg-é»˜è®¤ç½‘ç»œæ¥å£åï¼‰å°†é»˜è®¤ç½‘ç»œæ¥å£æ¡¥æ¥åˆ° br0 ä¸Šï¼Œé‡å¯ç½‘ç»œåï¼Œæ¡¥æ¥ç½‘ç»œå°±ä¼šç”Ÿæ•ˆã€‚Docker é»˜è®¤åœ¨æ¯æ¬¡å¯åŠ¨å®¹å™¨æ—¶éƒ½ä¼šå°†å®¹å™¨å†…çš„é»˜è®¤ç½‘å¡æ¡¥æ¥åˆ° br0 ä¸Šï¼Œè€Œä¸”å®¿ä¸»æœºçš„ç‰©ç†ç½‘å¡ä¹ŸåŒæ ·æ¡¥æ¥åˆ°äº† br0 ä¸Šäº†ã€‚å…¶å®æ¡¥æ¥çš„åŸç†å°±å¥½åƒæ˜¯ä¸€å°äº¤æ¢æœºï¼ŒDocker å®¹å™¨å’Œå®¿ä¸»æœºç‰©ç†ç½‘ç»œæ¥å£éƒ½æ˜¯æœåŠ¡å™¨ï¼Œé€šè¿‡ vethpair è¿™ä¸ªç½‘ç»œè®¾å¤‡åƒä¸€æ ¹ç½‘çº¿æ’åˆ°äº¤æ¢æœºä¸Šã€‚è‡³æ­¤ï¼Œæ‰€æœ‰çš„å®¹å™¨ç½‘ç»œå·²ç»åœ¨åŒä¸€ä¸ªç½‘ç»œä¸Šå¯ä»¥é€šä¿¡äº†ï¼Œæ¯ä¸€ä¸ª Docker å®¹å™¨å°±å¥½æ¯”æ˜¯ä¸€å°ç‹¬ç«‹çš„è™šæ‹Ÿæœºï¼Œæ‹¥æœ‰å’Œå®¿ä¸»æœºåŒä¸€ç½‘æ®µçš„ IPï¼Œå¯ä»¥å®ç°è·¨ä¸»æœºè®¿é—®äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€§èƒ½ç“¶é¢ˆä¸ä¼˜åŒ–&#34;&gt;æ€§èƒ½ç“¶é¢ˆä¸ä¼˜åŒ–&lt;/h2&gt;
&lt;p&gt;å¤§å®¶å¯èƒ½ä¼šæ‹…å¿ƒè‡ªå®šä¹‰ç½‘ç»œçš„æ€§èƒ½é—®é¢˜ï¼Œä¸ºæ­¤æˆ‘ä»¬ç”¨ iperf è¿›è¡Œäº†ç½‘ç»œæ€§èƒ½æµ‹è¯•ã€‚æˆ‘ä»¬å¯¹æ¯”äº†ä¸åŒä¸»æœºå®¹å™¨é—´çš„ç½‘é€Ÿï¼ŒåŒä¸€ä¸»æœºä¸Šçš„ä¸åŒå®¹å™¨å’Œä¸åŒä¸»æœºé—´çš„ç½‘é€Ÿï¼Œç»“æœå¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_iperf_hu_d22d3795cc1c4f2b.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_iperf.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_iperf.jpg&#34; data-width=&#34;676&#34; data-height=&#34;364&#34; alt=&#34;image&#34; data-caption=&#34;ç½‘ç»œæ€§èƒ½å¯¹æ¯”&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;ç½‘ç»œæ€§èƒ½å¯¹æ¯”&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;p&gt;ä»è¡¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸€ç»„æµ‹è¯•ä¸­ï¼Œå®¹å™¨é—´çš„ç½‘é€Ÿä¸å®¹å™¨æ˜¯åœ¨æƒ³é€šä¸»æœºè¿˜æ˜¯åœ¨ä¸åŒä¸»æœºä¸Šçš„å·®åˆ«ä¸å¤§ï¼Œè¯´æ˜æˆ‘ä»¬çš„ç½‘ç»œæ’ä»¶æ€§èƒ½è¿˜æ˜¯å¾ˆä¼˜å¼‚çš„ã€‚Â &lt;/p&gt;
&lt;h2 id=&#34;hadoop-é…ç½®ä¼˜åŒ–&#34;&gt;Hadoop é…ç½®ä¼˜åŒ–Â &lt;/h2&gt;
&lt;p&gt;å› ä¸ºä½¿ç”¨ docker å°†åŸæ¥ä¸€å°æœºå™¨ä¸€ä¸ª nodemanager ç»™ç»†åŒ–ä¸ºäº†å¤šä¸ªï¼Œä¼šé€ æˆ nodemanager ä¸ªæ•°çš„æˆå€å¢åŠ ï¼Œå› æ­¤ hadoop çš„ä¸€äº›é…ç½®éœ€è¦ç›¸åº”ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;- yarn.nodemanager.localizer.fetch.thread-count éšç€å®¹å™¨æ•°é‡å¢åŠ ï¼Œéœ€è¦ç›¸åº”è°ƒæ•´è¯¥å‚æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;- yarn.resourcemanager.amliveliness-monitor.interval-ms é»˜è®¤1ç§’ï¼Œæ”¹ä¸º10ç§’ï¼Œå¦åˆ™æ—¶é—´å¤ªçŸ­å¯èƒ½å¯¼è‡´æœ‰äº›èŠ‚ç‚¹æ— æ³•æ³¨å†Œ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;- yarn.resourcemanager.resource-tracker.client.thread-count é»˜è®¤50ï¼Œæ”¹ä¸º100ï¼Œéšç€å®¹å™¨æ•°é‡å¢åŠ ï¼Œéœ€è¦ç›¸åº”è°ƒæ•´è¯¥å‚æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;- yarn.nodemanager.pmem-check-enabled é»˜è®¤trueï¼Œæ”¹ä¸ºfalseï¼Œä¸æ£€æŸ¥ä»»åŠ¡æ­£åœ¨ä½¿ç”¨çš„ç‰©ç†å†…å­˜é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;- å®¹å™¨ä¸­hadoop ulimitå€¼ä¿®æ”¹ï¼Œé»˜è®¤4096ï¼Œæ”¹æˆ655350&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;é›†ç¾¤ç›‘æ§&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨ shipyard ç®¡ç†é›†ç¾¤ä¼šæœ‰ä¸€ä¸ªå•ç‹¬çš„ç›‘æ§é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å®šæ—¶é—´æ®µå†…çš„ CPUã€å†…å­˜ã€IOã€ç½‘ç»œä½¿ç”¨çŠ¶å†µã€‚&lt;/p&gt;
&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_monitor_hu_4beee412f67835d7.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_monitor.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_monitor.jpg&#34; data-width=&#34;722&#34; data-height=&#34;382&#34; alt=&#34;image&#34; data-caption=&#34;é›†ç¾¤ç›‘æ§&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;é›†ç¾¤ç›‘æ§&lt;/figcaption&gt;
  
&lt;/figure&gt;
&lt;h2 id=&#34;å…³äºæœªæ¥&#34;&gt;å…³äºæœªæ¥&lt;/h2&gt;
&lt;p&gt;&lt;figure class=&#34;mx-auto text-center&#34;&gt;
  
  
  
    
      
        
          
          &lt;picture&gt;
           &lt;source srcset=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_os_hu_9760c7504c472f4.webp&#34; type=&#34;image/webp&#34;&gt;
           &lt;img src=&#34;https://jimmysong.io/blog/yarn-on-docker/td_yarn_os.jpg&#34; data-img=&#34;/blog/yarn-on-docker/td_yarn_os.jpg&#34; data-width=&#34;820&#34; data-height=&#34;374&#34; alt=&#34;image&#34; data-caption=&#34;YARN çš„æœªæ¥&#34;&gt;
          &lt;/picture&gt;
        
      
    
  
  
  &lt;figcaption&gt;YARN çš„æœªæ¥&lt;/figcaption&gt;
  
&lt;/figure&gt;
Â &lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœªæ¥è§„åˆ’åšçš„æ˜¯ DC/OSï¼ŒåŸºäº Docker çš„åº”ç”¨è‡ªåŠ¨æ‰“åŒ…ç¼–è¯‘åˆ†å‘ç³»ç»Ÿï¼Œè®©å¼€å‘äººå‘˜å¯ä»¥å¾ˆä¾¿æ·çš„ç”³è¯·èµ„æºï¼Œä¸Šä¸‹çº¿æœåŠ¡ï¼Œç®¡ç†åº”ç”¨ã€‚è¦è¾¾åˆ°è¿™ä¸ªç›®æ ‡è¿˜æœ‰å¾ˆå¤šäº‹æƒ…è¦åšï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Service Control Panelï¼šç»Ÿä¸€çš„æ ¹æ®æœåŠ¡æ¥ç®¡ç†çš„ web é¡µé¢&lt;/li&gt;
&lt;li&gt;Loadbalanceï¼šå®¹å™¨æ ¹æ®æœºå™¨è´Ÿè½½æƒ…å†µè‡ªåŠ¨è¿ç§»&lt;/li&gt;
&lt;li&gt;Schedulerï¼šswarm è°ƒåº¦ç­–ç•¥ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;æœåŠ¡é…ç½®æ–‡ä»¶ï¼šæä¾›é•œåƒå¯åŠ¨å‚æ•°çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰å¯åŠ¨å‚æ•°å¯é€šè¿‡æ–‡ä»¶é…ç½®&lt;/li&gt;
&lt;li&gt;ç›‘æ§ï¼šæœåŠ¡çº§åˆ«çš„ç›‘æ§&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åè®°&#34;&gt;åè®°&lt;/h2&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« å†™å¥½çš„æ—¶å€™æ˜¯ 2016 å¹´ 10 æœˆï¼Œè·ç¦»ç°åœ¨æˆ‘æ·»åŠ &lt;strong&gt;å‰è¨€&lt;/strong&gt;å’Œ&lt;strong&gt;åè®°&lt;/strong&gt;çš„å·²ç»å¿«åŠå¹´æ—¶é—´äº†ï¼Œè¿™æ®µæ—¶é—´å†…ä¸šç•Œä¹Ÿå‘ç”Ÿäº†å¾ˆå¤šå˜åŒ–ï¼Œæ¯”å¦‚ docker æ¨å‡º CE å’Œ SE ç‰ˆæœ¬ï¼ŒKubernetes å‘å¸ƒäº† 1.6 ç‰ˆæœ¬ï¼Œäººå·¥æ™ºèƒ½ä¾ç„¶å¤§çƒ­ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥ï¼Œå¯ä»¥è¯´&lt;u&gt;Kubernetes ä¸€å®šä¼šè¿œè¿œè¶…è¶Š Docker æˆä¸ºå®¹å™¨ç¼–æ’é¢†åŸŸçš„ç‹è€…&lt;/u&gt;ï¼Œè¿™æ˜¯æ¯‹åº¸ç½®ç–‘çš„ï¼Œå¯¹äº docker 17.03-CE æˆ‘ä¹Ÿç ”ç©¶è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œå…¶ disgusting çš„ plugin è®©æˆ‘å¯¹äº Docker çš„ç¼–æ’å·²ç»å¤±å»ä¿¡å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®å½“æ—¶å®¹å™¨åœ¨å¤§æ•°æ®åœºæ™¯ä¸‹çš„åº”ç”¨å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œæ¯•ç«Ÿ Hadoop é‚£å¥—ç¬¨é‡çš„ä¸œè¥¿æ”¾åœ¨å®¹å™¨ä¸‹è¿è¡Œï¼Œä¸Šç”Ÿäº§ç¯å¢ƒå®å±ä¸æ˜“ã€‚å¦‚æœè¯´åšåŸå‹éªŒè¯ã€ç ”å‘æµ‹è¯•é‚£è¿˜å¯ä»¥ã€‚è¿™æ ·å°±å¤§å¤§é™åˆ¶äº†å®¹å™¨æŠ€æœ¯åœ¨å¤§æ•°æ®åœºæ™¯ä¸‹çš„åº”ç”¨åœºæ™¯ã€‚ä½¿ç”¨å®¹å™¨çš„ç¼–æ’è°ƒåº¦æ¥å®ç°å¤§æ•°æ®é›†ç¾¤çš„èµ„æºä¼˜åŒ–æœ‰ç‚¹èˆæœ¬é€æœ«ï¼Œ&lt;u&gt;å¦‚æœçœŸçš„è¦ä¼˜åŒ–é›†ç¾¤èµ„æºåˆ©ç”¨ç‡çš„è¯ï¼Œåº”è¯¥è®©ä¸åŒçš„åº”ç”¨æ··è·‘ï¼Œè€Œä¸åº”è¯¥è®©é›†ç¾¤ä¹‹é—´èµ„æºéš”ç¦»ï¼Œæ¯”å¦‚ Web åº”ç”¨è·Ÿå¤§æ•°æ®åº”ç”¨æ··å¸ƒã€‚&lt;/u&gt;ç›®å‰çš„è¿™ç§&lt;strong&gt;YARN on Docker&lt;/strong&gt;æ–¹æ¡ˆå®è´¨ä¸Šæ˜¯å°†åŸæ¥çš„æ•´ä½“ Hadoop YARN é›†ç¾¤åˆ’åˆ†æˆå¤šä¸ªä¸åŒçš„ YARNï¼Œå°†å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»äº†ã€‚å…¶å®è¿™è·Ÿ&lt;strong&gt;Nutanix&lt;/strong&gt;çš„è¶…èåˆæ¶æ„æœ‰ç‚¹åƒï¼ŒNutanix æ˜¯ç”±å‰ Google çš„å·¥ç¨‹å¸ˆåˆ›ç«‹çš„ï¼Œè§£å†³è™šæ‹ŸåŒ–è®¡ç®—ç¯å¢ƒä¸‹çš„å­˜å‚¨é—®é¢˜ï¼Œä¹Ÿæ˜¯å°†å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»ï¼Œå…±äº«å­˜å‚¨ï¼Œè®¡ç®—æ ¹æ®éœ€è¦è°ƒåº¦ã€‚äº‹å®ä¸Š Yahoo å·²ç»æœ‰è§£å†³ Hadoop é›†ç¾¤çš„èµ„æºç»†ç²’åº¦åˆ†é…å’Œè°ƒåº¦é—®é¢˜çš„æ–¹æ¡ˆï¼Œè¿™åº”è¯¥æ˜¯ä» YARN çš„ scheduler å±‚æ¥å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;Swarm å·²æ­»ï¼ŒSwarmkit å°†ç»§ç»­å‘å±•ï¼ŒDocker çš„ Swarm Mode è¿˜ä¼šåœ¨è‰°éš¾ä¸­å‰è¡Œï¼Œç›®å‰çœ‹åˆ°çš„è¶‹åŠ¿ä»ç„¶æ˜¯æ¨¡ä»¿ Kubernentes ä¸ºä¸»ï¼Œæ²¡æœ‰è‡ªå·±é²œæ˜çš„ç‰¹è‰²ï¼ˆé™¤äº†éƒ¨ç½²ç®¡ç†æ–¹ä¾¿æ„å¤–ï¼Œè°è®©å®ƒå°±é›†æˆåœ¨äº† Docker é‡Œå‘¢ï¼Œå°±åƒå½“å¹´ Windows é›†æˆ IE æ‰“è´¥ Netscapeï¼Œä¸è¿‡è¿™ä¸ä¼šå†æ­¤ä¸Šæ¼”äº†ï¼‰ï¼ŒKubernentes åˆæ˜¯ä¸€ä¸ªé€šç”¨çš„èµ„æºè°ƒåº¦æ¡†æ¶ï¼Œå®ƒçš„æœ€å°èµ„æºåˆ’åˆ†æ˜¯&lt;strong&gt;Pod&lt;/strong&gt;è€Œä¸æ˜¯ Dockerï¼Œå®ƒè¿˜å¯ä»¥è¿è¡Œ rktã€containerdã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šå‘¨èµ·æˆ‘å¼€å§‹å°†æ³¨æ„åŠ›å…¨éƒ¨è½¬ç§»åˆ°äº† Kubernentesï¼Œä»¥åè¯·å…³æ³¨æˆ‘çš„&lt;a href=&#34;https://jimmysong.io/tags/kubernetes/&#34; title=&#34;Kuberentes å®è·µ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kuberentes å®è·µ&lt;/a&gt;ç›¸å…³æ–‡ç« ã€‚&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
